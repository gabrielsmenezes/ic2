framework,Id,PostTypeId,AcceptedAnswerId,ParentId,CreationDate,DeletionDate,Score,ViewCount,Body,OwnerUserId,OwnerDisplayName,LastEditorUserId,LastEditorDisplayName,LastEditDate,LastActivityDate,Title,Tags,AnswerCount,CommentCount,FavoriteCount,ClosedDate
Android,28003186,1,28019789,,2015,,16,31689,"<p>What I want to achieve is capturing a picture without showing the preview, sending directly the output to an <code>ImageReader</code>. 
I have used the <a href=""https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/java/com/example/android/camera2basic/Camera2BasicFragment.java"" rel=""noreferrer"">Camera2Basic example</a> as a starting point. 
However, the callback of my <code>ImageReader</code> is never called, hence no image is sent to its <code>Surface</code>.
Do I really need to display a preview first?</p>

<p>This is the camera code, which is ordered following the flow of the asynchronous callbacks:</p>

<pre><code>private ImageReader imageReader;
private Handler backgroundHandler;
private HandlerThread backgroundThread;
private String cameraId;
private CameraDevice cameraDevice;
private CameraCaptureSession cameraCaptureSession;
    @Override
    public void onCreate() {
        setupCamera2();
    }

    private void setupCamera2() {
        CameraManager manager = (CameraManager) getSystemService(Context.CAMERA_SERVICE);

        try {

            for (String cameraId : manager.getCameraIdList()) {
            CameraCharacteristics characteristics = manager.getCameraCharacteristics(cameraId);

            if (characteristics.get(CameraCharacteristics.LENS_FACING) != CameraCharacteristics.LENS_FACING_FRONT) {
                continue;
            }

            this.cameraId = cameraId;

            int[] picSize = Settings.getPictureSize();
            int picWidth = picSize[0];
            int picHeight = picSize[1];

            imageReader = ImageReader.newInstance(picWidth, picHeight, ImageFormat.JPEG, 2);
            imageReader.setOnImageAvailableListener(onImageAvailableListener, backgroundHandler);
            }

        } catch (CameraAccessException | NullPointerException e) {
            e.printStackTrace();
        }
    }


    private void openCamera2() {
        CameraManager manager = (CameraManager) getSystemService(Context.CAMERA_SERVICE);
        try {

            manager.openCamera(cameraId, cameraStateCallback, backgroundHandler);

        } catch (CameraAccessException e) {
            e.printStackTrace();
        }
    }



    private final CameraDevice.StateCallback cameraStateCallback = new CameraDevice.StateCallback() {
        @Override
        public void onOpened(CameraDevice device) {
            cameraDevice = device;
            createCameraCaptureSession();
        }

        @Override
        public void onDisconnected(CameraDevice cameraDevice) {}

        @Override
        public void onError(CameraDevice cameraDevice, int error) {}
    };



    private void createCaptureSession() {
        List&lt;Surface&gt; outputSurfaces = new LinkedList&lt;&gt;();
        outputSurfaces.add(imageReader.getSurface());

        try {

            cameraDevice.createCaptureSession(outputSurfaces, new CameraCaptureSession.StateCallback() {
                @Override
                public void onConfigured(CameraCaptureSession session) {
                    cameraCaptureSession = session;
                }

                @Override
                public void onConfigureFailed(CameraCaptureSession session) {}
            }, null);

        } catch (CameraAccessException e) {
            e.printStackTrace();
        }
    }


    private final ImageReader.OnImageAvailableListener onImageAvailableListener = new ImageReader.OnImageAvailableListener() {
        @Override
        public void onImageAvailable(ImageReader reader) {
            createCaptureRequest();
        }
    };


    private void createCaptureRequest() {
        try {

            CaptureRequest.Builder requestBuilder = cameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_STILL_CAPTURE);
            requestBuilder.addTarget(imageReader.getSurface());

            // Focus
            requestBuilder.set(CaptureRequest.CONTROL_AF_MODE, CaptureRequest.CONTROL_AF_MODE_CONTINUOUS_PICTURE);

            // Orientation
            int rotation = windowManager.getDefaultDisplay().getRotation();
            requestBuilder.set(CaptureRequest.JPEG_ORIENTATION, ORIENTATIONS.get(rotation));

            cameraCaptureSession.capture(requestBuilder.build(), camera2Callback, null);

        } catch (CameraAccessException e) {
            e.printStackTrace();
        }
    }
</code></pre>
",2639515,,3192021,,2016-12-22 11:51:54,2018-03-20 16:37:04,Capture picture without preview using camera2 API,<android><camera>,3,4,18,
Android,50970915,1,,,2018,,33,2247,"<h2>Background</h2>

<p>Phone recording is not really supported on Android, yet some devices support it to some extend. </p>

<p>This made various call recording apps gather as much possible information about devices and what should be done to them, and decide upon this what to do.</p>

<p>Some even offer root solutions.</p>

<p>One such example is <a href=""https://play.google.com/store/apps/details?id=com.boldbeast.recorder&amp;hl=en"" rel=""noreferrer""><strong>boldbeast Call Recorder app</strong></a>, which offers a lot of various configurations to change:</p>

<p><a href=""https://i.stack.imgur.com/SV6Ud.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/SV6Ud.png"" alt=""enter image description here""></a></p>

<ul>
<li><p>""record mode"" . Shows 14 modes for non-rooted devices, and up to 34 for rooted. Also shows ""Alsa mode"" as an option for it, for rooted devices.</p></li>
<li><p>Has ""Tune Audio Effect (""auto tune a groupd of parameters"") . </p></li>
<li><p>Has ""Tune Audio Route"", with the possible values of ""Disabled"", ""Group1"", ""Group2"", ""Group3""</p></li>
<li><p>For rooted devices: </p>

<ul>
<li><p>""change audio controls"" (""auto change audio controls"")</p></li>
<li><p>""change audio driver"" (change audio drive settings to enable record mode 21,22,23,24,31,32,33,34"")</p></li>
<li><p>For rooted devices: ""start input stream""</p></li>
</ul></li>
</ul>

<h2>The problem</h2>

<p>If I'm in need to create a call recording app, there is no other way than to find the various workarounds for various devices, but as it seems other apps use terms that don't appear in the API.</p>

<p>I can't find any of those of the app I've mentioned, for example.</p>

<h2>What I've found</h2>

<p>Other than tons of questions of how to record calls on Android, showing that it doesn't work on all devices, I could find some interesting things. Here are my tries and insights so far:</p>

<ul>
<li><p>There are some Audio recording sources we can use while preparing the recording (docs <a href=""https://developer.android.com/reference/android/media/MediaRecorder.AudioSource"" rel=""noreferrer""><strong>here</strong></a>) , but sadly in each device it might be different. For some, VOICE_CALL works, and for some, others. But at least we can try...</p></li>
<li><p>On OnePlus 2 with Android 6.0.1, incoming calls can be recorded using <a href=""https://developer.android.com/reference/android/media/MediaRecorder.AudioSource.html#VOICE_CALL"" rel=""noreferrer""><strong>VOICE_CALL</strong></a>, but I can't make outgoing calls be recorded there, unless I use MIC as audio source together with speaker turned on. Somehow, the app I've mentioned succeeds recording it without any issues. I'm sure I will see other issues with other Android devices, as I've tried to address this whole topic in the past. Update: I've found <a href=""https://github.com/riul88/call-recorder-for-android"" rel=""noreferrer""><strong>this sample</strong></a> project (also <a href=""https://www.ipragmatech.com/make-call-recording-android-app/"" rel=""noreferrer""><strong>here</strong></a>), which for some reason sleeps for 2 seconds on the UI thread between <code>prepare</code> and <code>start</code> calls of the mediaRecorder. It works fine, and when I did something similar (wait using Handler.postDelayed for 1 second), it worked fine too. The comment that was written there is ""Sometimes prepare takes some time to complete"".</p></li>
<li><p>On Galaxy S7 with Android 8, I've failed to get sound of the other side for outgoing calls AND incoming calls (even with MIC and speaker), no matter what I did, yet the app I've mentioned worked fine.</p></li>
<li><p>To let you try my POC of call recording, I've published an open source github repository <a href=""https://github.com/AndroidDeveloperLB/PhoneCallRecorder"" rel=""noreferrer""><strong>here</strong></a>, having a sample that will record a single call, and let you listen to the most recent one, if all works well.</p></li>
<li><p><a href=""https://github.com/ViktorDegtyarev/CallRecLib"" rel=""noreferrer""><strong>This ""ViktorDegtyarev - CallRecLib"" SDK</strong></a> , which doesn't seem to work at all, and crashes on various Android versions</p></li>
<li><p>These 2 old sample projects : <a href=""https://code.google.com/archive/p/rvoix/downloads"" rel=""noreferrer""><strong>rvoix</strong></a> , <a href=""https://github.com/esnyder/callrecorder"" rel=""noreferrer""><strong>esnyder-callrecorder</strong></a> , both fail to actually record. The second doesn't even seem to work on Android 6.0.1 device, which it's supposed to support.</p></li>
<li><p><a href=""https://github.com/aykuttasil/CallRecorder"" rel=""noreferrer""><strong>aykuttasil - CallRecorder</strong></a> sample and <a href=""https://gitlab.com/axet/android-call-recorder"" rel=""noreferrer""><strong>axet - android-call-recorder</strong></a> sample - both, just like on my POC, don't have any tweaking except for AudioSource, and because of this they fails to record on some cases, such as OnePlus 2 output-audio of outgoing calls.</p></li>
<li><p>Most third party apps only offer the AudioSource tweaking, but some (like ""boldbeast"") do offer more. One example is ""<a href=""https://play.google.com/store/apps/details?hl=en&amp;id=com.appstar.callrecorder"" rel=""noreferrer""><strong>Automatic Call Recorder</strong></a>"" which has ""configuration"" (10 values to choose from, first is ""default"") and ""method"" (5 vales to choose from, first is ""default""). Those apps probably do not want others to understand what those configurations mean, so they put general names. Or, it's just too complicated for everyone (especially for users), so they generalize the names.</p></li>
<li><p>There is an API of ""setMode"" <a href=""https://stuff.mit.edu/afs/sipb/project/android/docs/reference/android/media/AudioManager.html#setMode(int)"" rel=""noreferrer""><strong>here</strong></a>, but it doesn't seem to change upon calling it. I was thinking of maybe change the ""channel"" of where the call is being used, this way, but it doesn't work. It stays on the value of ""2"" during call, which is <a href=""https://stuff.mit.edu/afs/sipb/project/android/docs/reference/android/media/AudioManager.html#MODE_IN_CALL"" rel=""noreferrer""><strong>MODE_IN_CALL</strong></a>.</p></li>
<li><p>There are customized parameters that are available for various devices (each OEM and its own parameters), which can be set <a href=""https://developer.android.com/reference/android/media/AudioManager.html#setParameters(java.lang.String)"" rel=""noreferrer""><strong>here</strong></a> and maybe even via JNI (<a href=""https://stackoverflow.com/a/46804577/878126""><strong>here</strong></a> and <a href=""https://stackoverflow.com/q/37080374/878126""><strong>here</strong></a>) , but I don't get where to get this information from (meaning which pairs of key-value are available). I've searched in a lot of places, but couldn't find any website that talks about which possible parameters are available, and for which devices.</p></li>
<li><p>I was thinking of using <a href=""https://developer.android.com/reference/android/media/AudioRecord"" rel=""noreferrer""><strong>AudioRecord</strong></a> instead of <a href=""https://developer.android.com/reference/android/media/MediaRecorder"" rel=""noreferrer""><strong>MediaRecorder</strong></a> class for recording, thinking that it's a bit low level, so it could give me more power and access to customized capabilities, but it seems to be very similar to MediaRecorder, and even use the same audio sources (example <a href=""https://gist.github.com/kmark/d8b1b01fb0d2febf5770"" rel=""noreferrer""><strong>here</strong></a>).</p></li>
<li><p>Another try I had with low level API, was even further, of using JNI (OpenSL ES for Android). For this, I couldn't find much information (except <a href=""https://developer.android.com/ndk/guides/audio/opensl/opensl-for-android"" rel=""noreferrer""><strong>here</strong></a> and <a href=""https://googlesamples.github.io/android-audio-high-performance/guides/opensl_es.html"" rel=""noreferrer""><strong>here</strong></a>), and only found the 2 samples of Google <a href=""https://github.com/googlesamples/android-ndk"" rel=""noreferrer""><strong>here</strong></a> (called ""audio echo"" and ""native audio""), which are not about recording sound, or at least I don't see them occur. </p></li>
<li><p>Android P might have official way to record calls (read <a href=""https://www.androidpit.com/android-p-news-release-features"" rel=""noreferrer""><strong>here</strong></a> and <a href=""https://www.neowin.net/news/android-p-could-officially-support-call-recording"" rel=""noreferrer""><strong>here</strong></a>). Testing on my Android P DP3 device (Pixel 2), I could record both sides fine in both incoming and outgoing calls, using ""DEFAULT"" as audio source, so maybe the API will finally be official and work on all Android versions. I wrote about it <a href=""https://issuetracker.google.com/issues/110436314"" rel=""noreferrer""><strong>here</strong></a> and <a href=""https://issuetracker.google.com/issues/110433612"" rel=""noreferrer""><strong>here</strong></a>.</p></li>
<li><p>I was thinking that maybe the <a href=""https://developer.android.com/reference/android/media/audiofx/Visualizer"" rel=""noreferrer""><strong>Visualizer</strong></a> class could be a workaround of recording, but according to some StackOverflow post (<a href=""https://stackoverflow.com/a/30157272/878126""><strong>here</strong></a>), the quality it extremely low, so I decided that maybe I shouldn't try it. Plus I couldn't find a sample of how to record from it.</p></li>
<li><p>I've found some parameters that might be available on some devices, <a href=""https://android.googlesource.com/platform/hardware/libhardware/+/jb-mr0-release/include/hardware/audio.h"" rel=""noreferrer""><strong>here</strong></a> (found from <a href=""https://stackoverflow.com/a/37921082/878126""><strong>here</strong></a>), all start with ""AUDIO_PARAMETER_"", but testing on Galaxy S7, all returned empty string. I've also found <a href=""https://twigstechtips.blogspot.com/2013/07/android-enable-noise-cancellation-in.html"" rel=""noreferrer""><strong>this website</strong></a>, that gave me the idea of using <code>audioManager.setParameters(""noise_suppression=off"")</code> together with MIC audio source, but this didn't seem to do anything in the case of Galaxy S7.</p></li>
</ul>

<h2>The questions</h2>

<p>As opposed to other similar questions about this topic, I'm not asking how to record calls. I already know it's a very problematic and complex problem. I already know I will have to address various configurations, and that I will probably use a server to store all of them and find there the best match for each one.</p>

<p>What I want to ask is more about the tweaking and workarounds :</p>

<ol>
<li><p>Is there a list of configurations for the various devices, Android versions, and what to choose for each?</p></li>
<li><p>Besides Audio source, which other configuration is possible to be used?</p></li>
<li><p>Which parameters are possible for the various devices and Android versions ? Are there any websites of the OEMs describing them? </p></li>
<li><p>What are the various terms in the app I've mentioned? Where can I find information of how to change them?</p></li>
<li><p>Which tools are available for rooted devices?</p></li>
<li><p>Is it possible to know which device supports call recording and which not, by using the API ? </p></li>
<li><p>About the workaround of OnePlus 2, to wait a moment till we start recording, why is it needed? Is it needed on all Android versions? Is it a known issue? Would 1 second be enough?</p></li>
<li><p>How come on the Galaxy S7 I've failed to record the other side even when using MIC&amp;speaker? </p></li>
</ol>
",878126,,878126,,2018-06-26 12:21:11,2018-12-10 16:59:01,How do some apps overcome phone recording restrictions?,<android><audio><call-recording>,1,12,17,
Android,32021193,1,32029162,,2015,,27,25619,"<p>I've been playing with the sample code from the new Google Barcode API.  It overlays a box and the barcode value over the live camera feed of a barcode.  (Also faces)</p>

<p>I can't tell how to return a barcode value to my app.  A) How to tell when a detection event has occurred and B) how to access the ravValue for use in other parts of my app.  Can anyone help with this?</p>

<p><a href=""https://developers.google.com/vision/multi-tracker-tutorial"">https://developers.google.com/vision/multi-tracker-tutorial</a></p>

<p><a href=""https://github.com/googlesamples/android-vision"">https://github.com/googlesamples/android-vision</a></p>

<p><strong>UPDATE:</strong>
Building on @pm0733464's answer, I added a callback interface (called onFound) to the Tracker class that I could access in the Activity. Adapting the Google multi-tracker sample:</p>

<p><strong>GraphicTracker</strong>:</p>

<pre><code>class GraphicTracker&lt;T&gt; extends Tracker&lt;T&gt; {
    private GraphicOverlay mOverlay;
    private TrackedGraphic&lt;T&gt; mGraphic;
    private Callback mCallback;

    GraphicTracker(GraphicOverlay overlay, TrackedGraphic&lt;T&gt; graphic, Callback callback) {
        mOverlay = overlay;
        mGraphic = graphic;
        mCallback = callback;
    }

    public interface Callback {
        void onFound(String barcodeValue);
    }

    @Override
    public void onUpdate(Detector.Detections&lt;T&gt; detectionResults, T item) {
        mCallback.onFound(((Barcode) item).rawValue);
        mOverlay.add(mGraphic);
        mGraphic.updateItem(item);
    }
</code></pre>

<p><strong>BarcodeTrackerFactory</strong> :</p>

<pre><code>class BarcodeTrackerFactory implements MultiProcessor.Factory&lt;Barcode&gt; {
    private GraphicOverlay mGraphicOverlay;
    private GraphicTracker.Callback mCallback;

    BarcodeTrackerFactory(GraphicOverlay graphicOverlay, GraphicTracker.Callback callback) {
        mGraphicOverlay = graphicOverlay;
        mCallback = callback;
    }

    @Override
    public Tracker&lt;Barcode&gt; create(Barcode barcode) {
        BarcodeGraphic graphic = new BarcodeGraphic(mGraphicOverlay);
        return new GraphicTracker&lt;&gt;(mGraphicOverlay, graphic, mCallback);
    }
}
</code></pre>

<p><strong>Main Activity:</strong></p>

<pre><code>BarcodeDetector barcodeDetector = new BarcodeDetector.Builder(context).build();
BarcodeTrackerFactory barcodeFactory = new BarcodeTrackerFactory(mGraphicOverlay, new GraphicTracker.Callback() {
    @Override
    public void onFound(String barcodeValue) {
        Log.d(TAG, ""Barcode in Multitracker = "" + barcodeValue);
    }
});
MultiProcessor&lt;Barcode&gt; barcodeMultiProcessor = new MultiProcessor.Builder&lt;&gt;(barcodeFactory).build();
barcodeDetector.setProcessor(barcodeMultiProcessor);
</code></pre>
",3576831,,3576831,,2015-08-16 4:35:36,2015-10-01 3:17:58,How to capture barcode values using the new Barcode API in Google Play Services?,<android><google-play-services><google-vision>,1,7,15,
Android,35381104,1,,,2016,,46,943,"<p>Releasing promo codes for in-app purchases seems like it will prevent an app from (ever again) performing remote server purchase verification!</p>

<p>When a <a href=""http://developer.android.com/intl/es/google/play/billing/billing_promotions.html"" rel=""noreferrer"">promo code</a> is used for an in-app purchase (the <code>PURCHASES_UPDATED</code> broadcast), it will completely bypass the purchase flow so the app has no chance to supply an <a href=""http://developer.android.com/google/play/billing/billing_best_practices.html#payload"" rel=""noreferrer"">""developerPayload""</a>, used for remote verification.</p>

<p>Later when the app call <a href=""http://developer.android.com/intl/es/google/play/billing/billing_reference.html#getPurchases"" rel=""noreferrer"">getPurchases()</a> to get/verify owner products, the <a href=""http://developer.android.com/intl/es/google/play/billing/billing_reference.html#purchase-data-table"" rel=""noreferrer"">purchase data</a> for promo purchases won't contain a <code>""developerPayload""</code> of course, but neither an <code>""orderId""</code>, also useful for remote verification using the <a href=""https://developers.google.com/android-publisher/api-ref/purchases/products"" rel=""noreferrer"">Google Play Developer API</a>.</p>

<p><strong>How is an app supposed to verify in-app purchases made with promo codes?</strong></p>

<p>Allowing users to redeem promo codes through the Google Play Store app/site, thus bypassing the purchase flow, seems like an major oversight which shouldn't be possible.</p>

<p>Issue reports:</p>

<ul>
<li><a href=""https://code.google.com/p/android/issues/detail?id=200722"" rel=""noreferrer"">https://code.google.com/p/android/issues/detail?id=200722</a> (closed WrongForum)</li>
<li><a href=""https://github.com/googlesamples/android-play-billing/issues/7"" rel=""noreferrer"">https://github.com/googlesamples/android-play-billing/issues/7</a></li>
</ul>

<p>Similar posts:</p>

<ul>
<li><a href=""https://stackoverflow.com/questions/34979420/in-app-purchases-made-via-promo-codes-return-empty-developer-payload-string"">In-app purchases made via promo codes return empty developer payload string</a></li>
</ul>
",445360,,-1,,2017-05-23 11:55:00,2017-07-06 19:38:41,In-app purchase promo codes breaks remote server verification?,<android><google-play><in-app-billing><promotion-code>,1,1,10,
Android,43251528,1,,,2017,,29,31846,"<p>So, with Android O, you need to have your service running as a foreground service if you want to receive more than just a few location updates per hour.</p>

<p>I noticed that the old method for starting a foreground service does seem to work on O.
i.e. </p>

<pre><code>startForeground(NOTIFICATION_ID, getNotification());
</code></pre>

<p>According to the behaviour changes guide here:
<a href=""https://developer.android.com/preview/behavior-changes.html"" rel=""noreferrer"">https://developer.android.com/preview/behavior-changes.html</a></p>

<blockquote>
  <p>The NotificationManager.startServiceInForeground() method starts a foreground service. The old way to start a foreground service no longer works.</p>
</blockquote>

<p>Though the new method only works when targeting O, it seems that the old method still seems to work on an O device whether targeting O or not.</p>

<p><strong>Edit</strong>
Including example:</p>

<p>The Google sample project LocationUpdatesForegroundService actually has a working example where you can see the issue first hand.
<a href=""https://github.com/googlesamples/android-play-location/tree/master/LocationUpdatesForegroundService"" rel=""noreferrer"">https://github.com/googlesamples/android-play-location/tree/master/LocationUpdatesForegroundService</a></p>

<p>The startForeground method seems to work without issue whether targeting and compiling against API level 25 OR targeting and compiling against O (as directed to here: <a href=""https://developer.android.com/preview/migration.html#uya"" rel=""noreferrer"">https://developer.android.com/preview/migration.html#uya</a>)</p>

<p>So, to reproduce:</p>

<ol>
<li>Configure the app gradle as mentioned in the previous link</li>
<li>Open the app</li>
<li>Request location updates</li>
<li>Close app (either via back button or home button)</li>
</ol>

<p>Service is running in foreground (shown by icon in notification shade).  Location updates are coming through as expected (every 10 seconds) even on a device running O. What I am missing here?</p>
",487812,,6618622,,2018-04-01 9:22:48,2019-01-04 14:12:28,Android O - Old start foreground service still working?,<android><location><android-8.0-oreo>,7,9,10,
Android,47459523,1,,,2017,,24,2967,"<p>I have an architectural question about the android ViewModels:</p>

<p>Let's say that in my App I have an Activity with two Fragments inside (using a Viewpager). The two fragments do different things (therefore may have their own ViewModel?), but they also both need various data that is similar. </p>

<p>This is for example the state if a network connection is available or not (and both fragments show different error UIs if there is no connection), or some user setting that comes via a Push from a server and affects both fragments equally.</p>

<p>This looks something like this:</p>

<p><a href=""https://i.stack.imgur.com/fnss1.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/fnss1.png"" alt=""enter image description here""></a></p>

<p>Now my question is how to deal with that situation when using ViewModels? 
Is it good that a view observes multiple ViewModels, like it would be if I have a ViewModel for the Activity (holding the state that both need equally) and one for each fragment, like this:</p>

<p><a href=""https://i.stack.imgur.com/7CufL.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/7CufL.png"" alt=""enter image description here""></a></p>

<p>This was hinted <a href=""https://github.com/googlesamples/android-architecture-components/issues/205"" rel=""noreferrer"">here</a> for example, but it is not a good practice, as the <a href=""https://stackoverflow.com/questions/9413034/viewmodel-per-view-or-per-model"">relationship in MVVM</a> generally is </p>

<blockquote>
  <p>View n - 1 ViewModel n - 1 Model</p>
</blockquote>

<p>But I am not sure where the right place for such shared LiveData is in my case?</p>
",2567799,,,,,2018-10-09 18:16:22,Android MVVM: Activity with multiple Fragments - Where to put shared LiveData?,<android><mvvm><android-viewmodel>,1,7,9,
Android,46111860,1,46111993,,2017,,23,18544,"<p>So far, I've adjsuted my code to use <code>ContextCompat.startForegroundService(context, intentService);</code> to start my service. This way, it works on android &lt; 26 and on android 26 (Oreo) as well.</p>

<p>I still see a difference, in android oreo I don't see my custom foreground notification (I only see the ""app is running in the background"" notification). Do I have to adjust anything there as well?</p>

<p>My service looks like this:</p>

<pre><code>public class BaseOverlayService extends Service {
    @Override
    public void onCreate() {
        super.onCreate();
        moveToForeground();
    }

    private void moveToForeground() {
        Notification notification = ...;
        super.startForeground(NOTIFICATION_ID, notification);
    }
}
</code></pre>

<p><strong>Official example</strong></p>

<p>This example (<a href=""https://github.com/googlesamples/android-play-location/blob/master/LocationUpdatesForegroundService/app/src/main/java/com/google/android/gms/location/sample/locationupdatesforegroundservice/LocationUpdatesService.java#L200"" rel=""noreferrer"">https://github.com/googlesamples/android-play-location/blob/master/LocationUpdatesForegroundService/app/src/main/java/com/google/android/gms/location/sample/locationupdatesforegroundservice/LocationUpdatesService.java#L200</a>) shows as comment, that I should use following, but <code>startServiceInForeground</code> does not exist...</p>

<pre><code>if (Build.VERSION.SDK_INT == Build.VERSION_CODES.O) {
    NotificationManager mNotificationManager = ((NotificationManager) getSystemService(NOTIFICATION_SERVICE));
    mNotificationManager.startServiceInForeground(new Intent(this, BaseOverlayService.class), NOTIFICATION_ID, notification);
} else {
    startForeground(NOTIFICATION_ID, notification);
}
</code></pre>

<p><strong>Edit</strong></p>

<p>My notification is created like this, which is working on thousands of android devices with API &lt; 26 until now:</p>

<pre><code>protected Notification foregroundNotification(int notificationId)
{
    boolean paused = MainApp.getPrefs().sidebarServicePaused();
    NotificationCompat.Builder builder = new NotificationCompat.Builder(this);
    builder.setSmallIcon(R.drawable.icon_not);
    builder.setContentIntent(notificationIntent());
    builder.setLargeIcon(BitmapFactory.decodeResource(getResources(), R.drawable.icon));
    builder.setContentTitle(getString(R.string.derived_app_name));
    builder.setContentText(getString(checkStatus() ? (paused ? R.string.service_notification_text_paused : R.string.service_notification_text_running) : R.string.service_notification_text_preparing));
    builder.setColor(Color.parseColor(""#25baa2""));

    if (MainApp.getPrefs().hideNotificationIcon())
        builder.setPriority(NotificationCompat.PRIORITY_MIN);
    else
        builder.setPriority(NotificationCompat.PRIORITY_MAX);

    if (paused)
        builder.addAction(R.drawable.ic_play_arrow_black_24dp, getString(R.string.resume), resumeIntent(this));
    else
        builder.addAction(R.drawable.ic_pause_black_24dp, getString(R.string.pause), pauseIntent(this));

    return builder.build();
}
</code></pre>
",1439522,,7679573,,2017-09-08 8:52:00,2019-01-05 15:58:05,Oreo - Foreground service does not show foreground notification,<android><android-notifications><android-8.0-oreo><foreground-service>,2,0,9,
Android,48406497,1,48410303,,2018,,10,1935,"<p>I bumped into an issue while trying to implement a touch to focus feature using the <a href=""https://developer.android.com/reference/android/hardware/camera2/package-summary.html"" rel=""noreferrer"">Android Camera2</a>. </p>

<p>The theory is easy:</p>

<ul>
<li>obtain the tap position in the preview surface</li>
<li>map it to the dimensions of the sensor or sensor crop area (in case of a zoom) making sure to invert the dimensions if needed</li>
<li>apply a change of basis to end up in the same basis as the sensor</li>
<li>make a <code>MeteringRectangle</code> out of the result and use it in a new <code>CaptureRequest</code></li>
</ul>

<p>There are a number of examples out there that show how to deal with the first and last point, but not a lot that deal with the second and third in an understandable way. The docs and examples are not really clear and it can be really confusing. </p>

<p>Here we go...</p>

<hr>

<p>The <code>CameraCharacteristics.SENSOR_ORIENTATION</code> is describe as</p>

<blockquote>
  <p>Clockwise angle through which the output image needs to be rotated to be upright on the device screen in its native orientation.</p>
</blockquote>

<p>Knowing that the sensor coordinate system is defined with (0,0) being the top-left pixel in the active pixel array, I read this as being the angle needed to rotate the image captured in the sensor coordinate system 
to the position that would make the image look upright in the native orientation. So if the sensor's top is facing the right side of a phone with a portrait native orientation, the <code>SENSOR_ORIENTATION</code> will be 90°.
<a href=""https://i.stack.imgur.com/Nq9Wb.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/Nq9Wb.png"" alt=""Sensor Orientation""></a></p>

<hr>

<p><strong>The display orientation</strong> obtained via <code>mActivity.getWindowManager().getDefaultDisplay().getRotation();</code> is documented as:</p>

<blockquote>
  <p>Returns the rotation of the screen from its ""natural"" orientation. The returned value may be Surface.ROTATION_0 (no rotation), Surface.ROTATION_90, Surface.ROTATION_180, or Surface.ROTATION_270. For example, if a device has a naturally tall screen, and the user has turned it on its side to go into a landscape orientation, the value returned here may be either Surface.ROTATION_90 or Surface.ROTATION_270 depending on the direction it was turned. The angle is the rotation of the drawn graphics on the screen, which is the opposite direction of the physical rotation of the device. For example, if the device is rotated 90 degrees counter-clockwise, to compensate rendering will be rotated by 90 degrees clockwise and thus the returned value here will be Surface.ROTATION_90.</p>
</blockquote>

<p>I find that this definition is much clearer than the sensor orientation one, there is no place for interpretation. </p>

<hr>

<p>Now where things start to get ugly...</p>

<p>I decided to make use of the method provided in the <a href=""https://github.com/googlesamples/android-Camera2Raw"" rel=""noreferrer"">Camera2Raw</a> example to obtain the rotation from the sensor orientation to the device orientation. </p>

<pre><code>/**
 * Rotation need to transform from the camera sensor orientation to the device's current
 * orientation.
 *
 * @param c                 the {@link CameraCharacteristics} to query for the camera sensor
 *                          orientation.
 * @param deviceOrientation the current device orientation relative to the native device
 *                          orientation.
 * @return the total rotation from the sensor orientation to the current device orientation.
 */
private static int sensorToDeviceRotation(CameraCharacteristics c, int deviceOrientation) {
    int sensorOrientation = c.get(CameraCharacteristics.SENSOR_ORIENTATION);

    // Get device orientation in degrees
    deviceOrientation = ORIENTATIONS.get(deviceOrientation);

    // Reverse device orientation for front-facing cameras
    if (c.get(CameraCharacteristics.LENS_FACING) == CameraCharacteristics.LENS_FACING_FRONT) {
        deviceOrientation = -deviceOrientation;
    }

    // Calculate desired JPEG orientation relative to camera orientation to make
    // the image upright relative to the device orientation
    return (sensorOrientation + deviceOrientation + 360) % 360;
}
</code></pre>

<p>Here is a table of the different outputs for a back and front facing camera on a phone with a portrait native orientation.
<a href=""https://i.stack.imgur.com/7DxTE.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/7DxTE.png"" alt=""enter image description here""></a></p>

<p>The first thing I noticed is that if I consider the outputs as described (rotation from the camera sensor orientation to the device's current orientation), 
for it to make sense, I have to consider the output rotation to be <strong>counter-clockwise</strong> (unlike the sensor orientation and device orientation)!! 
For instance if we take the typical 90° sensor and 0° device orientation, the resut is 90° and if I'm not mistaken in my analysis, it can only be counter-clockwise.</p>

<p>Under the hypothesis that my understanding of the sensor and device orientations is correct (not certain about that), then something must be wrong with the results of the above tables, because if you look at the 90° sensor and the 90° device orientation case, it can't be 180° it should be 0°. 
The next picture is a visual representation of my understanding of all of this for a 90° sensor orientation phone. <a href=""https://i.stack.imgur.com/JqNiQ.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/JqNiQ.png"" alt=""enter image description here""></a></p>

<p>I went ahead and implemented my basis changes in R<sup>2</sup> to get my tap point from the screen basis to the sensor basis and added the expected offsets. </p>

<p>I observed that if I switch the 180° and 0° calculations, then my touch to focus works perfectly. The correct observed values for the rotation from the sensor to the current device orientation actually correspond to the table for the front camera. </p>

<p>So my gut feeling is that the <code>sensorToDeviceRotation</code> is flawed and the return value should be:</p>

<pre><code>// Calculate desired JPEG orientation relative to camera orientation to make
// the image upright relative to the device orientation
return (sensorOrientation - deviceOrientation + 360) % 360;
</code></pre>

<p>It would actually be more logical in terms of what is computed...</p>

<p>Could someone confirm this? or have I misunderstood something somewhere?</p>

<p>Cheers</p>
",2414033,,192373,,2018-02-18 4:55:48,2018-02-18 4:55:48,Camera2 understanding the sensor and device orientations,<android><rotation><android-camera2>,1,0,8,
Android,30195940,1,30197939,,2015,,13,9302,"<p>I am trying to get the camera frame in preview mode. I am running the sample project from github <a href=""https://github.com/googlesamples/android-Camera2Basic"">https://github.com/googlesamples/android-Camera2Basic</a></p>

<p>The issue I am having is getting the frame in preview mode.</p>

<p>Here is the code:</p>

<pre><code>private CameraCaptureSession.CaptureCallback mCaptureCallback = new CameraCaptureSession.CaptureCallback() {

    private void process(CaptureResult result) {
        switch (mState) {
            case STATE_PREVIEW: {

                //HERE, HOW CAN I RETRIEVE THE CURRENT FRAME?

                break;
            }
            case STATE_WAITING_LOCK: {
               ...
                break;
            }
            case STATE_WAITING_PRECAPTURE: {
             ...
                break;
            }
            case STATE_WAITING_NON_PRECAPTURE: {
             ...
                break;
            }
        }
    }
</code></pre>

<p>Another thing I tried to get the frame is setting the  mImageReader.setOnImageAvailableListener.
I was expecting to be able to get the frame onImageAvailable callback, but onImageAvailable is never called. onPreviewFrame is my own method, I need to pass it the current frame.</p>

<pre><code>  mImageReader = ImageReader.newInstance(largest.getWidth(), largest.getHeight(), ImageFormat.JPEG, /*maxImages*/2);
  mImageReader.setOnImageAvailableListener(mOnImageAvailableListener, mBackgroundHandler);

  private final ImageReader.OnImageAvailableListener mOnImageAvailableListener  = new ImageReader.OnImageAvailableListener() {

    @Override
    public void onImageAvailable(ImageReader reader) {
        mTextureView.onPreviewFrame(reader.acquireNextImage().getPlanes([0].getBuffer().array());
    }

};
</code></pre>

<p>What I am doing wrong?
Thanks.</p>
",1520263,,,,,2016-03-13 18:20:45,Android Camera2 getPreviewFrame,<android><android-camera><android-5.0-lollipop>,1,0,8,
Android,46268768,1,,,2017,,11,3161,"<p>The problem is quite straightforward. The question is in context of using ViewModels, LiveData and other related <a href=""https://developer.android.com/reference/android/arch/lifecycle/package-summary.html"" rel=""noreferrer"">Lifecycle</a> aware arch approaches.
<br/>I have an Activity with NavDrawer, which switches fragments inside. <br>And also I have a case when two fragments are present at the same time on the screen - this will be the main pain.
One Fragment has a ViewPager with nested <code>Fragments</code>(<strong>don't ask why</strong>).
The other fragment is just obtaining info from first one when user performs some actions. This is achieved just by sharing activity viewmodel. But the app itself has a lot of business logic and as it goes further the viewmodel goes bigger and bigger.
<br/> What I want to ask - not a receipt or rules how to fix this, or maybe how to overcome this by fixing the entire structure of the project. I want to ask for suggestions how can I apply the MVVM approach within android.arch.lifecycle style to mine use-case.
<br> I haven't seen something more complicated then just sharing the Activity ViewModel between Fragments. But common, that's not a cure.
<a href=""https://i.stack.imgur.com/kASaU.jpg"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/kASaU.jpg"" alt=""enter image description here""></a></p>

<p>What you can see here - a mess actually. The point is that all are sharing the <code>ActivityViewModel</code>. Connections(aggregation) from FirstFragment mean that <code>ViewPager</code> inside <code>FirstFragment</code> is initiating <code>ChildFragments</code> and they are also working with the same <code>ActivityViewModel</code>(kill me). So as result everyone is working with one shared ViewModel. 
<br> My proposal is to add a ViewModel for each Layer. So that Activity/Fragments/ChildFragments have their own ViewModels.
But what appears here - <strong><em>how we should communicate then</em></strong>?
<br> Possible solutions :</p>

<ul>
<li>Having two ViewModels per one component. One ViewModel will handle/delegate the business logic and another will make the communication. <strong>Two viewmodels per component - not so good, yeah?</strong></li>
<li>Having old manner interface(<strong>please no!</strong>)</li>
<li><p>Other workarounds - like DB/SharedPrefs/Realm change listeners and Event Buses(<strong>I'm too old for this :(</strong> ).</p></li>
<li><p><strong>Your solution here!</strong></p></li>
</ul>

<p>I'll say that all of the above are breaking a lot of design principles, so what should I do?
How should I come out of this mess? Is there any <code>Uncle Bob</code> or another <code>superhero</code> here to help?</p>

<p><strong>P.S.</strong> - Well, creating UMLs or other charts isn't mine forte. Sorry for that. 
<br><strong>P.P.S.</strong> - I'm aware of <a href=""https://github.com/googlesamples/android-architecture-components"" rel=""noreferrer"">google</a> <a href=""https://github.com/googlesamples/android-architecture"" rel=""noreferrer"">samples</a>.</p>
",3874721,,4604751,,2017-09-18 8:54:19,2018-10-10 4:52:24,ViewModel for Fragment instead accessing Activity ViewModel?,<android><android-fragments><mvvm><kotlin><android-architecture-components>,2,5,8,
Android,32134299,1,,,2015,,39,16587,"<p>Say you have a method like this:</p>

<pre><code>public boolean saveFile (Url url, String content) {

   // save the file, this can be done a lot of different ways, but
   // basically the point is...

   return save_was_successful;
}
</code></pre>

<p>Throughout your app, if you want to save a file to external storage, you do something like...</p>

<pre><code>if (saveFile(external_storage_url, ""this is a test"")) {
   // yay, success!
} else { // notify the user something was wrong or handle the error }
</code></pre>

<p>This is a simplified example, so don't get on my case about blocking the UI, handling exceptions properly, etc.  If you don't like file saving, you could imagine a <code>getContact()</code> or <code>getPhoneState()</code> or whatever.  The point is it's a permission-needing operation that returns some value(s) and it's used throughout the app.</p>

<p>In Android &lt;= Lollipop, if the user had installed and agreed to granting <code>android.permission.WRITE_EXTERNAL_STORAGE</code> or whatever, all would be good.</p>

<p>But in the new Marshmallow (API 23) <a href=""https://developer.android.com/preview/features/runtime-permissions.html"">runtime permission model</a>, before you can save the file to external storage, you're supposed to (1) check if the permission has been granted.  <a href=""https://github.com/googlesamples/android-RuntimePermissions/blob/master/Application/src/main/java/com/example/android/system/runtimepermissions/MainActivity.java#L204-L208"">If not</a>, possibly (2) <a href=""https://github.com/googlesamples/android-RuntimePermissions/blob/master/Application/src/main/java/com/example/android/system/runtimepermissions/MainActivity.java#L217-L227"">show a rationale for the request</a> (if the <a href=""https://developer.android.com/reference/android/app/Activity.html#shouldShowRequestPermissionRationale(java.lang.String)"">system thinks it's a good idea</a>) with a toast or whatever and (3) ask the user to grant permission via a dialog, then basically sit back and wait for a callback...</p>

<p>(so your app sits around, waiting...)</p>

<p>(4) When the user finally responds to the dialog, the <a href=""https://github.com/googlesamples/android-RuntimePermissions/blob/master/Application/src/main/java/com/example/android/system/runtimepermissions/MainActivity.java#L263-L264"">onRequestPermissionsResult()</a> method fires off, and your code now (5) has to sift through WHICH <a href=""https://github.com/googlesamples/android-RuntimePermissions/blob/master/Application/src/main/java/com/example/android/system/runtimepermissions/MainActivity.java#L286"">permission</a> request they are actually <a href=""https://github.com/googlesamples/android-RuntimePermissions/blob/master/Application/src/main/java/com/example/android/system/runtimepermissions/MainActivity.java#L286"">responding to</a>, whether the user said yes or no (to my knowledge there's no way to handle ""no"" vs. ""no and don't ask again""), (6) figure out what they were trying to accomplish in the first place that prompted the whole ask-for-permissions process, so that the program can <em>finally</em>  (7) go ahead and do that thing.</p>

<p>To know what the user was trying to do in step (6) involves having previously passed a special <a href=""https://developer.android.com/preview/features/runtime-permissions.html#coding"">code</a> (the ""permissions request response"") which is described in the docs as an identifier of the type of <a href=""https://github.com/googlesamples/android-RuntimePermissions/blob/master/Application/src/main/java/com/example/android/system/runtimepermissions/MainActivity.java#L89"">permission request</a> (camera/contact/etc.) but seems to me more like a ""specifically, what you were trying to do when you realized you'd need to ask for permissions"" code, given that the same permission/group may be used for multiple purposes in your code, so you'd need to use this code to return execution to the appropriate place after getting the permission.</p>

<p>I could be totally misunderstanding how this is supposed to work-- so please let me know if I'm way off-- but the larger point is I'm <em>really</em> not sure how to even think about doing all of the above w/the <code>saveFile()</code> method described previously due to the asynchronous ""wait for the user to respond"" part.  The ideas I've considered are pretty hacky and certainly wrong.</p>

<p>Today's <a href=""http://androidbackstage.blogspot.com/2015/08/episode-33-permission-mission.html"">Android Developer Podcast</a> hinted that there may be a synchronous solution around the corner, and there was even talk about a magic, one-step alt-enter type of ""add a permissions request"" tool in Android Studio.  Still, how the runtime permission process might be shoved into a <code>saveFile()</code> or whatever-- I'm thinking something along the lines of :</p>

<pre><code>public boolean saveFile(Url url, String content) {
   //   this next line will check for the permission, ask the user
   //   for permission if required, maybe even handle the rationale
   //   situation
   if (!checkPermission(Manifest.permission.WRITE_EXTERNAL_STORAGE,
                        R.string.permission_storage_rationale))
       {
           return false; // or throw an exception or whatever
       } else {

   // try to save the file

   return save_was_successful;

   }
}
</code></pre>

<p>So the above <code>checkPermission()</code> would fail if the user didn't have and also refused to grant the permission.  Maybe one could use a loop around <code>checkPermission()</code> to try asking up to 3 times or something, or better would be if a sane dont-be-annoying-policy was handled by the method.</p>

<p>Is such a thing possible?  Desirable?  Would any such solution block the UI thread?  From the podcast it sounded like Google <em>may</em> have a solution like this coming 'round the corner, but I wanted to get thoughts on whether there was something-- a convenience class, a pattern, something-- that doesn't involve everyone having to refactor all permission-requiring operations, which I must assume could get pretty messy.</p>

<p>Sorry for the long-winded question, but I wanted to be as complete as possible.  I'll take my answer off the air.  Thanks!</p>

<hr>

<p><strong><em>Update</em></strong>:  Here is the transcript from the podcast mentioned above.</p>

<p>Listen at about <a href=""http://androidbackstage.blogspot.com/2015/08/episode-33-permission-mission.html"">41:20</a>.  In this discussion:</p>

<p>Rough transcript:</p>

<p>Tor Norbye (Tools team):  ""<em>So it doesn't seem like it should be a lot of work for developers.  But I understand part of the problem is that these are not synchronous calls, right?.  So what you have to- actually change the way your activity is written to have a callback-- so it's really kinda like a state machine where... for this state, you-</em>""</p>

<p>Poiesz (product manager): ""<em>Ah- I thought- there was a- there might be an option for synchronous response--</em>""</p>

<p>Norbye: ""<em>Oh.  that would make things--</em>""</p>

<p>Poiesz: ""<em>I can talk with folks internally.  I recall a discussion about synchronous- but we can find out.</em>""</p>

<p>Norbye: ""<em>Yeah. In fact we should probably make it into the tools.  Where you have an easy refactoring...</em>""</p>

<p>Then he talks about using annotations in the tools to determine which APIs require permissions.. (which as of now doesn't work that great IMO) and how he wants the tools someday to actually generate the required code if it finds an unchecked ""dangerous"" method call:</p>

<p>Norbye:  ""<em>...then if you're on M as well it'll say, 'hey, are you actually checking for this permission or are you catching security exceptions?', and if you're not, we'll say 'you probably need to do something for requesting the permission here.'   What I would like though is for that to have a quick fix where you can go 'CHING!' and it inserts all the right stuff for asking, but the way things were back when I looked, this required restructuring a lot of things-- adding interfaces and callbacks, and changing the flow, and that we couldn't do.  But if there's an easy synchronous mode as a temporary thing or a permanent thing, that would [be great].</em>""</p>
",3035127,,3035127,,2015-10-03 8:50:20,2017-07-24 19:04:10,Can you request permissions synchronously in Android Marshmallow (API 23)'s runtime permissions model?,<android><android-permissions><android-6.0-marshmallow>,5,9,8,
Android,43258773,1,43646354,,2017,,35,2613,"<p><a href=""https://msdn.microsoft.com/en-us/library/ff649690.aspx"" rel=""noreferrer"">Repository Pattern</a> is defined by <a href=""https://martinfowler.com/eaaCatalog/repository.html"" rel=""noreferrer"">Hieatt and Rob Mee</a> as design pattern that <em>mediates between the domain and data mapping layers using a collection-like interface for accessing domain objects</em>.</p>

<p><a href=""https://i.stack.imgur.com/CMJFn.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/CMJFn.png"" alt=""MSDN Repository Pattern""></a></p>

<p>Basically it abstracts one or more I/O devices (cloud, disk, data base, etc) into a common collection-like interface where you can <a href=""http://blog.cleancoder.com/uncle-bob/2016/01/04/ALittleArchitecture.html"" rel=""noreferrer""><em>read, write, seek and delete data</em></a>.</p>

<p>On <a href=""https://fernandocejas.com/2014/09/03/architecting-android-the-clean-way/"" rel=""noreferrer"">Fernando Cejas's Android Clean Architecture</a>, all data needed for the application comes from this layer through a repository implementation (the interface is in the domain layer) that uses a Repository Pattern with a strategy that, through a factory, picks different data sources depending on certain conditions.</p>

<p><a href=""https://fernandocejas.com/assets/migrated/clean_architecture_data.png"" rel=""noreferrer""><img src=""https://fernandocejas.com/assets/migrated/clean_architecture_data.png"" alt=""Content Provider""></a></p>

<p>However, as pointed out by professor <a href=""https://www.youtube.com/watch?v=b3m9UIeSpBY&amp;t=246s"" rel=""noreferrer"">Douglas Schmidt</a> at <a href=""http://www.dre.vanderbilt.edu/~schmidt/Coursera/"" rel=""noreferrer"">Coursera course</a>, content provider <a href=""https://developer.android.com/guide/topics/providers/content-provider-basics.html"" rel=""noreferrer""><em>manages and mediates access to a central repository of data to one or more applications</em></a></p>

<p><a href=""https://i.stack.imgur.com/9ELkt.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/9ELkt.png"" alt=""Content Provider""></a></p>

<p>In the book <a href=""https://rads.stackoverflow.com/amzn/click/com/1449316646"" rel=""noreferrer"" rel=""nofollow noreferrer"">Programming Android</a>, content providers are used <a href=""https://www.safaribooksonline.com/library/view/programming-android-2nd/9781449332921/ch13.html"" rel=""noreferrer"">as a Facade for a RESTful Web Service</a>. This approach was initially presented by <a href=""https://www.youtube.com/watch?v=xHXn3Kg2IQE"" rel=""noreferrer"">
Virgil Dobjanschi during Google I/O 2010</a>.</p>

<p>Thus, instead of using content providers to <a href=""https://github.com/googlesamples/android-architecture/tree/todo-mvp-contentproviders/todoapp/app/src/main/java/com/example/android/architecture/blueprints/todoapp/data/source"" rel=""noreferrer"">access the local SQLite database</a>, why not using it as the repository pattern itself?</p>

<p><a href=""https://i.stack.imgur.com/H21Oc.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/H21Oc.png"" alt=""enter image description here""></a></p>
",2886392,,2886392,,2017-04-26 11:54:06,2017-04-28 10:03:58,Is Content Provider an implementation of Repository Pattern?,<android><design-patterns><android-mvp>,8,0,8,
Android,44231334,1,,,2017,,16,4290,"<p>New Android Architecture Components released on google IO 17.</p>

<p>So should we use MVP with architecture components and MVVM?</p>

<p>In google sample on Github, they have used the MVVM model.
<a href=""https://github.com/googlesamples/android-architecture-components/tree/master/BasicSample"" rel=""noreferrer"">Google Sample</a></p>
",2534612,,767857,,2017-06-01 17:16:50,2018-03-18 10:08:36,Android architecture components with MVP,<android><android-architecture-components>,2,2,7,
Android,26689630,1,,,2014,,8,2392,"<p>The new Android Lollipop API provides a new pair of methods for getting and setting restrictions on other apps: <a href=""https://developer.android.com/reference/android/app/admin/DevicePolicyManager.html#getApplicationRestrictions(android.content.ComponentName,%20java.lang.String)"">DevicePolicyManager.getApplicationRestrictions</a> and <a href=""https://developer.android.com/reference/android/app/admin/DevicePolicyManager.html#setApplicationRestrictions(android.content.ComponentName,%20java.lang.String,%20android.os.Bundle)"">DevicePolicyManager.setApplicationRestrictions</a></p>

<p>There's an example of them being used in the <a href=""https://github.com/googlesamples/android-BasicManagedProfile"">BasicManagedProfile sample app</a> to set restrictions on the Chrome app by passing a set of key/value pairs that seem to correlate to the <a href=""http://www.chromium.org/administrators/policy-list-3"">Chrome's published policy list</a>. This works perfectly for me.</p>

<p>But I can't find any documentation on any other apps that can be restricted in this way. Does anyone know of any other apps that can be restricted with these methods, and the keys that can be set?</p>

<p><a href=""https://developer.android.com/reference/android/app/admin/DevicePolicyManager.html#getApplicationRestrictions(android.content.ComponentName,%20java.lang.String)"">DevicePolicyManager.getApplicationRestrictions</a> only seems to return the restrictions you've already set for that app, not a list of all available restrictions. I also tried using <a href=""http://developer.android.com/reference/android/content/RestrictionsManager.html#getManifestRestrictions(java.lang.String)"">RestrictionsManager.getManifestRestrictions</a> on Chrome but this returns an empty list, so I think this is something different.</p>
",2652471,,,,,2017-08-16 6:53:55,How to find an app's available restrictions for DevicePolicyManager.setApplicationRestrictions,<android><google-chrome><android-5.0-lollipop><device-policy-manager>,1,6,6,
Android,32715573,1,,,2015,,30,2306,"<p>I am using the <a href=""https://github.com/googlesamples/android-vision/tree/master/visionSamples/FaceTracker"" rel=""noreferrer"">FaceTracker</a> sample from the Android vision API. However, I am experiencing difficulty in recording videos while the overlays are drawn on them. </p>

<p>One way is to store bitmaps as images and process them using FFmpeg or Xuggler to merge them as videos, but I am wondering if there is a better solution to this problem if we can record video at runtime as the preview is projected.</p>

<p><strong>Update 1:</strong>
I updated the <a href=""https://github.com/googlesamples/android-vision/blob/master/visionSamples/FaceTracker/app/src/main/java/com/google/android/gms/samples/vision/face/facetracker/ui/camera/CameraSourcePreview.java"" rel=""noreferrer"">following</a> class with media recorder, but the recording is still not working. It is throwing the following error when I call triggerRecording() function:</p>

<p><strong>MediaRecorder: start called in an invalid state: 4</strong></p>

<p>and I have external storage permission in the Manifest file.</p>

<p><strong>Update 2:</strong></p>

<p>I have fixed the above issue in the code and moved the setupMediaRecorder() in the onSurfaceCreated callback. However, when I stop recording it throws the runtime-exception. According to the <a href=""http://developer.android.com/reference/android/media/MediaRecorder.html#stop%28%29"" rel=""noreferrer"">documentation</a> if there is no video/audio data Runtime exception will be thrown.</p>

<p>So, what am I missing here? </p>

<pre><code>public class CameraSourcePreview extends ViewGroup {
    private static final String TAG = ""CameraSourcePreview"";

    private static final SparseIntArray ORIENTATIONS = new SparseIntArray();

    static {
        ORIENTATIONS.append(Surface.ROTATION_0, 90);
        ORIENTATIONS.append(Surface.ROTATION_90, 0);
        ORIENTATIONS.append(Surface.ROTATION_180, 270);
        ORIENTATIONS.append(Surface.ROTATION_270, 180);
    }

    private MediaRecorder mMediaRecorder;
    /**
     * Whether the app is recording video now
     */
    private boolean mIsRecordingVideo;

    private Context mContext;
    private SurfaceView mSurfaceView;
    private boolean mStartRequested;
    private boolean mSurfaceAvailable;
    private CameraSource mCameraSource;

    private GraphicOverlay mOverlay;

    public CameraSourcePreview(Context context, AttributeSet attrs) {
        super(context, attrs);
        mContext = context;
        mStartRequested = false;
        mSurfaceAvailable = false;

        mSurfaceView = new SurfaceView(context);

        mSurfaceView.getHolder().addCallback(new SurfaceCallback());

        addView(mSurfaceView);

        mMediaRecorder = new MediaRecorder();
    }

    private void setUpMediaRecorder() throws IOException {
        mMediaRecorder.setPreviewDisplay(mSurfaceView.getHolder().getSurface());
        mMediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
        mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.SURFACE);
        mMediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);

        mMediaRecorder.setOutputFile(Environment.getExternalStorageDirectory() + File.separator + Environment.DIRECTORY_DCIM + File.separator + System.currentTimeMillis() + "".mp4"");
        mMediaRecorder.setVideoEncodingBitRate(10000000);
        mMediaRecorder.setVideoFrameRate(30);
        mMediaRecorder.setVideoSize(480, 640);
        mMediaRecorder.setVideoEncoder(MediaRecorder.VideoEncoder.H264);
        mMediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AAC);
        //int rotation = mContext.getWindowManager().getDefaultDisplay().getRotation();
        //int orientation = ORIENTATIONS.get(rotation);
        mMediaRecorder.setOrientationHint(ORIENTATIONS.get(0));
        mMediaRecorder.prepare();

        mMediaRecorder.setOnErrorListener(new MediaRecorder.OnErrorListener() {
            @Override
            public void onError(MediaRecorder mr, int what, int extra) {
                Timber.d(mr.toString() + "" : what["" + what + ""]"" + "" Extras["" + extra + ""]"");
            }
        });
    }

    public void start(CameraSource cameraSource) throws IOException {
        if (cameraSource == null) {
            stop();
        }

        mCameraSource = cameraSource;

        if (mCameraSource != null) {
            mStartRequested = true;
            startIfReady();
        }
    }

    public void start(CameraSource cameraSource, GraphicOverlay overlay) throws IOException {
        mOverlay = overlay;
        start(cameraSource);
    }

    public void stop() {
        if (mCameraSource != null) {
            mCameraSource.stop();
        }
    }

    public void release() {
        if (mCameraSource != null) {
            mCameraSource.release();
            mCameraSource = null;
        }
    }

    private void startIfReady() throws IOException {
        if (mStartRequested &amp;&amp; mSurfaceAvailable) {
            mCameraSource.start(mSurfaceView.getHolder());
            if (mOverlay != null) {
                Size size = mCameraSource.getPreviewSize();
                int min = Math.min(size.getWidth(), size.getHeight());
                int max = Math.max(size.getWidth(), size.getHeight());
                if (isPortraitMode()) {
                    // Swap width and height sizes when in portrait, since it will be rotated by
                    // 90 degrees
                    mOverlay.setCameraInfo(min, max, mCameraSource.getCameraFacing());
                } else {
                    mOverlay.setCameraInfo(max, min, mCameraSource.getCameraFacing());
                }
                mOverlay.clear();
            }

            mStartRequested = false;
        }
    }

    private class SurfaceCallback implements SurfaceHolder.Callback {
        @Override
        public void surfaceCreated(SurfaceHolder surface) {
            mSurfaceAvailable = true;
            surface.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

            // setup the media recorder
            try {
                setUpMediaRecorder();
            } catch (IOException e) {
                e.printStackTrace();
            }

            try {
                startIfReady();
            } catch (IOException e) {
                Timber.e(TAG, ""Could not start camera source."", e);
            }
        }

        @Override
        public void surfaceDestroyed(SurfaceHolder surface) {
            mSurfaceAvailable = false;
        }

        @Override
        public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
        }
    }

    @Override
    protected void onLayout(boolean changed, int left, int top, int right, int bottom) {
        int width = 320;
        int height = 240;
        if (mCameraSource != null) {
            Size size = mCameraSource.getPreviewSize();
            if (size != null) {
                width = size.getWidth();
                height = size.getHeight();
            }
        }

        // Swap width and height sizes when in portrait, since it will be rotated 90 degrees
        if (isPortraitMode()) {
            int tmp = width;
            width = height;
            height = tmp;
        }

        final int layoutWidth = right - left;
        final int layoutHeight = bottom - top;

        // Computes height and width for potentially doing fit width.
        int childWidth = layoutWidth;
        int childHeight = (int) (((float) layoutWidth / (float) width) * height);

        // If height is too tall using fit width, does fit height instead.
        if (childHeight &gt; layoutHeight) {
            childHeight = layoutHeight;
            childWidth = (int) (((float) layoutHeight / (float) height) * width);
        }

        for (int i = 0; i &lt; getChildCount(); ++i) {
            getChildAt(i).layout(0, 0, childWidth, childHeight);
        }

        try {
            startIfReady();
        } catch (IOException e) {
            Timber.e(TAG, ""Could not start camera source."", e);
        }
    }

    private boolean isPortraitMode() {
        int orientation = mContext.getResources().getConfiguration().orientation;
        if (orientation == Configuration.ORIENTATION_LANDSCAPE) {
            return false;
        }
        if (orientation == Configuration.ORIENTATION_PORTRAIT) {
            return true;
        }

        Timber.d(TAG, ""isPortraitMode returning false by default"");
        return false;
    }

    private void startRecordingVideo() {
        try {
            // Start recording
            mMediaRecorder.start();
            mIsRecordingVideo = true;
        } catch (IllegalStateException e) {
            e.printStackTrace();
        }
    }

    private void stopRecordingVideo() {
        // UI
        mIsRecordingVideo = false;
        // Stop recording
        mMediaRecorder.stop();
        mMediaRecorder.reset();
    }

    public void triggerRecording() {
        if (mIsRecordingVideo) {
            stopRecordingVideo();
            Timber.d(""Recording stopped"");
        } else {
            startRecordingVideo();
            Timber.d(""Recording starting"");
        }
    }
}
</code></pre>
",1053097,,4702010,,2017-12-07 11:51:59,2017-12-30 8:14:29,Media Recorder with Google Vision API,<android><android-camera><android-mediarecorder><google-vision><android-vision>,1,7,6,
Android,41615189,1,46238934,,2017,,4,1827,"<p>I try to fix call recording in my app since lolipop update in my Galaxy S5. As a base I am using google sample project from here: <a href=""https://github.com/googlesamples/android-ndk/tree/master/audio-echo/app/src/main/cpp"" rel=""nofollow noreferrer"">Sample</a>. </p>

<p>And this is the main part of the code:</p>

<h1>AudioRecorder::AudioRecorder(SampleFormat *sampleFormat, SLEngineItf slEngine) :freeQueue_(nullptr), recQueue_(nullptr), devShadowQueue_(nullptr), callback_(nullptr)</h1>

<pre><code>SLresult result;
sampleInfo_ = *sampleFormat;
SLAndroidDataFormat_PCM_EX format_pcm;
ConvertToSLSampleFormat(&amp;format_pcm, &amp;sampleInfo_);

gFp = fopen(""/storage/emulated/0/file.pcm"", ""w"");

// configure audio source
SLDataLocator_IODevice loc_dev = {SL_DATALOCATOR_IODEVICE, SL_IODEVICE_AUDIOINPUT,
                                  SL_DEFAULTDEVICEID_AUDIOINPUT, NULL};
SLDataSource audioSrc = {&amp;loc_dev, NULL};


// configure audio sink
SLDataLocator_AndroidSimpleBufferQueue loc_bq = {
        SL_DATALOCATOR_ANDROIDSIMPLEBUFFERQUEUE,
        DEVICE_SHADOW_BUFFER_QUEUE_LEN};

SLDataSink audioSnk = {&amp;loc_bq, &amp;format_pcm};

// create audio recorder
// (requires the RECORD_AUDIO permission)
const SLInterfaceID id[2] = {SL_IID_ANDROIDSIMPLEBUFFERQUEUE,
                             SL_IID_ANDROIDCONFIGURATION};

const SLboolean req[2] = {SL_BOOLEAN_FALSE, SL_BOOLEAN_FALSE};

result = (*slEngine)-&gt;CreateAudioRecorder(slEngine,
                                          &amp;recObjectItf_,
                                          &amp;audioSrc,
                                          &amp;audioSnk,
                                          2,
                                          id, req);
SLASSERT(result);

// Configure the voice recognition preset which has no
// signal processing for lower latency.
SLAndroidConfigurationItf inputConfig;
result = (*recObjectItf_)-&gt;GetInterface(recObjectItf_,
                                        SL_IID_ANDROIDCONFIGURATION,
                                        &amp;inputConfig);

SLuint32 presetValue = SL_ANDROID_RECORDING_PRESET_VOICE_COMMUNICATION;
result = (*inputConfig)-&gt;SetConfiguration(inputConfig,
                                          SL_ANDROID_KEY_RECORDING_PRESET,
                                          &amp;presetValue,
                                          sizeof(SLint32));
SLASSERT(result);


result = (*recObjectItf_)-&gt;Realize(recObjectItf_, SL_BOOLEAN_FALSE);
SLASSERT(result);

result = (*recObjectItf_)-&gt;GetInterface(recObjectItf_, SL_IID_RECORD, &amp;recItf_);
SLASSERT(result);

result = (*recObjectItf_)-&gt;GetInterface(recObjectItf_, SL_IID_ANDROIDSIMPLEBUFFERQUEUE,
                                        &amp;recBufQueueItf_);
SLASSERT(result);

result = (*recBufQueueItf_)-&gt;RegisterCallback(recBufQueueItf_, bqRecorderCallback, this);
SLASSERT(result);

devShadowQueue_ = new AudioQueue(DEVICE_SHADOW_BUFFER_QUEUE_LEN);
assert(devShadowQueue_);
</code></pre>

<p>And here is my problem this code do not record other side of the call, in output file I can only hear voice from microphone. I tried changing parameters but with same result. Anyone know what I am doing wrong?</p>
",7409905,,,,,2017-10-18 8:38:01,Call recording with OpenSL,<android><android-ndk><audio-recording><voice-recording>,2,5,6,
Android,54016644,1,54017265,,2019,,9,704,"<p>I was reading about the <a href=""https://github.com/googlesamples/android-testing"" rel=""nofollow noreferrer"">Android Testing Samples</a> project and noticed that a ""<strong>new</strong>"" build tool named <strong>Bazel</strong> is being used for building Android projects:</p>

<blockquote>
  <h2>Experimental Bazel Support</h2>
  
  <p>Some of these samples can be built with Bazel on Linux. These samples contain a <code>BUILD.bazel</code> file, which is similar to a <code>build.gradle</code> file. The external dependencies are defined in the top level WORKSPACE file.</p>
  
  <p>This is experimental feature. To run the tests, please install the latest version of Bazel (0.12.0 or later) by following the instructions on the Bazel website. </p>
</blockquote>

<p>Then, </p>

<ul>
<li>What is the added advantage of using Bazel over the existing Gradle? </li>
<li>Is it really good to have TWO build tools for Android? </li>
<li>Does it mean that Android developers will probably need to learn this new build tool in future?</li>
</ul>

<hr>

<p><strong>Update #1:</strong> Updated with accepted answer from <a href=""https://stackoverflow.com/users/7357920/farhana"">farhana</a> and thanks to <a href=""https://stackoverflow.com/users/521209/jin"">Jin</a> for the in depth details about the google build systems. </p>

<p><strong>Update #2:</strong> Updated with google code labs for <a href=""https://codelabs.developers.google.com/codelabs/bazel-android-intro/index.html#0"" rel=""nofollow noreferrer"">bazel android introduction</a>. </p>
",8034839,,8034839,,2019-02-22 8:16:21,2019-03-15 4:47:43,What is the added advantage of using Bazel over Gradle?,<android><gradle><android-gradle><android-testing><bazel>,2,3,6,2019-01-18 19:04:54
Android,30350739,1,,,2015,,9,24330,"<p>I need to make screen similar to this. I think it has autocompletetextview and listview to display returned results. Google Place API is used here to auto suggest places and listview adapter is updated accordingly.
Please any kind of help is appreciated.
Thanks in advance.</p>

<p>Checked android sample project on AutoComplete for places too. But it is not having any listview to display results. Instead it shows results in autocompletetextview spinner. Any modification we can do with that project</p>

<p><a href=""https://github.com/googlesamples/android-play-places"" rel=""noreferrer"">Link to google sample project</a></p>

<p><img src=""https://i.stack.imgur.com/KVQOR.png"" alt=""Uber PickUp location screen""></p>
",2265145,,,,,2018-07-02 23:36:11,AutoCompleteTextView with Google Places shown in ListView just like Uber,<android><android-fragments><android-listview><google-places-api><autocompletetextview>,3,4,6,
Android,33151244,1,,,2015,,11,8478,"<p>i want to implement tap to focus feature in my custom camera.
This is the basic code provided by Google <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""noreferrer"">https://github.com/googlesamples/android-Camera2Basic</a></p>

<p>Here's the code snippet where i think i should add my feature
If anyone has implemented the Camera2 API please help!</p>

<pre><code>  private void lockFocus() {
    try {
        // This is how to tell the camera to lock focus.
        mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AF_TRIGGER,
                CameraMetadata.CONTROL_AF_TRIGGER_START);
        // Tell #mCaptureCallback to wait for the lock.
        mState = STATE_WAITING_LOCK;
        mCaptureSession.capture(mPreviewRequestBuilder.build(), mCaptureCallback,
                mBackgroundHandler);
    } catch (CameraAccessException e) {
        e.printStackTrace();
    }
}
</code></pre>
",5137755,,,,,2019-01-02 7:57:29,Implement Tap to Focus in Camera2 API,<android>,3,0,6,
Android,39658993,1,,,2016,,16,3787,"<p>I have a BroadcastReceiver implementation that receives network connection events. its declared in the AndroidManifest.xml and is called by Android automatically when network events occur.</p>

<p>BroadcastReceiver:</p>

<pre><code>public class ConnectivityChangeReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        Log.v(TAG, ""action: "" + intent.getAction());
        Log.v(TAG, ""component: "" + intent.getComponent());
    }
}
</code></pre>

<p>AndroidManifest.xml:</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;manifest xmlns:android=""http://schemas.android.com/apk/res/android""
    package=""com.example.test""&gt;

    &lt;uses-permission android:name=""android.permission.ACCESS_NETWORK_STATE"" /&gt;

    &lt;application
        android:allowBackup=""true""
        android:icon=""@mipmap/ic_launcher""
        android:label=""@string/app_name""
        android:supportsRtl=""true""
        android:theme=""@style/AppTheme""&gt;
        ...
        &lt;receiver
            android:name="".ConnectivityChangeReceiver""
            android:enabled=""true""&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=""android.net.conn.CONNECTIVITY_CHANGE"" /&gt;
            &lt;/intent-filter&gt;
        &lt;/receiver&gt;
    &lt;/application&gt;

&lt;/manifest&gt;
</code></pre>

<p>I'd like to use Google's MVP sample architecture described here for my app:</p>

<p><a href=""https://github.com/googlesamples/android-architecture/tree/todo-mvp/"" rel=""noreferrer"">https://github.com/googlesamples/android-architecture/tree/todo-mvp/</a></p>

<p>Using the above architecture, just wondering:</p>

<ol>
<li><p>Where should my BroadcastReceiver be placed?</p></li>
<li><p>If my BroadcastReceiver needs to write to the database, whats the best way of doing this?</p></li>
<li><p>If my BroadcastReceiver needs to update the UI, whats the best way of doing this?</p></li>
</ol>
",4477923,,,,,2016-10-03 12:18:47,Where to put BroadcastReceiver in Android MVP?,<android><mvp>,5,5,6,
Android,36174807,1,,,2016,,8,4355,"<p>I want to capture image while recording video using camera2 API.</p>

<p>Two separate demos are available.
1. <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""noreferrer"">To capture image</a> and 
2. <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""noreferrer"">To record video</a></p>

<p>I tried to combine them into one app. But confused in many things. Like</p>

<ul>
<li>CameraDevice is single which representation of a single camera connected to an Android device.</li>
<li>Different template needed in request. For image : <code>mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_PREVIEW);</code> and for video <code>mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_RECORD);</code></li>
<li>In createCaptureSession method surface of ImageReader is needed and for video MediaRecorder is needed.</li>
</ul>

<p>CameraCaptureSession.StateCallback is needed in createCaptureSession method for both image and video.</p>

<p>And camera2 APIs are new. So no more examples available on Google.</p>

<p>Anyone has any idea about this? like how to capture photo while recording in android?</p>
",759684,,1033581,,2017-12-14 10:44:03,2018-09-12 16:46:05,How to programmatically take Photos while recording Video using Camera2 API in Android,<android><image><video><android-camera2>,6,2,6,
Android,27139281,1,28645831,,2014,,7,3866,"<p>I am playing around with the <a href=""https://github.com/googlesamples/android-BasicManagedProfile"" rel=""noreferrer"">BasicManagedProfile</a> sample and want to install a custom app to only the managed profile.  I can easily go to the play store, download, and install an app and it will only appear in the apps of the work profile.</p>

<p>However, using the standard Intent way to install an apk from the device does not seem to work.</p>

<pre><code>    final Intent intent = new Intent(Intent.ACTION_INSTALL_PACKAGE);
    intent.setDataAndType(Uri.fromFile(new File(APK_LOC)), ""application/vnd.android.package-archive"");
    intent.putExtra(Intent.EXTRA_NOT_UNKNOWN_SOURCE, true);
    intent.putExtra(Intent.EXTRA_INSTALLER_PACKAGE_NAME, getPackageName());
    startActivityForResult(intent, REQUEST_INSTALL, null);
</code></pre>

<p>Like normal, if the ""Install from unknown sources"" security setting isn't enabled, a dialog will pop up that sends you to the Settings app to enable it.  However, in a managed profile app, this dialog <em>always pops up</em> regardless of whether or not that security setting is checked.  It seems the settings are not reflected in a managed profile (which makes sense because it's an entirely separate settings database).</p>

<p>I have tried opening the Settings app directly, but it's still the same.  It just goes to the standards Settings app and not a Managed Profile settings app.</p>

<p>Is there a way to change this security setting for a managed profile or install an app from the profile owner app? Since my app is the profile owner it seems this should be allowed.  It's easily possible for system applications, but third party apps will not work with the <code>DevicePolicyManager#enableSystemApp()</code> method.</p>

<p>EDIT:</p>

<p>I have also tried installing from a Manage Profile Gmail app.  Same thing.  It does not seem possible to install apps outside the Google Play store in a managed profile.</p>
",786718,,660921,,2015-01-07 13:17:33,2016-03-01 7:08:44,Installing app to managed profile,<android><android-5.0-lollipop><android-managed-profile>,1,0,5,
Android,35489632,1,35509532,,2016,,11,6424,"<p>It seems I've found myself in the deep weeds of the Google Vision API for barcode scanning. Perhaps my mind is a bit fried after looking at all sorts of alternative libraries (ZBar, ZXing, and even some for-cost third party implementations), but I'm having some difficulty finding any information on where I can implement some sort of scan region limiting.</p>

<p>The use case is a pretty simple one: if I'm a user pointing my phone at a box with multiple barcodes of the same type (think shipping labels here), I want to explicitly point some little viewfinder or alignment straight-edge on the screen at exactly the thing I'm trying to capture, without having to worry about anything outside that area of interest giving me some scan results I don't want.</p>

<p>The above case is handled in most other Android libraries I've seen, taking in either a Rect with relative or absolute coordinates, and this is also a part of iOS' AVCapture metadata results system (it uses a relative CGRect, but really the same concept).</p>

<p>I've dug pretty deep into the sample app for the barcode-reader
<a href=""https://github.com/googlesamples/android-vision/tree/master/visionSamples/barcode-reader"" rel=""noreferrer"">here</a>, but the implementation is a tad opaque to get anything but the high level implementation details down.</p>

<p>It seems an ugly patch to, on successful detection of a barcode anywhere within the camera's preview frame, to simple no-op on barcodes outside of an area of interest, since the device is still working hard to compute those frames.</p>

<p>Am I missing something very simple and obvious on this one? Any ideas on a way to implement this cleanly, otherwise?</p>

<p>Many thanks for your time in reading through this!</p>
",3543729,,,,,2016-02-19 16:00:46,Limit Detection Area in Vision API,<android><google-vision><android-vision>,1,0,5,
Android,42820003,1,42820930,,2017,,12,9104,"<p>I've been following MVP design pattern provided by <a href=""https://github.com/googlesamples/android-architecture/tree/todo-mvp/"" rel=""noreferrer"">Google</a>  to refactor my application. I have one MainActivity and many Fragments and it's seems little be messy for me to create activity for every fragment , so i've been thinking to register presenter in fragment. What i'm seeing is that every fragment register it's own presenter, but i'm not sure how much wrong it is... :)</p>

<p>So here is my Presenter:</p>

<pre><code>public class FirstPresenter implements FirstContract.Presenter {
    private final FirstContract.View mView;

    public FirstPresenter(FirstContract.View view) {
        mView = view;
    }

    @Override
    public void start() {
        Log.e(TAG, ""Start"");
    }
}
</code></pre>

<p>And here is my Fragment:</p>

<pre><code>public class FirstFragment extends Fragment implements FirstContract.View {
    private FirstContract.Presenter mPresenter;

@Nullable
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container
            , Bundle savedInstanceState) {
...
// I register firstFragment's presenter here.
mPresenter = new FirstPresenter(this);
...
</code></pre>

<p>So my question is, is this right way? Can i register Presenter into Fragment instead in Activity? And if it is not right way, is there some good example to handle MVP with one activity and multiple fragments?</p>

<p>Thank you guys,
BR!</p>
",2922851,,2922851,,2017-03-15 20:38:22,2018-09-11 11:54:13,Can i register MVP Presenter inside Fragment,<android><android-fragments><android-activity><mvp><android-mvp>,1,1,5,
Android,29861580,1,29875013,,2015,,12,4281,"<p>Updating to Google Play Services v7.0+, and based in <a href=""https://github.com/googlesamples/android-play-location/blob/master/LocationSettings/app/src/main/java/com/google/android/gms/location/sample/locationsettings/MainActivity.java"">this sample</a> for LocationUpdates in Android, I have the following code to connect to the <code>LocationServices.SettingsApi</code> and check if user has everything OK for the Application receive the location updates.</p>

<pre><code>    LocationSettingsRequest.Builder builder = new LocationSettingsRequest.Builder();
    builder.addLocationRequest(mLocationRequest);
    mLocationSettingsRequest = builder.build();

    PendingResult&lt;LocationSettingsResult&gt; result =
            LocationServices.SettingsApi.checkLocationSettings(
                    mLocationClient,
                    mLocationSettingsRequest
            );
    result.setResultCallback(this);
</code></pre>

<p>Where <code>this</code> is the following callback:</p>

<pre><code>    @Override
    public void onResult(LocationSettingsResult locationSettingsResult) {

        final Status status = locationSettingsResult.getStatus();
        Intent resolutionIntent;
        switch (status.getStatusCode()) {
            case LocationSettingsStatusCodes.SUCCESS:
                // Everything is OK, starting request location updates
                break;
            case LocationSettingsStatusCodes.RESOLUTION_REQUIRED:
                // Seems the user need to change setting to enable locations updates, call startResolutionForResult(Activity, REQUEST_CODE)
                break;
            case LocationSettingsStatusCodes.SETTINGS_CHANGE_UNAVAILABLE:
                // Error, cannot retrieve location updates.
                break;
        }
    }
</code></pre>

<p>The <code>SUCCESS</code> it OK to reproduce, just keep GPS enabled.</p>

<p>The <code>RESOLUTION_REQUIRED</code> is also OK to reproduce, only disable GPS.</p>

<p>The <code>SETTINGS_CHANGE_UNAVAILABLE</code> is the deal: If user select ""NEVER"" when the step <code>RESOLUTION_REQUIRED</code> is executed, the result will come with this status always.</p>

<p>Did the Google Play Services has a option to reset <strong>programmatically</strong> the flag when user select the ""NEVER"" option? </p>

<p>I know that ""NEVER"" seems to be ""<strong><em>Really, don't ask me again!!!</em></strong>"", but I thinking to create a option in case the user change his mind, of course, if this can be possible.</p>

<p>In this case I'll be able to receive the status <code>RESOLUTION_REQUIRED</code> again and ask to user to accept the LocationUpdates when the app is executed next time.</p>
",1481408,,,,,2016-03-23 11:52:13,LocationServices.SettingsApi Reset SETTINGS_CHANGE_UNAVAILABLE flag,<android><google-play-services>,1,0,5,
Android,46278357,1,46280749,,2017,,17,1782,"<p>One of the most up to date samples covering Android Architecture Components is <a href=""https://github.com/googlesamples/android-architecture-components/tree/master/GithubBrowserSample"" rel=""nofollow noreferrer"">GithubBrowserSample</a> provided by Google. I reviewed the code and a few questions arose:</p>

<ol>
<li><p>I have noticed that <a href=""https://github.com/googlesamples/android-architecture-components/blob/master/GithubBrowserSample/app/src/main/java/com/android/example/github/di/ViewModelModule.kt"" rel=""nofollow noreferrer"">ViewModelModule</a> is included in <a href=""https://github.com/googlesamples/android-architecture-components/blob/master/GithubBrowserSample/app/src/main/java/com/android/example/github/di/AppModule.kt"" rel=""nofollow noreferrer"">AppModule</a>. It means that all the viewmodels are added to the DI graph. Why that is done in that way instead of having separate <code>Module</code> for each Activity/Fragment that would provide only needed <code>ViewModel</code> for specific Activity/Fragment?</p></li>
<li><p>In this specific example, where viewmodels are instantiated using <a href=""https://github.com/googlesamples/android-architecture-components/blob/master/GithubBrowserSample/app/src/main/java/com/android/example/github/viewmodel/GithubViewModelFactory.kt"" rel=""nofollow noreferrer"">GithubViewModelFactory</a> is there any way to pass a parameter to the specific <code>ViewModel</code>? Or the better solution would be to create a setter in <code>ViewModel</code> and set needed param via setter?</p></li>
</ol>
",4260554,,2489403,,2018-04-29 14:05:37,2018-04-29 14:05:37,"Understanding Android Architecture Components example GithubBrowserSample: ViewModelModule, ViewModel parameters",<android><dagger-2><android-architecture-components><dagger.android><android-viewmodel>,1,1,5,
Android,41251543,1,41258348,,2016,,4,2424,"<p>Im using MVP and RxJava similar to <a href=""https://github.com/googlesamples/android-architecture/tree/todo-mvp-rxjava/"" rel=""nofollow noreferrer"">google-samples</a> repo.</p>

<p>And I would like to ask how to correctly handle screen orientation change.</p>
",5140726,,5140726,,2016-12-20 21:39:24,2016-12-21 8:32:46,MVP and RxJava - Handling Orientation Changes on Android,<android><rx-java><screen-orientation><rx-android>,2,0,5,
Android,29431021,1,,,2015,,5,3713,"<p>I want to capture video with 4:3 aspect ratio from android fron-facing camera using Camera2 API (added in 5.0 version of android). It works correctly unless camera has 16:9 sensor array (as front-facing camera on Samsung Galaxy S5). In such case picture looks stretched as if 16:9 picture was being captured and squeezed into 4:3 surface provided by MediaRecorder.</p>

<p>According to documentation there shouldn't be any additional configuration needed as long as MediaRecorder's size has been set to one of sizes provided by <a href=""https://developer.android.com/reference/android/hardware/camera2/params/StreamConfigurationMap.html#getOutputSizes(java.lang.Class%3CT%3E)"" rel=""noreferrer"">getOutputSizes(MediaRecorder.class)</a>. Camera should automatically crop picture so it fits size of MediaRecorder's surface.</p>

<p>I tested also reversed situation - recording 16:9 video on camera with 4:3 sensor array (front-facing camera of Nexus-5). It works properly - picture is cropped to 16:9 aspect ratio.</p>

<p>I assume this is a bug in android API but would like to see whether there's something I miss here.</p>

<p>The simplest way to reproduce that problem is to use <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""noreferrer"">camera2Basic</a> sample app provided by google with the following <a href=""https://github.com/mikosik/android-Camera2Basic/commit/c3cf9f3755d2844d3398fa6252f3e324eee63e92"" rel=""noreferrer"">change</a> that switches to using front-facing camera and 4:3 size for preview. It works correctly on Nexus-5 but provides stretched image on Samsung Galaxy S5. Below screenshot of camera2Basic app on Samsung Galaxy S5 (android 5.0).</p>

<p><img src=""https://i.stack.imgur.com/WCJaj.jpg"" alt=""enter image description here""></p>
",2807871,,,,,2015-11-13 10:29:21,Capturing 4:3 camera picture via android Camera2 API on camera with 16:9 sensor array,<android><android-camera>,2,2,5,
Android,47236796,1,,,2017,,9,1107,"<p>I was looking in to the google sample for the new architecture component, where I found the the code as below:</p>

<pre><code>dependencies {
    // Support libraries
    implementation deps.support.app_compat
    implementation deps.support.v4
    implementation deps.support.design
    implementation deps.support.cardview

    // Architecture components
    implementation deps.lifecycle.runtime
    implementation deps.lifecycle.extensions
    annotationProcessor deps.lifecycle.compiler
    implementation deps.room.runtime
    annotationProcessor deps.room.compiler

    // Android Testing Support Library's runner and rules
    androidTestImplementation deps.atsl.runner
    androidTestImplementation deps.atsl.rules
    androidTestImplementation deps.room.testing
    androidTestImplementation deps.arch_core.testing

    // Espresso UI Testing
    androidTestImplementation deps.espresso.core
    androidTestImplementation deps.espresso.contrib
    androidTestImplementation deps.espresso.intents

    // Resolve conflicts between main and test APK:
    androidTestImplementation deps.support.annotations
    androidTestImplementation deps.support.v4
    androidTestImplementation deps.support.app_compat
    androidTestImplementation deps.support.design
}
</code></pre>

<p>I am not able to understand why they have written all the dependency starting with <code>deps.*</code>. Could anybody help me understand the code. Thanks in advance.
Here is the <a href=""https://github.com/googlesamples/android-architecture-components/blob/master/BasicSample/app/build.gradle"" rel=""noreferrer"">link</a> to the repo.</p>
",4820070,,542270,,2017-11-11 10:25:47,2017-11-24 15:06:06,"What is ""deps"" in ""implementation deps.support.app_compat""?",<android><gradle><build.gradle>,2,1,5,
Android,33039188,1,33253587,,2015,,18,7040,"<p>I'm studying the new permission model of Android Marshmallow but I'm facing an issue I find odd.</p>

<p>An app with <code>targetSdkVersion</code> 22 (so not yet using the new permission model of Android Marshmallow) declares the <code>READ_CONTACTS</code> permission in the manifest:</p>

<pre><code>&lt;uses-permission android:name=""android.permission.READ_CONTACTS"" /&gt;
</code></pre>

<p>and tries to read the phone number of a contact via <code>Intent.ACTION_PICK</code>:</p>

<pre><code>Intent intent = new Intent(Intent.ACTION_PICK);
intent.setType(ContactsContract.CommonDataKinds.Phone.CONTENT_TYPE);
startActivityForResult(intent, PICK_CONTACT_REQUEST);
</code></pre>

<p>When running on a device with Marshmallow MRA58K, after I revoke the permission after installing the app via ADB, the <code>ContextCompat.checkSelfPermission()</code> method still returns <code>PERMISSION_GRANTED</code>, but the operation fails later when accessing the contacts because a cursor with no records is returned. As I understood, this is the default ""retrocompatibility"" strategy to avoid legacy app to crash.</p>

<pre><code>@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == PICK_CONTACT_REQUEST &amp;&amp; resultCode == Activity.RESULT_OK) {
        Log.i("""", ""Permission granted: "" + (ContextCompat.checkSelfPermission(this, Manifest.permission.READ_CONTACTS) == PackageManager.PERMISSION_GRANTED));
        Uri contactUri = data.getData();
        Cursor c = null;
        try {
            c = getContentResolver().query(contactUri, new String[]{ContactsContract.CommonDataKinds.Phone.NUMBER}, null, null, null);
            if (c != null &amp;&amp; c.moveToFirst()) {
                Log.i("""", ""got phone number: "" + c.getString(0));
            } else {
                Log.w("""", ""No data received"");
            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            if (c != null) {
                c.close();
            }
        }
    } else {
        super.onActivityResult(requestCode, resultCode, data);
    }
}
</code></pre>

<p>How can I safely detect if the user explicitly before the permission before attempting the operation?</p>

<p>I also tried the official Google sample at <a href=""https://github.com/googlesamples/android-RuntimePermissions"" rel=""noreferrer"">https://github.com/googlesamples/android-RuntimePermissions</a> setting the <code>targetSdkVersion</code> to 22 with the same result: it logs that the permission is granted even if the user revoked it, ant then the operation fails.</p>

<p>Thanks ;)</p>
",247095,,,,,2017-07-17 10:16:34,checkSelfPermission returning PERMISSION_GRANTED for revoked permission with targetSdkVersion <= 22,<android><android-6.0-marshmallow>,2,5,5,
Android,38493000,1,,,2016,,21,1895,"<p>The new API, perhaps only on LG G3, seems to have something changed.</p>

<p>I'm using <a href=""https://github.com/googlesamples/android-Camera2Basic"">the sample code</a>.</p>

<p>On my nexus 4, the code runs perfectly, but on LGG3 updated to Android 6.0 it does not. Any ideas?</p>

<p>I played with the settings, but no luck, this still works fine on Nexus 4:</p>

<pre><code>mPreviewRequestBuilder.set(CaptureRequest.BLACK_LEVEL_LOCK, false);


mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AWB_LOCK, false);
mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AWB_MODE, CaptureRequest.CONTROL_AWB_MODE_AUTO);


mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AE_LOCK, false);

mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AE_MODE, CaptureRequest.CONTROL_AE_MODE_ON);
mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AE_ANTIBANDING_MODE, CaptureRequest.CONTROL_AE_ANTIBANDING_MODE_AUTO);
mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AE_EXPOSURE_COMPENSATION, 0);
//mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AE_TARGET_FPS_RANGE, Range.create(1000,1000));
mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AE_PRECAPTURE_TRIGGER, 0);


mPreviewRequestBuilder.set(CaptureRequest.CONTROL_MODE, CaptureRequest.CONTROL_MODE_AUTO);
mPreviewRequestBuilder.set(CaptureRequest.COLOR_CORRECTION_MODE, CaptureRequest.CONTROL_MODE_AUTO);


mPreviewRequestBuilder.set(CaptureRequest.CONTROL_CAPTURE_INTENT,
        CaptureRequest.CONTROL_CAPTURE_INTENT_PREVIEW);

mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AF_MODE,
        CaptureRequest.CONTROL_AF_MODE_CONTINUOUS_PICTURE);
</code></pre>
",6503333,,1276636,,2016-08-01 15:14:59,2018-04-29 15:23:24,"Camera2basic app, has very dark preview in Android 6.0 LGG3",<android><android-6.0-marshmallow><android-camera2>,3,4,5,
Android,35968315,1,36030703,,2016,,8,6675,"<p>I'm new in Android Camera2 API.
I just move my all project to the new Camera2 API. I have used the <a href=""https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/java/com/example/android/camera2basic/Camera2BasicFragment.java"" rel=""nofollow noreferrer"">Camera2Basic example</a> as a starting point.</p>

<p>I'm now trying handle zoom by adding this:</p>

<pre><code>public boolean onTouchEvent(MotionEvent event) {
    try {
        CameraManager manager = (CameraManager) getSystemService(Context.CAMERA_SERVICE);
        CameraCharacteristics characteristics = manager.getCameraCharacteristics(mCameraId);
        float maxZoom = (characteristics.get(CameraCharacteristics.SCALER_AVAILABLE_MAX_DIGITAL_ZOOM))*10;

        Rect m = characteristics.get(CameraCharacteristics.SENSOR_INFO_ACTIVE_ARRAY_SIZE);
        int action = event.getAction();
        float current_finger_spacing;

        if (event.getPointerCount() &gt; 1) {
            // Multi touch logic
            current_finger_spacing = getFingerSpacing(event);

            if(finger_spacing != 0){
                if(current_finger_spacing &gt; finger_spacing &amp;&amp; maxZoom &gt; zoom_level){
                    zoom_level++;

                }
                else if (current_finger_spacing &lt; finger_spacing &amp;&amp; zoom_level &gt; 1){
                    zoom_level--;

                }
                int minW = (int) (m.width() / maxZoom);
                int minH = (int) (m.height() / maxZoom);
                int difW = m.width() - minW;
                int difH = m.height() - minH;
                int cropW = difW /100 *(int)zoom_level;
                int cropH = difH /100 *(int)zoom_level;
                cropW -= cropW &amp; 3;
                cropH -= cropH &amp; 3;
                Rect zoom = new Rect(cropW, cropH, m.width() - cropW, m.height() - cropH);
                mPreviewRequestBuilder.set(CaptureRequest.SCALER_CROP_REGION, zoom);
            }
            finger_spacing = current_finger_spacing;
        }
        else{
            if (action == MotionEvent.ACTION_UP) {
                //single touch logic
            }
        }

        try {
            mCaptureSession.setRepeatingRequest(mPreviewRequestBuilder.build(), mCaptureCallback,
                    null);
        }
        catch (CameraAccessException e) {
            e.printStackTrace();
        }
        catch (NullPointerException ex)
        {
            ex.printStackTrace();
        }
    }
    catch (CameraAccessException e)
    {
        throw new RuntimeException(""can not access camera."", e);
    }

    return true;
}
</code></pre>

<p>And this:</p>

<pre><code>private float getFingerSpacing(MotionEvent event) {
    float x = event.getX(0) - event.getX(1);
    float y = event.getY(0) - event.getY(1);
    return FloatMath.sqrt(x * x + y * y);
}
</code></pre>

<p>But after I captured, the picture result is without the zoom.
How can I make it happen?
Thanks all.</p>

<p><strong>Update</strong>
Need to add <code>captureBuilder.set(CaptureRequest.SCALER_CROP_REGION, zoom);</code> to <code>captureStillPicture()</code> method.</p>
",5904387,,1363438,,2018-10-10 20:41:19,2018-10-10 20:41:19,android camera2 handle zoom,<android><zoom><capture><android-camera2>,4,4,5,
Android,33127258,1,,,2015,,10,4255,"<p>I have the code for the Camera2 from <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""noreferrer"">https://github.com/googlesamples/android-Camera2Basic</a>.</p>

<p>The problem i'm facing is that when i turn to my Front Camera, i cannot capture pictures but works fine with Back Camera.</p>

<p>Has anyone implemented the Camera2 Api please help!</p>

<p>Here's the code snippet:</p>

<pre><code>private void setUpCameraOutputs(int width, int height) {
    Activity activity = getActivity();
    CameraManager manager = (CameraManager) activity.getSystemService(Context.CAMERA_SERVICE);
    try {
        for (String cameraId : manager.getCameraIdList()) {
            CameraCharacteristics characteristics
                    = manager.getCameraCharacteristics(cameraId);

            // We don't use a front facing camera in this sample.
            int facing = characteristics.get(CameraCharacteristics.LENS_FACING);
            Log.i(TAG,""Front Cam ID: ""+ facing);
            if (characteristics.get(CameraCharacteristics.LENS_FACING)==CameraCharacteristics.LENS_FACING_FRONT)
            {



                StreamConfigurationMap map = characteristics.get(
                        CameraCharacteristics.SCALER_STREAM_CONFIGURATION_MAP);


                // For still image captures, we use the largest available size.
                Size largest = Collections.max(
                        Arrays.asList(map.getOutputSizes(ImageFormat.JPEG)),
                        new CompareSizesByArea());
                mImageReader = ImageReader.newInstance(largest.getWidth(), largest.getHeight(),
                        ImageFormat.JPEG, /*maxImages*/2);
                mImageReader.setOnImageAvailableListener(
                        mOnImageAvailableListener, mBackgroundHandler);

                // Danger, W.R.! Attempting to use too large a preview size could  exceed the camera
                // bus' bandwidth limitation, resulting in gorgeous previews but the storage of
                // garbage capture data.
                mPreviewSize = chooseOptimalSize(map.getOutputSizes(SurfaceTexture.class),
                        width, height, largest);

                // We fit the aspect ratio of TextureView to the size of preview we picked.
                int orientation = getResources().getConfiguration().orientation;
                if (orientation == Configuration.ORIENTATION_LANDSCAPE) {
                    mTextureView.setAspectRatio(
                            mPreviewSize.getWidth(), mPreviewSize.getHeight());
                } else {
                    mTextureView.setAspectRatio(
                            mPreviewSize.getHeight(), mPreviewSize.getWidth());
                }

                mCameraId = cameraId;
                return;
            }
            else
            {
                onActivityCreated(Bundle.EMPTY);
            }
        }
    } catch (CameraAccessException e) {
        e.printStackTrace();
    } catch (NullPointerException e) {
        // Currently an NPE is thrown when the Camera2API is used but not supported on the
        // device this code runs.
        ErrorDialog.newInstance(getString(R.string.camera_error))
                .show(getChildFragmentManager(), FRAGMENT_DIALOG);
    }
}
</code></pre>
",5137755,,,,,2016-11-14 20:21:31,Front Camera in Camera2 not capturing image,<android>,5,3,5,
Android,29029594,1,,,2015,,22,7668,"<p>I've been testing the geofencing api available in the latest Google Play Services, using the official sample available here: <a href=""https://github.com/googlesamples/android-Geofencing/"">https://github.com/googlesamples/android-Geofencing/</a>
And of course, following the training course: <a href=""http://developer.android.com/training/location/geofencing.html"">http://developer.android.com/training/location/geofencing.html</a></p>

<p>The sample displays a notification when you are nearing two Google buildings in San Fransisco, so I tweaked it to be triggered when I'm nearing my home or my work place.</p>

<p>If I use a real device, it works. The notifications are triggered properly. But when I'm using a simulator, and change the location with telnet or ddms, nothing happens. I also tried with Genymotion, with the Gapps installed, and same stuff: nothing.</p>

<p>Would anyone have any pointer about how to test geofence, without actually moving my butt? Because in the street, there is no way to debug the code...</p>
",870751,,,,,2018-09-04 10:17:40,Testing geofencing with Google Play Services 6.5.+,<android><google-play-services><geofencing>,6,7,5,
Android,42583759,1,42868218,,2017,,17,7806,"<p>DataBinding worked very well in my project,  But after upgrade Android Studio 2.3 today . <strong>Run 'app'</strong> failed because following error : </p>

<pre><code>Error:(15, 40) Error: package com.javan.myrecorder.databinding not exist.
import com.javan.myrecorder.databinding.FragmentEventsBinding;
:app:compileMockDebugJavaWithJavac FAILED
</code></pre>

<p>I just upgrade android studio and didn't change anything. all plugin is latest! Now my question is, why occurs this error and how could I solve it? any help is welcome!</p>

<p>English is not my mother tongue; please excuse any errors on my part.</p>

<hr>

<p>EDIT1</p>

<p>Like android project <a href=""https://github.com/googlesamples/android-architecture"" rel=""nofollow noreferrer"">googlesamples/android-architecture</a></p>

<ul>
<li><code>git checkout todo-databinding</code> </li>
<li>and then run <code>./gradlew assembleDebug</code> to build, build failed because of following error:</li>
</ul>

<p><a href=""https://i.stack.imgur.com/cwMyA.png"" rel=""nofollow noreferrer"">complete log of build</a></p>

<hr>

<p>EDIT2 <strong>I have fixed this problem by following <a href=""https://stackoverflow.com/questions/42570707/data-binding-broke-after-upgrade-to-gradle-2-3/42590471#42590471"">Data Binding broke after upgrade to Gradle 2.3</a></strong>.</p>

<p>in <code>build.gradle(app)</code> add </p>

<pre><code>apply plugin: 'com.android.application'
apply plugin: 'com.neenbedankt.android-apt'

..balabala

dependencies {
    apt 'com.android.databinding:compiler:2.3.0'
}
</code></pre>

<p>some file in my project:</p>

<p><code>gradle-wrapper.properties</code></p>

<pre><code>#Mon Mar 06 10:59:04 CST 2017
distributionBase=GRADLE_USER_HOME
distributionPath=wrapper/dists
zipStoreBase=GRADLE_USER_HOME
zipStorePath=wrapper/dists
distributionUrl=https\://services.gradle.org/distributions/gradle-3.3-all.zip
</code></pre>

<p>@petrnohejl @George Mount @Sa-Zad Prasla, Thanks!</p>
",7638509,,-1,,2017-05-23 10:31:31,2018-03-16 17:03:30,DataBinding not working after Upgrade Android Studio 2.3,<android><android-studio><data-binding><android-databinding><android-studio-2.3>,7,5,5,
Android,46119375,1,,,2017,,5,1251,"<p>I'm trying to add the new Architecture Components <code>ViewModel</code> to my application while injecting them with dagger. I based my code on what google showed <a href=""https://github.com/googlesamples/android-architecture-components/tree/master/GithubBrowserSample/app/src/main/java/com/android/example/github/di"" rel=""nofollow noreferrer"">here</a>. I'm trying to avoid having a <code>ViewModelFactory</code> for each <code>ViewModel</code> type, so I used the <code>ViewModelFactory</code> that receives <code>Map&lt;Class&lt;? extends ViewModel&gt;, Provider&lt;ViewModel&gt;&gt; creators</code>. It works for <code>ViewModels</code> that have dependencies with <code>@Singleton</code> scope. However, one of my <code>ViewModels</code> has a dependency that comes from the fragment. This is the module of that fragment:</p>

<pre><code>@Module
public abstract class DownloadIssueDialogFragmentModule {

    @Binds
    abstract DialogFragment dialogFragment(DownloadIssueDialogFragment dialogFragment);

    @Provides
    @FragmentScope
    static Issue provideIssue(DownloadIssueDialogFragment dialogFragment) {
        return dialogFragment.getIssue();
    }
}
</code></pre>

<p>And my <code>ViewModelModule</code>:</p>

<pre><code>@Module
public abstract class ViewModelModule {

    @Binds
    abstract ViewModelProvider.Factory bindViewModelFactory(ViewModelFactory factory);

    @Binds
    @IntoMap
    @ViewModelKey(DownloadIssueViewModel.class)
    abstract ViewModel bindDownloadIssueViewModel(DownloadIssueViewModel viewModel);

}
</code></pre>

<p>dagger says it can't provide <code>Issue</code>. It makes sense since <code>Map&lt;Class&lt;? extends ViewModel&gt;, Provider&lt;ViewModel&gt;&gt;</code> seems to be created at compile time. But I will only know the parameter during the scope of that fragment. How can I achieve this?</p>

<p>Thank you.</p>

<p><strong>EDIT:</strong></p>

<p>In the end I went with a different approach. Now I create a factory for each ViewModel and instead of injecting ViewModels, I inject the factory.</p>

<p>I created this library: <a href=""https://github.com/kakai248/AutoViewModelFactory"" rel=""nofollow noreferrer"">AutoViewModelFactory</a></p>

<p>To automatically generate the factories. It's the best solution I've found so far.</p>
",2283624,,2283624,,2017-09-21 11:38:15,2017-09-21 11:38:15,Architecture Components ViewModels inject with dagger with params that come from the Activity/Fragment,<android><mvvm><dagger-2><dagger><android-architecture-components>,1,2,4,
Android,41926591,1,,,2017,,6,2179,"<p>So I have played around all weekend with the camera2 api. Now I'm at a point where I begin to understand how things are wired together.
While testing the api to implement a video recording app I hit a wall though.</p>

<p>I started by changing the <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""noreferrer"">Android Camera2Video Sample</a> to my needs. What bugged me is that after each recording process the camera session is being recreated. Even worse, when a recording session is beeing started whats happening is that the preview session will be destroyed first and a recording session is created. After the recording session is done it gets destroyed and a new preview session is created.</p>

<p>The documentation clearly states: </p>

<blockquote>
  <p>Creating a session is an expensive operation and can take several hundred milliseconds... <a href=""https://developer.android.com/reference/android/hardware/camera2/CameraCaptureSession.html"" rel=""noreferrer"">CameraCaptureSession Documentation</a></p>
</blockquote>

<p>The result looks pretty ugly and the screen stutters when I hit record and stop. I wanted to improve this behavior so I fiddled around with the code.</p>

<p>What I do now is I create my one and only <code>CameraSession</code> where I add my preview surface (a <code>TextureView</code>) and also the Surface from a already created <code>MediaRecorder</code> by calling its <code>getSurface</code> method. This works fine for the first video but when I try to capture a second Video I get a <code>IllegalArgumentException: Bad argument passed to camera service</code>. I think this is because the surface of the <code>MediaRecorder</code> which I pass to the <code>CameraSession</code> upon it's creation is somehow destroyed or changed when I reset the <code>MediaRecorder</code> to prepare a new recording.</p>

<p>My question now is, is there any way around this problem? (<code>setInputSurface(Surface surface)</code>) might be but the api level is too high so I didn't test it.</p>

<p>Here is a quick overview over the relevant code pieces:</p>

<ol>
<li><p>setup the <code>MediaRecorder</code></p>

<pre><code>private void setUpMediaRecorder() throws IOException {
    if (mMediaRecorder == null) {
        mMediaRecorder = new MediaRecorder();
    }
    mMediaRecorder.setVideoEncodingBitRate(5000000);
    mMediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
    mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.SURFACE);
    mMediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);
    mMediaRecorder.setVideoFrameRate(24);
    mMediaRecorder.setVideoSize(mVideoSize.getWidth(), mVideoSize.getHeight());
    mMediaRecorder.setVideoEncoder(MediaRecorder.VideoEncoder.H264);
    mMediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AAC);
    mMediaRecorder.setOrientationHint(SENSOR_ORIENTATION_DEFAULT_DEGREES);
    mNextVideoAbsolutePath = getVideoFilePath();
    mMediaRecorder.setOutputFile(mNextVideoAbsolutePath);
    mMediaRecorder.prepare();
}
</code></pre></li>
<li><p>create the all mighty recording session</p>

<pre><code>SurfaceTexture texture = mTextureView.getSurfaceTexture();
texture.setDefaultBufferSize(mPreviewSize.getWidth(), mPreviewSize.getHeight());

List&lt;Surface&gt; surfaces = new ArrayList&lt;&gt;();
// Set up Surface for the camera preview
mPreviewSurface = new Surface(texture);
surfaces.add(mPreviewSurface);

// Set up Surface for the MediaRecorder
mRecorderSurface = mMediaRecorder.getSurface();
surfaces.add(mRecorderSurface);

// create the capture session
mCameraDevice.createCaptureSession(surfaces, new CameraCaptureSession.StateCallback() {

    @Override
    public void onConfigured(@NonNull CameraCaptureSession cameraCaptureSession) {
        mCameraSession = cameraCaptureSession;

        // now that the session is created, start using it  for the preview
        showPreview();
    }

    @Override
    public void onConfigureFailed(@NonNull CameraCaptureSession cameraCaptureSession) {
        ....
            }
        }
    }, mBackgroundHandler);
} catch (CameraAccessException) {
    e.printStackTrace();
}

void showPreview() {
    mPreviewBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_PREVIEW);
    mPreviewBuilder.set(CaptureRequest.CONTROL_MODE, CameraMetadata.CONTROL_MODE_AUTO);
    mPreviewBuilder.addTarget(mPreviewSurface);
    mCameraSession.setRepeatingRequest(mPreviewBuilder.build(), null, mBackgroundHandler);
}
</code></pre></li>
<li><p>start recording a video</p>

<pre><code>mVideoBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_RECORD);
mVideoBuilder.set(CaptureRequest.CONTROL_AF_MODE, CaptureRequest.CONTROL_AF_MODE_CONTINUOUS_VIDEO);
mVideoBuilder.set(CaptureRequest.CONTROL_AE_MODE, CaptureRequest.CONTROL_AE_MODE_ON);
mVideoBuilder.addTarget(mPreviewSurface);
mVideoBuilder.addTarget(mRecorderSurface);
// set the request for the capture
mCameraSession.setRepeatingRequest(mVideoBuilder.build(), null, mBackgroundHandler);
// Start recording
mMediaRecorder.start();
</code></pre></li>
<li><p>stop recording</p>

<pre><code>mMediaRecorder.stop();
mMediaRecorder.reset();
showPreview();
setUpMediaRecorder(); // this is key to not get an error from the MediaRecorder
</code></pre></li>
</ol>

<p>All of this works perfect and the video recording starts and stops without any hiccups! It's awesome but when I go back to step 3 (after 4) I get the aforementioned <code>IllegalArgumentException: Bad argument passed to camera service</code>. I keep banging my head against the wall but I cannot find a way around this problem.</p>

<p>Any help is greatly appreciated!</p>

<p>Thanks!</p>
",1096141,,1096141,,2017-01-30 21:17:51,2017-05-16 21:38:44,How to reuse the Surface of MediaRecorder in the camera2 API on Android?,<android><video><mediarecorder><android-camera2>,1,1,4,
Android,35354363,1,35404097,,2016,,10,1899,"<p>I made a video capture app with Camera2 API by following <a href=""https://github.com/googlesamples/android-Camera2Video"">this</a> guide, </p>

<p>Is there a provision to change brightness/contrast/exposure settings of the video programatically? I'm trying to capture some low-lit video footage, and I wish to increase the exposure.</p>

<p>The documentation <a href=""http://developer.android.com/reference/android/hardware/Camera.Parameters.html"">here</a> seems to apply only for still pictures.</p>

<p>Any such way for video capture, using <strong>Camera2</strong> API?</p>
",2499724,,,,,2016-02-15 7:55:01,Set brightness/contrast in video capture using Android Camera2,<android><video><video-capture><android-camera2>,1,0,4,
Android,48169430,1,,,2018,,11,428,"<p>I am having trouble to find a proper solution to make view/viewmodel aware of network status, specially using RxJava.</p>

<p>I tried to follow <a href=""https://developer.android.com/topic/libraries/architecture/guide.html#addendum"" rel=""nofollow noreferrer"">Google's NetworkBoundResource</a> and <a href=""https://medium.com/@iammert/offline-app-with-rxjava-2-and-room-ccd0b5c18101"" rel=""nofollow noreferrer"">Iammert's networkBoundResouce</a> (also tried <a href=""https://github.com/googlesamples/android-architecture-components/tree/master/GithubBrowserSample"" rel=""nofollow noreferrer"">GithubBrowserSample</a>
but I just don't really understand the code or how it should be encapsulated.</p>

<p>I'm looking for how can I implement NetworkBoundResource with RxJava2 in a way that the data gets refreshed automatically with the Database.</p>

<p>I will show what I currently have:</p>

<p>A fragment with arch.lifecycle.ViewModel</p>

<pre><code>public class LoginViewModel extends ViewModel {

    static final int SCREEN_JUST_BUTTONS = 0;
    static final int SCREEN_LOGIN_INPUT = 1;
    static final int SCREEN_PASS_INPUT = 2;

    // using a PublishSubject because we are not interested in the last object that was emitted
    // before subscribing. Like this we avoid displaying the snackbar multiple times
    @NonNull
    private final PublishSubject&lt;Integer&gt; snackbarText;

    private int SCREEN = 0;

    private LoginUiModel loginUiModel;
    @NonNull
    private BaseSchedulerProvider schedulerProvider;
    @NonNull
    private UserRepository userRepository;

    @Inject
    LoginViewModel(@NonNull final BaseSchedulerProvider schedulerProvider, @NonNull final UserRepository userRepository) {
        this.schedulerProvider = schedulerProvider;
        this.userRepository = userRepository;
        snackbarText = PublishSubject.create();
        disposables = new CompositeDisposable();
        loginUiModel = new LoginUiModel();
    }

    int getScreen() {
        return SCREEN;
    }

    void setScreen(final int screen) {
        this.SCREEN = screen;
    }

    @NonNull
    Observable&lt;Integer&gt; getSnackbarText() {
        return snackbarText;
    }

    LoginUiModel getLoginUiModel() {
        return loginUiModel;
    }


    public Single&lt;User&gt; login(final String login, final String password) {
        return userRepository.login(login, password)
                             .subscribeOn(schedulerProvider.io())
                             .observeOn(schedulerProvider.ui())
                             .doOnError(this::handleErrorLogin);
    }

    private void handleErrorLogin(final Throwable t) {
        if (t instanceof HttpException) {
            showSnackbar(R.string.Login_invalid_input);
        } else if (t instanceof IOException) {
            showSnackbar(R.string.Common_no_connection);
        } else {
            showSnackbar(R.string.Common_error_loading);
        }
    }

    private void showSnackbar(@StringRes int textId) {
        snackbarText.onNext(textId);
    }

    void forgotPassword() {
        if (isValidEmail(loginUiModel.getEmail())) {
            showSnackbar(R.string.Login_password_sent);
        } else {
            showSnackbar(R.string.Login_invalid_login);
        }
        //TODO;
    }

    boolean isValidEmail(@Nullable final String text) {
        return text != null &amp;&amp; text.trim().length() &gt; 3 &amp;&amp; text.contains(""@"");
    }
}
</code></pre>

<p>and in my UserRepository:</p>

<pre><code>@Singleton
public class UserRepository {

    @NonNull
    private final UserDataSource userRemoteDataSource;

    @NonNull
    private final UserDataSource userLocalDataSource;

    @NonNull
    private final RxSharedPreferences preferences;

    @Inject
    UserRepository(@NonNull RxSharedPreferences rxSharedPreferences, @NonNull @Remote UserDataSource userRemoteDataSource, @NonNull @Local UserDataSource
            userLocalDataSource) {
        this.userRemoteDataSource = userRemoteDataSource;
        this.userLocalDataSource = userLocalDataSource;
        preferences = rxSharedPreferences;
    }

    @NonNull
    public Single&lt;User&gt; login(final String email, final String password) {
        return userRemoteDataSource
                .login(email, password) // busca do webservice
                .flatMap(userLocalDataSource::saveUser) // salva no banco local
                .flatMap(user -&gt; userLocalDataSource.login(user.getEmail(), user.getPassword())) // busca usuário no banco local como SSOT
                .doOnSuccess(this::saveUserId); // salva o ID do usuário nas preferências.
    }

    public Single&lt;User&gt; saveUser(String email, String password, String name, String phone, String company) {
        User user = new User(0, name, email, password, phone, company);

        return saveUser(user);
    }

    private Single&lt;User&gt; saveUser(final User user) {
        return userRemoteDataSource.saveUser(user)
                                   .flatMap(userLocalDataSource::saveUser)
                                   .doOnSuccess(this::saveUserId); // salva o ID do usuário nas preferências.
    }

    private void saveUserId(final User user) {
        preferences.getLong(Consts.KEY_USER_ID__long).set(user.getUserId());
    }

    public Flowable&lt;User&gt; getUserUsingSystemPreferences() {
        Preference&lt;Long&gt; userIdPref = preferences.getLong(Consts.KEY_USER_ID__long, -1L);
        if (userIdPref.get() &lt;= 0) {
            //nao deveria acontecer, mas se acontecer, reseta:
            userIdPref.delete();
            return Flowable.error(new RuntimeException(""Not logged in.""));
        } else if (!userIdPref.isSet()) {
            return Flowable.error(new RuntimeException(""Not logged in.""));
        } else {
            return userLocalDataSource.getUser(String.valueOf(userIdPref.get()));
            }
        }
    }
</code></pre>

<p>and my UserLocalDataSource:</p>

<pre><code>@Singleton
public class UserLocalDataSource implements UserDataSource {

    private final UserDao userDao;

    @Inject
    UserLocalDataSource(UserDao userDao) {
        this.userDao = get(userDao);
    }

    @NonNull
    @Override
    public Single&lt;User&gt; login(final String email, final String password) {
        return userDao.login(email, password);
    }

    @Override
    public Flowable&lt;User&gt; getUser(final String id) {
        return userDao.getUserById(Long.valueOf(id));
    }

    @Override
    public Single&lt;User&gt; saveUser(final User user) {
        return Single.create(e -&gt; {
            long id = userDao.insert(user);
            user.setUserId(id);
            e.onSuccess(user);
        });
    }

    @Override
    public Completable deleteUser(final String id) {
        return getUser(id).flatMapCompletable(user -&gt; Completable.create(e -&gt; {
            int numberOfDeletedRows = userDao.delete(user);
            if (numberOfDeletedRows &gt; 0) {
                e.onComplete();
            } else {
                e.onError(new Exception(""Tried to delete a non existing user""));
            }
        }));
    }
}
</code></pre>

<p>and the user remote data source:</p>

<pre><code>public class UserRemoteDataSource implements UserDataSource {

    private final ISApiService apiService;

    @Inject
    UserRemoteDataSource(ISApiService apiService) {
        this.apiService = get(apiService);
    }

    @NonNull
    @Override
    public Single&lt;User&gt; login(final String email, final String password) {
        return apiService.login(email, password);
    }

    @Override
    public Flowable&lt;User&gt; getUser(final String id) {
        throw new RuntimeException(""NO getUser endpoint"");
    }

    @Override
    public Single&lt;User&gt; saveUser(final User user) {
        Map&lt;String, String&gt; params = new HashMap&lt;&gt;();

        params.put(ISApiConsts.EMAIL, user.getEmail());
        params.put(ISApiConsts.NAME, user.getName());
        params.put(ISApiConsts.PASSWORD, user.getPassword());
        params.put(ISApiConsts.PHONE, user.getPhone());
        params.put(ISApiConsts.COMPANY, user.getCompany());

        return apiService.signUp(params);
    }

    @Override
    public Completable deleteUser(final String id) {
        //can't delete user.
        return Completable.complete();
    }
}
</code></pre>

<p>UserDao interface ( It is using Room)</p>

<pre><code>@Dao
public interface UserDao extends BaseDao&lt;User&gt; {

    @Query(""SELECT * FROM user WHERE user_id = :id"")
    Flowable&lt;User&gt; getUserById(long id);

    @Query(""SELECT * FROM user WHERE email = :login AND password = :password"")
    Single&lt;User&gt; login(String login, String password);

}
</code></pre>

<p>What I want to know exactly is: How can I encapsulate my domain while still get access to possible problems like network and show it to the user using RxJava in the MVVM pattern?</p>
",3291164,,3674262,,2018-02-09 18:01:42,2018-02-10 0:39:50,Network Awareness from Repository using RxJava,<android><rx-java2><rx-android>,1,9,4,
Android,32736708,1,,,2015,,2,4172,"<p>I am presently working with a chat application where I'm suppose to use Bluetooth LE Technology in my chat application.<br>
Through my research &amp; study over it,i have gone through several links:</p>

<ol>
<li><p><a href=""https://stackoverflow.com/questions/21489386/android-bluetooth-le-chat-example"">Android Bluetooth LE Chat example</a></p>

<p>From here i got to know that serial data transfer over Bluetooth low
energy is not supported as of then(10.10.14).</p></li>
<li><p><a href=""https://github.com/onlyinamerica/blemeshchat"" rel=""nofollow noreferrer"">https://github.com/onlyinamerica/blemeshchat</a> </p>

<p>The above project i have found bit similar as of my purpose but later on it was in vain.</p></li>
<li><p>Even gone through several Bluetooth chat tutorials and got to know that the user has to pair their device for their purpose.<br>
Gone through the following tutorials:</p>

<ul>
<li><a href=""https://github.com/googlesamples/android-BluetoothChat"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-BluetoothChat</a></li>
<li><a href=""http://www.androidhive.info/2014/10/android-building-group-chat-app-using-sockets-part-1/"" rel=""nofollow noreferrer"">http://www.androidhive.info/2014/10/android-building-group-chat-app-using-sockets-part-1/</a></li>
<li><a href=""http://www.pubnub.com/blog/tutorial-how-to-build-android-group-chat-application/"" rel=""nofollow noreferrer"">http://www.pubnub.com/blog/tutorial-how-to-build-android-group-chat-application/</a></li>
<li><a href=""http://myapptemplates.com/simple-android-chat-app-parse-integration-tutorial/"" rel=""nofollow noreferrer"">http://myapptemplates.com/simple-android-chat-app-parse-integration-tutorial/</a></li>
</ul></li>
</ol>

<p>I have done loads of research on how to use BLE Technology for chatting but didn't find a good resource on how to implement it.</p>

<p>So my questions are as follows:</p>

<ol>
<li><p>Can we make a chat application using Bluetooth Low Energy similarly as of Bluetooth? Please give a verified reasons but not opinion based.</p></li>
<li><p>Can BLE chat application can chat with normal bluetooth application? Give reasons?</p></li>
<li><p>If possible please provide me some good resource for implementing chat with BLE Technology.</p></li>
</ol>
",4684069,,-1,,2017-05-23 11:46:36,2018-12-07 9:33:05,How to use Bluetooth Low Energy (BLE) in an android chat application?,<android><bluetooth><chat><bluetooth-lowenergy>,2,2,4,
Android,51192192,1,,,2018,,3,145,"<p>I develop an android app which streams video over <a href=""https://tokbox.com/a"" rel=""nofollow noreferrer"">TokBox</a>. I want to record the streaming video. In order to do this, I tried to use <a href=""https://github.com/googlesamples/android-MediaRecorder"" rel=""nofollow noreferrer"">MediaRecorder</a> sample. It did great job on video recording, however I lost my stream. There are two main java classes, just say A and B. The class B implements <code>PreviewCallback</code>. Here are <code>onPreviewFrame</code> method. If you are interested in TokBox, the class B extends <code>BaseVideoCapturer</code>.</p>

<pre><code>@Override
public void onPreviewFrame(byte[] data, Camera camera) {
    mPreviewBufferLock.lock();
    if (isCaptureRunning) {
        if (data.length == mExpectedFrameSize) {
            // Get the rotation of the camera
            int currentRotation = compensateCameraRotation(mCurrentDisplay
                    .getRotation());
            // Send frame to OpenTok
            provideByteArrayFrame(data, NV21, mCaptureWidth,
                    mCaptureHeight, currentRotation, isFrontCamera());

            // Reuse the video buffer
            camera.addCallbackBuffer(data);
        }
    }
    mPreviewBufferLock.unlock();
}
</code></pre>

<p>The class A is an activity that manages recording. There is a method to start video record and stop after 5 seconds.</p>

<pre><code>public static boolean prepareAndStartMediaRecorder(){
    if(CustomVideoCapturer.isCaptureStarted){
        // BEGIN_INCLUDE (configure_media_recorder)
        mMediaRecorder = new MediaRecorder();
        // Step 1: Unlock and set camera to MediaRecorder
        B.mCamera.unlock();
        mediaRecorder.setCamera(B.mCamera);
        // Step 2: Set sources
        mediaRecorder.setAudioSource(MediaRecorder.AudioSource.CAMCORDER);
        mediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
        // Step 3: Set a CamcorderProfile (requires API Level 8 or higher)
        mMediaRecorder.setProfile(profile);
        // Step 4: Set output file
        mediaRecorder.setOutputFile(""/sdcard/myvideo.mp4"");
        mediaRecorder.setMaxDuration(60000); // Set max duration 60 sec.
        mediaRecorder.setMaxFileSize(5000000); // Set max file size 5M
        //configure preview
        mediaRecorder.setPreviewDisplay(mPreview.getSurfaceTexture());
        // Step 5: Prepare configured MediaRecorder
        try {
            mediaRecorder.prepare();
        } catch (IllegalStateException e) {
            releaseMediaRecorder();
            return false;
        } catch (IOException e) {
            releaseMediaRecorder();
            return false;
        }
        mediaRecorder.start();
        final Handler handler = new Handler();
        handler.postDelayed(new Runnable() {
            @Override
            public void run() {
                mediaRecorder.stop();  // stop the recording
            }
        }, 5000);
    }
</code></pre>

<p>After recording is started, <code>onPreviewFrame</code> method is not called. Do you have any solution about this problem or another approach to record and stream video at the same time?</p>

<p>Edit 1: I tried to apply this <a href=""https://stackoverflow.com/questions/14412618/android-onpreviewframe-is-not-called"">solution</a>, but it did not work. If you claim that this is the right solution, please inform me.</p>

<p>Edit 2: The archiving API records the streaming media, so it has noisy sometimes. I need to record frames from camera directly in order to get high-quality video.</p>
",8065997,,8065997,,2018-07-07 11:21:20,2018-07-24 10:09:46,How to record video that is already streamed on onPreviewFrame,<android><video-streaming><android-camera><opentok><android-video-record>,2,2,4,
Android,45099484,1,46485018,,2017,,6,761,"<p>I'm trying to implement an MDM client app for Android, known in the Android For Work world as a Device Policy Controller or DPC. Google's documentation for building a DPC is <a href=""https://developers.google.com/android/work/build-dpc"" rel=""noreferrer"">here</a>.</p>

<p>The documented process <a href=""https://developers.google.com/android/work/build-dpc#download_the_library"" rel=""noreferrer"">begins</a> with downloading the DPC Support Library. Unfortunately, the <a href=""https://connect.googleforwork.com/community/developers/android/emm/technical-integration/profile-owner-and-device-owner-guidance"" rel=""noreferrer"">download link they provide</a> (to the ""EMM Community's Technical Integration"" section) doesn't work: you're prompted to log in with a Google account, but after doing so I see this:</p>

<blockquote>
  <p><strong>We’re sorry...</strong></p>
  
  <p>...but it looks like you don’t have access to this place or content. If you think you should have access to this space, try logging out and back in again using your account menu accessible by clicking your avatar in the top right corner of this page. If this issue persists, please notify your Support Representative and we will troubleshoot further.</p>
</blockquote>

<p>Others have had the same problem: there's an <a href=""https://connect.googleforwork.com/thread/19771"" rel=""noreferrer"">issue ticket raised here</a> which is only 2 months old, has no answer but for some reason has been marked <em>Assumed Answered</em> and then ignored.</p>

<p>The <a href=""https://developers.google.com/android/work/prov-devices#final_setup_steps_for_all_modes_of_operation"" rel=""noreferrer"">steps documented here</a> make it very clear that the DPC Support Library is a required part of the process, and don't describe any alternatives to using it.</p>

<p>So, <strong>how do I get hold of the DPC Support Library?</strong> Can it be obtained anywhere else? Or failing that, how do I find out what it does so I can reproduce those steps manually in my own code?</p>

<hr/>

<p>Some steps I've already tried:</p>

<ol>
<li>I have successfully <a href=""https://connect.googleforwork.com/docs/DOC-13121"" rel=""noreferrer"">registered for the EMM Community</a> and have access to the <a href=""https://developers.google.com/android/work/play/emm-api/v1/"" rel=""noreferrer"">EMM API</a>. (i.e. I get a valid response now from <a href=""https://developers.google.com/android/work/play/emm-api/v1/enterprises/generateSignupUrl"" rel=""noreferrer"">Enterprises.generateSignupUrl</a>, and no longer the dreaded ""<a href=""https://stackoverflow.com/questions/41094734/google-emm-apis-return-the-caller-is-not-registered-as-an-mdm"">The caller is not registered as an MDM</a>"".) That in itself was a long and frustratingly opaque process.</li>
<li>I have built and run the <a href=""https://github.com/googlesamples/android-testdpc"" rel=""noreferrer"">googlesamples/android-testdpc</a> app and looked through the source code. Unfortunately this is a client-only demo: it doesn't communicate with an EMM server and doesn't use the DPC Support Library. Specifically, it doesn't obtain an authorisation token in order to provision a work profile on the device, as documented <a href=""https://developers.google.com/android/work/prov-devices#final_setup_steps_for_all_modes_of_operation"" rel=""noreferrer"">here</a>.</li>
<li>I have played with the <a href=""https://enterprise.google.com/android/experience/overview"" rel=""noreferrer"">public EMM demo system</a> and its <a href=""https://play.google.com/store/apps/details?id=com.google.android.apps.work.clouddpc"" rel=""noreferrer"">DPC app</a>. That seems to be doing things properly, but as it's closed-source I can't look at the code for either client or server.</li>
</ol>
",440921,,440921,,2017-07-14 10:03:00,2017-10-12 11:12:05,How can I get hold of (or bypass) the Android DPC Support Library?,<android><mdm><android-for-work>,2,5,4,
Android,52140059,1,52142897,,2018,,6,994,"<p><strong>OBS:</strong> Though still no first class support (as of writing this), Google has now updated their samples with an example of how they think this should be solved: <a href=""https://github.com/googlesamples/android-architecture-components/tree/master/NavigationAdvancedSample"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-architecture-components/tree/master/NavigationAdvancedSample</a></p>

<p>The <a href=""https://codelabs.developers.google.com/codelabs/android-navigation/index.html?index=..%2F..%2Findex#0"" rel=""nofollow noreferrer"">Android Codelab for Navigation</a> does a good job describing how to use the architecture component Navigation together with a <code>BottomNavigationView</code>. But let's say I have 2 tabs in the <code>BottomNavigationView</code>, <strong>Tab1</strong> and <strong>Tab2</strong>. And let's say that in <strong>Tab1</strong> you navigate through the fragments <strong>Frag1</strong> --> <strong>Frag2</strong>. Now, whenever I go to <strong>Tab2</strong>, and then back to <strong>Tab1</strong>, the fragment back stack of <strong>Frag1,2</strong> is gone, and replaced with the starting point <strong>Frag1</strong> again. </p>

<p>What do I have to do in an app so that a <code>BottomNavigationView</code> together with <a href=""https://developer.android.com/topic/libraries/architecture/navigation/"" rel=""nofollow noreferrer"">Navigation</a> keeps its back stack intact even though I change tabs? And, also keeping the back/up button behaviours in sync with the guidelines.</p>

<p>Previously I've done this with the use of <code>ViewPager</code> and managing the back stack my selfe, but that doesn't feels like the right approach with the new Navigation.</p>

<p>Thanks in advance!</p>

<hr>

<p><strong>Edit:</strong></p>

<p>There's a more elaborate answer <a href=""https://stackoverflow.com/questions/51707889/android-jetpack-navigation-with-multiple-stack/52146506#52146506"">here</a>.</p>
",3499145,,3499145,,2019-03-20 7:27:39,2019-03-20 7:27:39,Android Jetpack Navigation proper back stack with BottomNavigationView,<android><android-architecture-components><bottomnavigationview><android-navigation><android-jetpack>,2,0,4,
Android,30172529,1,,,2015,,10,753,"<p><a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""nofollow noreferrer"">One of the official Google samples for the Camera2 API</a> suffers from <a href=""https://github.com/googlesamples/android-Camera2Basic/issues/10"" rel=""nofollow noreferrer"">the same <code>BufferQueue has been abandoned</code> problem</a> as is seen in:</p>

<ul>
<li><a href=""https://stackoverflow.com/questions/22486762/what-can-i-do-when-the-bufferqueue-has-been-abandoned"">What can I do when the BufferQueue has been abandoned?</a></li>
<li><a href=""https://stackoverflow.com/questions/30111951/android-logcat-shows-bufferqueueprocedure-solved"">Android LogCat shows BufferQueueProcedure</a></li>
</ul>

<p>Specifically, the sample app calls a <code>closeCamera()</code> method from <code>onPause()</code> of a fragment, where <code>closeCamera()</code> calls <code>close()</code> on the <code>CameraCaptureSession</code>, then <code>close()</code> on the <code>CameraDevice</code>, then <code>close()</code> on the <code>ImageReader</code> (used for actual picture-taking). After the <code>close()</code> on <code>CameraDevice</code> is when a few occurrences of the aforementioned <code>BufferQueue has been abandoned</code> message appears in LogCat, though I only get the message on some Android 5.1 hardware (Nexus 4 and Nexus 7 2013) and not others (Nexus 5 and Nexus 6).</p>

<p>fadden's comment on this was:</p>

<blockquote>
  <p>If the consumer side is shut down before entering onPause(), the messages would be expected.</p>
</blockquote>

<p>When will <code>TextureView</code>'s ""consumer side"" will be shut down, and why then?</p>

<p>Google's sample code does not proactively do anything to shut down the <code>TextureView</code> that I can see. And, since the <code>TextureView</code> could still be visible when paused, I would have expected that the ""consumer side"" would not be affected at the time of <code>onPause()</code>, but perhaps later in <code>onStop()</code>.</p>

<p>While I realize that this message (despite being an error) is benign, I'm trying to figure out how to get rid of it, if for no other reason than to prevent my being asked time and again why code of mine is logging this error. I am hoping that by understanding more about this ""consumer side"", I can figure out how better to tidy things up when the user exits a Camera2-using activity or fragment and avoid this error.</p>
",115145,,-1,,2017-05-23 11:51:56,2015-05-19 20:22:42,"When Is a TextureView's ""Consumer Side"" Closed?",<android><android-camera><textureview>,2,2,4,
Android,33220233,1,33220286,,2015,,17,12352,"<p>I've just pasted this <a href=""https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/java/com/example/android/camera2basic/Camera2BasicFragment.java"">file</a> in a new project, but I'm getting:</p>

<blockquote>
  <p>Cannot resolve symbol FragmentCompat;</p>
</blockquote>

<p>any help?</p>
",248959,,,,,2018-04-27 14:04:32,Cannot resolve symbol FragmentCompat,<android>,2,0,4,
Android,45407964,1,45563152,,2017,,14,2331,"<p><strong>What I am trying?</strong></p>

<p>I am trying to take picture with drawable/paint on face but, i am not able to get both on same picture.</p>

<p><a href=""https://i.stack.imgur.com/2c3rI.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/2c3rI.png"" alt=""enter image description here""></a></p>

<p><strong>What I have tried?</strong></p>

<p>I have tried using <code>CameraSource.takePicture</code> but i am just getting face without any drawable/paint on it.</p>

<pre><code>mCameraSource.takePicture(shutterCallback, new CameraSource.PictureCallback() {
            @Override
            public void onPictureTaken(byte[] bytes) {
                try {
                    String mainpath = getExternalStorageDirectory() + separator + ""TestXyz"" + separator + ""images"" + separator;
                    File basePath = new File(mainpath);
                    if (!basePath.exists())
                        Log.d(""CAPTURE_BASE_PATH"", basePath.mkdirs() ? ""Success"": ""Failed"");
                    String path = mainpath + ""photo_"" + getPhotoTime() + "".jpg"";
                    File captureFile = new File(path);
                    captureFile.createNewFile();
                    if (!captureFile.exists())
                        Log.d(""CAPTURE_FILE_PATH"", captureFile.createNewFile() ? ""Success"": ""Failed"");
                    FileOutputStream stream = new FileOutputStream(captureFile);
                    stream.write(bytes);
                    stream.flush();
                    stream.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        });
</code></pre>

<p>I also tried using : </p>

<pre><code>mPreview.setDrawingCacheEnabled(true);
        Bitmap drawingCache = mPreview.getDrawingCache();
        try {
            String mainpath = getExternalStorageDirectory() + separator + ""TestXyz"" + separator + ""images"" + separator;
            File basePath = new File(mainpath);
            if (!basePath.exists())
                Log.d(""CAPTURE_BASE_PATH"", basePath.mkdirs() ? ""Success"": ""Failed"");
            String path = mainpath + ""photo_"" + getPhotoTime() + "".jpg"";
            File captureFile = new File(path);
            captureFile.createNewFile();
            if (!captureFile.exists())
                Log.d(""CAPTURE_FILE_PATH"", captureFile.createNewFile() ? ""Success"": ""Failed"");
            FileOutputStream stream = new FileOutputStream(captureFile);
            drawingCache.compress(Bitmap.CompressFormat.PNG, 100, stream);
            stream.flush();
            stream.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
</code></pre>

<p>in this case i am only getting what i draw on face. Here, mPreview is the <a href=""https://github.com/googlesamples/android-vision/blob/master/visionSamples/googly-eyes/app/src/main/java/com/google/android/gms/samples/vision/face/googlyeyes/ui/camera/CameraSourcePreview.java"" rel=""noreferrer"">CameraSourcePreview</a>. </p>

<p>Just added capture button and added above code in <a href=""https://github.com/googlesamples/android-vision/tree/master/visionSamples/googly-eyes"" rel=""noreferrer"">this</a> google example.</p>
",2024527,,7663565,,2017-08-04 4:04:36,2018-05-02 3:59:10,Take picture with drawable/paint on face using vision api,<android><google-vision><vision-api>,3,6,4,
Android,47727211,1,47930515,,2017,,20,9731,"<p>With the stabilization of Android Architecture Components I started updating all my basic <code>ViewModel</code>s to the new implementation of<a href=""https://developer.android.com/topic/libraries/architecture/viewmodel.html"" rel=""noreferrer""><code>ViewModel</code></a>. In my understanding, the usage of <a href=""https://developer.android.com/topic/libraries/architecture/livedata.html"" rel=""noreferrer""><code>LiveData</code></a> is recommended to hold the <code>Model</code> class since it handles the lifecycle better.</p>

<p>I like using <code>Data Binding</code> because it makes the code clearer in Java/Kotlin side and it is not needed to ""watch"" the value changes to update the UI. However the layout using <code>Data Binding</code> only watch data changes if the <code>Model</code> (or the ViewModel) extends <a href=""https://developer.android.com/reference/android/databinding/BaseObservable.html"" rel=""noreferrer""><code>BaseObservable</code></a> and <code>LiveData</code> does not. I understand the one of the main objectives of <code>LiveData</code> is to be observed and updates the UI programmatically but for simple updates, <code>Data Binding</code> is very useful.</p>

<p>This issue was already reported (<a href=""https://github.com/googlesamples/android-architecture-components/issues/34#issuecomment-305991529"" rel=""noreferrer"">GitHub</a> and <a href=""https://stackoverflow.com/questions/44077566/how-to-combine-architecture-components-with-data-binding-on-android#comment82259306_44178060"">Stack Overflow</a>) and first was said that the version 1.0 would have it and now is said that this feature is in development.</p>

<p>In order to use both <code>LiveData</code> and <code>Data Binding</code>, I created a very simple implementation of class that extends <code>BaseObservable</code>:</p>

<pre><code>import android.arch.lifecycle.LiveData
import android.arch.lifecycle.MutableLiveData
import android.databinding.BaseObservable

class ObservableMutableLiveData&lt;T&gt;() : BaseObservable() {

    private var data: MutableLiveData&lt;T&gt; = MutableLiveData()

    constructor(data: T) : this() {
        this.data.value = data
    }

    public fun set(value: T) {
        if (value != data.value) {
            data.value = value
            notifyChange()
        }
    }

    public fun get(): T? {
        return data.value
    }

    public fun getObservable(): LiveData&lt;T&gt; {
        return data
    }
}
</code></pre>

<p>So basically my <code>ObservableMutableLiveData</code> is a copy of <a href=""https://android.googlesource.com/platform/frameworks/data-binding/+/c9a5d6f140f732ca0ff279a4b1ee315072e1c422/library/src/main/java/android/databinding/ObservableField.java"" rel=""noreferrer""><code>ObservableField</code></a> using <code>LiveData</code> to store the model and with this implementation, the layout updates after every model update.</p>

<p>The questions are:</p>

<ul>
<li>Is this a bad implementation of <code>LiveData</code>? Does this wrapper ""breaks"" the functionalities of <code>LiveData</code>, such as be lifecycle-aware?</li>
<li>In my understanding, <code>LiveData</code> is the new <code>ObservableField</code>. Is this correct?</li>
</ul>
",6100078,,,,,2019-02-05 20:14:44,Using LiveData with Data Binding,<android><kotlin><android-databinding><android-architecture-components><android-mvvm>,3,0,4,
Android,30334319,1,,,2015,,16,9602,"<p>There is not enough info about camera2 face recognition mechanism. I used Camera2 sample from Google:
  <a href=""http://%20%20https://github.com/googlesamples/android-Camera2Basic"" rel=""noreferrer"">android-Camera2Basic</a></p>

<p>I set face recognition mode to FULL.</p>

<pre><code>mPreviewRequestBuilder.set(CaptureRequest.STATISTICS_FACE_DETECT_MODE,
                                    CameraMetadata.STATISTICS_FACE_DETECT_MODE_FULL);
</code></pre>

<p>Also I checked </p>

<p><code>STATISTICS_INFO_MAX_FACE_COUNT</code> and <code>STATISTICS_INFO_AVAILABLE_FACE_DETECT_MODES</code>:</p>

<pre><code>int max_count = characteristics.get(
CameraCharacteristics.STATISTICS_INFO_MAX_FACE_COUNT);
int modes [] = characteristics.get(
CameraCharacteristics.STATISTICS_INFO_AVAILABLE_FACE_DETECT_MODES);
</code></pre>

<p><strong>Output</strong>: <em>maxCount : 5 , modes : [0, 2]</em> </p>

<p>My CaptureCallback:</p>

<pre><code> private CameraCaptureSession.CaptureCallback mCaptureCallback
 = new CameraCaptureSession.CaptureCallback() {

    private void process(CaptureResult result) {
                Integer mode = result.get(CaptureResult.STATISTICS_FACE_DETECT_MODE);
                Face [] faces = result.get(CaptureResult.STATISTICS_FACES);
                if(faces != null &amp;&amp; mode != null)
                    Log.e(""tag"", ""faces : "" + faces.length + "" , mode : "" + mode ); 
    }

    @Override
    public void onCaptureProgressed(CameraCaptureSession session, CaptureRequest request,
                                    CaptureResult partialResult) {
        process(partialResult);
    }

    @Override
    public void onCaptureCompleted(CameraCaptureSession session, CaptureRequest request,
                                   TotalCaptureResult result) {
        process(result);
    }
</code></pre>

<p><strong>Output</strong>: <em>faces : 0 , mode : 2</em> </p>

<pre><code> public static final int STATISTICS_FACE_DETECT_MODE_FULL = 2;
</code></pre>

<p>Faces length is constantly 0. Looks like it doesn't recognise a face properly or I missed something.</p>

<p>I know approach with <a href=""https://developer.android.com/reference/android/media/FaceDetector.html"" rel=""noreferrer"">FaceDetector</a>. I just wanted to check how it works with new camera2 <a href=""https://developer.android.com/reference/android/hardware/camera2/params/Face.html"" rel=""noreferrer"">Face</a>.</p>
",1100525,,4501480,,2016-06-27 5:09:28,2018-12-29 13:01:05,Android camera2 face recognition,<android><android-camera><face-detection><face-recognition>,4,2,4,
Android,30106336,1,30107908,,2015,,2,1236,"<p>The <a href=""http://developer.android.com/reference/android/media/projection/package-summary.html"" rel=""nofollow noreferrer"">Media Projection</a> package is new Lollipop, and allows an app to capture the device's screen in realtime for streaming to video. I was hoping this could also be used to capture a single still screenshot, but so far I have not been successful. Of course, the first frame of a captured video could work, but I'm aiming for a perfect, lossless screenshot matching the pixel resolution of the device. A still from a captured video cannot provide that.</p>

<p>I've tried a lot of things, but the closest I came to a solution was to first launch an <a href=""https://stackoverflow.com/questions/2176922/how-to-create-transparent-activity-in-android/2700683#2700683"">invisible activity</a>. This activity then follows the <a href=""https://github.com/googlesamples/android-ScreenCapture"" rel=""nofollow noreferrer"">API example</a> for starting screen capture, which can include asking the user's permission. Once screen capture is enabled, the screen image is live in a SurfaceView. However, I cannot find a way to capture a bitmap from the SurfaceView. There are lots of <a href=""https://stackoverflow.com/questions/12724237/taking-screen-shot-of-a-surfaceview-in-android"">questions</a> and <a href=""https://stackoverflow.com/questions/25091703/how-to-create-and-save-a-screenshot-from-a-surfaceview"">discussions</a> about this, but no solutions seem to work, and there is some evidence that it is <a href=""https://groups.google.com/d/msg/android-platform/xHIActZZ9PA/Ur4E0BuEKvEJ"" rel=""nofollow noreferrer"">impossible</a>.</p>

<p>Any ideas?</p>
",369833,,-1,,2017-05-23 12:02:11,2015-05-07 17:28:19,How to capture a screenshot programmatically with Lollipop,<android><android-mediaprojection>,1,6,3,
Android,46435424,1,46452324,,2017,,3,1813,"<p>I'm trying to use dagger 2 on my Android application to inject the new ViewModel from arch android library. </p>

<p>From what I see on this sample <a href=""https://github.com/googlesamples/android-architecture-components/tree/e33782ba54ebe87f7e21e03542230695bc893818/GithubBrowserSample"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-architecture-components/tree/e33782ba54ebe87f7e21e03542230695bc893818/GithubBrowserSample</a> I need to use this: </p>

<pre><code>@MustBeDocumented
@Target(AnnotationTarget.FUNCTION, AnnotationTarget.CONSTRUCTOR, AnnotationTarget.PROPERTY_GETTER, AnnotationTarget.PROPERTY_SETTER)
@Retention(AnnotationRetention.RUNTIME)
@MapKey
internal annotation class ViewModelKey(val value: KClass&lt;out ViewModel&gt;)

@Module
abstract class ViewModelModule {
    @Binds
    @IntoMap
    @ViewModelKey(LoginViewModel::class)
    internal abstract fun bindLoginViewModel(viewModel: LoginViewModel): LoginViewModel

    @Binds
    @IntoMap
    @ViewModelKey(MainMenuViewModel::class)
    internal abstract fun bindSearchViewModel(viewModel: MainMenuViewModel): MainMenuViewModel

    @Binds
    internal abstract fun bindViewModelFactory(factory: ViewModelFactory): ViewModelProvider.Factory
}

@ApplicationScope
@Component(modules = arrayOf(ApplicationModule::class, NetworkModule::class, ViewModelModule::class))
interface ApplicationComponent {
    fun plusActivityComponent(activityModule: ActivityModule): ActivityComponent
    fun inject(application: LISAApplication)

}
</code></pre>

<p>And my factory is: </p>

<pre><code>@ApplicationScope
class ViewModelFactory @Inject constructor(private val creators: Map&lt;Class&lt;out ViewModel&gt;, @JvmSuppressWildcards Provider&lt;ViewModel&gt;&gt;) : ViewModelProvider.Factory {

    @Suppress(""UNCHECKED_CAST"")
    override fun &lt;T : ViewModel&gt; create(modelClass: Class&lt;T&gt;): T {
        var creator: Provider&lt;out ViewModel&gt;? = creators[modelClass]
        if (creator == null) {
            for ((key, value) in creators) {
                if (modelClass.isAssignableFrom(key)) {
                    creator = value
                    break
                }
            }
        }
        if (creator == null) {
            throw IllegalArgumentException(""unknown model class "" + modelClass)
        }
        try {
            return creator.get() as T
        } catch (e: Exception) {
            throw RuntimeException(e)
        }

    }
}
</code></pre>

<p>But the project doesn't compile :( I have this error (Map&lt;...> cannot be provided without an @Provides-annotated method.): </p>

<pre><code>Using Kotlin incremental compilation
:mobile:transformDataBindingWithDataBindingMergeArtifactsForDebug UP-TO-DATE
:mobile:kaptDebugKotlin
e: /Users/jaumard/LISAProjects/LISA/mobile/build/tmp/kapt3/stubs/debug/com/mylisabox/lisa/dagger/components/ApplicationComponent.java:6: error: [com.mylisabox.lisa.dagger.components.ActivityComponent.inject(com.mylisabox.lisa.common.BaseActivity)] java.util.Map&lt;java.lang.Class&lt;? extends android.arch.lifecycle.ViewModel&gt;,javax.inject.Provider&lt;android.arch.lifecycle.ViewModel&gt;&gt; cannot be provided without an @Provides-annotated method.
e: 

e: public abstract interface ApplicationComponent {
e:                 ^
e:       java.util.Map&lt;java.lang.Class&lt;? extends android.arch.lifecycle.ViewModel&gt;,javax.inject.Provider&lt;android.arch.lifecycle.ViewModel&gt;&gt; is injected at
e:           com.mylisabox.lisa.dagger.ViewModelFactory.&lt;init&gt;(creators)
e:       com.mylisabox.lisa.dagger.ViewModelFactory is injected at
e:           com.mylisabox.lisa.common.BaseActivity.factory
e:       com.mylisabox.lisa.common.BaseActivity is injected at
e:           com.mylisabox.lisa.dagger.components.ActivityComponent.inject(activity)
e: /Users/jaumard/LISAProjects/LISA/mobile/build/tmp/kapt3/stubs/debug/com/mylisabox/lisa/dagger/components/ActivityComponent.java:4: error: com.mylisabox.lisa.dagger.components.ActivityComponent scoped with @com.mylisabox.network.dagger.annotations.ActivityScope may not reference bindings with different scopes:
e: 
</code></pre>

<p>Any idea on how fix this ? </p>
",541867,,541867,,2017-09-28 8:29:55,2017-09-28 8:29:55,Kotlin dagger 2 Android ViewModel injection error,<android><kotlin><viewmodel><dagger-2><kotlin-interop>,1,4,3,
Android,49834875,1,,,2018,,4,2021,"<p>I am currently working on a project regarding neural networks.
For this, I want to build an Android Application which should use tensorflow [lite] to solve some object detection / recognition problems.</p>

<p>As I want the code to be as portable as possible, I want to write most of the code in C++, thus using the C++ API of tensorflow lite over the Java API / wrapper.
So, I modified tensorflow/contrib/lite/BUILD and added the following to be able to create a shared tensorflow library.</p>

<pre><code>cc_binary(
name = ""libtensorflowLite.so"",

linkopts=[""-shared"", ""-Wl""],
linkshared=1,

copts = tflite_copts(),
deps = [
    "":framework"",
    ""//tensorflow/contrib/lite/kernels:builtin_ops"",
],

)
</code></pre>

<p>(Which is based on the answer to this issue: <a href=""https://github.com/tensorflow/tensorflow/issues/17826"" rel=""nofollow noreferrer"">https://github.com/tensorflow/tensorflow/issues/17826</a>)</p>

<p>Then I used</p>

<pre><code>bazel build //tensorflow/contrib/lite:libtensorflowLite.so --crosstool_top=//external:android/crosstool --cpu=arm64-v8a --host_crosstool_top=@bazel_tools//tools/cpp:toolchain --cxxopt=""-std=c++11""
</code></pre>

<p>to finally build it.</p>

<p>Afterwards I headed over to Android Studio and set up a basic project.
For adding the shared library to the project, I refered to this example: </p>

<p><a href=""https://github.com/googlesamples/android-ndk/tree/840858984e1bb8a7fab37c1b7c571efbe7d6eb75/hello-libs"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-ndk/tree/840858984e1bb8a7fab37c1b7c571efbe7d6eb75/hello-libs</a></p>

<p>I also added the needed dependencies for flatbuffers.</p>

<p>The build / compilation process succeeds without any linker errors (well, at least after trying around for some hours..).</p>

<p>The APK is then successfully installed on an Android device, but immediately crashes after it starts. Logcat gives the following output:</p>

<pre><code>04-14 20:09:59.084 9623-9623/com.example.hellolibs E/AndroidRuntime: FATAL EXCEPTION: main
    Process: com.example.hellolibs, PID: 9623
    java.lang.UnsatisfiedLinkError: dlopen failed: library ""/home/User/tensorflowtest/app/src/main/cpp/../../../../distribution/tensorflow/lib/x86/libtensorflowLite.so"" not found
        at java.lang.Runtime.loadLibrary0(Runtime.java:1016)
        at java.lang.System.loadLibrary(System.java:1657)
        at com.example.hellolibs.MainActivity.&lt;clinit&gt;(MainActivity.java:36)
        at java.lang.Class.newInstance(Native Method)
        at android.app.Instrumentation.newActivity(Instrumentation.java:1174)
        at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2669)
        at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2856)
        at android.app.ActivityThread.-wrap11(Unknown Source:0)
        at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1589)
        at android.os.Handler.dispatchMessage(Handler.java:106)
        at android.os.Looper.loop(Looper.java:164)
        at android.app.ActivityThread.main(ActivityThread.java:6494)
        at java.lang.reflect.Method.invoke(Native Method)
        at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:438)
        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:807)
</code></pre>

<p>I tried this on an android x86 emulator and on a real arm64-v8a android smartphone.</p>

<p>So for me this looks like on startup the application tries to load the tensorflowLite shared library, but is unable to find it. 
Opening the apk with a zip archive manager I can verify that the platform (arm, x86) dependent .so files are packed into the APK as expected (by adding the following to build.gradle: </p>

<pre><code>sourceSets {
        main {
            // let gradle pack the shared library into apk
            jniLibs.srcDirs = ['../distribution/tensorflow/lib']
        }
})
</code></pre>

<p>What I do not understand is why it looks for the library in the path where I placed it on my Ubuntu 17.10 PC.
So, I thought I had done a mistake trying to adapt the example about adding external libraries to an Android Studio Project I mentioned earlier.
That's why I downloaded the whole project and opened it in Android Studio and verified that the example works as expected. Afterwards I replaced the example libgperf.so by the libtensorflowLite.so and left everything else, especially the CMakeLists.txt, untouched.
But I get the exact same error again, therefore I suspect this to be a problem with the libtensorflowLite library itself and not the android project (although that's just my guess).</p>

<p>I am working on android studio 3.1.1, NDK Version 14 and API Level 24 (Android 7.0).
If anyone has an idea what could be wrong, any help would be highly appreciated.
I am also open for any other methods which allow me to use tensorflow lite with C++ for an android application.</p>

<p>Thanks a lot,</p>

<p>Martin</p>
",9646450,,,,,2019-03-06 21:24:56,Problems with using tensorflow lite C++ API in Android Studio Project,<android><c++><tensorflow><android-ndk><android-studio-3.0>,1,0,3,
Android,53129932,1,53275304,,2018,,4,618,"<p>I want to get realtime frames from video. like camera is open and I am getting frames per seconds.</p>

<p>I have also gone through google example of video capturing app via camera2 API <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-Camera2Video</a>
, But couldn't find any such method/way.</p>

<p>I know this is possible as video broadcasters and apps like snapchat who does realtime video processing must be doing something like this.</p>

<p>Also I require 30 frames/seconds.</p>
",1404257,,,,,2018-11-13 6:48:14,How to capture frame by frame images from Android video recording in real time,<java><android><kotlin><video-processing><video-capture>,1,5,3,
Android,45593065,1,,,2017,,4,1374,"<p>I'm working on a call recorder app using MediaRecorder <strong>VOICE_CALL</strong> audio source, In some marshmallow devices it's crashing, then I changed source to <strong>MIC</strong> here incoming voice is not getting recorded. Due to this java limitation now I'm working on native android code to record voice call.
I'm managed to record the audio using <a href=""https://github.com/googlesamples/android-ndk/tree/master/native-audio"" rel=""nofollow noreferrer"">native-audio</a> recorder for call recorder. Problem is in native code also it's recording one side voice only,incoming voice is not getting recorded. Then I tried the <strong>voice communication</strong> preset configuration, its not recording. Below is the preset configuration code.</p>

<pre><code>const SLInterfaceID id[2] = { SL_IID_ANDROIDSIMPLEBUFFERQUEUE,SL_IID_ANDROIDCONFIGURATION};
const SLboolean req[2] = { SL_BOOLEAN_TRUE,SL_BOOLEAN_TRUE};

result = (*engineEngine)-&gt;CreateAudioRecorder(engineEngine, &amp;recorderObject, &amp;audioSrc,
                                              &amp;audioSnk, 2, id, req);

SLAndroidConfigurationItf inputConfig;
result = (*recorderObject)-&gt;GetInterface(recorderObject,
                                         SL_IID_ANDROIDCONFIGURATION,
                                         &amp;inputConfig);


if (SL_RESULT_SUCCESS == result) {
    SLuint32 presetValue =SL_ANDROID_RECORDING_PRESET_VOICE_COMMUNICATION ;
    (*inputConfig)-&gt;SetConfiguration(inputConfig,
                                     SL_ANDROID_KEY_RECORDING_PRESET,
                                     &amp;presetValue,
                                     sizeof(SLuint32));
    __android_log_print(ANDROID_LOG_DEBUG, ""LOG_TAG"", ""\n Native PCM Conf Success\n"");

} else{
    __android_log_print(ANDROID_LOG_DEBUG, ""LOG_TAG"", ""\n Native PCM Conf Error %d\n"",result);

}
</code></pre>

<p><strong>After adding preset configuration I'm getting system error when start recording the voice call :</strong> </p>

<blockquote>
  <p>E/AudioRecord: Could not get audio input for record source 7, sample
  rate 16000, format 0x1, channel mask 0x10, session 925, flags 0 </p>
  
  <p>E/libOpenSLES: android_audioRecorder_realize(0x559548c350) error
  creating AudioRecord object; status -22 </p>
  
  <p>W/libOpenSLES: Leaving Object::Realize (SL_RESULT_CONTENT_UNSUPPORTED)</p>
</blockquote>
",4491620,,5458344,,2018-07-17 15:20:51,2018-07-17 15:20:51,How to configure OpenSL to record voice call,<android><audio><android-ndk><opensl>,1,8,3,
Android,45358247,1,45420167,,2017,,5,664,"<p>I am writing an app which records video from the phone and uploads it to a server. Works fine on any device except Galaxy S7. On the Galaxy S7 recording produces a video file with audio only and either no video or one video frame. This is true in the temporary file created on the phone and not just the one uploaded to the server.
I am using the Camera2 API, and I have tried with the front and back cameras.</p>

<p>I have tried with my code, and these two example applications:
<a href=""https://developer.android.com/samples/Camera2Video/project.html"" rel=""noreferrer"">https://developer.android.com/samples/Camera2Video/project.html</a>
<a href=""https://github.com/googlesamples/android-Camera2Video/blob/master/Application/src/main/java/com/example/android/camera2video/Camera2VideoFragment.java"" rel=""noreferrer"">https://github.com/googlesamples/android-Camera2Video/blob/master/Application/src/main/java/com/example/android/camera2video/Camera2VideoFragment.java</a></p>

<p>The video file produced appears to be ok, here is the codec info:
Stream 0
Type: Video
Codec: H264 - MPEG-4 AVC (part 10) (avc1)
Language: English
Resolution: 960x720
Display resolution: 960x720
Frame rate: 29.055091</p>

<p>Stream 1
Type: Audio
Codec: MPEG AAC Audio (mp4a)
Language: English
Channels: Stereo
Sample rate: 16000 Hz</p>
",3561494,,,,,2017-08-06 16:14:37,Android camera2 api galaxy s7,<java><android><video><android-camera2>,1,1,3,
Android,50615225,1,52530498,,2018,,5,1315,"<p>Which is the best way to update a single element when using the new paging library?</p>

<p>Let's say we have the <a href=""https://github.com/googlesamples/android-architecture-components/tree/master/PagingWithNetworkSample"" rel=""noreferrer"">Paging with network</a> google sample using the <code>PageKeyedSubredditDataSource</code>. Imagine we want to make a change of a single element of <code>RedditPost</code>. So, we want to check if it is in the list and if so, update it. The update should not be as easy as calling invalidate() which will make a call to the first page (maybe the RedditPost is in the 5th page. We don't want to update all elements, just one).</p>
",5125212,,,,,2018-09-27 6:11:41,Best way to update a single element using Paging Library,<android><android-architecture-components><android-paging><android-livedata>,1,8,3,
Android,46666474,1,,,2017,,7,1804,"<p>I am currently working on an exiting Android application in order to create an Instant apps version.</p>

<p>My Android Studio is now split into several modules :</p>

<ul>
<li>the business object module (which is a library)</li>
<li>the base -feature- module</li>
<li>the moduleA -feature- module</li>
<li>the app module (which is a phone/tablet module)</li>
<li>the instant module (which is an instant apps module)</li>
</ul>

<p>My instant app module can be compiled and launched on a phone/tablet but each time it crashes due to Firebase issues. I have the following message into the logcat :</p>

<blockquote>
  <p>I/FirebaseInitProvider: FirebaseApp initialization unsuccessful</p>
</blockquote>

<p>According to the <a href=""https://developer.android.com/topic/instant-apps/guides/analytics.html"" rel=""noreferrer"">documentation</a> the Firebase library is compatible with Instant Apps, but I am pretty sure that I do not move the google-services.json file into the right place in my project...</p>

<p>Here what I have done :</p>

<ol>
<li><p>I defined the following classpath dependencies into the build.gradle file of the Android Studio project : classpath 'com.google.gms:google-services:3.1.1'</p></li>
<li><p>I put the google-services.json file into my module base (because the documentation asks for it)</p></li>
</ol>

<p>Now, if I try to apply the plugin (apply plugin: 'com.google.gms.google-services') into the build.gradle file of the base module, I cannot compile. I have the following message :</p>

<blockquote>
  <p>Error:Execution failed for task ':base:processGooglePlayProductionDebugFeatureGoogleServices'.</p>
  
  <p>> No matching client found for package name 'com.mycompany.myapp.base'</p>
</blockquote>

<p>In fact, the package name defined into the google-services.json file is the one use by the app (because according to the <a href=""https://codelabs.developers.google.com/codelabs/android-instant-apps/#4"" rel=""noreferrer"">documentation</a> the base library cannot have the same package name as the installed android app.</p>

<p>I also tried to apply the plugin into the build.gradle files of the installed app and into the instant apps module leaving the google-services.json file into the base module. The app compile but I have the log : ""FirebaseApp initialization unsuccessful"".</p>

<p>So I tried moving the google-services.json file into my instant app module but I still have the log : ""FirebaseApp initialization unsuccessful""</p>

<p>I also tried to force the initialization calling the static method initializeApp from the FirebaseApp class but the log persists.</p>

<p>I cannot find an example of implementation on the web. In fact, the <a href=""https://github.com/googlesamples/android-instant-apps"" rel=""noreferrer"">Google Sample repository</a> does not use a google-services.json file.</p>

<p>Thank you in advance for your help !</p>

<p><strong>Edit :</strong> Here the dependencies of my modules :</p>

<p>The dependencies of my base -feature- module :</p>

<pre><code>  implementation project(':businessobject')
  feature project(':moduleA')
  application project(':app')
</code></pre>

<p>The dependencies of my moduleA -feature- module :</p>

<pre><code>api project(':base')
api project(':businessobject')
</code></pre>

<p>The dependencies of my app module (which is a phone/tablet module) :</p>

<pre><code>implementation (project(':base'))
implementation (project(':businessobject'))
implementation (project(':moduleA'))
</code></pre>

<p>The dependencies of my instant module (which is an instant apps module) :</p>

<pre><code>implementation project(':base')
implementation project(':businessobject')
implementation project(':moduleA')
</code></pre>
",2762990,,2762990,,2017-10-10 15:38:26,2018-02-22 7:35:40,FirebaseApp initialization unsuccessful in Android Instant apps,<android><firebase><android-instant-apps><google-play-services>,1,3,3,
Android,35709241,1,35728962,,2016,,7,6500,"<p>I do not have a background in imaging or graphics, so please bear with me :)</p>

<p>I am using <a href=""https://github.com/bytedeco/javacv"" rel=""nofollow noreferrer"">JavaCV</a> in one of my projects. In the <a href=""https://github.com/bytedeco/javacv/blob/master/samples/RecordActivity.java"" rel=""nofollow noreferrer"">examples</a>, a <code>Frame</code> is constructed which has a buffer of a <a href=""https://github.com/bytedeco/javacv/blob/master/src/main/java/org/bytedeco/javacv/Frame.java#L108"" rel=""nofollow noreferrer"">certain size</a>. </p>

<p>When using the <code>public void onPreviewFrame(byte[] data, Camera camera)</code> function in Android, copying this <code>data</code> byte array is no problem if you declare the <code>Frame</code> as <code>new Frame(frameWidth, frameHeight, Frame.DEPTH_UBYTE, 2);</code> where <code>frameWidth</code> and <code>frameHeight</code> are declared as </p>

<pre><code>Camera.Size previewSize = cameraParam.getPreviewSize();
int frameWidth = previewSize.width;
int frameHeight = previewSize.height;
</code></pre>

<p>Recently, Android added a method to capture your screen. Naturally, I wanted to grab those images and also covert them to <code>Frame</code>s. I modified <a href=""https://github.com/googlesamples/android-ScreenCapture"" rel=""nofollow noreferrer"">the example code from Google</a> to use the <a href=""https://developer.android.com/reference/android/media/ImageReader.html"" rel=""nofollow noreferrer"">ImageReader</a>. </p>

<p>This <code>ImageReader</code> is constructed as <code>ImageReader.newInstance(DISPLAY_WIDTH, DISPLAY_HEIGHT, PixelFormat.RGBA_8888, 2);</code>. So currently it uses the RGBA_8888 pixel format. I use the following code to copy the bytes to the <code>Frame</code>, which is instantiated as <code>new Frame(DISPLAY_WIDTH, DISPLAY_HEIGHT, Frame.DEPTH_UBYTE, 2);</code>:</p>

<pre><code>ByteBuffer buffer = mImage.getPlanes()[0].getBuffer();
byte[] bytes = new byte[buffer.remaining()];
buffer.get(bytes);
mImage.close();
((ByteBuffer) frame.image[0].position(0)).put(bytes);
</code></pre>

<p>But this gives me a <code>java.nio.BufferOverflowException</code>. I printed the sizes of both buffers and the Frame's buffer size is 691200 whereas the <code>bytes</code> array above is of size <code>1413056</code>. Figuring out how this latter number is constructed failed because <a href=""https://android.googlesource.com/platform/frameworks/base.git/+/master/media/java/android/media/ImageReader.java#847"" rel=""nofollow noreferrer"">I ran into this native call</a>. So clearly, this won't work out.</p>

<p>After quite a bit of digging I found out that the <a href=""http://developer.android.com/reference/android/graphics/ImageFormat.html#NV21"" rel=""nofollow noreferrer"">NV21 image format</a> is ""the default format for Camera preview images, when not otherwise set with setPreviewFormat(int)"", but the <a href=""http://developer.android.com/reference/android/media/ImageReader.html#newInstance%28int,%20int,%20int,%20int%29"" rel=""nofollow noreferrer"">ImageReader class does not support the NV21 format</a> (see the format parameter). So that's tough luck. In the documentation it also reads that 
""For the android.hardware.camera2 API, the YUV_420_888 format is recommended for YUV output instead.""</p>

<p>So I tried creating an ImageReader like this <code>ImageReader.newInstance(DISPLAY_WIDTH, DISPLAY_HEIGHT, ImageFormat.YUV_420_888, 2);</code>, but this gives me <code>java.lang.UnsupportedOperationException: The producer output buffer format 0x1 doesn't match the ImageReader's configured buffer format 0x23.</code> so that won't work either.</p>

<p>As a last resort, I tried to convert RGBA_8888 to YUV myself using e.g. <a href=""https://stackoverflow.com/questions/5960247/convert-bitmap-array-to-yuv-ycbcr-nv21"">this post</a>, but I fail to understand how I can obtain an <code>int[] rgba</code> as per the answer.</p>

<p>So, TL;DR <strong>how can I obtain  NV21 image data like you get in Android's <code>public void onPreviewFrame(byte[] data, Camera camera)</code> camera function to instantiate my <code>Frame</code> and work with it using Android's ImageReader (and Media Projection)?</strong> </p>

<h2>Edit (25-10-2016)</h2>

<p>I have created the following conversion runnable to go from RGBA to NV21 format:</p>

<pre><code>private class updateImage implements Runnable {

    private final Image mImage;

    public updateImage(Image image) {
        mImage = image;
    }

    @Override
    public void run() {

        int mWidth = mImage.getWidth();
        int mHeight = mImage.getHeight();

        // Four bytes per pixel: width * height * 4.
        byte[] rgbaBytes = new byte[mWidth * mHeight * 4];
        // put the data into the rgbaBytes array.
        mImage.getPlanes()[0].getBuffer().get(rgbaBytes);

        mImage.close(); // Access to the image is no longer needed, release it.

        // Create a yuv byte array: width * height * 1.5 ().
        byte[] yuv = new byte[mWidth * mHeight * 3 / 2];
        RGBtoNV21(yuv, rgbaBytes, mWidth, mHeight);
        ((ByteBuffer) yuvImage.image[0].position(0)).put(yuv);
    }

    void RGBtoNV21(byte[] yuv420sp, byte[] argb, int width, int height) {
        final int frameSize = width * height;

        int yIndex = 0;
        int uvIndex = frameSize;

        int A, R, G, B, Y, U, V;
        int index = 0;
        int rgbIndex = 0;

        for (int i = 0; i &lt; height; i++) {
            for (int j = 0; j &lt; width; j++) {

                R = argb[rgbIndex++];
                G = argb[rgbIndex++];
                B = argb[rgbIndex++];
                A = argb[rgbIndex++]; // Ignored right now.

                // RGB to YUV conversion according to
                // https://en.wikipedia.org/wiki/YUV#Y.E2.80.B2UV444_to_RGB888_conversion
                Y = ((66 * R + 129 * G + 25 * B + 128) &gt;&gt; 8) + 16;
                U = ((-38 * R - 74 * G + 112 * B + 128) &gt;&gt; 8) + 128;
                V = ((112 * R - 94 * G - 18 * B + 128) &gt;&gt; 8) + 128;

                // NV21 has a plane of Y and interleaved planes of VU each sampled by a factor
                // of 2 meaning for every 4 Y pixels there are 1 V and 1 U.
                // Note the sampling is every other pixel AND every other scanline.
                yuv420sp[yIndex++] = (byte) ((Y &lt; 0) ? 0 : ((Y &gt; 255) ? 255 : Y));
                if (i % 2 == 0 &amp;&amp; index % 2 == 0) {
                    yuv420sp[uvIndex++] = (byte) ((V &lt; 0) ? 0 : ((V &gt; 255) ? 255 : V));
                    yuv420sp[uvIndex++] = (byte) ((U &lt; 0) ? 0 : ((U &gt; 255) ? 255 : U));
                }
                index++;
            }
        }
    }
}
</code></pre>

<p>The <code>yuvImage</code> object is initialized as <code>yuvImage = new Frame(DISPLAY_WIDTH, DISPLAY_HEIGHT, Frame.DEPTH_UBYTE, 2);</code>, the <code>DISPLAY_WIDTH</code> and <code>DISPLAY_HEIGHT</code> are just two integers specifying the display size. 
This is the code where a background handler handles the onImageReady:</p>

<pre><code>private final ImageReader.OnImageAvailableListener mOnImageAvailableListener
            = new ImageReader.OnImageAvailableListener() {

        @Override
        public void onImageAvailable(ImageReader reader) {
            mBackgroundHandler.post(new updateImage(reader.acquireNextImage()));
        }

    };

...

mImageReader = ImageReader.newInstance(DISPLAY_WIDTH, DISPLAY_HEIGHT, PixelFormat.RGBA_8888, 2);
mImageReader.setOnImageAvailableListener(mOnImageAvailableListener, mBackgroundHandler);
</code></pre>

<p>The methods work and I at least don't get any errors, but the output image is malformed. What is going wrong in my conversion? An example image that is being created:</p>

<p><img src=""https://gyazo.com/5095490f2f461b2d6334da1c68c611e4.png"" alt=""example of malformed image""></p>

<h2>Edit (15-11-2016)</h2>

<p>I have modified the <code>RGBtoNV21</code> function to be the following:</p>

<pre><code>void RGBtoNV21(byte[] yuv420sp, int width, int height) {
    try {
        final int frameSize = width * height;

        int yIndex = 0;
        int uvIndex = frameSize;
        int pixelStride = mImage.getPlanes()[0].getPixelStride();
        int rowStride = mImage.getPlanes()[0].getRowStride();
        int rowPadding = rowStride - pixelStride * width;
        ByteBuffer buffer = mImage.getPlanes()[0].getBuffer();

        Bitmap bitmap = Bitmap.createBitmap(getResources().getDisplayMetrics(), width, height, Bitmap.Config.ARGB_8888);

        int A, R, G, B, Y, U, V;
        int offset = 0;

        for (int i = 0; i &lt; height; i++) {
            for (int j = 0; j &lt; width; j++) {

                // Useful link: https://stackoverflow.com/questions/26673127/android-imagereader-acquirelatestimage-returns-invalid-jpg

                R = (buffer.get(offset) &amp; 0xff) &lt;&lt; 16;     // R
                G = (buffer.get(offset + 1) &amp; 0xff) &lt;&lt; 8;  // G
                B = (buffer.get(offset + 2) &amp; 0xff);       // B
                A = (buffer.get(offset + 3) &amp; 0xff) &lt;&lt; 24; // A
                offset += pixelStride;

                int pixel = 0;
                pixel |= R;     // R
                pixel |= G;  // G
                pixel |= B;       // B
                pixel |= A; // A
                bitmap.setPixel(j, i, pixel);

                // RGB to YUV conversion according to
                // https://en.wikipedia.org/wiki/YUV#Y.E2.80.B2UV444_to_RGB888_conversion
//                        Y = ((66 * R + 129 * G + 25 * B + 128) &gt;&gt; 8) + 16;
//                        U = ((-38 * R - 74 * G + 112 * B + 128) &gt;&gt; 8) + 128;
//                        V = ((112 * R - 94 * G - 18 * B + 128) &gt;&gt; 8) + 128;

                Y = (int) Math.round(R *  .299000 + G *  .587000 + B *  .114000);
                U = (int) Math.round(R * -.168736 + G * -.331264 + B *  .500000 + 128);
                V = (int) Math.round(R *  .500000 + G * -.418688 + B * -.081312 + 128);

                // NV21 has a plane of Y and interleaved planes of VU each sampled by a factor
                // of 2 meaning for every 4 Y pixels there are 1 V and 1 U.
                // Note the sampling is every other pixel AND every other scanline.
                yuv420sp[yIndex++] = (byte) ((Y &lt; 0) ? 0 : ((Y &gt; 255) ? 255 : Y));
                if (i % 2 == 0 &amp;&amp; j % 2 == 0) {
                    yuv420sp[uvIndex++] = (byte) ((V &lt; 0) ? 0 : ((V &gt; 255) ? 255 : V));
                    yuv420sp[uvIndex++] = (byte) ((U &lt; 0) ? 0 : ((U &gt; 255) ? 255 : U));
                }
            }
            offset += rowPadding;
        }

        File file = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES).getAbsolutePath(), ""/Awesomebitmap.png"");
        FileOutputStream fos = new FileOutputStream(file);
        bitmap.compress(Bitmap.CompressFormat.PNG, 100, fos);
    } catch (Exception e) {
        Timber.e(e, ""Converting image to NV21 went wrong."");
    }
}
</code></pre>

<p>Now the image is no longer malformed, but the chroma is off. </p>

<p><img src=""https://gyazo.com/0d9947a036c0924f4e09d55ea730e4b8.png"" alt=""Wrong color chroma""></p>

<p>The right side is the bitmap that is being created in that loop, the left side is the NV21 saved to an image. So the RGB pixels are processed correctly. Clearly the chroma is off, but the RGB to YUV conversion should be the same one as depicted by wikipedia. What could be wrong here?</p>
",1360853,,-1,,2017-05-23 12:10:04,2016-11-15 14:48:17,Android ImageReader get NV21 format?,<android><image><imaging><android-mediaprojection>,1,4,3,
Android,43159280,1,,,2017,,10,2007,"<p>I am using mobile vision API for scanning barcode. I am using <code>TextureView</code> to render camera on it. I read this github thread <a href=""https://github.com/googlesamples/android-vision/issues/15"" rel=""noreferrer"">https://github.com/googlesamples/android-vision/issues/15</a> it seems mobile vision is not compatible with <code>TextureView</code></p>

<p>I see that <code>CameraSource</code> is for <code>SurfaceView</code> which is not compatible with <code>TextureView</code>, as there is no method to preview frames on <code>TextureView</code>. <a href=""https://developers.google.com/android/reference/com/google/android/gms/vision/CameraSource.html#start(android.view.SurfaceHolder)"" rel=""noreferrer"">https://developers.google.com/android/reference/com/google/android/gms/vision/CameraSource.html#start(android.view.SurfaceHolder)</a></p>

<p>I tried to do using below approach and checked that <code>receiveDetections</code> is not being called. Does anyone have any idea how can I integrate mobile vision API with <code>TextureView</code> and <code>Camera</code>.</p>

<h2>MainActivity.java</h2>

<pre><code>@RuntimePermissions
public class ScanBarcodeActivity extends BaseActivity {

    private TextureView textureView;

    private BarcodeDetector barcodeDetector;

    private Camera camera;

    private String TAG = LogUtils.makeLogTag(ScanBarcodeActivity.class);

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        ActivityScanBarcodeBinding activityScanBarcodeBinding = setContentView(this, R.layout.activity_scan_barcode);

        textureView = activityScanBarcodeBinding.textureView;

        barcodeDetector = new BarcodeDetector.Builder(this).build();

        ScanBarcodeActivityPermissionsDispatcher.requestCameraPermissionWithCheck(this);

    }

    @Override
    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {
        super.onRequestPermissionsResult(requestCode, permissions, grantResults);
        // NOTE: delegate the permission handling to generated method
        ScanBarcodeActivityPermissionsDispatcher.onRequestPermissionsResult(this, requestCode, grantResults);

        if(permissions[0].equals(Manifest.permission.CAMERA)) {
            if(grantResults[0] == PackageManager.PERMISSION_GRANTED) {
                initializeCamera();            }
        }
    }

    @NeedsPermission(Manifest.permission.CAMERA)
    void requestCameraPermission() {
        initializeCamera();
    }

    void initializeCamera() {
        textureView.setSurfaceTextureListener(new TextureView.SurfaceTextureListener() {
            @Override
            public void onSurfaceTextureAvailable(SurfaceTexture surface, int width, int height) {
                camera = Camera.open();

                /* Set Auto focus */
                Camera.Parameters parameters = camera.getParameters();
                List&lt;String&gt; focusModes = parameters.getSupportedFocusModes();
                if(focusModes.contains(Camera.Parameters.FOCUS_MODE_CONTINUOUS_PICTURE)){
                    parameters.setFocusMode(Camera.Parameters.FOCUS_MODE_CONTINUOUS_PICTURE);
                } else
                if(focusModes.contains(Camera.Parameters.FOCUS_MODE_AUTO)){
                    parameters.setFocusMode(Camera.Parameters.FOCUS_MODE_AUTO);
                }

                camera.setParameters(parameters);

                try {
                    camera.setPreviewTexture(surface);
                } catch (IOException io) {
                    LogUtils.LOGD(TAG, io.getMessage());
                }
                camera.startPreview();
            }

            @Override
            public void onSurfaceTextureSizeChanged(SurfaceTexture surface, int width, int height) {

            }

            @Override
            public boolean onSurfaceTextureDestroyed(SurfaceTexture surface) {
                try {
                    camera.stopPreview();
                    camera.release();
                } catch (Exception e) {
                    LogUtils.LOGD(TAG, e.getMessage());
                }
                return true;
            }

            @Override
            public void onSurfaceTextureUpdated(SurfaceTexture surface) {

            }
        });

        barcodeDetector.setProcessor(new Detector.Processor&lt;Barcode&gt;() {
            @Override
            public void release() {

            }

            @Override
            public void receiveDetections(Detector.Detections&lt;Barcode&gt; detections) {
                final SparseArray&lt;Barcode&gt; barcodes = detections.getDetectedItems();

                if (barcodes.size() != 0) {
                    LogUtils.LOGD(TAG, barcodes.valueAt(0).displayValue);
                }
            }
        });

    }

    @OnShowRationale(Manifest.permission.CAMERA)
    void showRationaleForCamera(final PermissionRequest request) {
        new AlertDialog.Builder(this)
                .setMessage(R.string.permission_camera_rationale)
                .setPositiveButton(R.string.button_allow, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        request.proceed();
                    }
                })
                .setNegativeButton(R.string.button_deny, new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        request.cancel();
                    }
                })
                .show();
    }

    @OnPermissionDenied(Manifest.permission.CAMERA)
    void showPermissionDeniedForCamera() {
        Toast.makeText(this, R.string.permission_camera_denied, Toast.LENGTH_SHORT).show();
    }

    @OnNeverAskAgain(Manifest.permission.CAMERA)
    void showNeverAskAgainForCamera() {
        Toast.makeText(this, R.string.permission_camera_never_ask_again, Toast.LENGTH_SHORT).show();
    }

}
</code></pre>
",2455259,,2455259,,2017-04-01 16:56:57,2017-04-11 21:53:45,How to use mobile vision API with TextureView and Camera,<android><android-vision><google-vision><android-textureview>,1,0,3,
Android,50177783,1,,,2018,,10,928,"<p>What backwards compatibility does</p>

<pre><code>NotificationManagerCompat notificationManager = NotificationManagerCompat.from(this);
</code></pre>

<p>provide that I don't get from the normal</p>

<pre><code> NotificationManager notificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
</code></pre>

<p>They both have a <code>notify</code> method that worked on my tested devices (down to API level 19).</p>

<p>The Google sample here doesn't even use the <code>Compat</code> version once:</p>

<p><a href=""https://github.com/googlesamples/android-NotificationChannels/blob/master/Application/src/main/java/com/example/android/notificationchannels/NotificationHelper.java"" rel=""noreferrer"">https://github.com/googlesamples/android-NotificationChannels/blob/master/Application/src/main/java/com/example/android/notificationchannels/NotificationHelper.java</a></p>
",8281994,,,,,2018-11-02 19:37:42,NotificationManagerCompat vs NotificationManager,<android><push-notification><notifications><android-notifications>,1,0,3,
Android,45531230,1,45645939,,2017,,19,1797,"<p>I'm currently checking out the following guide: <a href=""https://developer.android.com/topic/libraries/architecture/guide.html"" rel=""noreferrer"">https://developer.android.com/topic/libraries/architecture/guide.html</a></p>

<p>The networkBoundResource class: </p>

<pre><code>// ResultType: Type for the Resource data
// RequestType: Type for the API response
public abstract class NetworkBoundResource&lt;ResultType, RequestType&gt; {
    // Called to save the result of the API response into the database
    @WorkerThread
    protected abstract void saveCallResult(@NonNull RequestType item);

    // Called with the data in the database to decide whether it should be
    // fetched from the network.
    @MainThread
    protected abstract boolean shouldFetch(@Nullable ResultType data);

    // Called to get the cached data from the database
    @NonNull @MainThread
    protected abstract LiveData&lt;ResultType&gt; loadFromDb();

    // Called to create the API call.
    @NonNull @MainThread
    protected abstract LiveData&lt;ApiResponse&lt;RequestType&gt;&gt; createCall();

    // Called when the fetch fails. The child class may want to reset components
    // like rate limiter.
    @MainThread
    protected void onFetchFailed() {
    }

    // returns a LiveData that represents the resource
    public final LiveData&lt;Resource&lt;ResultType&gt;&gt; getAsLiveData() {
        return result;
    }
}
</code></pre>

<p>I'm a bit confused here about the use of threads.<br>
Why is @MainThread applied here for networkIO?<br>
Also, for saving into the db, @WorkerThread is applied, whereas @MainThread for retrieving results.  </p>

<p>Is it bad practise to use a worker thread by default for NetworkIO and local db interaction?  </p>

<p>I'm also checking out the following demo (GithubBrowserSample): <a href=""https://github.com/googlesamples/android-architecture-components"" rel=""noreferrer"">https://github.com/googlesamples/android-architecture-components</a><br>
This confuses me from a threading point of view.<br>
The demo uses executors framework, and defines a fixed pool with 3 threads for networkIO, however in the demo only a worker task is defined for one call, i.e. the <code>FetchNextSearchPageTask</code>. All other network requests seem to be executed on the main thread. </p>

<p>Can someone clarify the rationale? </p>
",917467,,,,,2017-08-12 2:26:17,Android Architecture Components network threads,<java><android><multithreading><architecture>,1,0,3,
Android,33371331,1,33450716,,2015,,5,6020,"<p>I have tried new Google Play Services feature - Barcode/QR scanner. In <a href=""https://github.com/googlesamples/android-vision"" rel=""noreferrer"">sample</a> application is scanning started by taping on button and result is returned also on tap.</p>

<p>Is there a way to change its behavior to return first detected barcode/QR immediately?</p>

<p>I am not the first one curious about <a href=""https://github.com/googlesamples/android-vision/issues/37"" rel=""noreferrer"">this</a>.</p>

<p>Thank you in advance.</p>
",1317571,,,,,2017-11-21 10:01:03,How to get detected barcode/QR automatically,<android><android-vision>,2,0,3,
Android,41828237,1,,,2017,,5,929,"<p>I got an error and I'm going mad because happen only in some circumstances but I really don't understand when, maybe a more expert eye can help me:</p>

<p>From the Google tutorials I took the code for make an in-app purchase, <strong>briefly this code do</strong>: </p>

<ol>
<li><code>Initialize the In-App Service</code></li>
<li><code>Retrieve the price</code> of the object</li>
<li><code>Start the in-purchase</code> if the user click the button ""Buy"".</li>
</ol>

<p>Now, in all the tests that I did this work fine (more devices and API) <strong>BUT</strong> I got ton of reports that say: thrown a <code>NullPointerException</code> on <code>mHelper</code>. </p>

<p>I think that this happen in on the OnDestroy() when the service is disposed but i'm not sure and I couldn't fix it(Complete Error Log in the end).</p>

<p><strong>Here is my cleaned and commented as much as possible code:</strong></p>

<pre><code>IabHelper mHelper;
IabHelper.OnIabPurchaseFinishedListener mPurchaseFinishedListener;
Activity c;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_show_room);
    getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
    c=this;

    //Initialize the In-App Service
    mHelper = new IabHelper(this, ""my_key"");
    mHelper.startSetup(new IabHelper.OnIabSetupFinishedListener() {
            public void onIabSetupFinished(IabResult result) {
                if (!result.isSuccess()) {
                        //Problem setting up In-app Billing
                    return;
                }
                if (mHelper == null) return;

                //Ask for the price
                List additionalSkuList = new ArrayList();
                additionalSkuList.add(""SKU_ID"");
                try {
                    mHelper.queryInventoryAsync(true, additionalSkuList, mQueryFinishedListener);
                }catch (Exception e){
                    //Fail while asking the price
                }
            }
        });

    //Buy Button Listener
    b_buy.setOnClickListener(new View.OnClickListener()
    {
        public void onClick(View V)
        {
            try {
            String payload= ""my_payload""
            mHelper.launchPurchaseFlow(c, ""SKU_ID"",1111,mPurchaseFinishedListener, payload);
            } catch (Exception e) {
                //Error launching purchase flow. Another async operation in progress
            }
        }
    });

    // Callback for when a purchase is finished
    mPurchaseFinishedListener = new IabHelper.OnIabPurchaseFinishedListener() {
        public void onIabPurchaseFinished(IabResult result, Purchase purchase) {
            // if we were disposed of in the meantime, quit.
            if (mHelper == null) return;

            if (result.isFailure()) {
                //Error while buying
                return;
            }

            if (purchase.getSku().equals(""SKU_ID"")) {
                // bought the premium upgrade!
            }
            }
        };
}

//For retrieve the price:
IabHelper.QueryInventoryFinishedListener mQueryFinishedListener = new IabHelper.QueryInventoryFinishedListener() {
    public void onQueryInventoryFinished(IabResult result, Inventory inventory) {
        if (result.isFailure()) {
            return;
        }
        String z = inventory.getSkuDetails(""SKU_ID"").getPrice();
        //The price of the object is + z !!!
    }

};

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (mHelper == null) return;

    // Pass on the activity result to the helper for handling
    if (!mHelper.handleActivityResult(requestCode, resultCode, data)) {
        super.onActivityResult(requestCode, resultCode, data);
    }
}

@Override
public void onDestroy() {
    super.onDestroy();
        if (mHelper != null) mHelper.dispose();
        mHelper = null;
}

@Override
public void onBackPressed() {
    super.onBackPressed();
    finish();
}
}
</code></pre>

<p><strong>And this is the error:</strong></p>

<pre><code>Exception java.lang.NullPointerException: Attempt to invoke virtual method 'java.lang.String android.content.Context.getPackageName()' on a null object reference
com.myproj.util.IabHelper.startSetup (IabHelper.java)
__null__.dispose (IabHelper.java)
__null__.launchPurchaseFlow (IabHelper.java)
__null__.handleActivityResult (IabHelper.java)
__null__.queryInventory (IabHelper.java)
__null__.queryInventoryAsync (IabHelper.java)
__null__.getResponseDesc (IabHelper.java)
__null__.checkSetupDone (IabHelper.java)
__null__.getResponseCodeFromBundle (IabHelper.java)
__null__.getResponseCodeFromIntent (IabHelper.java)
__null__.queryPurchases (IabHelper.java)
__null__.querySkuDetails (IabHelper.java)
com.myproj.util.IabHelper.startSetup (IabHelper.java)
__null__.dispose (IabHelper.java)
__null__.launchPurchaseFlow (IabHelper.java)
__null__.handleActivityResult (IabHelper.java)
__null__.queryInventory (IabHelper.java)
__null__.queryInventoryAsync (IabHelper.java)
__null__.getResponseDesc (IabHelper.java)
__null__.checkSetupDone (IabHelper.java)
__null__.getResponseCodeFromBundle (IabHelper.java)
__null__.getResponseCodeFromIntent (IabHelper.java)
__null__.queryPurchases (IabHelper.java)
__null__.querySkuDetails (IabHelper.java)
com.myproj.util.IabHelper.startSetup (IabHelper.java)
__null__.dispose (IabHelper.java)
__null__.launchPurchaseFlow (IabHelper.java)
__null__.handleActivityResult (IabHelper.java)
__null__.queryInventory (IabHelper.java)
__null__.queryInventoryAsync (IabHelper.java)
__null__.getResponseDesc (IabHelper.java)
__null__.checkSetupDone (IabHelper.java)
__null__.getResponseCodeFromBundle (IabHelper.java)
__null__.getResponseCodeFromIntent (IabHelper.java)
__null__.queryPurchases (IabHelper.java)
__null__.querySkuDetails (IabHelper.java)
com.myproj.util.IabHelper$2.run (IabHelper.java)
java.lang.Thread.run (Thread.java:818)
</code></pre>

<hr>

<p>Here is some involved method of the Google IabHelper class <strong>(Probably you'll NOT need to read this)</strong> They are just mentioned in the Error Log and are written by Google:</p>

<p>Dispose:</p>

<pre><code>public void dispose() {
    logDebug(""Disposing."");
    mSetupDone = false;
    if (mServiceConn != null) {
        logDebug(""Unbinding from service."");
        if (mContext != null) mContext.unbindService(mServiceConn);
    }
    mDisposed = true;
    mContext = null;
    mServiceConn = null;
    mService = null;
    mPurchaseListener = null;
}
</code></pre>

<p>StartSetup:</p>

<pre><code>    public void startSetup(final OnIabSetupFinishedListener listener) {
    // If already set up, can't do it again.
    checkNotDisposed();
    if (mSetupDone) throw new IllegalStateException(""IAB helper is already set up."");

    // Connection to IAB service
    logDebug(""Starting in-app billing setup."");
    mServiceConn = new ServiceConnection() {
        @Override
        public void onServiceDisconnected(ComponentName name) {
            logDebug(""Billing service disconnected."");
            mService = null;
        }

        @Override
        public void onServiceConnected(ComponentName name, IBinder service) {
            if (mDisposed) return;
            logDebug(""Billing service connected."");
            mService = IInAppBillingService.Stub.asInterface(service);
            String packageName = mContext.getPackageName();
            try {
                logDebug(""Checking for in-app billing 3 support."");

                // check for in-app billing v3 support
                int response = mService.isBillingSupported(3, packageName, ITEM_TYPE_INAPP);
                if (response != BILLING_RESPONSE_RESULT_OK) {
                    if (listener != null) listener.onIabSetupFinished(new IabResult(response,
                            ""Error checking for billing v3 support.""));

                    // if in-app purchases aren't supported, neither are subscriptions.
                    mSubscriptionsSupported = false;
                    return;
                }
                logDebug(""In-app billing version 3 supported for "" + packageName);

                // check for v3 subscriptions support
                response = mService.isBillingSupported(3, packageName, ITEM_TYPE_SUBS);
                if (response == BILLING_RESPONSE_RESULT_OK) {
                    logDebug(""Subscriptions AVAILABLE."");
                    mSubscriptionsSupported = true;
                }
                else {
                    logDebug(""Subscriptions NOT AVAILABLE. Response: "" + response);
                }

                mSetupDone = true;
            }
            catch (RemoteException e) {
                if (listener != null) {
                    listener.onIabSetupFinished(new IabResult(IABHELPER_REMOTE_EXCEPTION,
                                                ""RemoteException while setting up in-app billing.""));
                }
                e.printStackTrace();
                return;
            }

            if (listener != null) {
                listener.onIabSetupFinished(new IabResult(BILLING_RESPONSE_RESULT_OK, ""Setup successful.""));
            }
        }
    };

    Intent serviceIntent = new Intent(""com.android.vending.billing.InAppBillingService.BIND"");
    serviceIntent.setPackage(""com.android.vending"");
    if (!mContext.getPackageManager().queryIntentServices(serviceIntent, 0).isEmpty()) {
        // service available to handle that Intent
        mContext.bindService(serviceIntent, mServiceConn, Context.BIND_AUTO_CREATE);
    }
    else {
        // no service available to handle that Intent
        if (listener != null) {
            listener.onIabSetupFinished(
                    new IabResult(BILLING_RESPONSE_RESULT_BILLING_UNAVAILABLE,
                    ""Billing service unavailable on device.""));
        }
    }
}
</code></pre>

<p>and the Constructor of IabHelper:</p>

<pre><code>    public IabHelper(Context ctx, String base64PublicKey) {
        mContext = ctx.getApplicationContext();
        mSignatureBase64 = base64PublicKey;
        logDebug(""IAB helper created."");
    }
</code></pre>

<p><a href=""https://github.com/googlesamples/android-play-billing/blob/master/TrivialDrive/app/src/main/java/com/example/android/trivialdrivesample/util/IabHelper.java"" rel=""nofollow noreferrer"">Here</a> is the complete IabHelper class.</p>

<p><strong>Recap:</strong></p>

<p>Tell me if you can see <strong>where/when the <code>NullPointerException</code> of the variable <code>mHelper</code> is thrown.</strong> I couldn't from the code and test with virtual and physical devices since work fine. </p>

<p>I'm pretty much sure that the error is thrown after that the Activity is closed but I don't understand why for fix it.</p>

<p>Write if you need more info. Thank to all!</p>
",3893550,,3893550,,2017-01-27 22:44:07,2017-02-02 15:04:41,Android In-app purchase NullPointerException,<java><android><nullpointerexception><in-app-purchase>,2,7,3,
Android,44527420,1,,,2017,,6,1055,"<p>I need to use Camera2 API on my application. (Api21+)
I found the next sample:
<a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-Camera2Basic</a> </p>

<p>I downloaded it and started on my phone. When I pressed the ""Picture"" Button, it's call the takePhoto method.</p>

<pre><code>private void takePicture() {
    lockFocus();
}
</code></pre>

<p>It is a State machine. Sometimes this machine stuck on <code>STATE_WAITING_LOCK</code>.
My device is waiting for Focus, but nothing happens! (Yes, my device is support auto focus)</p>

<pre><code>case STATE_WAITING_LOCK: {
        Integer afState = result.get(CaptureResult.CONTROL_AF_STATE);
        if (afState == null) {
            captureStillPicture();
        } else if (CaptureResult.CONTROL_AF_STATE_FOCUSED_LOCKED == afState ||
                CaptureResult.CONTROL_AF_STATE_NOT_FOCUSED_LOCKED == afState) {
            // CONTROL_AE_STATE can be null on some devices
            Integer aeState = result.get(CaptureResult.CONTROL_AE_STATE);
            if (aeState == null ||
                    aeState == CaptureResult.CONTROL_AE_STATE_CONVERGED) {
                mState = STATE_PICTURE_TAKEN;
                captureStillPicture();
            } else {
                runPrecaptureSequence();
            }
        }
        break;
    }
</code></pre>

<p>What is the good solution for this problem?
And this program sometimes crashed here:</p>

<pre><code>private void unlockFocus() {
    try {
        // Reset the auto-focus trigger
        mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AF_TRIGGER,
                CameraMetadata.CONTROL_AF_TRIGGER_CANCEL);
        setAutoFlash(mPreviewRequestBuilder);
/*HERE*/ mCaptureSession.capture(mPreviewRequestBuilder.build(), mCaptureCallback,
                mBackgroundHandler);
        // After this, the camera will go back to the normal state of preview.
        mState = STATE_PREVIEW;
        mCaptureSession.setRepeatingRequest(mPreviewRequest, mCaptureCallback,
                mBackgroundHandler);
    } catch (CameraAccessException e) {
        e.printStackTrace();
    }
}
</code></pre>

<p>Why can't focus my device?</p>
",5472479,,1033581,,2019-02-01 7:41:35,2019-02-01 7:41:35,Android Camera2 focus state stuck,<android><android-camera2>,2,2,3,
Android,39022845,1,39064930,,2016,,6,8702,"<p>I'm creating a custom camera capturing videos with the new camera2 API.</p>

<p>My code is strongly inspired from the code provided by Google <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""noreferrer"">here</a>. My camera preview has a button to switch from back to front camera and then from front to back camera.
The ""camera preview"" activity is launched with the back camera by default.</p>

<p>For some reason, when I click on the ""switch/swap camera"" button <strong>for the first time</strong>, it brings be to the front camera as it should, BUT everytime I click again, the switch/swap doesn't work anymore: the preview (on the front camera) fades a little bit, like if something is happening, but it remains on the currently selected (front) camera. </p>

<p>Here is my code :</p>

<p>In a <code>RecordVideoFragment</code>, in the <code>onViewCreated</code>:</p>

<pre><code>//  Switch camera button
        switchCameraButton = (ImageButton) view.findViewById(R.id.button_switch_camera);
        // Listener for Switch cameras button
        switchCameraButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                switchCameras();
            }
        });
</code></pre>

<p>And here is the <code>switchCameras()</code> function: </p>

<pre><code>private void  switchCameras() {
        mCameraOpenCloseLock.release();
        mCameraDevice.close();

        CameraManager mCameraManager = (CameraManager) getActivity().getSystemService(Context.CAMERA_SERVICE);
        try {
            String mCameraId = mCameraManager.getCameraIdList()[0];
            if (mCameraId.equals(""0"")) {   // If currently on FRONT camera (0 = CameraCharacteristics.LENS_FACING_FRONT)
                mCameraId = ""1"";           // switch to BACK camera (1 = CameraCharacteristics.LENS_FACING_BACK)
                switchCameraButton.setImageResource(R.drawable.ic_camera_front);
            } else {  // If currently on BACK camera
                mCameraId = ""0""; // switch to front camera
                switchCameraButton.setImageResource(R.drawable.ic_camera_back);
            }
            try {
                if (ActivityCompat.checkSelfPermission(getActivity(), Manifest.permission.CAMERA)
                        == PackageManager.PERMISSION_GRANTED) {
                    mCameraManager.openCamera(mCameraId, mStateCallback, null);
                } else {
                    requestVideoPermissions();
                }
            } catch (CameraAccessException e) {
                e.printStackTrace();
            }
        } catch (CameraAccessException e) {
            Toast.makeText(getActivity(), ""Cannot access the camera."", Toast.LENGTH_SHORT).show();
            getActivity().finish();
        }
    }
</code></pre>

<p>If you have any idea on what's happening that would save me. I have been bugging on this for days. Thank you very much</p>
",5175297,,,,,2018-02-08 8:39:38,Android Camera2 API switch back - front cameras,<android><camera><camera2><android-camera2>,2,1,3,
Android,32063524,1,,,2015,,7,4011,"<p>I am working with <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""noreferrer"">camera2Basic</a> now and trying to get each frame data to do some image processing. I am using camera2 API in Android5.0, everything is fine when only doing the camera preview and it is fluid. But the preview stuck when I use the <code>ImageReader.OnImageAvailableListener</code> callback to get each frame data, this cause a bad User Experience. 
The following is my related codes:</p>

<p>This is the setup for camera and ImageReader, I set the format of image is YUV_420_888</p>

<pre><code>public&lt;T&gt; Size setUpCameraOutputs(CameraManager cameraManager,Class&lt;T&gt; kClass, int width, int height) {
    boolean flagSuccess = true;
    try {
        for (String cameraId : cameraManager.getCameraIdList()) {
            CameraCharacteristics characteristics = cameraManager.getCameraCharacteristics(cameraId);
            // choose the front or back camera
            if (FLAG_CAMERA.BACK_CAMERA == mChosenCamera &amp;&amp;        
                    CameraCharacteristics.LENS_FACING_BACK != characteristics.get(CameraCharacteristics.LENS_FACING)) {
                continue;
            }
            if (FLAG_CAMERA.FRONT_CAMERA == mChosenCamera &amp;&amp;  
                    CameraCharacteristics.LENS_FACING_FRONT != characteristics.get(CameraCharacteristics.LENS_FACING)) {
                continue;
            }
            StreamConfigurationMap map = characteristics.get(
                    CameraCharacteristics.SCALER_STREAM_CONFIGURATION_MAP);

            Size largestSize = Collections.max(
                    Arrays.asList(map.getOutputSizes(ImageFormat.YUV_420_888)),
                    new CompareSizesByArea());

            mImageReader = ImageReader.newInstance(largestSize.getWidth(), largestSize.getHeight(),
                    ImageFormat.YUV_420_888, 3);

            mImageReader.setOnImageAvailableListener(mOnImageAvailableListener, mBackgroundHandler);
            ...
            mCameraId = cameraId;
       }
    } catch (CameraAccessException e) {
        e.printStackTrace();
    } catch (NullPointerException e) {

    }
    ......
}
</code></pre>

<p>When the camera opened successfully, I Create a CameraCaptureSession for camera preview</p>

<pre><code>private void createCameraPreviewSession() {
    if (null == mTexture) {
        return;
    }

    // We configure the size of default buffer to be the size of camera preview we want.
    mTexture.setDefaultBufferSize(mPreviewSize.getWidth(), mPreviewSize.getHeight());

    // This is the output Surface we need to start preview
    Surface surface = new Surface(mTexture);

    // We set up a CaptureRequest.Builder with the output Surface.
    try {
        mPreviewRequestBuilder =
                mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_PREVIEW);
        mPreviewRequestBuilder.addTarget(mImageReader.getSurface());
        mPreviewRequestBuilder.addTarget(surface);

        // We create a CameraCaptureSession for camera preview
        mCameraDevice.createCaptureSession(Arrays.asList(surface, mImageReader.getSurface()),
                new CameraCaptureSession.StateCallback() {

                    @Override
                    public void onConfigured(CameraCaptureSession session) {
                        if (null == mCameraDevice) {
                            return;
                        }

                        // when the session is ready, we start displaying the preview
                        mCaptureSession = session;

                        // Finally, we start displaying the camera preview
                        mPreviewRequest = mPreviewRequestBuilder.build();
                        try {
                            mCaptureSession.setRepeatingRequest(mPreviewRequest,
                                    mCaptureCallback, mBackgroundHandler);
                        } catch (CameraAccessException e) {
                            e.printStackTrace();
                        }
                    }

                    @Override
                    public void onConfigureFailed(CameraCaptureSession session) {

                    }
                }, null);
    } catch (CameraAccessException e) {
        e.printStackTrace();
    }
}
</code></pre>

<p>The last is the <code>ImageReader.OnImageAvailableListener</code> callback</p>

<pre><code>private final ImageReader.OnImageAvailableListener mOnImageAvailableListener = new ImageReader.OnImageAvailableListener() {
            @Override
            public void onImageAvailable(ImageReader reader) {
                Log.d(TAG, ""The onImageAvailable thread id: "" + Thread.currentThread().getId());
                Image readImage = reader.acquireLatestImage();
                readImage.close();
            }
        };
</code></pre>

<p>Maybe I do the wrong setup but I try several times and it doesn't work. Maybe there is another way to get frame data rather than ImageReader but I don't know.
Anybody knows how to get each frame data in realtime?</p>
",5237329,,5237329,,2015-08-18 4:39:35,2017-01-30 14:25:00,How to get each frame data using camera2 API in Android5.0 in realtime,<android><android-camera>,2,8,3,
Android,39044494,1,39054918,,2016,,8,7231,"<p>I'm building a custom camera using the new camera2 API. My code is based on the code sample provided by Google <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""noreferrer"">here</a>. </p>

<p>I can't find a way to get the camera preview in full screen. In the code sample, they use ratio optimization to adapt to all screens but it's only taking around 3/4 of the screen's height.</p>

<p>Here is my code of <code>AutoFitTextureView</code> :</p>

<pre><code>public class AutoFitTextureView extends TextureView {

private int mRatioWidth = 0;
private int mRatioHeight = 0;

public AutoFitTextureView(Context context) {
    this(context, null);
}

public AutoFitTextureView(Context context, AttributeSet attrs) {
    this(context, attrs, 0);
}

public AutoFitTextureView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
}

/**
 * Sets the aspect ratio for this view. The size of the view will be measured based on the ratio
 * calculated from the parameters. Note that the actual sizes of parameters don't matter, that
 * is, calling setAspectRatio(2, 3) and setAspectRatio(4, 6) make the same result.
 *
 * @param width  Relative horizontal size
 * @param height Relative vertical size
 */
public void setAspectRatio(int width, int height) {
    if (width &lt; 0 || height &lt; 0) {
        throw new IllegalArgumentException(""Size cannot be negative."");
    }
    mRatioWidth = width;
    mRatioHeight = height;
    requestLayout();
}

@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    int width = MeasureSpec.getSize(widthMeasureSpec);
    int height = MeasureSpec.getSize(heightMeasureSpec);

    if (0 == mRatioWidth || 0 == mRatioHeight) {
        setMeasuredDimension(width, height);
    } else {
        if (width &lt; height * mRatioWidth / mRatioHeight) {
            setMeasuredDimension(width, width * mRatioHeight / mRatioWidth);
        } else {
            setMeasuredDimension(height * mRatioWidth / mRatioHeight, height);
        }
    }
}
</code></pre>

<p>}</p>

<p>Thank you very much for your help.</p>
",5175297,,,,,2018-04-03 12:23:20,Get full screen preview with Android camera2,<android><camera><camera2><android-camera2>,2,0,3,
Android,37559401,1,,,2016,,11,1558,"<p>I saw that in android vision api (the sample is here: <a href=""https://github.com/googlesamples/android-vision"" rel=""noreferrer"">https://github.com/googlesamples/android-vision</a>) camera (camera1) is now deprecated and the recommend is to use camera2.</p>

<p>Do you guys have any idea how to re-write CameraSource to use camera2 on android vision?</p>

<p>Thanks in advance,</p>
",6369323,,,,,2018-06-29 17:20:25,Switching to Camera2 in Android Vision API,<android><android-vision>,2,0,3,
Android,45461226,1,,,2017,,12,9692,"<p>I am trying to implement Custom Camera to record a video. I have followed <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""noreferrer"">This sample</a> and it is working fine.</p>

<p>Now, i want to add <strong>""Switch Camera""</strong> functionality over a Button click. It should be able to <strong>Switch between Front/Back Camera</strong> even while the video is getting recorded.</p>

<p>Hence please help me to know if it is even possible??</p>

<p><strong>1. If yes then How??</strong></p>

<p><strong>2. If no then Please suggest some workaround??</strong></p>

<p>Some sample codes or links would be very helpful...</p>

<p><strong>Note :</strong> I have been googling about it and found some StackOverFlow answers like </p>

<p><a href=""https://stackoverflow.com/questions/39022845/android-camera2-api-switch-back-front-cameras"">Android Camera2 API switch back - front cameras</a></p>

<p><a href=""https://stackoverflow.com/questions/16765527/android-switch-camera-when-button-clicked"">Android: Switch camera when button clicked</a></p>

<p>But none of these are giving a <strong>facility to switch the camera when the video is being recorded</strong>.</p>

<p><strong>Please Help.</strong> </p>

<p>The code is same as <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""noreferrer"">This sample</a>. And it's the <strong>Camera2 API</strong>.</p>
",3792476,,3792476,,2017-08-10 8:33:02,2017-08-10 12:33:05,Android - Switch between front and back camera while recording a video,<android><android-layout><video><android-camera><android-camera2>,2,1,3,
Android,47078005,1,47079964,,2017,,13,2800,"<p>I'm working on UI tests with Espresso for Android, and following the Google's <a href=""https://github.com/googlesamples/android-testing/blob/master/ui/espresso/IdlingResourceSample/app/src/androidTest/java/com/example/android/testing/espresso/IdlingResourceSample/ChangeTextBehaviorTest.java"" rel=""noreferrer"">code sample</a> it is used, even though it's deprecated. So my questions are:</p>

<ul>
<li>why is it deprecated?</li>
<li>what replaces it?</li>
</ul>
",1769975,,1769975,,2017-11-03 8:45:31,2018-07-03 19:57:40,"Why is Espresso's registerIdlingResources deprecated, and what replaces it?",<java><android><android-espresso>,2,0,3,
Android,49488903,1,49489018,,2018,,32,7467,"<p>I'm trying to set up location updates in my Android app using <code>com.google.android.gms:play-services-location:12.0.0</code>, but I'm getting the following error:</p>

<blockquote>
  <p>LocationRequest constructor is marked as internal and should not be accessed from apps</p>
</blockquote>

<p>My location updates request looks like this:</p>

<pre><code>locationClient.requestLocationUpdates(
    new LocationRequest()
        .setInterval(5000)
        .setFastestInterval(1000)
        .setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY),
    locationCallback,
    null
);
</code></pre>

<p>I have followed the <a href=""https://developer.android.com/training/location/change-location-settings.html#location-request"" rel=""noreferrer"">docs</a> and the <a href=""https://github.com/googlesamples/android-play-location/blob/432d3b72b8c058f220416958b444274ddd186abd/LocationUpdates/app/src/main/java/com/google/android/gms/location/sample/locationupdates/MainActivity.java#L238"" rel=""noreferrer"">example</a>, which do it the same way. If I'm not supposed to call <code>new LocationRequest()</code>, then what is the proper way to do it?</p>
",4136777,,4136777,,2018-03-28 12:20:29,2018-04-04 14:24:37,LocationRequest constructor is marked as internal,<java><android><location>,2,0,3,
Android,50456919,1,,,2018,,44,2004,"<p><strong>Short question</strong>:</p>

<p>What is the correct way to handle database + network on the Paging library from Architecture components, using an API that uses page + size to load a new page and the <code>BoundaryCallback</code> class?</p>

<p><strong>Research and explanation</strong></p>

<p>Currently the class <a href=""https://developer.android.com/reference/android/arch/paging/PagedList.BoundaryCallback"" rel=""noreferrer""><code>BoundaryCallback</code></a> used in the paging library for architecture components, receives as parameter the instance of an element in the list without actual context of where this element is at. It happens in <code>onItemAtFrontLoaded</code> and <code>onItemAtEndLoaded</code>.</p>

<p>My Api is supposed to receive the page and the size of the page to load the next chunk of data. Boundary callback, added as part of the paged list builder, is supposed to tell you when to load the next page of data based on prefetch distance and page size.</p>

<p>Since the Api needs the page number and the size of the page to provide, I don't see a way to send that to the Api just by receiving one of the elements from the list as offered in <code>onItemAtFrontLoaded</code> and <code>onItemAtEndLoaded</code>. Checking the google examples in <a href=""https://github.com/googlesamples/android-architecture-components/tree/master/PagingWithNetworkSample"" rel=""noreferrer"">this link</a>, they use the name of the last element to get the next one, but that doesn't fit an Api with page + size.</p>

<p>They also have another example with only network that uses <a href=""https://developer.android.com/reference/android/arch/paging/PageKeyedDataSource"" rel=""noreferrer""><code>PagedKeyedDatasource</code></a>, but there is no sample or clue on how to mix that with the database and the BoundaryCallback.</p>

<p><strong>Edit</strong>:
Only solutions I have found so far is to store the last loaded page on the shared preferences, but that sounds like a dirty trick.</p>

<p>Refer to 
<a href=""https://github.com/googlesamples/android-architecture-components/issues/252#issuecomment-392119468"" rel=""noreferrer"">https://github.com/googlesamples/android-architecture-components/issues/252#issuecomment-392119468</a> for official input on it.</p>
",1560067,,1560067,,2018-05-25 17:01:16,2019-01-06 17:52:15,Paging library - Boundary callback for network + db with API taking page and size,<android><android-room><android-architecture-components><android-livedata><android-paging>,2,5,3,
Android,34638651,1,34650699,,2016,,10,3202,"<p>My question is very simple:</p>

<blockquote>
  <p>How to get an Android <code>android.hardware.Camera2</code> with 1:1 ratio and without deformation like Instagram?</p>
</blockquote>

<p>I tested with the GoogeSamples project <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""noreferrer"">android-Camera2Basic</a>. But when I change the preview with a ratio of 1:1 image is deformed. Does anyone have an idea on this?</p>

<p><a href=""https://i.stack.imgur.com/wGC9Y.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/wGC9Y.png"" alt=""enter image description here""></a></p>
",1832221,,2370483,,2019-01-16 22:53:19,2019-01-16 22:53:19,How to get an Android Camera2 with 1:1 ratio like Instagram?,<android><android-camera2>,3,4,3,
Android,39470098,1,,,2016,,14,4423,"<p>I have gone through the android finger print sample provided by Google.</p>

<p><a href=""https://github.com/googlesamples/android-FingerprintDialog"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-FingerprintDialog</a></p>

<p>As I am new to security standards, I am unable to understand the following.</p>

<ol>
<li>Why we need to use Keystore, key, CryptoObject... etc? Simply It could be like, ask fingerprint manager to authenticate the user and it can simply return the status(success/failed)</li>
<li>Do I need to generate new key every time on each authentication?</li>
</ol>
",1294150,,3857465,,2018-09-13 10:55:35,2018-09-13 10:55:35,Why crypto object is needed for Android fingerprint authentication?,<android><android-fingerprint-api>,3,3,3,
Android,52873173,1,52897124,,2018,,20,3401,"<p>I am migrating my app to androidx, I can't seem to get my unit tests working. I took example from <a href=""https://github.com/googlesamples/android-testing/tree/master/runner/AndroidJunitRunnerSample/"" rel=""noreferrer"">Google's AndroidJunitRunnerSample</a>, which has been updated to use the new androidx api. I get the following error when trying to run my tests:</p>

<pre><code>java.lang.Exception: Delegate runner 'androidx.test.internal.runner.junit4.AndroidJUnit4ClassRunner' for AndroidJUnit4 could not be loaded. Check your build configuration.
</code></pre>

<p>Here is my module build.gradle:</p>

<pre><code>android {
    defaultConfig {
        testInstrumentationRunner ""androidx.test.runner.AndroidJUnitRunner""
    }
}
dependencies {
    // Test dependencies
    androidTestImplementation 'androidx.test:core:1.0.0-beta02'
    androidTestImplementation 'androidx.test.ext:junit:1.0.0-beta02'
    androidTestImplementation 'androidx.test:runner:1.1.0-beta02'
    androidTestImplementation 'androidx.test.espresso:espresso-core:3.1.0-beta02'
    androidTestImplementation ""androidx.arch.core:core-testing:2.0.0""
    androidTestImplementation 'androidx.room:room-testing:2.1.0-alpha01'
    androidTestImplementation 'androidx.test.espresso:espresso-core:3.1.0-beta02'
    androidTestImplementation 'org.hamcrest:hamcrest-library:1.3'
}
</code></pre>

<p>And here is how my tests are structured:</p>

<pre><code>import org.junit.BeforeClass;
import org.junit.Test;
import org.junit.runner.RunWith;

import androidx.test.ext.junit.runners.AndroidJUnit4;

@RunWith(AndroidJUnit4.class)
public class EntityParcelTest {

    @BeforeClass
    public void createEntities() {
        // Setup...
    }

    @Test
    void someTest() {
        // Testing here
    }
</code></pre>

<p>What am I doing wrong?</p>
",10518087,,10518087,,2018-10-19 17:02:09,2019-03-01 11:15:35,Migrating Junit4 tests to androidx: What causes 'delegate runner could not be loaded'?,<android><android-studio><junit><junit4><androidx>,5,0,3,
Android,28954421,1,29069944,,2015,,15,32893,"<p>I'm attempting to follow the Android <a href=""https://developer.android.com/training/location/receive-location-updates.html"">Receiving Location Updates</a> tutorial. The example code is <a href=""https://github.com/googlesamples/android-play-location/blob/master/LocationUpdates/app/src/main/java/com/google/android/gms/location/sample/locationupdates/MainActivity.java"">here on Github</a>.</p>

<p>Everything is working except for this line:
        <code>LocationServices.FusedLocationApi.requestLocationUpdates(mGoogleApiClient, mLocationRequest, this);</code></p>

<p>It's throwing a <code>cannot resolve method requestLocationUpdates</code> error. I don't see anything in the <a href=""https://developer.android.com/reference/com/google/android/gms/location/FusedLocationProviderApi.html#requestLocationUpdates(com.google.android.gms.common.api.GoogleApiClient,%20com.google.android.gms.location.LocationRequest,%20com.google.android.gms.location.LocationListener)"">documentation</a>, but I'm pretty new to Android so might be missing something :).</p>

<p>Here's the full code. Any ideas where I'm going wrong? Thanks!</p>

<pre><code>package location.test.example.com;

import android.app.Fragment;
import android.content.Intent;
import android.location.Location;
import android.location.LocationListener;
import android.os.Bundle;
import android.support.v4.app.NavUtils;
import android.text.format.DateFormat;
import android.util.Log;
import android.view.ActionMode;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;

import com.google.android.gms.common.ConnectionResult;
import com.google.android.gms.common.api.GoogleApiClient;
import com.google.android.gms.location.LocationRequest;
import com.google.android.gms.location.LocationServices;

import java.util.ArrayList;
import java.util.Date;

public class LocationFragment extends Fragment implements
        GoogleApiClient.ConnectionCallbacks, GoogleApiClient.OnConnectionFailedListener, LocationListener {

    protected GoogleApiClient mGoogleApiClient;
    protected Location mCurrentLocation;
    protected LocationRequest mLocationRequest;
    protected String mLastUpdateTime;

    public static final long UPDATE_INTERVAL_IN_MILLISECONDS = 5000;

    public static final long FASTEST_UPDATE_INTERVAL_IN_MILLISECONDS = UPDATE_INTERVAL_IN_MILLISECONDS / 5;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        mLastUpdateTime = """";

        buildGoogleApiClient();

        if (NavUtils.getParentActivityName(getActivity()) != null) {
            getActivity().getActionBar().setDisplayHomeAsUpEnabled(true);
        }
        setHasOptionsMenu(true);

    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View v = inflater.inflate(R.layout.fragment_location, container, false);    

        return v;
    }

    protected synchronized void buildGoogleApiClient() {
        mGoogleApiClient = new GoogleApiClient.Builder(getActivity())
                .addConnectionCallbacks(this)
                .addOnConnectionFailedListener(this)
                .addApi(LocationServices.API)
                .build();
        createLocationRequest();
    }

    protected void createLocationRequest() {
        mLocationRequest = new LocationRequest();

        mLocationRequest.setInterval(UPDATE_INTERVAL_IN_MILLISECONDS);

        mLocationRequest.setFastestInterval(FASTEST_UPDATE_INTERVAL_IN_MILLISECONDS);

        mLocationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
        startLocationUpdates();
    }

    protected void startLocationUpdates() {
        LocationServices.FusedLocationApi.requestLocationUpdates(mGoogleApiClient, mLocationRequest, this);
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {

    }

    @Override
    public void onProviderEnabled(String provider) {

    }

    @Override
    public void onProviderDisabled(String provider) {

    }

    @Override
    public void onLocationChanged(Location location) {
        mCurrentLocation = location;
        mLastUpdateTime = DateFormat.getDateFormat(getActivity()).format(new Date());
        Toast.makeText(getActivity(), location.toString() + """", Toast.LENGTH_SHORT).show();
    }

    @Override
    public void onConnected(Bundle connectionHint) {

    }

    @Override
    public void onConnectionFailed(ConnectionResult result) {
        Log.i(""LocationFragment"", ""Connection failed: ConnectionResult.getErrorCode() "" + result.getErrorCode());
    }

    @Override
    public void onConnectionSuspended(int cause) {
        Log.i(""LocationFragment"", ""Connection suspended"");
        mGoogleApiClient.connect();
    }

}
</code></pre>
",2650407,,,,,2018-08-07 9:16:15,Android cannot resolve method requestLocationUpdates FusedLocationProviderAPI,<android><fusedlocationproviderapi>,6,0,3,
Android,47866673,1,47881098,,2017,,1,1912,"<p>i'm studying the <a href=""https://developer.android.com/topic/libraries/architecture/index.html"" rel=""nofollow noreferrer"">Android Architecture Components</a> and i'm a little bit confused. In the <a href=""https://github.com/googlesamples/android-architecture-components/tree/master/BasicSample"" rel=""nofollow noreferrer"">sample</a> they use a repository and state that changes within the datasource of the repository are observed by the ViewModels. I don't understand how the changes within the datasource are pushed to the ViewModels, as i cannot see any code within the ViewModels that subscribes them to the repository. Analogously, the fragments observe the ViewModel's LiveData, but they actually subscribe to the LiveData:</p>

<pre><code> // Observe product data
    model.getObservableProduct().observe(this, new Observer&lt;ProductEntity&gt;() {
        @Override
        public void onChanged(@Nullable ProductEntity productEntity) {
            model.setProduct(productEntity);
        }
    });
</code></pre>

<p>I cannot see any kind of subscribing within the ViewModels to observe the Repository. Am i missing something?</p>
",5268086,,1000551,,2018-03-19 11:24:36,2018-03-19 11:24:36,Android Architecture Components: How is LiveData in the repository observed by a ViewModel,<android><mvvm><viewmodel><android-architecture-components><android-livedata>,1,1,2,
Android,35604954,1,35606877,,2016,,1,424,"<p>I am trying to capture a photo and after that, allow to the user to add some effects, draw, drag other assets to the image, add text, etc. Like snapchat camera.</p>

<p>I have followed the <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""nofollow noreferrer"">Camera 2 API sample</a>. The major part of the code is at
<a href=""https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/java/com/example/android/camera2basic/Camera2BasicFragment.java"" rel=""nofollow noreferrer"">Camera2BasicFragment.java</a></p>

<p>I have achieved the capture and preview image, but the example set the image in a <code>TextureView</code>, but I do not have idea how to continue to manipulate the image.</p>

<p>I dont know if I should use a <code>TextureView</code> or a <code>Canvas</code> or a <code>SurfaceView</code>.</p>

<p>An example of the final image result that I want:</p>

<p><a href=""https://i.stack.imgur.com/4aLG4.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/4aLG4.jpg"" alt=""example""></a></p>

<p>Thanks in advance.</p>
",3796083,,4848308,,2016-02-24 16:15:18,2016-02-24 16:15:18,"Capture photo and apply effects (scale, rotate, grey, draw with finger)",<android><android-camera2>,1,11,2,
Android,38403559,1,38409251,,2016,,1,257,"<p>I would like to know how to automate creating a new app for Google Play Store. I know that it's possible to generate screenshots, create the <code>apk</code>, upload listing information etc. But how can I <strong>create</strong> the app initially? I want to create with a new package and all. Is there a way to automate this? </p>

<p>I read the fastlane documentation as well as the code here:</p>

<p><a href=""https://github.com/googlesamples/android-play-publisher-api/tree/master/v2/python"" rel=""nofollow"">https://github.com/googlesamples/android-play-publisher-api/tree/master/v2/python</a></p>

<p>I also read the documentation here:</p>

<p><a href=""https://developers.google.com/android-publisher/#publishing"" rel=""nofollow"">https://developers.google.com/android-publisher/#publishing</a></p>

<p>So far i'm not finding anything for <em>creating</em> a new package name.</p>
",1233366,,,,,2016-07-16 8:20:06,Google Play Dev Console automation of creating a new app,<android><fastlane>,1,0,2,
Android,39363500,1,,,2016,,1,2781,"<p>I use <code>setAlarmClock</code> method of <code>Alarmmanager</code> for do alarm clock application.
When I set alarm clock from 6.00 AM and alarm in 6.01 AM . It delay and not exact.</p>

<p>Code when <code>setAlarmClock</code>.</p>

<pre><code>Intent intent = new Intent(getBaseContext(), AlarmReceiver.class);
intent.setFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);
intent.putExtra(AppConstant.REMINDER, note.convertToString());
PendingIntent pendingIntent = PendingIntent.getBroadcast(getApplicationContext(),
        note.getId(), intent, PendingIntent.FLAG_CANCEL_CURRENT);
AlarmManager alarmManager = (AlarmManager) getSystemService(Context.ALARM_SERVICE);

if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) {
    alarmManager.setAlarmClock(new AlarmManager.AlarmClockInfo(getTargetTime().getTimeInMillis(),pendingIntent),pendingIntent);
}
</code></pre>

<p>Code when setCalander for alarm</p>

<pre><code>  private Calendar getTargetTime() {
    Calendar calNow = Calendar.getInstance();
    Calendar calSet = (Calendar) calNow.clone();
    calSet.set(Calendar.DAY_OF_MONTH, sDay);
    calSet.set(Calendar.HOUR_OF_DAY, sHour);
    calSet.set(Calendar.MINUTE, sMinute);
    calSet.set(Calendar.SECOND, 0);
    calSet.set(Calendar.MILLISECOND, 0);

    return calSet;
}
</code></pre>

<p>Ok, I implement from this project <a href=""https://github.com/googlesamples/android-DirectBoot"" rel=""nofollow"">https://github.com/googlesamples/android-DirectBoot</a>.</p>

<p>This project use setAlarmClock for alarm when it's time.</p>

<p>update: I change setAlarmClock to setExact</p>

<p>This code:</p>

<pre><code> alarmManager.setExact(AlarmManager.RTC_WAKEUP, getTargetTime().getTimeInMillis(), pendingIntent);
</code></pre>

<p>It doesn't work for me but It delay same setAlarmClock.</p>

<p>Current Time in millisecond: 1473318858628
I change to default format by use <a href=""http://www.ruddwire.com/handy-code/date-to-millisecond-calculators/#.V9EPXfmLRD8"" rel=""nofollow"">http://www.ruddwire.com/handy-code/date-to-millisecond-calculators/#.V9EPXfmLRD8</a></p>

<p>Thu Sep 08 2016 14:14:18 GMT+0700</p>

<p>Set Alarm Time in millisecond:1473318960000</p>

<p>Thu Sep 08 2016 14:16:00 GMT+0700</p>

<p>And now It's 14:16:00 , It doesn't alarm.</p>

<p>It's alarm on 14.20:00 , so delay about 4 minutes. ( Time in millisecond = 1473319200207)</p>

<p>Thank</p>
",5549837,,5549837,,2016-09-08 7:23:25,2016-09-08 7:23:25,setAlarmClock not exact in android marshmallow,<android><alarmmanager><android-alarms>,1,2,2,
Android,54529117,1,55016471,,2019,,1,44,"<p><a href=""https://i.stack.imgur.com/YOXFF.png"" rel=""nofollow noreferrer"">ref: log</a>  </p>

<p>We use the <a href=""https://github.com/googlesamples/android-SimpleMediaPlayer"" rel=""nofollow noreferrer"">Google sample project</a> with the following changes. Same things we use in our project, we got an error (-38,0) on media player error listener in Samsung flagship devices and Google devices. (tested in note 8-8.1 and pixel 2xl-9.0)</p>

<p>Here, <code>onError</code> listener calls first then <code>onPrepared</code> listener.</p>

<p>Expected solution: Play audio without any error.</p>

<pre><code>package com.example.android.mediaplayersample;

import android.content.Context;
import android.content.res.AssetFileDescriptor;
import android.media.AudioManager;
import android.media.MediaPlayer;

import java.util.concurrent.Executors;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.TimeUnit;

/**
 * Exposes the functionality of the {@link MediaPlayer} and implements the {@link PlayerAdapter}
 * so that {@link MainActivity} can control music playback.
 */
public final class MediaPlayerHolder implements PlayerAdapter {

    public static final int PLAYBACK_POSITION_REFRESH_INTERVAL_MS = 1000;

    private final Context mContext;
    private MediaPlayer mMediaPlayer;
    private int mResourceId;
    private PlaybackInfoListener mPlaybackInfoListener;
    private ScheduledExecutorService mExecutor;
    private Runnable mSeekbarPositionUpdateTask;

    public MediaPlayerHolder(Context context) {
        mContext = context.getApplicationContext();
    }

    /**
     * Once the {@link MediaPlayer} is released, it can't be used again, and another one has to be
     * created. In the onStop() method of the {@link MainActivity} the {@link MediaPlayer} is
     * released. Then in the onStart() of the {@link MainActivity} a new {@link MediaPlayer}
     * object has to be created. That's why this method is private, and called by load(int) and
     * not the constructor.
     */
    private void initializeMediaPlayer() {
        if (mMediaPlayer != null) {

            mMediaPlayer.setOnPreparedListener(new MediaPlayer.OnPreparedListener() {
                @Override
                public void onPrepared(MediaPlayer mediaPlayer) {
                    logToUI(""OnPrepared()"");
                    mediaPlayer.start();
                }
            });
            mMediaPlayer.setOnCompletionListener(new MediaPlayer.OnCompletionListener() {
                @Override
                public void onCompletion(MediaPlayer mediaPlayer) {
                    stopUpdatingCallbackWithPosition(true);
                    logToUI(""MediaPlayer playback completed"");
                    if (mPlaybackInfoListener != null) {
                        mPlaybackInfoListener.onStateChanged(PlaybackInfoListener.State.COMPLETED);
                        mPlaybackInfoListener.onPlaybackCompleted();
                    }
                }
            });
            mMediaPlayer.setOnErrorListener(new MediaPlayer.OnErrorListener() {
                @Override
                public boolean onError(MediaPlayer mediaPlayer, int i, int i1) {
                    logToUI(""OnError()"" + i + "" "" + i1);
                    return true;
                }
            });
            logToUI(""mMediaPlayer = new MediaPlayer()"");
        }
    }

    public void setPlaybackInfoListener(PlaybackInfoListener listener) {
        mPlaybackInfoListener = listener;
    }

    // Implements PlaybackControl.
    @Override
    public void loadMedia(int resourceId) {
        mResourceId = resourceId;
        mMediaPlayer = new MediaPlayer();

        try {
            logToUI(""load() {1. setDataSource}"");
            mMediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
            mMediaPlayer.setDataSource(""http://radio-electron.ru:8000/96"");
        } catch (Exception e) {
            logToUI(e.toString());
        }

        initializeMediaPlayer();


        try {
            logToUI(""load() {2. prepare}"");
            mMediaPlayer.prepareAsync();
        } catch (Exception e) {
            logToUI(e.toString());
        }

        initializeProgressCallback();
        logToUI(""initializeProgressCallback()"");
    }

    @Override
    public void release() {
        if (mMediaPlayer != null) {
            logToUI(""release() and mMediaPlayer = null"");
            mMediaPlayer.release();
            mMediaPlayer = null;
        }
    }

    @Override
    public boolean isPlaying() {
        if (mMediaPlayer != null) {
            return mMediaPlayer.isPlaying();
        }
        return false;
    }

    @Override
    public void play() {
        if (mMediaPlayer != null &amp;&amp; !mMediaPlayer.isPlaying()) {
            logToUI(String.format(""playbackStart() %s"",
                    mContext.getResources().getResourceEntryName(mResourceId)));
            mMediaPlayer.start();
            if (mPlaybackInfoListener != null) {
                mPlaybackInfoListener.onStateChanged(PlaybackInfoListener.State.PLAYING);
            }
            startUpdatingCallbackWithPosition();
        }
    }

    @Override
    public void reset() {
        if (mMediaPlayer != null) {
            logToUI(""playbackReset()"");
            mMediaPlayer.reset();
            loadMedia(mResourceId);
            if (mPlaybackInfoListener != null) {
                mPlaybackInfoListener.onStateChanged(PlaybackInfoListener.State.RESET);
            }
            stopUpdatingCallbackWithPosition(true);
        }
    }

    @Override
    public void pause() {
        if (mMediaPlayer != null &amp;&amp; mMediaPlayer.isPlaying()) {
            mMediaPlayer.pause();
            if (mPlaybackInfoListener != null) {
                mPlaybackInfoListener.onStateChanged(PlaybackInfoListener.State.PAUSED);
            }
            logToUI(""playbackPause()"");
        }
    }

    @Override
    public void seekTo(int position) {
        if (mMediaPlayer != null) {
            logToUI(String.format(""seekTo() %d ms"", position));
            mMediaPlayer.seekTo(position);
        }
    }

    /**
     * Syncs the mMediaPlayer position with mPlaybackProgressCallback via recurring task.
     */
    private void startUpdatingCallbackWithPosition() {
        if (mExecutor == null) {
            mExecutor = Executors.newSingleThreadScheduledExecutor();
        }
        if (mSeekbarPositionUpdateTask == null) {
            mSeekbarPositionUpdateTask = new Runnable() {
                @Override
                public void run() {
                    updateProgressCallbackTask();
                }
            };
        }
        mExecutor.scheduleAtFixedRate(
                mSeekbarPositionUpdateTask,
                0,
                PLAYBACK_POSITION_REFRESH_INTERVAL_MS,
                TimeUnit.MILLISECONDS
        );
    }

    // Reports media playback position to mPlaybackProgressCallback.
    private void stopUpdatingCallbackWithPosition(boolean resetUIPlaybackPosition) {
        if (mExecutor != null) {
            mExecutor.shutdownNow();
            mExecutor = null;
            mSeekbarPositionUpdateTask = null;
            if (resetUIPlaybackPosition &amp;&amp; mPlaybackInfoListener != null) {
                mPlaybackInfoListener.onPositionChanged(0);
            }
        }
    }

    private void updateProgressCallbackTask() {
        if (mMediaPlayer != null &amp;&amp; mMediaPlayer.isPlaying()) {
            int currentPosition = mMediaPlayer.getCurrentPosition();
            if (mPlaybackInfoListener != null) {
                mPlaybackInfoListener.onPositionChanged(currentPosition);
            }
        }
    }

    @Override
    public void initializeProgressCallback() {
        final int duration = mMediaPlayer.getDuration();
        if (mPlaybackInfoListener != null) {
            mPlaybackInfoListener.onDurationChanged(duration);
            mPlaybackInfoListener.onPositionChanged(0);
            logToUI(String.format(""firing setPlaybackDuration(%d sec)"",
                    TimeUnit.MILLISECONDS.toSeconds(duration)));
            logToUI(""firing setPlaybackPosition(0)"");
        }
    }

    private void logToUI(String message) {
        if (mPlaybackInfoListener != null) {
            mPlaybackInfoListener.onLogUpdated(message);
        }
    }

}
</code></pre>
",9222720,,,,,2019-03-06 5:55:31,"I face android media player error (-38, 0) in Samsung and Google latest version mobile",<android><android-mediaplayer><samsung-mobile>,1,0,2,
Android,43300273,1,,,2017,,2,205,"<p>I've tried to use Nearby Connections, but I keep getting the dialog ""Google Play Services"" has crashed. The logcat shows a stack trace like this:</p>

<pre><code>04-08 20:01:32.309 8904-11589/? E/AndroidRuntime: FATAL EXCEPTION: highpool[3]
                                                  Process: com.google.android.gms.nearby.connection, PID: 8904
                                                  java.lang.NullPointerException: Attempt to read from field 'java.lang.Object pu.a' on a null object reference
                                                      at vsb.e(:com.google.android.gms:244)
                                                      at vsr.run(:com.google.android.gms:344)
                                                      at lmq.run(:com.google.android.gms:450)
                                                      at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1112)
                                                      at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:587)
                                                      at lra.run(:com.google.android.gms:17)
                                                      at java.lang.Thread.run(Thread.java:818)
</code></pre>

<p>Where the specific random letters can change.</p>

<p>After further investigation, it seems to occur when a device is attempting to discover advertising devices and the timeout it specifies ends.</p>

<p>I went to report the issue and found someone already had:</p>

<p><a href=""https://code.google.com/p/android/issues/detail?can=1&amp;start=0&amp;num=100&amp;q=nearby%20connections%20nullpointerexception&amp;colspec=ID%20Status%20Priority%20Owner%20Summary%20Stars%20Reporter%20Opened&amp;groupby=&amp;sort=&amp;id=316748"" rel=""nofollow noreferrer"">https://code.google.com/p/android/issues/detail?can=1&amp;start=0&amp;num=100&amp;q=nearby%20connections%20nullpointerexception&amp;colspec=ID%20Status%20Priority%20Owner%20Summary%20Stars%20Reporter%20Opened&amp;groupby=&amp;sort=&amp;id=316748</a></p>

<p>Very few apps seem to use Nearby Connections; I know of none. The official documentation isn't great. Heck, <code>Nearby.Connections.startAdvertising()</code> still wants a <code>AppMetadata</code> parameter, which Google has deprecated.</p>

<p>The official code example, <a href=""https://github.com/googlesamples/android-nearby"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-nearby</a> , is obsolete and non-functional.</p>

<p>So my question is: how can I work around these issues? Is there a modern, <em>working</em> example of Nearby Connections anywhere? Or is the Nearby Connections API itself simply unused and completely broken?</p>
",967131,,,,,2017-07-06 8:19:32,Nearby Connections NullPointerException,<android><google-nearby>,1,4,2,
Android,39034348,1,39045922,,2016,,2,563,"<p>I'm trying to code a proof of concept, with <strong>Xamarin android</strong>.
A sort of EMM tool, i.e. an application which will be on charge to install other application and manage the device.
So <strong>Android Marshmallow</strong> is a good start with android for work features.</p>

<p>My app is <strong>Device Owner</strong> therefore it should have no problem to <strong>silently install</strong> other applications. It can download an apk from a website without a problem. But when I try to install it, it throws an ""<strong>Files still open</strong>"" exception despite of calling all <code>Close()</code> methods.</p>

<p>I have taken my code from the example of the excellent android-testdpc sample on github  <a href=""https://github.com/googlesamples/android-testdpc/tree/master/app/src/main/java/com/afwsamples/testdpc/cosu"" rel=""nofollow"">here</a></p>

<p>I have changed it for it work in c# with Xamarin.</p>

<p>Here is my code :</p>

<pre><code>    public static bool InstallPackage(Context context, Handler handler, InputStream input, String packageName)
    {
        try
        {
            PackageInstaller packageInstaller = context.PackageManager.PackageInstaller;
            PackageInstaller.SessionParams param = new PackageInstaller.SessionParams(PackageInstallMode.FullInstall);
            param.SetAppPackageName(packageName);
            // set params
            int sessionId = packageInstaller.CreateSession(param);
            PackageInstaller.Session session = packageInstaller.OpenSession(sessionId);
            using (System.IO.Stream output = session.OpenWrite(""COSU"", 0, -1))
            {
                byte[] buffer = new byte[65536];
                int c;
                while ((c = input.Read(buffer)) != -1)
                {
                    output.Write(buffer, 0, c);
                }
                session.Fsync(output);
                input.Close();
                output.Close();
            }
            session.Commit(createIntentSender(context, sessionId)); // this line throws exception 'Files stil open'
            return true;
        }
        catch (Exception ex)
        {
            Log.Error(TAG, ""Error installing package: "" + packageName, ex);
            handler.SendMessage(handler.ObtainMessage(Common.MSG_INSTALL_FAIL,
                    packageName));
            return false;
        }
    }
</code></pre>

<p>I'm stuck with this for the moment. if I have the time I will try to install android studio and test my code in java to see if the problem come from Xamarin.</p>

<p>If someone got any clue for my problem I will really appreciate the help</p>
",6733826,,,,,2016-08-19 18:48:53,"Xamarin.Android PackageInstaller Session.commit ""Files still open"" Exception on apk silent install",<c#><android><xamarin><xamarin.android><android-install-apk>,1,0,2,
Android,31756883,1,32000958,,2015,,2,687,"<p>Not sure how many people here are familiar with the <a href=""https://github.com/googlesamples/android-UniversalMusicPlayer"" rel=""nofollow noreferrer"">Android Universal Music Player</a> but I am having issue with displaying an album in the <a href=""https://github.com/googlesamples/android-UniversalMusicPlayer/blob/b729def3679cac2d66136e8fdc9237d01bfb485c/mobile/src/main/java/com/example/android/uamp/ui/MediaItemViewHolder.java#L75"" rel=""nofollow noreferrer"">MediaItemViewHolder.java</a> file.</p>

<p>So here is a basic structure after my modifications: </p>

<pre><code>// image view for the album cover
holder.mImageView = (ImageView) convertView.findViewById(R.id.play_eq);

// get the album art url
String artUrl = description.getIconUri().toString();
Bitmap art;
AlbumArtCache cache = AlbumArtCache.getInstance();
art = cache.getIconImage(artUrl);
....
if (cachedState == null || cachedState != state) {
    switch (state) {
    case STATE_PLAYABLE:
         // display the album cover
         holder.mImageView.setImageBitmap(art);
         break;
....
</code></pre>

<p>This correctly displays the album cover. However, <strong>it is initially blank</strong>. Once the user clicks on an item, the image is displayed. </p>

<p><strong>Screenshot #1</strong> : Once the app is loaded and user did not click on any item: </p>

<p><a href=""https://i.stack.imgur.com/9oObH.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/9oObH.png"" alt=""enter image description here""></a></p>

<p><strong>Screenshot #2</strong> : Once the user click on the item to play the song</p>

<p><a href=""https://i.stack.imgur.com/6ZtlI.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/6ZtlI.png"" alt=""enter image description here""></a></p>

<p>I am not really sure what is causing the album to be initially blank. Looking at the <a href=""https://github.com/googlesamples/android-UniversalMusicPlayer/blob/b729def3679cac2d66136e8fdc9237d01bfb485c/mobile/src/main/java/com/example/android/uamp/AlbumArtCache.java#L75"" rel=""nofollow noreferrer"">AlbumArtCache.java</a> I can't see any restrictions about OnClickListener that can cause this. </p>

<p>Any suggestions how to resolve this issue?</p>
",4576720,,,,,2015-08-14 1:24:58,Android universal music player add album cover in the MediaItemViewHolder,<java><android><android-imageview><android-bitmap>,1,0,2,
Android,50031467,1,,,2018,,2,251,"<p>I have a class called <code>CosuUtils</code> that follows <a href=""https://github.com/googlesamples/android-testdpc/blob/master/app/src/main/java/com/afwsamples/testdpc/cosu/CosuUtils.java"" rel=""nofollow noreferrer"">this</a> class pretty closely. I am programmatically updating an application that is a device owner. This works fine in Android 6 but I'm getting the following error when trying to update in Android 7. </p>

<p><code>PackageInstaller: Commit of session 1108510423 failed: /data/app/vmdl1108510423.tmp/COSU specified package com.mypackage inconsistent with com.mypackage.full</code></p>

<p>In <code>CosuUtils</code> I set the package name as such </p>

<pre><code>public static boolean installPackage(Context context, InputStream in, String packageName) throws IOException {
    PackageInstaller packageInstaller = context.getPackageManager().getPackageInstaller();
    PackageInstaller.SessionParams params = new PackageInstaller.SessionParams(PackageInstaller.SessionParams.MODE_FULL_INSTALL);
    params.setAppPackageName(packageName);
</code></pre>

<p>I was passing <code>com.mypackage</code> to <code>installPackage</code> which as mentioned earlier works fine on Android 6. This doesn't work in Android 7 unless I use <code>com.mypackage.full</code>. The issue is this breaks the ability for users who have upgraded to Android 7 to update to the latest version of the app. What changed between Android 6 and 7 that caused it to break and is there a work around for it?</p>
",9301093,,,,,2018-04-26 15:51:46,PackageInstaller error when pragmatically updating app,<android><android-7.0-nougat><device-owner><cosu><packageinstaller>,1,0,2,
Android,36713033,1,,,2016,,2,494,"<p>Android's <code>Content Provider</code> <a href=""http://developer.android.com/guide/topics/manifest/provider-element.html#auth"" rel=""nofollow"">must have</a>:</p>

<blockquote>
  <p>At least one authority must be specified.</p>
</blockquote>

<p>So for example in Google's samples <a href=""https://github.com/googlesamples/android-BasicSyncAdapter/blob/master/Application/src/main/AndroidManifest.xml"" rel=""nofollow"">android-BasicSyncAdapter AndroidManifest.xml</a> there is</p>

<pre><code>&lt;provider
    android:name="".provider.FeedProvider""
    android:authorities=""com.example.android.basicsyncadapter""
    android:exported=""false"" /&gt;
</code></pre>

<p>Then to implement this CP one need to define the same String inside the CP like in <a href=""https://github.com/googlesamples/android-BasicSyncAdapter/blob/8210761ee67e06210d14ce913b2d82618cee0bb7/Application/src/main/java/com/example/android/basicsyncadapter/provider/FeedProvider.java"" rel=""nofollow"">android-BasicSyncAdapter FeedProvider.java</a> <code>CONTENT_AUTHORITY</code></p>

<pre><code>public static final String CONTENT_AUTHORITY = ""com.example.android.basicsyncadapter"";
</code></pre>

<p>As we have to define this String twice, isn't this basically breaking the DRY rule - if I change it in one place, I have to remember to change it somewhere else as well.</p>
",2401535,,,,,2016-05-01 18:56:55,Does Android Content Provider authority definition break the DRY rule?,<android><android-contentprovider><dry>,1,1,2,
Android,36739298,1,,,2016,,2,592,"<p>I am trying to record video from <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""nofollow"">android camera2 sample</a></p>

<p>All works fine but when I play the video after recording (from the sd card), the video starts freezing and you can hear just the audio at the background and when the audio stops, the video start playing without the audio and the time of the video jumps from seconds to minites (03:24)</p>

<pre><code>private void setUpMediaRecorder() throws IOException {
    mMediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
    mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.SURFACE);
    mMediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);

    mMediaRecorder.setOutputFile(getVideoFile().getAbsolutePath());
    mMediaRecorder.setVideoEncodingBitRate(10000000);
    mMediaRecorder.setVideoFrameRate(30);
    //mMediaRecorder.setMaxDuration(60000); // Set max duration 60 sec.
    mMediaRecorder.setVideoSize(mVideoSize.getWidth(), mVideoSize.getHeight());
    mMediaRecorder.setVideoEncoder(MediaRecorder.VideoEncoder.H264);
    mMediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AAC);


    int rotation = getWindowManager().getDefaultDisplay().getRotation();
    int orientation = ORIENTATIONS.get(rotation);

    if (mCameraType == 1) {
        if (orientation == 90) {
            mMediaRecorder.setOrientationHint(270);
        } else if (orientation == 270) {
            mMediaRecorder.setOrientationHint(90);
        }
    }
    else {
        mMediaRecorder.setOrientationHint(orientation);
    }
    mMediaRecorder.prepare();
}
</code></pre>

<p>Figure out that it works without those lines:</p>

<pre><code>mMediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
mMediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AAC);
</code></pre>

<p>How can I make it works with sound?</p>

<p>The stupid solution is to restart the device.
Is someone know why is that happening? </p>

<p>Thanks for helping</p>
",5904387,,5904387,,2016-06-13 10:16:48,2017-04-05 1:38:17,Android camera2 delay between the video to the sound,<android><android-mediarecorder><camera2>,1,2,2,
Android,46696170,1,,,2017,,3,2594,"<p>Looking through the samples I seen 2 approaches to MVVM using Android Architecture Components.</p>

<p>First  approach:</p>

<ol>
<li><code>ViewModel</code> provides <code>LiveData</code></li>
<li><code>Activity</code> subscribes to <code>LiveData</code></li>
<li>When observer called <code>Activity</code> is setting data to <code>ViewModel</code> <code>ObservableField</code>.</li>
<li>Whole <code>ViewModel</code> is passed to binding.</li>
<li><p>In <code>xml</code> you just set <code>ObservableField</code> as value</p>

<pre><code>&lt;ProgressBar
    android:layout_width=""wrap_content""
    android:layout_height=""wrap_content""
    android:layout_gravity=""center""
    app:visibleGone=""@{viewmodel.listLoading}""/&gt;

&lt;android.support.v4.widget.SwipeRefreshLayout
    android:id=""@+id/swiperefresh""
    android:layout_width=""match_parent""
    android:layout_height=""match_parent""
    app:refreshing=""@{viewmodel.listRefreshing}""
    app:onRefreshListener=""@{() -&gt; viewmodel.refreshList()}""
    app:visibleGone=""@{!viewmodel.listLoading}""&gt;
</code></pre></li>
</ol>

<p><strong>Pros:</strong> I don't need to pass state (for example ""loading""), as I update <code>listLoading</code> <code>ObservableField</code> in <code>ViewModel</code> as this:</p>

<pre><code>val listLoading = ObservableBoolean(false)
/** other observable fields go here **/

val list: MutableLiveData&lt;List&lt;Item&gt;&gt; = MutableLiveData()

  fun loadList() {
        listLoading.set(true)
        repo.getList { items -&gt;
            list.value = items
            listLoading.set(false)
        }
    }
</code></pre>

<p><strong>Cons:</strong> Are there any cons in this approach?</p>

<p>Second approach:</p>

<ol>
<li><code>ViewModel</code> provides <code>LiveData</code></li>
<li><code>Activity</code> subscribes to <code>LiveData</code></li>
<li>When observer called <code>Activity</code> is passed to binding</li>
<li>Only needed object (pojo) is passed to binding</li>
</ol>

<p><strong>Pros:</strong> Any pros of this approach?</p>

<p><strong>Cons:</strong> State should be returned from <code>ViewModel</code>. In this <a href=""https://github.com/googlesamples/android-architecture-components/tree/master/GithubBrowserSample"" rel=""nofollow noreferrer"">sample from Google</a> data is wrapped in <code>Resource</code> object.</p>

<p>First approach is used in <a href=""https://github.com/googlesamples/android-architecture/tree/dev-todo-mvvm-live-kotlin/"" rel=""nofollow noreferrer"">another sample app from Google</a></p>

<p>I would like to know what are pros and cons of both patterns from developers with more experience working with Android Data Binding and Android Arch Components.</p>
",4260554,,4260554,,2017-10-11 20:59:14,2017-10-11 21:29:27,Best practices and patterns in ViewModel + Data Binding. Is ObservableField in ViewModel OK?,<android><design-patterns><android-databinding><android-architecture-components><android-mvvm>,1,1,2,
Android,43098757,1,43180267,,2017,,3,977,"<p>I am trying to get location update in background with the batched version of Fused Location Provider Api. </p>

<p>I am doing this by following Google guidelines by requesting a location updates with a callback on a broadcast <a href=""https://developers.google.com/android/reference/com/google/android/gms/location/FusedLocationProviderApi.html#requestLocationUpdates(com.google.android.gms.common.api.GoogleApiClient,%20com.google.android.gms.location.LocationRequest,%20android.app.PendingIntent)"" rel=""nofollow noreferrer"">PendingIntent</a>.</p>

<p>For the location request I used <a href=""https://developers.google.com/android/reference/com/google/android/gms/location/LocationRequest.html#setMaxWaitTime(long)"" rel=""nofollow noreferrer"">setMaxWaitTime</a> to get the location update results in batched as specific by Google API documentation.</p>

<p>My problem is that my broadcast receiver didn’t get the location in batch and still get one location at a time from location service.</p>

<p>I also tried a new <a href=""https://github.com/googlesamples/android-play-location/tree/master/LocationUpdatesPendingIntent"" rel=""nofollow noreferrer"">PendingIntent location update sample project</a> from google but the location update still return only one location at a time.</p>

<p>For information I tested on a Nexus 5X device as it has a <a href=""https://source.android.com/devices/sensors/batching.html"" rel=""nofollow noreferrer"">batching sensor hardware</a>.</p>

<p>Am I missing something ?</p>

<p>Here is an example of the code :</p>

<p>Build and connected Google Api Client</p>

<pre><code>private static final long UPDATE_INTERVAL = 60000; // Every 60 seconds.
private static final long FASTEST_UPDATE_INTERVAL = 30000; // Every 30 seconds
private static final long MAX_WAIT_TIME = 60000 * 5; // Batch every 5 minutes.

public void buildGoogleApiClient() {
    mGoogleApiClient = new GoogleApiClient.Builder(context)
            .addConnectionCallbacks(this)
            .addOnConnectionFailedListener(this)
            .addApi(LocationServices.API)
            .build();

    mLocationRequest = new LocationRequest();
    mLocationRequest.setInterval(UPDATE_INTERVAL);
    mLocationRequest.setFastestInterval(FASTEST_UPDATE_INTERVAL);
    mLocationRequest.setPriority(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY);
    mLocationRequest.setMaxWaitTime(MAX_WAIT_TIME);

    mGoogleApiClient.connect();
}

@Override
public void onConnected(Bundle connectionHint) {
    try {
        // Create a pending intent to listening on location service when the update become available
        Intent mIntent = new Intent(context, LocationReceiver.class);
        mPendingIntent = PendingIntent.getBroadcast(context, 42, mIntent, PendingIntent.FLAG_CANCEL_CURRENT);
        // Permission check before launching location services
        if (ContextCompat.checkSelfPermission(context,
                Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
            return;
        }
        LocationServices.FusedLocationApi.requestLocationUpdates(mGoogleApiClient, mLocationRequest, mPendingIntent);
    } catch (Exception e) {
        e.printStackTrace();
    }
}
</code></pre>

<p>BroadcastReceiver class</p>

<pre><code>public class LocationReceiver extends BroadcastReceiver {

@Override
public void onReceive(final Context context, Intent intent) {
    try {

        // Check if intent has location result
        if (LocationResult.hasResult(intent)) {
            // Get our location from the LocationResult
            LocationResult locationResult = LocationResult.extractResult(intent);
            if (locationResult != null) {

                List&lt;Location&gt; locations = locationResult.getLocations();

                for (Location location : locations) {
                    SimpleDateFormat formatter = new SimpleDateFormat(""dd/MM/yyyy HH:mm:ss"", Locale.FRANCE);
                    String dateString = formatter.format(new java.util.Date(location.getTime()));

                    Log.d(TAG, ""LOCATION: lat:"" + location.getLatitude() + "" long:"" + location.getLongitude() +
                            "" radius:"" + location.getAccuracy() + "" date:"" + dateString);
                }

            } else {
                Log.d(TAG, ""Location is null"");
            }
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
}
</code></pre>

<p>}</p>

<p>Thanks for any help.</p>
",3041015,,3041015,,2017-03-30 11:43:33,2017-04-03 8:51:53,Android how to get location update in batch,<android><geolocation><location><google-play-services><fusedlocationproviderapi>,1,0,2,
Android,34881551,1,,,2016,,3,1754,"<p>Implemented <a href=""https://github.com/googlesamples/android-nearby"" rel=""nofollow"">this sample</a> on mobile &amp; tablet everything is perfect ! But whit Android TV ADT-1 v5.0.2 build LRX22G these eloquent message shows up.</p>

<pre><code>GmsClient: unable to connect to service: com.google.android.gms.nearby.messages.service.NearbyMessagesService.START

D/NearbyMessagesClient: Failed to emit client lifecycle event ACTIVITY_STOPPED due to GmsClient being disconnected

NearbyMessagesClient: Failed to emit client lifecycle event CLIENT_DISCONNECTED due to GmsClient being disconnected
</code></pre>

<p>The callback :</p>

<pre><code>@Override public void onConnectionFailed(@NonNull ConnectionResult connectionResult) 
</code></pre>

<p>Outputs :</p>

<pre><code>ConnectionResult{statusCode=INTERNAL_ERROR, resolution=null, message=null}
</code></pre>

<p>Like I said, everything works in the mobile module. I doubled checked API_KEY, gradle dependencies, Manifest meta, nope, I even created a listing for the APK and created a Game on Google Play Console, nothing.</p>

<p>Any ideas ? Thanks !</p>
",704439,,1018109,,2016-04-18 17:11:04,2016-04-18 17:11:04,"ConnectionResult{statusCode=INTERNAL_ERROR, resolution=null, message=null}",<android><google-api-client><android-tv><google-nearby>,1,0,2,
Android,55520315,1,,,2019,,3,72,"<p>I'm using the new <code>LocationSettingsRequest</code> system to request high accuracy locations. If my device is set to power saving mode for example, would prompt a system dialog to update the location accuracy. This works in most cases but in some devices the following happens:</p>

<ol>
<li>If the device is set to power saving mode, the system dialog asks for gps permission and changes to gps only if confirmed.</li>
<li>If the device is set to gps only, the system asks for wifi and google services to improve location and changes to power saving mode location if confirmed.</li>
</ol>

<p>Here is how I set the <code>LocationSettingsRequest</code>:</p>

<pre><code>val builder = LocationSettingsRequest.Builder()
    .addLocationRequest(createLocationRequest(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY))
    .addLocationRequest(createLocationRequest(LocationRequest.PRIORITY_HIGH_ACCURACY))
    .setAlwaysShow(true)

settingsClient.checkLocationSettings(builder.build())
</code></pre>

<p>This triggers the Google Play Services system dialog to update the location accuracy settings. But for example on a Samsung Galaxy S6 running Android 7.0, the location is never updated to high accuracy.</p>

<p>The same happens when I try the Google Location example available <a href=""https://github.com/googlesamples/android-play-location"" rel=""nofollow noreferrer"">here</a>. In the <code>locationupdates</code> folder, check the <code>startLocationUpdates()</code> method where the settings resolution is called:</p>

<pre><code>private void startLocationUpdates() {
    // Begin by checking if the device has the necessary location settings.
    mSettingsClient.checkLocationSettings(mLocationSettingsRequest)
            .addOnSuccessListener(this, new OnSuccessListener&lt;LocationSettingsResponse&gt;() {
                @Override
                public void onSuccess(LocationSettingsResponse locationSettingsResponse) {
                    Log.i(TAG, ""All location settings are satisfied."");

                    //noinspection MissingPermission
                    mFusedLocationClient.requestLocationUpdates(mLocationRequest,
                            mLocationCallback, Looper.myLooper());

                    updateUI();
                }
            })
            .addOnFailureListener(this, new OnFailureListener() {
                @Override
                public void onFailure(@NonNull Exception e) {
                    int statusCode = ((ApiException) e).getStatusCode();
                    switch (statusCode) {
                        case LocationSettingsStatusCodes.RESOLUTION_REQUIRED:
                            Log.i(TAG, ""Location settings are not satisfied. Attempting to upgrade "" +
                                    ""location settings "");
                            try {
                                // Show the dialog by calling startResolutionForResult(), and check the
                                // result in onActivityResult().
                                ResolvableApiException rae = (ResolvableApiException) e;
                                rae.startResolutionForResult(MainActivity.this, REQUEST_CHECK_SETTINGS);
                            } catch (IntentSender.SendIntentException sie) {
                                Log.i(TAG, ""PendingIntent unable to execute request."");
                            }
                            break;
                        case LocationSettingsStatusCodes.SETTINGS_CHANGE_UNAVAILABLE:
                            String errorMessage = ""Location settings are inadequate, and cannot be "" +
                                    ""fixed here. Fix in Settings."";
                            Log.e(TAG, errorMessage);
                            Toast.makeText(MainActivity.this, errorMessage, Toast.LENGTH_LONG).show();
                            mRequestingLocationUpdates = false;
                    }

                    updateUI();
                }
            });
}
</code></pre>

<p>Running this sample app on this Samsung device causes the same problem. The <code>onActivityResult()</code> is called for the <code>Activity.RESULT_CANCELED</code> case.</p>

<p>Has anyone been through something similar? Any ideas on how to address the problem?</p>
",11312661,,,,,2019-04-15 10:39:58,Requesting high precision location with LocationSettingsRequest not updating location settings,<android><google-play-services><android-location>,1,5,2,
Android,41773621,1,,,2017,,3,3176,"<p>I'm trying to use <a href=""https://developers.google.com/vision/barcodes-overview"" rel=""nofollow noreferrer"">Google Mobile Vision API</a> with the camera2 module and I'm having a lot of trouble.</p>

<p>I'm using Google's <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""nofollow noreferrer"">android-Camera2Video</a> example code as a base. I've modified it to include the following callback:</p>

<p><strong>Camera2VideoFragment.java</strong></p>

<pre><code>OnCameraImageAvailable mCameraImageCallback;

public interface OnCameraImageAvailable {
    void onCameraImageAvailable(Image image);
}


ImageReader.OnImageAvailableListener mImageAvailable = new ImageReader.OnImageAvailableListener() {
    @Override
    public void onImageAvailable(ImageReader reader) {

        Image image = reader.acquireLatestImage();
        if (image == null)
            return;

        mCameraImageCallback.onCameraImageAvailable(image);

        image.close();
    }
};
</code></pre>

<p>That way any fragment including <code>Camera2VideoFragment.java</code> can get access to its images.</p>

<p>Now, The Barcode API only accepts <code>Bitmap</code> images, but I'm unable to convert <code>YUV_420_888</code> to Bitmap. Instead, I changed the <code>imageReader</code>'s file format to <code>JPEG</code> and ran the following conversion code:</p>

<pre><code>    Image.Plane[] planes = image.getPlanes();
    ByteBuffer buffer = planes[0].getBuffer();
    buffer.rewind();
    byte[] data = new byte[buffer.capacity()];
    buffer.get(data);
    Bitmap bitmap = BitmapFactory.decodeByteArray(data, 0, data.length);
</code></pre>

<p>This worked but the framerate drop of feeding <code>JPEG</code> data to the <code>imageReader</code> was significant. I'm wondering if anyone has worked around this issue before.</p>
",5710376,,,,,2018-01-04 0:11:23,camera2 output to Bitmap,<java><android><bitmap><google-vision>,1,0,2,
Android,42420540,1,42448872,,2017,,4,546,"<p>I'm using the BarcodeDetector from the Mobile Vision API on the Google Play Services (Version 10.2.0) for my app. I pretty much took the code from the smaple app they provide:
<a href=""https://github.com/googlesamples/android-vision"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-vision</a></p>

<p>And the barcodes are only detected if they are in the middle/centre of the screen. Is there any way of increasing this to extend the whole screen/camera preview? Its a bit misleading for the user unless you add a rectangle in the centre leading them to place the barcode inside.</p>

<p>Any help on how to accomplish this is welcome!</p>
",1652657,,8511554,,2018-04-04 17:25:01,2018-04-04 17:25:01,Mobile Vision API BarcodeDetector only detects in centre of the screen,<android><barcode><android-vision><vision-api>,1,2,2,
Android,31232008,1,,,2015,,5,4521,"<p>I use the <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""noreferrer"">https://github.com/googlesamples/android-Camera2Basic</a>, but try to modify it in a way that I could get access to each frame before it is drawn on the surfaceview.
I understood, I should add additional surface (ImageReader.getSurface()), and read the frame from it in this callback:</p>

<pre><code>private final ImageReader.OnImageAvailableListener mOnImageAvailableListener
            = new ImageReader.OnImageAvailableListener() {

        @Override
        public void onImageAvailable(ImageReader reader) {

           Log.d(""Img"", ""onImageAvailable"");
            mBackgroundHandler.post(new ImageSaver(reader.acquireNextImage(), mFile));
        }

    };
</code></pre>

<p>The problem is this callback gets called only when the image is capture by the user and not on eacg frame that is sent to preview screen from camera.</p>

<p>Here is what I tried to add:</p>

<pre><code>private void createCameraPreviewSession() {
        try {
            SurfaceTexture texture = mTextureView.getSurfaceTexture();
            assert texture != null;

            // We configure the size of default buffer to be the size of camera preview we want.
            texture.setDefaultBufferSize(mPreviewSize.getWidth(), mPreviewSize.getHeight());

            // This is the output Surface we need to start preview.
            Surface surface = new Surface(texture);

            // We set up a CaptureRequest.Builder with the output Surface.
            mPreviewRequestBuilder
                    = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_PREVIEW);
            mPreviewRequestBuilder.addTarget(surface);

            // Here, we create a CameraCaptureSession for camera preview.
            mCameraDevice.createCaptureSession(Arrays.asList(surface, mImageReader.getSurface()),
                    new CameraCaptureSession.StateCallback() {

                        @Override
                        public void onConfigured(CameraCaptureSession cameraCaptureSession) {
                            // The camera is already closed
                            if (null == mCameraDevice) {
                                return;
                            }

                            // When the session is ready, we start displaying the preview.
                            mCaptureSession = cameraCaptureSession;
                            try {
                                // Auto focus should be continuous for camera preview.
                                mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AF_MODE,
                                        CaptureRequest.CONTROL_AF_MODE_CONTINUOUS_PICTURE);
                                // Flash is automatically enabled when necessary.
                                mPreviewRequestBuilder.set(CaptureRequest.CONTROL_AE_MODE,
                                        CaptureRequest.CONTROL_AE_MODE_ON_AUTO_FLASH);

                                // Finally, we start displaying the camera preview.
                                mPreviewRequest = mPreviewRequestBuilder.build();
                                mCaptureSession.setRepeatingRequest(mPreviewRequest,
                                        mCaptureCallback, mBackgroundHandler);
                                //mPreviewRequestBuilder.addTarget(mImageReader.getSurface());
                            } catch (CameraAccessException e) {
                                e.printStackTrace();
                            }
                        }

                        @Override
                        public void onConfigureFailed(CameraCaptureSession cameraCaptureSession) {
                            showToast(""Failed"");
                        }
                    }, null
            );

            /**TODO added for capturing aeach frame*/
            // This is the CaptureRequest.Builder that we use to take a picture.
            final CaptureRequest.Builder captureBuilder =
                    mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_STILL_CAPTURE);
            captureBuilder.addTarget(mImageReader.getSurface());

            // Use the same AE and AF modes as the preview.
            captureBuilder.set(CaptureRequest.CONTROL_AF_MODE,
                    CaptureRequest.CONTROL_AF_MODE_CONTINUOUS_PICTURE);
            captureBuilder.set(CaptureRequest.CONTROL_AE_MODE,
                    CaptureRequest.CONTROL_AE_MODE_ON_AUTO_FLASH);

            /**end added for capture each frame*/


        } catch (CameraAccessException e) {
            e.printStackTrace();
        }
    }
</code></pre>
",2924714,,,,,2018-10-17 0:22:56,android camera2 process each frame and display its preview,<android><image-processing><android-camera><surfaceview>,1,1,2,
Android,36472561,1,36482728,,2016,,5,721,"<p>I'm using NDK with the experimental gradle plugin, and initially I was able to debug my native code.</p>

<p>Then I saw this issue <a href=""https://github.com/googlesamples/android-ndk/issues/119"">https://github.com/googlesamples/android-ndk/issues/119</a> and this blog post <a href=""http://frogermcs.github.io/json-parsing-with-flatbuffers-in-android/"">http://frogermcs.github.io/json-parsing-with-flatbuffers-in-android/</a>.
This approach would be great, because I could use the stable gradle plugin for android specific code, and the experimental gradle plugin for the native code, witch would be great to use use databinding for example.
I was able to use this structure, but I lost the ability to debug native code.</p>

<p>I have created a sample project that illustrate my problem.
<a href=""https://github.com/4brunu/AndroidNDKDebug"">https://github.com/4brunu/AndroidNDKDebug</a></p>

<p>In there you can find two projects.
The first one ""hello-jni-one-gradle-plugin"", only use the experimental gradle plugin, and I'm able to debug the native code.
The second one ""hello-jni-two-gradle-plugins"", I use the stable gradle plugin for android specific code, and the experimental gradle plugin for the native code, and I'm unable to debug the native code.</p>

<p>Am I doing something wrong?
Could you help me enable native code debug in the second project please?</p>

<p>Thanks</p>
",976628,,,,,2016-04-07 17:00:56,Android NDK unable to debug native code with two gradle plugins,<android><debugging><android-ndk><java-native-interface><native>,1,0,2,
Android,41892544,1,41893129,,2017,,5,3196,"<p>In converting a library project build from <code>Android.mk</code> to <code>CMakeLists.txt</code> following the Google <a href=""https://github.com/googlesamples/android-ndk/blob/master/hello-libs/app/src/main/cpp/CMakeLists.txt"" rel=""noreferrer"">hello-libs example</a> and I have encountered problems avoiding undefined references. I'm using an open source project called <a href=""http://dcmtk.org"" rel=""noreferrer"">DCMTK</a> and compiling DCMTK and <a href=""https://www.gnu.org/software/libiconv/"" rel=""noreferrer"">ICONV</a> to static libraries that I then link in. Building using the <code>Android.mk</code> works via <code>ndk-build</code> and building them with <code>gradle</code> and the following <code>CMakeLists.txt</code> works when I add each static library to the <code>target_link_libraries</code>. However, I wanted to use <code>add_library</code> to do the job and tried</p>

<pre><code>add_library( lib_dcmdata STATIC IMPORTED )
set_target_properties( lib_dcmdata
                           PROPERTIES
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmdata.a )
</code></pre>

<p>for each library and then adding them to target_link_libraries. This resulted in a ton of undefined references. I also tried set_target_properties by grouping the static libraries into one target, but this didn't work either.</p>

<p>Is the order of dependency linking different in some way or the way CMake handles these libraries different using the <code>add_library</code> <code>set_target_properties</code> method?</p>

<h3>CMakeLists.txt</h3>

<pre><code>cmake_minimum_required( VERSION 3.6 )
project( dicom-jni )

set( SOURCE_FILES
         dicom.cpp
         dicom.hpp )

add_library( lib_dcmtk STATIC IMPORTED )
set_target_properties( lib_dcmtk
                           PROPERTIES
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmrt.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmpstat.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmqrdb.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmwlm.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmdsig.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmnet.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmjpeg.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmjpls.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libcharls.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libijg16.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libijg12.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libijg8.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmimage.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmimgle.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libi2d.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmdata.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/liboflog.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libofstd.a )

add_library( lib_iconv STATIC IMPORTED )
set_target_properties( lib_iconv
                           PROPERTIES
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/iconv/${ANDROID_ABI}/lib/libiconv.a
                           IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/prebuilt_libs/iconv/${ANDROID_ABI}/lib/libcharset.a )

find_library( lib_jnigraphics jnigraphics )
find_library( lib_android-log log )

add_library( dicom-jni SHARED ${SOURCE_FILES} )

target_include_directories( dicom-jni PRIVATE
                                prebuilt_libs/dcmtk/${ANDROID_ABI}/include
                                prebuilt_libs/iconv/${ANDROID_ABI}/include
                                logger )

target_link_libraries( dicom-jni
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmrt.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmpstat.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmqrdb.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmwlm.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmdsig.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmnet.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmjpeg.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmjpls.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libcharls.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libijg16.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libijg12.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libijg8.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmimage.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmimgle.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libi2d.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libdcmdata.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/liboflog.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/dcmtk/${ANDROID_ABI}/lib/libofstd.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/iconv/${ANDROID_ABI}/lib/libiconv.a
                           ${CMAKE_SOURCE_DIR}/prebuilt_libs/iconv/${ANDROID_ABI}/lib/libcharset.a
                           z
                           dl
                           stdc++
                           ${lib_jnigraphics}
                           ${lib_android-log} )
</code></pre>
",410867,,,,,2017-01-27 11:38:25,"Android, CMake and Static Linking",<android-ndk><cmake>,1,0,2,
Android,32258675,1,32300841,,2015,,5,2913,"<p>I've been working on a project and got to make face detection working, with focus, <a href=""https://stackoverflow.com/questions/32051973/google-vision-api-samples-get-the-camerasource-to-focus"">thanks to SO</a>.</p>

<p>I am now taking pictures, but using the front camera on my Nexus 5 and a preview size of 1280x960, the play services seem to set the picture size to 320x240.</p>

<p>I checked, 1280x960 is supported on both preview and picture.</p>

<p>I tried changing the parameters using reflection (same as for the focus), but nothing changed.
Seems to be necessary to change that before starting the preview...</p>

<p>I've been trying to read and debug the obfuscated code, but I can't get why the library decides to go for this low resolution :-(</p>

<p>The code used is close to what's included in the sample, just added the possibility to take a picture using CameraSource.takePicture(...)</p>

<p>You can find the code in <a href=""https://github.com/googlesamples/android-vision/tree/master/visionSamples/FaceTracker"" rel=""nofollow noreferrer"">the samples repo</a></p>

<p>Code to reproduce the issue => <a href=""https://github.com/saiimons/android-vision/tree/take_picture_issue/visionSamples/FaceTracker"" rel=""nofollow noreferrer"">here</a></p>

<p>I changed the camera init with :</p>

<pre><code>mCameraSource = new CameraSource.Builder(context, detector)
    .setRequestedPreviewSize(1280, 960)
            .setFacing(CameraSource.CAMERA_FACING_FRONT)
            .setRequestedFps(30.0f)
            .build();
</code></pre>

<p>Added a button and connected a clik listener :</p>

<pre><code>findViewById(R.id.snap).setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            mCameraSource.takePicture(null, new CameraSource.PictureCallback() {
                @Override
                public void onPictureTaken(byte[] bytes) {
                    Bitmap bmp = BitmapFactory.decodeByteArray(bytes, 0, bytes.length);
                    Log.d(""BITMAP"", bmp.getWidth() + ""x"" + bmp.getHeight());
                }
            });
        }
    });
</code></pre>

<p>Log output :</p>

<pre><code>BITMAP﹕ 320x240
</code></pre>

<p>Thanks for the help !</p>
",5274454,,-1,,2017-05-23 11:59:44,2015-12-22 18:05:32,New vision API - Picture size,<android><camera><google-play-services><google-vision><android-vision>,1,3,2,
Android,28734594,1,28737314,,2015,,6,8693,"<p>I've implemented <a href=""https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/java/com/example/android/camera2basic/Camera2BasicFragment.java"" rel=""noreferrer"">this</a> offical Google <code>Camera2</code> example with minor changes into my app to take pictures in a custom camera. I need to also provide the option for video recording, but I can't find an example- maybe because the <code>Camera2</code> API is relatively new. </p>

<p>Does anyone have examples/tutorials on how to either A) modify the above code to also allow video recording, or B) implement video recording in a new fragment, while using the <code>Camera2</code> API?</p>

<p>Thank you in advance!</p>
",3558874,,,,,2015-02-26 8:11:36,Camera2 video recording,<android><android-camera>,1,1,2,
Android,48675221,1,,,2018,,6,833,"<p>I can't understand why this very simple activity produces memory leaks.</p>

<p>It follows the guidelines given here: <a href=""https://developer.android.com/training/location/receive-location-updates.html"" rel=""noreferrer"">https://developer.android.com/training/location/receive-location-updates.html</a> and the example code given here: <a href=""https://github.com/googlesamples/android-play-location/tree/master/LocationUpdates"" rel=""noreferrer"">https://github.com/googlesamples/android-play-location/tree/master/LocationUpdates</a></p>

<p>I also noticed that the memory leak is solved if I don't override the onLocationResult method of the LocationCallback class.
But in this ways the LocationCallback is completely useless.</p>

<p>Thank you for your help!</p>

<pre><code>public class TestLeaks extends Activity {
    private FusedLocationProviderClient mFusedLocationClient;   // Access to Fused Loc. Provider API
    private LocationRequest mLocationRequest;         // Stores parameters for requests to F.L.P.Api
    private LocationCallback mLocationCallback;                      // Callback for Location events

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.test_leaks);

        mFusedLocationClient = LocationServices.getFusedLocationProviderClient(this);
        mLocationCallback = new LocationCallback() {
            @Override
            public void onLocationResult(LocationResult locationResult) {
                super.onLocationResult(locationResult);
                Location loc = locationResult.getLastLocation();
                ((TextView) findViewById(R.id.latitude)).setText(String.format(Locale.US, ""%.6f"", loc.getLatitude()));
                ((TextView) findViewById(R.id.longitude)).setText(String.format(Locale.US, ""%.6f"", loc.getLongitude()));
            }
        };

        mLocationRequest = new LocationRequest()
                .setInterval(5000)
                .setFastestInterval(2000)
                .setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
    }

    @SuppressLint(""MissingPermission"")
    @Override
    public void onResume() {
        super.onResume();
        mFusedLocationClient.requestLocationUpdates(mLocationRequest, mLocationCallback, Looper.myLooper());
    }

    @Override
    protected void onPause() {
        super.onPause();
        mFusedLocationClient.removeLocationUpdates(mLocationCallback);
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        mLocationCallback = null;
    }
}
</code></pre>

<p>This is the output of LeakCanary about the detected memory leak:</p>

<pre><code>In it.myapp.app:1.0.4:10004.
* it.myapp.app.activities.TestLeaks has leaked:
* GC ROOT com.google.android.gms.internal.zzcfe.zzfus
* references com.google.android.gms.common.api.internal.zzci.zzful
* references com.google.android.gms.common.api.internal.zzck.zzfuk
* references it.myapp.app.activities.TestLeaks$1.this$0 (anonymous subclass of com.google.android.gms.location.LocationCallback)
* leaks it.myapp.app.activities.TestLeaks instance

* Retaining: 35 KB.
* Reference Key: 969b4256-81ff-4b01-b0d4-63e27e49b764
* Device: samsung samsung SM-G920F zerofltexx
* Android Version: 7.0 API: 24 LeakCanary: 1.5.4 74837f0
* Durations: watch=637463ms, gc=258ms, heap dump=2766ms, analysis=46757ms

* Details:
* Instance of com.google.android.gms.internal.zzcfe
|   static $classOverhead = byte[768]@317861889 (0x12f23001)
|   zzfus = com.google.android.gms.common.api.internal.zzci@318105032 (0x12f5e5c8)
|   mDescriptor = java.lang.String@317290744 (0x12e978f8)
|   mObject = 511599546432
|   mOwner = com.google.android.gms.internal.zzcfe@317359520 (0x12ea85a0)
|   shadow$_klass_ = com.google.android.gms.internal.zzcfe
|   shadow$_monitor_ = 0
* Instance of com.google.android.gms.common.api.internal.zzci
|   static $classOverhead = byte[648]@316776449 (0x12e1a001)
|   zzfuj = com.google.android.gms.common.api.internal.zzcj@317594368 (0x12ee1b00)
|   zzfuk = null
|   zzful = com.google.android.gms.common.api.internal.zzck@318185888 (0x12f721a0)
|   shadow$_klass_ = com.google.android.gms.common.api.internal.zzci
|   shadow$_monitor_ = 0
* Instance of com.google.android.gms.common.api.internal.zzck
|   static $classOverhead = byte[608]@316789761 (0x12e1d401)
|   zzfuk = it.myapp.app.activities.TestLeaks$1@318185648 (0x12f720b0)
|   zzfun = java.lang.String@317049344 (0x12e5ca00)
|   shadow$_klass_ = com.google.android.gms.common.api.internal.zzck
|   shadow$_monitor_ = 0
* Instance of it.myapp.app.activities.TestLeaks$1
|   static $classOverhead = byte[640]@316606465 (0x12df0801)
|   static serialVersionUID = -1641506329145588052
|   static $change = null
|   this$0 = it.myapp.app.activities.TestLeaks@317686496 (0x12ef82e0)
|   shadow$_klass_ = it.myapp.app.activities.TestLeaks$1
|   shadow$_monitor_ = -1897236332
* Instance of it.myapp.app.activities.TestLeaks
|   static $classOverhead = byte[4336]@316567553 (0x12de7001)
|   static serialVersionUID = 2740572635131010457
|   static $change = null
|   mFusedLocationClient = com.google.android.gms.location.FusedLocationProviderClient@317049680 (0x12e5cb50)
|   mLocationCallback = null
|   mLocationRequest = com.google.android.gms.location.LocationRequest@318159496 (0x12f6ba88)
|   mActionBar = null
|   mActionModeTypeStarting = 0
|   mActivityInfo = android.content.pm.ActivityInfo@317696896 (0x12efab80)
|   mActivityTransitionState = android.app.ActivityTransitionState@317736656 (0x12f046d0)
|   mAppLockCheckRunnable = android.app.Activity$1@318057504 (0x12f52c20)
|   mAppLockIsInMultiWindowMode = false
|   mApplication = it.myapp.app.CanaryLeak@315492064 (0x12ce06e0)
|   mCalled = true
|   mChangeCanvasToTranslucent = false
|   mChangingConfigurations = false
|   mComponent = android.content.ComponentName@318099536 (0x12f5d050)
|   mConfigChangeFlags = 0
|   mCurrentConfig = android.content.res.Configuration@317764560 (0x12f0b3d0)
|   mDecor = null
|   mDefaultKeyMode = 0
|   mDefaultKeySsb = null
|   mDestroyed = true
|   mDoReportFullyDrawn = false
|   mEatKeyUpEvent = false
|   mEmbeddedID = null
|   mEnableDefaultActionBarUp = false
|   mEnterTransitionListener = android.app.SharedElementCallback$1@1899179144 (0x71332c88)
|   mExitTransitionListener = android.app.SharedElementCallback$1@1899179144 (0x71332c88)
|   mFinished = true
|   mFlipfont = 0
|   mFragments = android.app.FragmentController@318057472 (0x12f52c00)
|   mHandler = android.os.Handler@317542688 (0x12ed5120)
|   mHasCurrentPermissionsRequest = false
|   mIdent = 165309401
|   mInstanceTracker = android.os.StrictMode$InstanceTracker@318057488 (0x12f52c10)
|   mInstrumentation = android.app.Instrumentation@315494968 (0x12ce1238)
|   mIntent = android.content.Intent@314929344 (0x12c570c0)
|   mLastNonConfigurationInstances = null
|   mMainThread = android.app.ActivityThread@315314736 (0x12cb5230)
|   mManagedCursors = java.util.ArrayList@318035832 (0x12f4d778)
|   mManagedDialogs = null
|   mMenuInflater = null
|   mParent = null
|   mPolicyManager = null
|   mReferrer = java.lang.String@314929856 (0x12c572c0)
|   mResultCode = 0
|   mResultData = null
|   mResumed = false
|   mScreenChangeListener = null
|   mSearchEvent = null
|   mSearchManager = null
|   mStartedActivity = false
|   mStopped = true
|   mTaskDescription = android.app.ActivityManager$TaskDescription@317542720 (0x12ed5140)
|   mTemporaryPause = false
|   mTitle = java.lang.String@315505152 (0x12ce3a00)
|   mTitleColor = 0
|   mTitleReady = true
|   mToken = android.os.BinderProxy@315387808 (0x12cc6fa0)
|   mTranslucentCallback = null
|   mUiThread = java.lang.Thread@2004343960 (0x7777dc98)
|   mVisibleBehind = false
|   mVisibleFromClient = true
|   mVisibleFromServer = true
|   mVoiceInteractor = null
|   mWindow = com.android.internal.policy.PhoneWindow@315451968 (0x12cd6a40)
|   mWindowAdded = true
|   mWindowManager = android.view.WindowManagerImpl@318034248 (0x12f4d148)
|   mInflater = com.android.internal.policy.PhoneLayoutInflater@316645632 (0x12dfa100)
|   mOverrideConfiguration = null
|   mResources = android.content.res.Resources@316047040 (0x12d67ec0)
|   mTheme = android.content.res.Resources$Theme@318057696 (0x12f52ce0)
|   mThemeResource = 2131820551
|   mBase = android.app.ContextImpl@316473008 (0x12dcfeb0)
|   shadow$_klass_ = it.myapp.app.activities.TestLeaks
|   shadow$_monitor_ = 1073742768
* Excluded Refs:
| Field: android.view.inputmethod.InputMethodManager.mNextServedView
| Field: android.view.inputmethod.InputMethodManager.mServedView
| Field: android.view.inputmethod.InputMethodManager.mServedInputConnection
| Field: android.view.textservice.SpellCheckerSession$1.this$0
| Field: com.samsung.android.content.clipboard.SemClipboardManager.mContext
| Field: com.samsung.android.emergencymode.SemEmergencyManager.mContext
| Field: android.view.Choreographer$FrameDisplayEventReceiver.mMessageQueue (always)
| Thread:FinalizerWatchdogDaemon (always)
| Thread:main (always)
| Thread:LeakCanary-Heap-Dump (always)
| Class:java.lang.ref.WeakReference (always)
| Class:java.lang.ref.SoftReference (always)
| Class:java.lang.ref.PhantomReference (always)
| Class:java.lang.ref.Finalizer (always)
| Class:java.lang.ref.FinalizerReference (always)
</code></pre>
",8073535,,,,,2018-10-10 4:09:29,Location Updates with FusedLocationProviderClient produces memory leaks,<android><memory-leaks><google-api-client><fusedlocationproviderclient><location-updates>,1,1,2,
Android,35634085,1,35666374,,2016,,6,3225,"<p><strong>Problem</strong>: I've been using <a href=""https://github.com/googlesamples/android-play-publisher-api"" rel=""noreferrer"">Python Script Samples by Google</a> to upload the apk to Play Store and to get list of apps published via my account (<a href=""https://github.com/googlesamples/android-play-publisher-api/blob/master/v2/python/basic_list_apks_service_account.py"" rel=""noreferrer"">list_apks.py</a> and <code>upload_apk.py</code>). However recently it started breaking. I've tried to update the packages like <code>google-api-python-client</code>, <code>oath2client</code> etc by doing <code>pip install --update packagename</code> but it didn't help. </p>

<p><strong>Logs</strong>:</p>

<p>This if while listing apk's:</p>

<pre><code>Determining latest version for my.package.name...
error   25-Feb-2016 06:30:52    Traceback (most recent call last):
error   25-Feb-2016 06:30:52      File ""list_apks.py"", line 80, in &lt;module&gt;
error   25-Feb-2016 06:30:52        main()
error   25-Feb-2016 06:30:52      File ""list_apks.py"", line 46, in main
error   25-Feb-2016 06:30:52        credentials = client.SignedJwtAssertionCredentials(
error   25-Feb-2016 06:30:52    AttributeError: 'module' object has no attribute 'SignedJwtAssertionCredentials'
build   25-Feb-2016 06:30:52    Found latest APK version: 
build   25-Feb-2016 06:30:52    Generated new APK version: 1
</code></pre>

<p>This is when uploading apk:</p>

<pre><code>25-Feb-2016 06:33:30    Uploading APK...
25-Feb-2016 06:33:30    Traceback (most recent call last):
25-Feb-2016 06:33:30      File ""upload_apk.py"", line 115, in &lt;module&gt;
25-Feb-2016 06:33:30        main(sys.argv)
25-Feb-2016 06:33:30      File ""upload_apk.py"", line 62, in main
25-Feb-2016 06:33:30        credentials = client.SignedJwtAssertionCredentials(
25-Feb-2016 06:33:30    AttributeError: 'module' object has no attribute 'SignedJwtAssertionCredentials'
</code></pre>

<p><strong>Code sniplet</strong>:</p>

<pre><code>import argparse

from apiclient.discovery import build
import httplib2
from oauth2client import client


SERVICE_ACCOUNT_EMAIL = (
    'myaccountemail.com')

# Declare command-line flags.
argparser = argparse.ArgumentParser(add_help=False)
argparser.add_argument('package_name',
                       help='The package name. Example: com.android.sample')


def main():
  # Load the key in PKCS 12 format that you downloaded from the Google APIs
  # Console when you created your Service account.
  f = file('mykeyname.p12', 'rb')
  key = f.read()
  f.close()

  # HERE IS THE EXCEPTION 
  credentials = client.SignedJwtAssertionCredentials(
      SERVICE_ACCOUNT_EMAIL,
      key,
      scope='https://www.googleapis.com/auth/androidpublisher')
  http = httplib2.Http()
  http = credentials.authorize(http)
  ...
</code></pre>

<p>What else I can try? I would appreciate your help.</p>
",1306419,,1306419,,2016-02-29 1:22:35,2016-02-29 1:22:35,AttributeError: 'module' object has no attribute 'SignedJwtAssertionCredentials',<android><python><attributeerror><oauth2client><google-play-developer-api>,1,0,2,
Android,36034766,1,36062362,,2016,,8,2523,"<p>I am trying to generate an Android application to use some extra *.so libraries (specifically 'libinterface.so'). Those libraries are generated externally, and included as a dependency inside a wrapper class called from Java side. The library is stored into 'src/main/jniLibs/armeabi-v7a'. The system includes all the .so file into the generated app.</p>

<p>Previously, I was using Eclipse for this purpose and I was able to use this library, but I have problems to do this with Android Studio.</p>

<p>The generated error is: </p>

<pre><code>/home/******/Libraries/android-sdk-linux/ndk-bundle/toolchains/aarch64-linux-android-4.9/prebuilt/linux-x86_64/bin/../lib/gcc/aarch64-linux-android/4.9/../../../../aarch64-linux-android/bin/ld: cannot find -linterface
</code></pre>

<p>As the error is thrown by the linker, it looks related with the library inclusion step. On Eclipse, I was using an 'Android.mk' file to include the new library, but I can't find the way to do this using Gradle.</p>

<pre><code>#Android.mk
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_MODULE := libinterface-prebuilt
LOCAL_SRC_FILES := prebuilt/libinterface.so
include $(PREBUILT_SHARED_LIBRARY)
</code></pre>

<p>I am trying to include the libraries with this gradle definition (Note: I have included the last JNI support and gradle-experimental <a href=""https://codelabs.developers.google.com/codelabs/android-studio-jni/index.html?index=..%2F..%2Findex#0"" rel=""nofollow"">using this tutorial</a>):</p>

<pre><code>...
android.buildTypes {
    release {
        minifyEnabled = false
        proguardFiles.add(file('proguard-android.txt'))
    }
}

android.ndk {
    moduleName = ""custom_wrapper_jni""
    cppFlags.add(""-I"" + file(""src/main/jni"").absolutePath)
    cppFlags.add(""-I"" + file(""../Integration/include"").absolutePath)  // &lt;- New library header include path 
    cppFlags.add(""-L"" + file(""src/main/jniLibs/armeabi-v7a"").absolutePath)  // &lt;- Path where the library is stored
    cppFlags.add(""-std=c++11"")
    stl = ""stlport_static"" // Which STL library to use: gnustl or stlport
    ldLibs.add(""log"")

    ldLibs.add(""interface"")    //&lt;- Library to be included
}
...
</code></pre>

<p>The library is compiled externally using CMake and makefile tools, and it is cross-compiled 'correctly' for Android platform (tested with Eclipse and ADT).</p>

<p>I have implemented the wrapper like this:</p>

<pre><code>// custom_wrapper_jni.h
#ifndef ANDROID_JNI_H
#define ANDROID_JNI_H

#include &lt;jni.h&gt;

extern ""C""
{
    JNIEXPORT jint JNICALL
    Java_com_example_goe_android_JniInterface_testFunction(JNIEnv *env,
                                                           jobject instance);
}
#endif
</code></pre>

<p>and</p>

<pre><code>// custom_wrapper_jni.cpp
#include &lt;custom_wrapper_jni.h&gt;

#include ""Interface.h""   // Header of the included library

Interface* mInterface = Interface::create();  // Generate the library class instance

JNIEXPORT jint JNICALL
Java_com_example_goe_android_JniInterface_testFunction(JNIEnv *env,
                                                    jobject instance)
{
    LOGI(""Test function called in wrapper!"");
    return mInterface-&gt;test();    // Use the instance
}
</code></pre>

<p>The header of the library looks like this:</p>

<pre><code>#ifndef INTERFACE_H__
#define INTERFACE_H__

#include &lt;string&gt;

class Interface
{
public:
    static Interface* create();
    virtual ~Interface(){}


    // Testing function
    virtual int test() = 0;

protected:
    Interface();
};
#endif // INTERFACE_H__
</code></pre>

<p>Thanks in advance.</p>

<h1>UPDATE:</h1>

<p>Following <a href=""https://github.com/googlesamples/android-ndk/tree/master/hello-thirdparty"" rel=""nofollow"">this example</a>, I have included some blocks into gradle script:</p>

<pre><code>def lib_path = file(""src/main/jniLibs"").absolutePath

model {

    repositories {
        libs(PrebuiltLibraries) {
            newlibs {
                headers.srcDir file(""../Integration/include"").absolutePath
                binaries.withType(SharedLibraryBinary) {
                    sharedLibraryFile = file(""${lib_path}/${targetPlatform.getName()}/libinterface.so"")
                    println ""Included libraries: "" + file(""${lib_path}/${targetPlatform.getName()}/libinterface.so"")
                }
            }
        }
    }

    android {
     ...
    }

    android.sources {
        main {
            jni {
                dependencies {
                    library ""newlibs"" linkage ""shared""
                }
            }
        }
    }
}
</code></pre>

<p>but is not working:</p>

<pre><code>Error: org.gradle.nativeplatform.toolchain.internal.CommandLineToolInvocationFailure: Linker failed while linking libcustom_wrapper_jni.so.
</code></pre>
",1407528,,1407528,,2016-03-17 7:29:10,2016-03-17 13:43:56,How to use extra *.so libraries on Android Studio and NDK,<android><android-studio><java-native-interface><shared-libraries><gradle-experimental>,1,7,2,
Android,40144970,1,,,2016,,9,3229,"<p>I've been looking at the Google Android Architecture examples for MVP with Dagger 2:</p>

<p><a href=""https://github.com/googlesamples/android-architecture/blob/todo-mvp-dagger/todoapp/app/src/main/java/com/example/android/architecture/blueprints/todoapp/tasks/TasksActivity.java"" rel=""noreferrer"">https://github.com/googlesamples/android-architecture/blob/todo-mvp-dagger/todoapp/app/src/main/java/com/example/android/architecture/blueprints/todoapp/tasks/TasksActivity.java</a></p>

<p>But, the example is rather trivial - each Activity has only one Fragment, and the Dagger Component is built in the Activity, and used to inject the Activity with the Presenter for the Fragment.</p>

<p>I've tried building on that example, to add multiple fragments to an Activity and navigate between them. Since each fragment has its own presenter, I've moved the dagger component building into the Fragment. So now I have:</p>

<ul>
<li>FragmentCallback (an interface providing methods to load fragment1 and fragment2)</li>
<li>Activity (implements FragmentCallback)</li>
<li>Fragment1 (implements the view interface)</li>
<li>Fragment1Contract (defines view and presenter interfaces)</li>
<li>Fragment1Presenter (implements the presenter interface)</li>
<li>Fragment1Component (injects Fragment1)</li>
<li>Fragment1Module (provides the view and presenter)</li>
<li>Fragment2</li>
<li>Fragment2Contract (defines view and presenter interfaces)</li>
<li>Fragment2Presenter (implements the presenter interface)</li>
<li>Fragment2Component (injects Fragment2)</li>
<li>Fragment2Module (provides the view and presenter)</li>
</ul>

<p>The activity does very little, it just loads the first fragment and implements FragmentCallback which the view can use to switch to another fragment.</p>

<p>The first fragment has a button which loads the second fragment using the FragmentCallback - which the fragments get by casting the Activity via</p>

<pre><code>public void onAttach(Context context) {
    super.onAttach(context);
    callback = (FragmentCallback) context;
}
</code></pre>

<p>Am I on a sensible track here? While the code looks clean with MVP am I missing something w.r.t the dagger components and modules?</p>

<p>Thanks.</p>

<h1>Update</h1>

<p>I've improved my situation a bit by creating one Component and Module for the Activity. Each Fragment still builds the Dagger context, but I'm no longer injecting the view (fragment) in the presenter constructor - when the fragment builds the context, injects itself (so it has the presenter) it then calls <code>presenter.init(this)</code> so that the presenter now has the view. </p>

<p>This nicely reduces the number of classes, and the next step would be to try only building the component in the activity, and having the fragment use this to inject itself (without having to build a new component). </p>
",20242,,20242,,2016-10-21 23:47:29,2016-11-08 12:22:51,Android MVP with Dagger 2 - Activity with multiple fragments,<android><mvp><dagger-2>,1,7,2,
Android,35105545,1,35106120,,2016,,19,15782,"<p>I have just read about Unit Instrumented Testing in Android and I wonder how I can mock a SharedPreferences without any SharedPreferencesHelper class on it like <a href=""https://github.com/googlesamples/android-testing/blob/master/unit/BasicSample/app/src/test/java/com/example/android/testing/unittesting/BasicSample/SharedPreferencesHelperTest.java"" rel=""noreferrer"">here</a></p>

<p>My code is:</p>

<pre><code>public class Auth {
private static SharedPreferences loggedUserData = null;
public static String getValidToken(Context context)
{
    initLoggedUserPreferences(context);
    String token = loggedUserData.getString(Constants.USER_TOKEN,null);
    return token;
}
public static String getLoggedUser(Context context)
{
    initLoggedUserPreferences(context);
    String user = loggedUserData.getString(Constants.LOGGED_USERNAME,null);
    return user;
}
public static void setUserCredentials(Context context, String username, String token)
{
    initLoggedUserPreferences(context);
    loggedUserData.edit().putString(Constants.LOGGED_USERNAME, username).commit();
    loggedUserData.edit().putString(Constants.USER_TOKEN,token).commit();
}

public static HashMap&lt;String, String&gt; setHeaders(String username, String password)
{
    HashMap&lt;String, String&gt; headers = new HashMap&lt;String, String&gt;();
    String auth = username + "":"" + password;
    String encoding = Base64.encodeToString(auth.getBytes(), Base64.DEFAULT);
    headers.put(""Authorization"", ""Basic "" + encoding);
    return headers;
}

public static void deleteToken(Context context)
{
    initLoggedUserPreferences(context);
    loggedUserData.edit().remove(Constants.LOGGED_USERNAME).commit();
    loggedUserData.edit().remove(Constants.USER_TOKEN).commit();
}

public static HashMap&lt;String, String&gt; setHeadersWithToken(String token) {
    HashMap&lt;String, String&gt; headers = new HashMap&lt;String, String&gt;();
    headers.put(""Authorization"",""Token ""+token);
    return headers;
}
private static SharedPreferences initLoggedUserPreferences(Context context)
{
    if(loggedUserData == null)
        loggedUserData = context.getSharedPreferences(Constants.LOGGED_USER_PREFERENCES,0);
    return loggedUserData;
}}
</code></pre>

<p>Is is possible to mock SharedPreferences without creating other class on it?</p>
",3127984,,,,,2016-10-31 9:39:51,How to mock a SharedPreferences using Mockito,<android><sharedpreferences><mockito>,1,0,2,
Android,33379534,1,33386364,,2015,,27,8839,"<p><strong>Summary</strong></p>

<p>Finally, I found the related issue, <code>setForeground()</code> incorrectly flagged as requiring API 23 on ViewGroups extending <code>FrameLayout</code>.</p>

<p><a href=""https://code.google.com/p/android/issues/detail?id=189041"" rel=""noreferrer"">Issue 189041:  setForeground() incorrectly flagged as requiring API 23 (NewApi) for ViewGroups extending FrameLayout</a></p>

<p>If you are not extending <code>FrameLayout</code>, the documentation is wrong and API 23 is required.</p>

<p><a href=""https://code.google.com/p/android/issues/detail?id=186273"" rel=""noreferrer"">Issue 186273:  View.setForeground wrong API level</a></p>

<p><strong>Updated question</strong></p>

<p>Marked as <a href=""https://stackoverflow.com/a/33201753/1009132"">duplicated of Can't use <code>setForeground</code> method on ImageView</a> by Commonsware and answered by him:</p>

<blockquote>
  <p>That is a documentation bug. setForeground() existed on FrameLayout
  from API Level 1; it is only on View as of API Level 23.</p>
</blockquote>

<p>In my case the documentation bug is not detected by the inspection in the fork but does it in an integration project, I don't understand it, anyway, this answers my initial question.</p>

<p>But It's not the same case, this code is already extending a <code>Framelayout</code> and using this method, it's not an <code>ImageView</code>, so I suppose the method has been removed in API 23. It doesn't appear in the reference now.</p>

<p><strong>Update:</strong> I add a <a href=""https://developer.android.com/sdk/api_diff/23/changes.html"" rel=""noreferrer"">diff report</a> for FrameLayout:</p>

<p><a href=""https://i.stack.imgur.com/cRCUa.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/cRCUa.png"" alt=""enter image description here""></a></p>

<p><strong>New question</strong></p>

<p>So my question changes to how to use the method in previous versions, and, why does appear the inspection error selectively?</p>

<p>If I add a redundant cast, the error message disappears:</p>

<pre><code>((FrameLayout) layout).getForeground()
</code></pre>

<p>But it's accessing the <code>View</code> method that is not supported now.</p>

<p>So I suppose targeting a previous API would remove the error message but I would appreciate a solution to use this Framelayout method or a clue to fix the issue in my case:</p>

<pre><code>ANDROID_COMPILE_SDK_VERSION=23
ANDROID_BUILD_TOOLS_VERSION=23.0.1
ANDROID_DEFAULT_MIN_SDK_VERSION=19
ANDROID_DEFAULT_TARGET_SDK_VERSION=23
</code></pre>

<p><strong>Workaround</strong> </p>

<p>In short, as a workaround, I changed the type to <code>FrameLayout</code> directly, so warnings about API and casting are gone, and I tested it works on Android 4.4.4 device and debugging, I thought it would crash, anyway it's only used in one animation, and I will fix/replace it in the future.</p>

<p><strong>Initial question</strong></p>

<p>I forked and customised the Google sample <a href=""https://github.com/googlesamples/android-topeka/blob/master/app/src/main/java/com/google/samples/apps/topeka/widget/quiz/AbsQuizView.java#L89"" rel=""noreferrer"">android-topeka</a>, and android-studio shows an error that I don't understand about the API level required to use the method <code>getForeground()</code> of the class <code>View</code> in <code>android.view</code> package:</p>

<blockquote>
  <p>Call requires API level 23 (current min is 19):
  android.view.View#getForeground</p>
</blockquote>

<p>The <a href=""http://developer.android.com/reference/android/view/View.html#getForeground()"" rel=""noreferrer"">reference</a> marks the method as added in API level 1, and the documentation (<code>Control+Q</code>) shows the same:</p>

<p><a href=""https://i.stack.imgur.com/YTaVn.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/YTaVn.png"" alt=""Doc showing API level 1 method""></a></p>

<p>But the <code>Calling new methods on older versions inspection</code> shows an error that API level 23 is required:</p>

<p><a href=""https://i.stack.imgur.com/xrVqr.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/xrVqr.png"" alt=""Error message about API 23 required""></a></p>

<p>I found a <a href=""https://stackoverflow.com/questions/16591672/android-studio-call-requires-api-level-16-error"">similar question</a>,  a bug in that case, but I think this is not a bug due to the original fork doesn't show this error message.</p>

<p>I'll try to detect the first time the message appears, but I did a lot of changes so any clue would be appreciated, thanks.</p>
",1009132,,1009132,,2018-01-09 17:27:45,2018-09-19 4:48:56,"Call requires API level 23' error, but getForeground() exists on FrameLayout from API 1",<java><android><android-studio><android-framelayout><android-api-levels>,1,0,2,
Android,42068877,1,42069068,,2017,,1,821,"<p>Android 6.0 (M) offers new features Fingerprint Authentication. I tried this example <a href=""https://github.com/googlesamples/android-FingerprintDialog"" rel=""nofollow noreferrer"">android-FingerprintDialog</a> it's good google sample.</p>

<p>A Problem is i am creating app like once user successfully authenticated by Fingerprint load that user data from <code>SQlite Database</code> but <code>FingerprintManager</code> can't provide any unique identity of fingerprint. If anyone have idea about this then please share it.</p>
",4395114,,4395114,,2017-02-06 13:27:51,2017-12-21 8:04:21,Is Android Fingerprint provide fingerprint name or Any unique identity of fingerprint?,<android><android-6.0-marshmallow><android-fingerprint-api>,2,9,2,
Android,37936693,1,,,2016,,2,1476,"<p>I am currently making an application where I need to get the user's location when a button is clicked. I am using <a href=""https://github.com/googlesamples/android-play-location/tree/master/LocationUpdates"" rel=""nofollow"">this</a> sample and it works great as a sample application. My question is, how would I implement it into my application button's <em>onClick</em> event? I don't need it to refresh often, I just need it so that when the user clicks the button, it gets the user's latitude and longitude and saves them to two variables. What would be the best way to do this? I didn't post my own code because all I have is a button with an <em>onClick</em> event.</p>
",6363024,,,,,2016-06-21 7:15:10,How do I get android location once at the push of a button?,<java><android><android-location>,2,0,2,
Android,52477887,1,,,2018,,3,239,"<p>When I config Android Studio 3.3 Canary 11 (gradle 3.3.0 alpha 11) with Kotlin 1.3.0-rc-57 and <code>constraintlayout 2.0</code></p>

<p>I have some problems like this, and AS can not work with some projects, i.e <a href=""https://github.com/googlesamples/android-sunflower/"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-sunflower/</a></p>

<p>Problem: AS can't understand Kotlin code, no auto-complete of codes, etc.....</p>

<p>Not all projects, maybe only the projects with <code>constraintlayout 2.0</code></p>

<p>Error in AS:</p>

<pre><code>com.google.common.util.concurrent.UncheckedExecutionException: java.io.IOException: File format error reading /Users/xxxxx/.gradle/caches/transforms-1/files-1.1/constraintlayout-2.0.0-alpha2.aar/66d32464c2b8004a7b95f523ebd1e95c/R.txt line 1743: 'int[] styleable GradientColor { 0x0101020b, 0x010101a2, 0x010101a3, 0x0101019e, 0x01010512, 0x01010513, 0x010101a4, 0x0101019d, 0x01010510, 0x01010511, 0x01010201, 0x010101a1 }'
    at com.android.utils.concurrency.CacheUtils.getAndUnwrap(CacheUtils.kt:37)
    at com.android.tools.idea.res.ProjectLightResourceClassService.getAarRClasses(ProjectLightResourceClassService.kt:172)
    at com.android.tools.idea.res.ProjectLightResourceClassService.getAarRClasses$default(ProjectLightResourceClassService.kt:169)
    at com.android.tools.idea.res.ProjectLightResourceClassService.getLightRClassesAccessibleFromModule(ProjectLightResourceClassService.kt:122)
</code></pre>

<p><a href=""https://issuetracker.google.com/issues/116402286"" rel=""nofollow noreferrer"">issue</a></p>
",1835650,,1835650,,2018-09-24 11:03:44,2018-09-29 20:49:35,Big problem Android Studio 3.3 Canary 11 (gradle 3.3.0 alpha 11) with Kotlin 1.3.0-rc-57 and constraintlayout 2.0,<android><android-studio><android-gradle>,2,2,2,
Android,39019899,1,,,2016,,3,1328,"<p>I would like to perform face detection / tracking on a video file (e.g. an MP4 from the users gallery) using the Android Vision <code>FaceDetector</code> API. I can see many examples on using the <a href=""https://developers.google.com/android/reference/com/google/android/gms/vision/CameraSource"" rel=""nofollow noreferrer"">CameraSource</a> class to perform face tracking on the stream coming directly from the camera (e.g. <a href=""https://github.com/googlesamples/android-vision/blob/master/visionSamples/FaceTracker/app/src/main/java/com/google/android/gms/samples/vision/face/facetracker/FaceTrackerActivity.java"" rel=""nofollow noreferrer"">on the android-vision github</a>), but nothing on video files.</p>

<p>I tried looking at the source code for <code>CameraSource</code> through Android Studio, but it is obfuscated, and I couldn't see the original online. I image there are many commonalities between using the camera and using a file. Presumably I just play the video file on a <code>Surface</code>, and then pass that to a pipeline.</p>

<p>Alternatively I can see that <code>Frame.Builder</code> has functions <code>setImageData</code> and <code>setTimestampMillis</code>. If I was able to read in the video as <code>ByteBuffer</code>, how would I pass that to the <code>FaceDetector</code> API? I guess <a href=""https://stackoverflow.com/questions/33173525/android-vision-face-detection-with-video-stream"">this question</a> is similar, but no answers. Similarly, decode the video into <code>Bitmap</code> frames and pass that to <code>setBitmap</code>.</p>

<p>Ideally I don't want to render the video to the screen, and the processing should happen as fast as the <code>FaceDetector</code> API is capable of.</p>
",1847734,,-1,,2017-05-23 12:17:32,2017-05-31 15:46:07,Android Face Detection API - Stored video file,<android><video><face-detection><android-vision>,2,2,2,
Android,35054405,1,,,2016,,3,2320,"<p>I have authenticated user using <code>authenticate()</code> method in my app. I was looking through documentation regarding gestures on Finger-Print Sensor but couldn't find any class pertaining to gestures. Is there any class regarding same which detects gestures like long Press,Tap, etc on finger print sensor. </p>

<p>I went through <code>FingerprintManager</code> class &amp; <a href=""https://github.com/googlesamples/android-FingerprintDialog"" rel=""nofollow"">this</a> but couldn't find much info regarding gestures. </p>
",5717212,,,,,2017-03-30 0:28:17,Detect Gestures on Fingerprint Sensor-Android,<android><gesture><android-6.0-marshmallow><fingerprint>,2,0,2,
Android,36481333,1,,,2016,,4,827,"<p>I have kontakt.io beacon and I try to write application for background scanning with nearby API.</p>

<p>I use this method to subscribe messages: </p>

<pre><code>SubscribeOptions options = new SubscribeOptions.Builder()
            // Finds messages attached to BLE beacons. See
            // https://developers.google.com/beacons/
            .setStrategy(Strategy.BLE_ONLY)
            .build();

    Nearby.Messages.subscribe(mGoogleApiClient, getPendingIntent(), options)
            .setResultCallback(new ResultCallback&lt;Status&gt;() {
                @Override
                public void onResult(@NonNull Status status) {
                    if (status.isSuccess()) {
                        Log.i(TAG, ""subscribed successfully"");
                        mSubState = SubState.SUBSCRIBING;
                        // Start background service for handling the notification.
                        getActivity().startService(getBackgroundSubscribeServiceIntent());
                    } else {
                        Log.i(TAG, ""could not subscribe"");
                        handleUnsuccessfulNearbyResult(status);
                    }
                }
            });
</code></pre>

<p>My code is according to this sample:
<a href=""https://github.com/googlesamples/android-nearby/tree/master/messages/NearbyBackgroundBeacons"" rel=""nofollow"">https://github.com/googlesamples/android-nearby/tree/master/messages/NearbyBackgroundBeacons</a></p>

<p>I´m receiving messages correctly, but when I kill application no more message come.</p>

<p>Is there any way to get messages from nearby after killing application?</p>
",5967417,,,,,2016-05-03 22:02:48,Google nearby API background scan doesn´t work after application kill,<android><google-play-services><beacon><google-nearby>,2,0,2,
Android,32295158,1,32299031,,2015,,4,2634,"<p>As Android Studio 1.3 coming with NDK support, I tried to convert my Gradle scripts (build.gradle app/build.gradle and gradle-wrapper.properties) following this link <a href=""http://tools.android.com/tech-docs/new-build-system/gradle-experimental"" rel=""nofollow"">http://tools.android.com/tech-docs/new-build-system/gradle-experimental</a>.</p>

<p>However, I cannot find any guidance about <strong>lintOptions</strong> from both the tutorial as well as ndk example repository <a href=""https://github.com/googlesamples/android-ndk"" rel=""nofollow"">https://github.com/googlesamples/android-ndk</a></p>

<p>My app/build.gradle</p>

<pre><code>apply plugin: 'com.android.model.application'

model {
    android {
        compileSdkVersion = 21
        buildToolsVersion = ""21.1.2""

        defaultConfig.with {
            applicationId = ""com.abc.xyz""
            minSdkVersion.apiLevel = 9
            targetSdkVersion.apiLevel = 21
        }

        compileOptions.with {
            sourceCompatibility=JavaVersion.VERSION_1_7
            targetCompatibility=JavaVersion.VERSION_1_7
        }

        lintOptions {       // &lt;-- this block
            checkReleaseBuilds false
        }
    }

        android.buildTypes {
        release {
            minifyEnabled = true
        }
    }
}
</code></pre>

<p>The sync failed with log: Error:Cause: com.android.build.gradle.managed.AndroidConfig_Impl</p>

<p>If I remove the <strong>lintOptions</strong> block, it seems to sync OK but build fails later.</p>
",3850054,,2016562,,2015-10-05 20:50:31,2015-12-08 16:24:00,lintOptions for experimental Gradle build tool in Android Studio 1.3,<android><android-studio><android-gradle><build.gradle><gradle-experimental>,2,0,2,
Android,42901334,1,42912408,,2017,,4,6003,"<p>I want to develop an Android Camera App for myself (can share it if there are interested people) that has a manual focus while video recording.</p>

<p>I've added a SeekBar to the google sample <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""nofollow noreferrer"">Camera2 app</a> but I can't find the way to implement the manual focus.</p>

<p>I found <a href=""https://stackoverflow.com/questions/28170491/manual-focus-in-camera2-android"">Manual focus in camera2, android</a> but it doesn't work on my LG G4.
The stock camera app is almost perfect since it doesn't allow the manual focus in video mode.</p>

<p>Does anyone of you have an idea ?</p>

<p>EDIT: here's the code of the SeekBar listener:</p>

<pre><code>@Override
public void onStopTrackingTouch(SeekBar seekBar) {}

@Override
public void onStartTrackingTouch(SeekBar seekBar) {
    mPreviewBuilder.set(CaptureRequest.CONTROL_AF_MODE, CameraMetadata.CONTROL_AF_MODE_OFF);
}

@Override
public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser) {
    float minimumLens = characteristics.get(CameraCharacteristics.LENS_INFO_MINIMUM_FOCUS_DISTANCE);
    float num = (((float)progress) * minimumLens / 100);
    mPreviewBuilder.set(CaptureRequest.LENS_FOCUS_DISTANCE, num);
}
</code></pre>
",7230462,,7230462,,2017-03-21 14:26:06,2017-08-08 15:35:36,Manual Focus using android camera2 API,<android><api><focus><android-camera2><lg>,2,0,2,
Android,32990275,1,35264164,,2015,,4,3851,"<p>there is no response after I typed adb -s emulator-5554 emu finger touch 1. 
this is reference link 
<a href=""https://github.com/googlesamples/android-FingerprintDialog/issues/2"" rel=""nofollow"">https://github.com/googlesamples/android-FingerprintDialog/issues/2</a></p>
",5417969,,,,,2017-09-06 15:19:02,how to register Fingerprint for Authentication on Nexus emulator,<emulation><nexus-5>,2,0,2,
Android,51781176,1,51788659,,2018,,5,1740,"<p>I have been using the <code>SingleLiveData</code> class which can be found <a href=""https://github.com/googlesamples/android-architecture/blob/dev-todo-mvvm-live/todoapp/app/src/main/java/com/example/android/architecture/blueprints/todoapp/SingleLiveEvent.java"" rel=""noreferrer"">here</a>.  My questions are:</p>

<ol>
<li><p>Is <code>SingleLiveData</code> is actually part of the Android Architecture Components?</p></li>
<li><p>Is it a good idea to use it?</p></li>
</ol>
",9291997,,139985,,2018-08-10 8:01:40,2019-03-16 15:50:59,Is SingleLiveEvent actually part of the Android Architecture Components Library?,<android><android-architecture-components><android-livedata><mutablelivedata>,2,1,2,
Android,50121501,1,,,2018,,6,472,"<h2>TL;DR</h2>

<p>How do I deal with Activities that actively change data (for example through an EditText)? Do I keep saving their state in the SavedInstanceState on rotation and only use the ViewModel when all of the fields are ready, or is there a way to make the ViewModel responsible for checking/holding/using the UI's data?</p>

<h2>Question</h2>

<p>I'm developing my application using Google's Arch. Components, and writing my latest class I've noticed I'm not really sure on what the best practice is when handling, say, data coming from an Activity form.</p>

<h2>Example</h2>

<p>I have a POJO made of title, description, location, type</p>

<p>I have an Activity with four EditText: <code>title_et</code>, <code>description_et</code>, <code>location_et</code>, <code>type_et</code>.</p>

<p>My ViewModel, through a Repository (irrelevant here), can send an object to the Database when the <code>sendObject</code> function is called.</p>

<h3>How I'm doing it now</h3>

<p>The activity has the <code>mTitle</code>, <code>mDescription</code>, <code>mLocation</code>, <code>mType</code>.
On rotation, the activity saves all of the EditText values in the <code>savedInstanceState</code> bundle, and it loads them again populating the views.</p>

<p>When the user wants to send the object, it clicks a button and the activity calls the function <code>viewModel.sendObject(mTitle, mDescription, mLocation, mType)</code> after the necessary checks.</p>

<h3>Problems with this approach</h3>

<p>The activity is responsible of holding/checking all the data of the EditTexts, basically making the ViewModel only responsible of interacting with the Repository.</p>

<h3>What I'd like to accomplish</h3>

<p>Ideally, I'd want to make the Activity only responsible of the UI, delegating everything to the ViewModel.</p>

<p>This way I could call <code>sendObject()</code> and the ViewModel would have already all of the data needed.</p>

<h3>The LiveData situation</h3>

<p>Right now the ViewModel has only one instance of LiveData, inside that there is a Resource (which is <a href=""https://developer.android.com/topic/libraries/architecture/guide#addendum"" rel=""noreferrer"">taken from here</a>) and it's used to ""tell"" the Activity that new data has arrived or an error occurred.</p>

<p>This approach works fine in all Activities that just receive data from the network and display them. What do I do when I want to synchronise data coming FROM the Activity? Do I use one LiveData for each field and use that to display potential errors?</p>

<p>I've read most of the <a href=""https://github.com/googlesamples/android-architecture-components"" rel=""noreferrer"">samples</a> but all of the Activities there are passive.</p>

<h2>Conclusion</h2>

<p>Thanks to anyone who takes the time to help.</p>
",8095850,,,,,2018-05-08 17:04:06,Handling input with Android Architecture Components,<android><mvvm><android-architecture-components>,2,0,2,
Android,42112519,1,42176567,,2017,,8,3263,"<p>I'm trying to disable multiple <code>Barcode</code> detection at time.
How to disable <code>MultiProcessor</code> using <code>Google Vision API</code>, I couldn't find any solution from official site <a href=""https://developers.google.com/vision/android/multi-tracker-tutorial"" rel=""noreferrer"">here</a></p>

<p>I have downloaded sample from <a href=""https://github.com/googlesamples/android-vision"" rel=""noreferrer"">here</a></p>

<p><strong>Code</strong>    </p>

<pre><code>BarcodeDetector barcodeDetector = new BarcodeDetector.Builder(context).build();
    BarcodeTrackerFactory barcodeFactory = new BarcodeTrackerFactory(mGraphicOverlay);
    barcodeDetector.setProcessor(
            new MultiProcessor.Builder&lt;&gt;(barcodeFactory).build());
</code></pre>

<p>Even if remove below line, I cannot detect at all.</p>

<pre><code> barcodeDetector.setProcessor(
        new MultiProcessor.Builder&lt;&gt;(barcodeFactory).build());
</code></pre>
",3251783,,3251783,,2017-02-08 12:33:16,2017-02-11 13:45:16,How to Disable multiple barcode detection android Vision API,<android><barcode-scanner><android-vision>,2,2,2,
Android,33763874,1,33923113,,2015,,8,1677,"<p>I'm testing Nearby connection API with the sample application available here: <a href=""https://github.com/googlesamples/android-nearby"">https://github.com/googlesamples/android-nearby</a>
It seems that this is not working for some devices. I successfully connected Samsung Galaxy S3 with Nexus 7, in both directions (S3 as host, N7 as slave and vice versa). However, when I try to connect Samusung Galaxy S3 to Nexus 5, the connection ALWAYS fails, with status code 8005. </p>

<p>Below you can see the method invoked by slave (discovering device) in order to connect to host (advertising device).</p>

<pre><code>private void connectTo(String endpointId, final String endpointName) {
    debugLog(""connectTo:"" + endpointId + "":"" + endpointName);

    // Send a connection request to a remote endpoint. By passing 'null' for the name,
    // the Nearby Connections API will construct a default name based on device model
    // such as 'LGE Nexus 5'.
    String myName = null;
    byte[] myPayload = null;
    Nearby.Connections.sendConnectionRequest(mGoogleApiClient, myName, endpointId, myPayload,
            new Connections.ConnectionResponseCallback() {
                @Override
                public void onConnectionResponse(String endpointId, Status status,
                                                 byte[] bytes) {
                    Log.d(TAG, ""onConnectionResponse:"" + endpointId + "":"" + status);
                    if (status.isSuccess()) {
                        debugLog(""onConnectionResponse: "" + endpointName + "" SUCCESS"");
                        Toast.makeText(MainActivity.this, ""Connected to "" + endpointName,
                                Toast.LENGTH_SHORT).show();

                        mOtherEndpointId = endpointId;
                        updateViewVisibility(STATE_CONNECTED);
                    } else {
                        debugLog(""onConnectionResponse: "" + endpointName + "" FAILURE. ResponseCode="" + status.getStatusCode() + "" statusMessage="" + status.getStatusMessage() );
                    }
                }
            }, this);
}
</code></pre>

<p>The result I always get is :<br>
11-17 18:48:50.678 11133-11133/com.google.example.connectionsquickstart D/MainActivity: onConnectionResponse: Samsung GT-I9300 FAILURE. ResponseCode=8005 statusMessage=null</p>

<p>Any clue what is going on?</p>
",229697,,,,,2015-11-25 17:55:35,Nearby connection API for Android - not working for some devices,<android><google-nearby>,2,0,2,
Android,32142463,1,32273525,,2015,,10,4336,"<p>This is first time I am using espresso intents, I followed <a href=""https://github.com/googlesamples/android-testing/tree/master/ui/espresso/IntentsBasicSample"" rel=""noreferrer"">IntentsBasicSamle</a> provided in the android-testing project but no solved.</p>

<p>In my app I have a activity where user selects multiple images and then returned images are shown in the gridview, Now by using the espresso intents I want to mock this without going to actual image picker and return some specified images everytime.</p>

<p>No error but still opens the image chooser window when I run the test. I feel I am doing it wrong but I am not getting how it works. </p>

<p>I am testing using apk.</p>

<p>This is how photo picker is called</p>

<p><strong>App code</strong></p>

<p>This is how I am calling select images Intent and result is handled in onActivityResult.</p>

<pre><code>if (ApiUtils.checkApiLevel(18)) {
        //API18+
        intent.putExtra(Intent.EXTRA_ALLOW_MULTIPLE, true);
    }
    intent.setAction(Intent.ACTION_GET_CONTENT);
    startActivityForResult(Intent.createChooser(intent,      getActivity().getString(R.string.fragment_image_selection_select_picture)), 1);
</code></pre>

<p><strong>Testing Code</strong></p>

<pre><code>@RunWith(AndroidJUnit4.class)
@LargeTest
public class ImagesTests {

private static final String LAUNCHER_ACTIVITY_FULL_CLASSNAME = ""com.company.recorder.RecorderActivity"";
private static Class&lt;? extends Activity&gt; activityClass;
private ServiceValidatorIdlingResource serviceValidatorIdlingResource;

static {
    try {
        activityClass = (Class&lt;? extends Activity&gt;) Class.forName(LAUNCHER_ACTIVITY_FULL_CLASSNAME);
    } catch (ClassNotFoundException e) {
        throw new RuntimeException(e);
    }
}

/**
 * Change espresso default view idling time
 * so that test can wait for long time
 */
@Before
public void registerWaitService() {
    EspressoSolo.setIdlingResourceTimeout(30);

    Instrumentation.ActivityResult result = createImageCaptureActivityResultStub();

    // Stub the Intent.
    intending(hasAction(Intent.ACTION_GET_CONTENT)).respondWith(result);

   //For API 18 and above
    intending(hasAction(Intent.EXTRA_ALLOW_MULTIPLE)).respondWith(result);

    //intending(not(isInternal())).respondWith(result);
}

private Instrumentation.ActivityResult createImageCaptureActivityResultStub() {
    // Put the drawable in a bundle.
    Bundle bundle = new Bundle();
    Uri imageUri = Uri.parse(ContentResolver.SCHEME_ANDROID_RESOURCE + ""://"" +
            InstrumentationRegistry.getTargetContext().getPackageName()+ '/' +
            InstrumentationRegistry.getTargetContext().getResources().getResourceTypeName(R.drawable.abc_ic_menu_copy_mtrl_am_alpha) + '/' +
            InstrumentationRegistry.getTargetContext().getResources().getResourceEntryName(R.drawable.abc_ic_menu_copy_mtrl_am_alpha) );

    Parcelable parcelable = (Parcelable)imageUri;

    ArrayList&lt;Parcelable&gt; parcels = new ArrayList&lt;&gt;();
    parcels.add(parcelable);

    bundle.putParcelableArrayList(Intent.EXTRA_STREAM, parcels);

    // Create the Intent that will include the bundle.
    Intent resultData = new Intent();
    resultData.putExtras(bundle);

    // Create the ActivityResult with the Intent.
    return new Instrumentation.ActivityResult(Activity.RESULT_OK, resultData);
}

@Rule
public IntentsTestRule&lt;?&gt; mIntentsRule = new IntentsTestRule&lt;&gt;(
        activityClass);


/**
 * In this test images are taken during the recording
 * add the images taken during the recording through add photos card
 * displayed after recording is stopped.
 *
 * @throws Exception
 */
@Test
public void testAddImagesFromPhotosCard() throws Exception {

    onView(withId(Recorder.getId(""recorderpage_record""))).perform(click());

    Log.d(""called"", ""other package"");
    IdlingResource idlingResource0 = new RecordingWaitIdlingResource(5000);
    Espresso.registerIdlingResources(idlingResource0);

    Log.d(""called"", ""other package"");
    onView(withId(Recorder.getId(""card_topText""))).perform(click());
    Espresso.unregisterIdlingResources(idlingResource0);
    onView(withId(Recorder.getId(""recorderpage_stop""))).perform(click());
    //Log.d(""called"", ""other package"");
    IdlingResource idlingResource2 = new RecordingWaitIdlingResource(2000);
    Espresso.registerIdlingResources(idlingResource2);
    onView(withId(Recorder.getId(""recorderpage_statustext"")))
            .perform(click());
    Espresso.unregisterIdlingResources(idlingResource2);

    onView(withId(Recorder.getId(""pager""))).perform(swipeLeft());

    onData(allOf()).onChildView(withId(Recorder.getId(""recordsOverflow""))).
            atPosition(0).perform(click());

    IdlingResource idlingResource3 = new RecordingWaitIdlingResource(2000);
    Espresso.registerIdlingResources(idlingResource3);
    onData(allOf()).onChildView(withId(Recorder.getId(""recordsOverflow""))).
            atPosition(0).perform(click());
    Espresso.unregisterIdlingResources(idlingResource3);
    onView(withText(""Add an image"")).perform(click());

    Instrumentation.ActivityResult result = createImageCaptureActivityResultStub();
    intending(toPackage(""com.android.documentsui"")).respondWith(result);

     /* I actually dont know which preinstalled app is opened by intent, I saw this com.android.documentsui, also tried with photos and gallery package names */

    intending(toPackage(""com.android.documentsui.DocumentsActivity"")).respondWith(result);

    intending(hasAction(Intent.ACTION_GET_CONTENT)).respondWith(result);

    //Now click on add images
    onView(withId(Recorder.getId(""menu_fragment_imagewizard_selection_add""))).perform(click());

    //Just waits for 2seconds
    IdlingResource idlingResource4 = new RecordingWaitIdlingResource(2000);
    Espresso.registerIdlingResources(idlingResource4);
    onView(withText(""Add images"")).perform(click());
    Espresso.unregisterIdlingResources(idlingResource4);

}
}
</code></pre>
",2765160,,2765160,,2015-08-24 10:00:43,2017-03-10 11:30:40,How to stub select images intent using Espresso intents?,<java><android><android-intent><android-testing><android-espresso>,2,0,2,
Android,47323883,1,47326971,,2017,,11,1537,"<p>I have been exploring <a href=""https://developer.android.com/training/data-storage/room/index.html"" rel=""noreferrer"">Room</a> database object mapping library and I figured something weird.</p>

<p>An entity data model cannot have immutable properties, as <a href=""https://stackoverflow.com/a/44213583/4620609"">this</a> answer suggests.</p>

<p>But I checked out <a href=""https://github.com/googlesamples/android-architecture-components/tree/master/BasicRxJavaSampleKotlin"" rel=""noreferrer"">google's persistent example with kotlin</a>, <code>Room</code> works with immutable properties too. Please check <a href=""https://github.com/googlesamples/android-architecture-components/blob/master/BasicRxJavaSampleKotlin/app/src/main/java/com/example/android/observability/persistence/User.kt"" rel=""noreferrer"">this</a> data class from the example.</p>

<p>What could be the reason for this behavior?</p>

<p>This could be a good feature if we could create immutable values (<code>val</code> properties), as this restrict programmers from changing unique identifiers such as ids after an object has been created.</p>
",4620609,,4620609,,2017-11-16 8:37:26,2018-01-16 17:47:04,Why Room entities don't work with immutable properties in Android,<android><sqlite><kotlin><immutability><android-room>,2,2,2,
Android,31154802,1,,,2015,,2,1918,"<p>I want to use <a href=""http://developer.android.com/training/location/geofencing.html"" rel=""nofollow noreferrer"">Geofencing location API</a> in my application to set certain Point of Interest. I have used <a href=""https://github.com/googlesamples/android-play-location/tree/master/Geofencing"" rel=""nofollow noreferrer"">this</a> demo provided by google. I am able to run this demo when WIFI and location services both are on. But this doesn't seem to work when only GPS is turned on. I am not able to get <a href=""http://developer.android.com/reference/com/google/android/gms/location/Geofence.html#GEOFENCE_TRANSITION_ENTER"" rel=""nofollow noreferrer"">GEOFENCE_TRANSITION_ENTER</a> or <a href=""https://developers.google.com/android/reference/com/google/android/gms/location/Geofence#GEOFENCE_TRANSITION_EXIT"" rel=""nofollow noreferrer"">GEOFENCE_TRANSITION_EXIT</a> events for that. I have modified the expiration time to <a href=""https://developers.google.com/android/reference/com/google/android/gms/location/Geofence#NEVER_EXPIRE"" rel=""nofollow noreferrer"">NEVER_EXPIRE</a>, but still no luck. Can anyone point out what I am doing wrong ? TIA.  </p>

<p>Edit: After following many sites, I finally managed to get the Geofence API working with <a href=""https://stackoverflow.com/a/23741825/1465910"">this code</a>. That is, Poll the GPS hardware on an interval without doing anything with the result. But now my question is that, is it the right way to do it ? Will google allow this once it's on Play store ? Please guide me on this topic. </p>
",1465910,,-1,,2017-05-23 12:01:40,2016-09-02 9:19:06,Geofencing with only GPS does not work in android,<android><gps><geolocation><geofencing><android-geofence>,3,0,2,
Android,43460985,1,,,2017,,2,4098,"<p>I'm working on some app using Android's Camera2 API. So far I've been able to get a preview displayed within a <code>TextureView</code>. The app is by default in landscape mode. When using the emulator the preview will appear upside-down. On my physical Nexus 5 the preview is <em>usually</em> displayed correctly (landscape, not upside-down), but occasionally it is rotated by 90 degrees, yet stretched to the dimensions of the screen.
I thought that should be easy and thought the following code would return the necessary information on the current orientation:</p>

<pre><code>// display rotation
getActivity().getWindowManager().getDefaultDisplay().getRotation();
// sensor orientation
mManager.getCameraCharacteristics(mCameraId).get(CameraCharacteristics.SENSOR_ORIENTATION);
</code></pre>

<p>... I was pretty surprised when I saw that above code <strong>always</strong> returned <code>1</code> for the display rotation and <code>90</code> for the sensor orientation, <em>regardless</em> of the preview being rotated by 90 degree or not. (Within the emulator sensor orientation is always 270 which kinda makes sense if I assume 90 to be the correct orientation).
I also checked the width and height within <code>onMeasure</code> within <a href=""https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/java/com/example/android/camera2basic/AutoFitTextureView.java"" rel=""nofollow noreferrer"">AutoMeasureTextureView</a> (adopted from <a href=""https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/java/com/example/android/camera2basic/Camera2BasicFragment.java"" rel=""nofollow noreferrer"">Android's Camera2 example</a>) that I'm using to create my TextureView. But no luck either - width and height reported from within <code>onMeasure</code> are always the same regardless of the preview rotation.
So I'm clueless on how to tackle this issue. Does anyone have an idea what could be the reason for the occasional hickups in my preview orientation?</p>

<p>[Edit]
A detail I just found out: Whenever the preview appears rotated <code>onSurfaceTextureSizeChanged</code> in the <code>TextureView.SurfaceTextureListener</code> seems not to get called. In the documentation for <code>onSurfaceTextureSizeChanged</code> it is said that this method is called whenever the <code>SurfaceTexture</code>'s buffers size is changed. I have a method <code>createCameraPreviewSession</code> (copied from Android's Camera2 example) in which I set the default buffer size of my texture like</p>

<pre><code>texture.setDefaultBufferSize(mPreviewSize.getWidth(), mPreviewSize.getHeight());
</code></pre>

<p>From my logging output I can tell that <code>onSurfaceTextureSizeChanged</code> is called exactly after that - however, not always... (or setting the default buffer size sometimes silently fails?).</p>
",2001687,,2001687,,2018-09-15 14:07:27,2018-09-15 14:07:27,Android Camera2 preview occasionally rotated by 90 degrees,<android><rotation><android-camera2>,3,0,2,
Android,35287835,1,35469813,,2016,,2,6762,"<p>I used this <a href=""https://github.com/googlesamples/android-vision"" rel=""nofollow"">android-vision project</a> to scan a barcode. When the camera detects the barcode, I am currently required to manually tap to capture it. But, I want to change the code a little bit so that it is captured automatically when the barcode is detected. How can I do this? This is my <code>BarcodeCaptureActivity</code> class: </p>

<pre><code>package com.example.fs.barcodescanner;

import android.Manifest;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.AlertDialog;
import android.app.Dialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.IntentFilter;
import android.content.pm.PackageManager;
import android.hardware.Camera;
import android.os.Build;
import android.os.Bundle;
import android.support.annotation.NonNull;
import android.support.design.widget.Snackbar;
import android.support.v4.app.ActivityCompat;
import android.support.v7.app.AppCompatActivity;
import android.util.Log;
import android.view.GestureDetector;
import android.view.MotionEvent;
import android.view.ScaleGestureDetector;
import android.view.View;
import android.view.WindowId;
import android.widget.Toast;

import com.example.fs.barcodescanner.ui.camera.CameraSource;
import com.example.fs.barcodescanner.ui.camera.CameraSourcePreview;
import com.example.fs.barcodescanner.ui.camera.GraphicOverlay;
import com.google.android.gms.common.ConnectionResult;
import com.google.android.gms.common.GoogleApiAvailability;
import com.google.android.gms.common.api.CommonStatusCodes;
import com.google.android.gms.vision.MultiProcessor;
import com.google.android.gms.vision.barcode.Barcode;
import com.google.android.gms.vision.barcode.BarcodeDetector;

import java.io.IOException;

public final class BarcodeCaptureActivity extends AppCompatActivity {
    private static final String TAG = ""Barcode-reader"";

    // intent request code to handle updating play services if needed.
    private static final int RC_HANDLE_GMS = 9001;

    // permission request codes need to be &lt; 256
    private static final int RC_HANDLE_CAMERA_PERM = 2;

    // constants used to pass extra data in the intent
    public static final String AutoFocus = ""AutoFocus"";
    public static final String UseFlash = ""UseFlash"";
    public static final String BarcodeObject = ""Barcode"";

    private CameraSource mCameraSource;
    private CameraSourcePreview mPreview;
    private GraphicOverlay&lt;BarcodeGraphic&gt; mGraphicOverlay;

    // helper objects for detecting taps and pinches.
    private ScaleGestureDetector scaleGestureDetector;
    private GestureDetector gestureDetector;
    private WindowId.FocusObserver fo;

    /**
     * Initializes the UI and creates the detector pipeline.
     */
    @Override
    public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.activity_barcode_capture);

        mPreview = (CameraSourcePreview) findViewById(R.id.preview);
        mGraphicOverlay = (GraphicOverlay&lt;BarcodeGraphic&gt;) findViewById(R.id.graphicOverlay);

        // read parameters from the intent used to launch the activity.
        boolean autoFocus = getIntent().getBooleanExtra(AutoFocus, false);
        boolean useFlash = getIntent().getBooleanExtra(UseFlash, false);

        // Check for the camera permission before accessing the camera.  If the
        // permission is not granted yet, request permission.
        int rc = ActivityCompat.checkSelfPermission(this, Manifest.permission.CAMERA);
        if (rc == PackageManager.PERMISSION_GRANTED) {
            createCameraSource(autoFocus, useFlash);
        } else {
            requestCameraPermission();
        }

        gestureDetector = new GestureDetector(this, new CaptureGestureListener());
        scaleGestureDetector = new ScaleGestureDetector(this, new ScaleListener());

        Snackbar.make(mGraphicOverlay, ""Tap to capture. Pinch/Stretch to zoom"",
                Snackbar.LENGTH_LONG)
                .show();
    }

    /**
     * Handles the requesting of the camera permission.  This includes
     * showing a ""Snackbar"" message of why the permission is needed then
     * sending the request.
     */
    private void requestCameraPermission() {
        Log.w(TAG, ""Camera permission is not granted. Requesting permission"");

        final String[] permissions = new String[]{Manifest.permission.CAMERA};

        if (!ActivityCompat.shouldShowRequestPermissionRationale(this,
                Manifest.permission.CAMERA)) {
            ActivityCompat.requestPermissions(this, permissions, RC_HANDLE_CAMERA_PERM);
            return;
        }

        final Activity thisActivity = this;

        View.OnClickListener listener = new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                ActivityCompat.requestPermissions(thisActivity, permissions,
                        RC_HANDLE_CAMERA_PERM);
            }
        };

        Snackbar.make(mGraphicOverlay, R.string.permission_camera_rationale,
                Snackbar.LENGTH_INDEFINITE)
                .setAction(R.string.ok, listener)
                .show();
    }

    @Override
    public boolean onTouchEvent(MotionEvent e) {
        boolean b = scaleGestureDetector.onTouchEvent(e);
        System.out.println(""scale gesture""+b);
        boolean c = gestureDetector.onTouchEvent(e);
        System.out.println(""tap gesture""+c);
        return b || c || super.onTouchEvent(e);
    }


    /**
     * Creates and starts the camera.  Note that this uses a higher resolution in comparison
     * to other detection examples to enable the barcode detector to detect small barcodes
     * at long distances.
     *
     * Suppressing InlinedApi since there is a check that the minimum version is met before using
     * the constant.
     */
    @SuppressLint(""InlinedApi"")
    private void createCameraSource(boolean autoFocus, boolean useFlash) {
        Context context = getApplicationContext();

        // A barcode detector is created to track barcodes.  An associated multi-processor instance
        // is set to receive the barcode detection results, track the barcodes, and maintain
        // graphics for each barcode on screen.  The factory is used by the multi-processor to
        // create a separate tracker instance for each barcode.
        BarcodeDetector barcodeDetector = new BarcodeDetector.Builder(context).build();
        BarcodeTrackerFactory barcodeFactory = new BarcodeTrackerFactory(mGraphicOverlay);
        barcodeDetector.setProcessor(
                new MultiProcessor.Builder&lt;&gt;(barcodeFactory).build());

        if (!barcodeDetector.isOperational()) {
            // Note: The first time that an app using the barcode or face API is installed on a
            // device, GMS will download a native libraries to the device in order to do detection.
            // Usually this completes before the app is run for the first time.  But if that
            // download has not yet completed, then the above call will not detect any barcodes
            // and/or faces.
            //
            // isOperational() can be used to check if the required native libraries are currently
            // available.  The detectors will automatically become operational once the library
            // downloads complete on device.
            Log.w(TAG, ""Detector dependencies are not yet available."");

            // Check for low storage.  If there is low storage, the native library will not be
            // downloaded, so detection will not become operational.
            IntentFilter lowstorageFilter = new IntentFilter(Intent.ACTION_DEVICE_STORAGE_LOW);
            boolean hasLowStorage = registerReceiver(null, lowstorageFilter) != null;

            if (hasLowStorage) {
                Toast.makeText(this, R.string.low_storage_error, Toast.LENGTH_LONG).show();
                Log.w(TAG, getString(R.string.low_storage_error));
            }
        }

        // Creates and starts the camera.  Note that this uses a higher resolution in comparison
        // to other detection examples to enable the barcode detector to detect small barcodes
        // at long distances.
        CameraSource.Builder builder = new CameraSource.Builder(getApplicationContext(), barcodeDetector)
                .setFacing(CameraSource.CAMERA_FACING_BACK)
                .setRequestedPreviewSize(1600, 1024)
                .setRequestedFps(15.0f);

        // make sure that auto focus is an available option
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.ICE_CREAM_SANDWICH) {
            builder = builder.setFocusMode(
                    autoFocus ? Camera.Parameters.FOCUS_MODE_CONTINUOUS_PICTURE : null);
        }

        mCameraSource = builder
                .setFlashMode(useFlash ? Camera.Parameters.FLASH_MODE_TORCH : null)
                .build();
    }

    /**
     * Restarts the camera.
     */
    @Override
    protected void onResume() {
        super.onResume();
        startCameraSource();
    }

    /**
     * Stops the camera.
     */
    @Override
    protected void onPause() {
        super.onPause();
        if (mPreview != null) {
            mPreview.stop();
        }
    }

    /**
     * Releases the resources associated with the camera source, the associated detectors, and the
     * rest of the processing pipeline.
     */
    @Override
    protected void onDestroy() {
        super.onDestroy();
        if (mPreview != null) {
            mPreview.release();
        }
    }

    /**
     * Callback for the result from requesting permissions. This method
     * is invoked for every call on {@link #requestPermissions(String[], int)}.
     * &lt;p&gt;
     * &lt;strong&gt;Note:&lt;/strong&gt; It is possible that the permissions request interaction
     * with the user is interrupted. In this case you will receive empty permissions
     * and results arrays which should be treated as a cancellation.
     * &lt;/p&gt;
     *
     * @param requestCode  The request code passed in {@link #requestPermissions(String[], int)}.
     * @param permissions  The requested permissions. Never null.
     * @param grantResults The grant results for the corresponding permissions
     *                     which is either {@link PackageManager#PERMISSION_GRANTED}
     *                     or {@link PackageManager#PERMISSION_DENIED}. Never null.
     * @see #requestPermissions(String[], int)
     */
    @Override
    public void onRequestPermissionsResult(int requestCode,
                                           @NonNull String[] permissions,
                                           @NonNull int[] grantResults) {
        if (requestCode != RC_HANDLE_CAMERA_PERM) {
            Log.d(TAG, ""Got unexpected permission result: "" + requestCode);
            super.onRequestPermissionsResult(requestCode, permissions, grantResults);
            return;
        }

        if (grantResults.length != 0 &amp;&amp; grantResults[0] == PackageManager.PERMISSION_GRANTED) {
            Log.d(TAG, ""Camera permission granted - initialize the camera source"");
            // we have permission, so create the camerasource
            boolean autoFocus = getIntent().getBooleanExtra(AutoFocus,false);
            boolean useFlash = getIntent().getBooleanExtra(UseFlash, false);
            createCameraSource(autoFocus, useFlash);
            return;
        }

        Log.e(TAG, ""Permission not granted: results len = "" + grantResults.length +
                "" Result code = "" + (grantResults.length &gt; 0 ? grantResults[0] : ""(empty)""));

        DialogInterface.OnClickListener listener = new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int id) {
                finish();
            }
        };

        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setTitle(""Multitracker sample"")
                .setMessage(R.string.no_camera_permission)
                .setPositiveButton(R.string.ok, listener)
                .show();
    }

    /**
     * Starts or restarts the camera source, if it exists.  If the camera source doesn't exist yet
     * (e.g., because onResume was called before the camera source was created), this will be called
     * again when the camera source is created.
     */
    private void startCameraSource() throws SecurityException {
        // check that the device has play services available.
        int code = GoogleApiAvailability.getInstance().isGooglePlayServicesAvailable(
                getApplicationContext());
        if (code != ConnectionResult.SUCCESS) {
            Dialog dlg =
                    GoogleApiAvailability.getInstance().getErrorDialog(this, code, RC_HANDLE_GMS);
            dlg.show();
        }

        if (mCameraSource != null) {
            try {
                mPreview.start(mCameraSource, mGraphicOverlay);
            } catch (IOException e) {
                Log.e(TAG, ""Unable to start camera source."", e);
                mCameraSource.release();
                mCameraSource = null;
            }
        }
    }

    /**
     * onTap is called to capture the oldest barcode currently detected and
     * return it to the caller.
     *
     * @param rawX - the raw position of the tap
     * @param rawY - the raw position of the tap.
     * @return true if the activity is ending.
     */
    private boolean onTap(float rawX, float rawY) {

        //TODO: use the tap position to select the barcode.
        BarcodeGraphic graphic = mGraphicOverlay.getFirstGraphic();
        Barcode barcode = null;
        if (graphic != null) {
            barcode = graphic.getBarcode();
            if (barcode != null) {
                Intent data = new Intent();
                data.putExtra(BarcodeObject, barcode);
                setResult(CommonStatusCodes.SUCCESS, data);
                finish();
            }
            else {
                Log.d(TAG, ""barcode data is null"");
            }
        }
        else {
            Log.d(TAG,""no barcode detected"");
        }
        return barcode != null;
    }

    private class CaptureGestureListener extends GestureDetector.SimpleOnGestureListener {

        @Override
        public boolean onSingleTapConfirmed(MotionEvent e) {
            System.out.println(e.getRawX());
            System.out.println(e.getRawY());
            return onTap(e.getRawX(), e.getRawY()) || super.onSingleTapConfirmed(e);
        }
    }

    private class ScaleListener implements ScaleGestureDetector.OnScaleGestureListener {

        /**
         * Responds to scaling events for a gesture in progress.
         * Reported by pointer motion.
         *
         * @param detector The detector reporting the event - use this to
         *                 retrieve extended info about event state.
         * @return Whether or not the detector should consider this event
         * as handled. If an event was not handled, the detector
         * will continue to accumulate movement until an event is
         * handled. This can be useful if an application, for example,
         * only wants to update scaling factors if the change is
         * greater than 0.01.
         */
        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            return false;
        }

        /**
         * Responds to the beginning of a scaling gesture. Reported by
         * new pointers going down.
         *
         * @param detector The detector reporting the event - use this to
         *                 retrieve extended info about event state.
         * @return Whether or not the detector should continue recognizing
         * this gesture. For example, if a gesture is beginning
         * with a focal point outside of a region where it makes
         * sense, onScaleBegin() may return false to ignore the
         * rest of the gesture.
         */
        @Override
        public boolean onScaleBegin(ScaleGestureDetector detector) {
            return true;
        }

        /**
         * Responds to the end of a scale gesture. Reported by existing
         * pointers going up.
         * &lt;p/&gt;
         * Once a scale has ended, {@link ScaleGestureDetector#getFocusX()}
         * and {@link ScaleGestureDetector#getFocusY()} will return focal point
         * of the pointers remaining on the screen.
         *
         * @param detector The detector reporting the event - use this to
         *                 retrieve extended info about event state.
         */
        @Override
        public void onScaleEnd(ScaleGestureDetector detector) {
            mCameraSource.doZoom(detector.getScaleFactor());
        }
    }
}
</code></pre>
",4697260,,5350328,,2016-02-09 9:38:12,2017-03-21 16:10:49,Detect and capture barcode automatically when it is read by camera,<android>,3,2,2,
Android,32603382,1,32618529,,2015,,3,1556,"<p>I am trying to run <a href=""https://code.google.com/p/android-test-kit/"" rel=""nofollow"">Espresso</a> tests for an Android app. It works fine on a hardware device. When I run it on a freshly created <strong>AVD emulator</strong> it <strong>fails</strong> as shown here:</p>

<pre><code>:ExampleApp:connectedDebugAndroidTest

com.example.MainFragmentTest &gt; initializationError[Nexus_5_API_19(AVD) - 4.4.2] 
FAILED 
    java.lang.NoClassDefFoundError: com/example/MainActivity
    at java.lang.Class.getDeclaredFields(Native Method)
:ExampleApp:connectedDebugAndroidTest FAILED

FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':ExampleApp:connectedDebugAndroidTest'.
&gt; There were failing tests. See the report at: 
file:///home/user/work/ExampleApp/build/reports/androidTests/connected/index.html
</code></pre>

<p>The HTML report contains the following stacktrace:</p>

<pre><code>java.lang.NoClassDefFoundError: com/example/MainActivity
at java.lang.Class.getDeclaredFields(Native Method)
at java.lang.Class.getDeclaredFields(Class.java:610)
at org.junit.runners.model.TestClass.getSortedDeclaredFields(TestClass.java:77)
at org.junit.runners.model.TestClass.scanAnnotatedMembers(TestClass.java:70)
at org.junit.runners.model.TestClass.&lt;init&gt;(TestClass.java:57)
at org.junit.runners.ParentRunner.createTestClass(ParentRunner.java:88)
at org.junit.runners.ParentRunner.&lt;init&gt;(ParentRunner.java:83)
at org.junit.runners.BlockJUnit4ClassRunner.&lt;init&gt;(BlockJUnit4ClassRunner.java:65)
at android.support.test.internal.runner.junit4.AndroidJUnit4ClassRunner.&lt;init&gt;(AndroidJUnit4ClassRunner.java:38)
at android.support.test.runner.AndroidJUnit4.&lt;init&gt;(AndroidJUnit4.java:36)
at java.lang.reflect.Constructor.constructNative(Native Method)
at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
at android.support.test.internal.runner.junit4.AndroidAnnotatedBuilder.buildAndroidRunner(AndroidAnnotatedBuilder.java:57)
at android.support.test.internal.runner.junit4.AndroidAnnotatedBuilder.runnerForClass(AndroidAnnotatedBuilder.java:45)
at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:59)
at org.junit.internal.builders.AllDefaultPossibilitiesBuilder.runnerForClass(AllDefaultPossibilitiesBuilder.java:26)
at org.junit.runner.Computer.getRunner(Computer.java:40)
at org.junit.runner.Computer$1.runnerForClass(Computer.java:31)
at org.junit.runners.model.RunnerBuilder.safeRunnerForClass(RunnerBuilder.java:59)
at org.junit.runners.model.RunnerBuilder.runners(RunnerBuilder.java:101)
at org.junit.runners.model.RunnerBuilder.runners(RunnerBuilder.java:87)
at org.junit.runners.Suite.&lt;init&gt;(Suite.java:81)
at org.junit.runner.Computer.getSuite(Computer.java:28)
at android.support.test.internal.runner.TestRequestBuilder.classes(TestRequestBuilder.java:701)
at android.support.test.internal.runner.TestRequestBuilder.build(TestRequestBuilder.java:664)
at android.support.test.runner.AndroidJUnitRunner.buildRequest(AndroidJUnitRunner.java:329)
at android.support.test.runner.AndroidJUnitRunner.onStart(AndroidJUnitRunner.java:226)
at android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:1701)

Caused by: java.lang.ClassNotFoundException: Didn't find class 
  ""com.example.MainActivity"" on path: DexPathList[[zip file 
  ""/system/framework/android.test.runner.jar"", zip file 
  ""/data/app/com.example.debug.test-1.apk"", zip file 
  ""/data/app/com.example.debug-1.apk""],
  nativeLibraryDirectories=[/data/app-lib/com.example.debug.test-1, 
  /data/app-lib/com.example.debug-1, /vendor/lib, /system/lib]]
at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:56)
at java.lang.ClassLoader.loadClass(ClassLoader.java:497)
at java.lang.ClassLoader.loadClass(ClassLoader.java:457)
... 28 more
</code></pre>

<p>I am basically following the structure in <a href=""https://github.com/googlesamples/android-testing/blob/master/ui/espresso/BasicSample/app/src/androidTest/java/com/example/android/testing/espresso/BasicSample/ChangeTextBehaviorTest.java"" rel=""nofollow"">espresso/BasicSample/ChangeTextBehaviorTest.java</a>. This test <strong>works</strong> on the emulator!</p>

<p>For my test I could boil it down that running the test already <strong>fails</strong> when I just use the following code:</p>

<pre><code>@RunWith(AndroidJUnit4.class)
public class MainFragmentTest {

    @Rule
    public ActivityTestRule&lt;MainActivity&gt; mActivityRule = 
        new ActivityTestRule&lt;&gt;(MainActivity.class);    
}
</code></pre>

<p>Here is the complete test class:</p>

<pre><code>import org.junit.Before;
import org.junit.Rule;
import org.junit.Test;
import org.junit.runner.RunWith;

import android.support.test.rule.ActivityTestRule;
import android.support.test.runner.AndroidJUnit4;

import com.example.R;

import static android.support.test.espresso.Espresso.onView;
import static android.support.test.espresso.assertion.ViewAssertions.matches;
import static android.support.test.espresso.matcher.ViewMatchers.withId;
import static android.support.test.espresso.matcher.ViewMatchers.withText;

@RunWith(AndroidJUnit4.class)
public class MainFragmentTest {

    @Rule
    public ActivityTestRule&lt;MainActivity&gt; mActivityRule = 
        new ActivityTestRule&lt;&gt;(MainActivity.class);

    MainActivity mMainActivity;

    MainFragment mMainFragment;

    @Before
    public void setUp() {
        mMainActivity = mActivityRule.getActivity();
        mMainFragment = (MainFragment) mMainActivity
                .getSupportFragmentManager()
                .findFragmentByTag(MainFragment.FRAGMENT_TAG);
    }

    @Test
    public void testHeadline() {
        onView(withId(R.id.headline)).check(matches(withText(R.string.headline)));
    }
}
</code></pre>

<p>I am currently using the following tool chain:</p>

<ul>
<li>com.android.tools.build:gradle:1.4.0-beta2</li>
<li>buildToolsVersion ""23.0.1""</li>
<li>compileSdkVersion 22</li>
<li>targetSdkVersion 22</li>
<li>Gradle wrapper 2.5</li>
<li>java version ""1.7.0_79"" OpenJDK</li>
</ul>
",356895,,356895,,2015-09-16 9:14:31,2015-11-27 8:36:58,NoClassDefFoundError when running Gradle connectedCheck on AVD emulator,<android><android-emulator><android-testing><android-espresso><avd>,3,0,2,
Android,28355353,1,28532785,,2015,,4,2995,"<p>My main requirement would be to have a service having its own process and trigger its own geofencing event. I'd like the user to be notified from the notification center when he enters a geofence, even if the app is killed.</p>

<p>I read about services and this seems pretty clear to me, the Android documentation is dense so I managed to understand how to start a service with its own process, and also how it is able to communicate with the app using Messenger.</p>

<p>Then there is this code sample from Google showing how to use geofencing with google play services:
<a href=""https://github.com/googlesamples/android-Geofencing"" rel=""nofollow"">Google samples geofencing</a></p>

<p>What I found so far is that we have to use an IntentService to trigger geofencing events, and from the docs I've read it states that an IntentService terminates itself when its work is done. And I tested a bit also, it looks like the Intentservice gets killed when the app gets killed, which doesn't surprise me regarding the documentation.</p>

<p>So my question is, how could we perform a geofencing service having its own process? Is that possible to avoid using IntentService for this matter?</p>

<p><strong>EDIT:</strong></p>

<p>The reason I wanna do this, is that the user can set geofence ""reminders"", it is based on a daily usage. For instance imagine each day you arrive at your workplace, we should be able to fire an alarm (or a notification) when we enter this geofence regarding the app is running or not. We don't want the user to worry about having the app running in background.</p>
",1763767,,1763767,,2015-02-06 9:19:41,2015-04-17 14:37:35,Android geofencing when app is killed,<android><service><android-service><geofencing><android-geofence>,3,3,2,
Android,48094952,1,48095129,,2018,,5,2615,"<p>I am trying to implement a camera app. and checking examples. Some examples contain following manifest feature: <code>uses-feature android:name=""android.hardware.camera2.full</code>.
I have checked official documents and google examples and none of them mentioning existing this feature. (or I am missing some).</p>

<p>What is the source of this feature and what is the difference between <code>android.hardware.camera</code>?</p>

<hr>

<p>Edit:
What confuses me was those examples on <code>googlesamples</code>:</p>

<p><a href=""https://github.com/googlesamples/android-Camera2Basic/blob/master/kotlinApp/Application/src/main/AndroidManifest.xml"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-Camera2Basic/blob/master/kotlinApp/Application/src/main/AndroidManifest.xml</a></p>

<p>and this</p>

<p><a href=""https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/AndroidManifest.xml"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/AndroidManifest.xml</a></p>

<p>and this</p>

<p><a href=""https://github.com/googlesamples/android-Camera2Raw/blob/master/Application/src/main/AndroidManifest.xml"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-Camera2Raw/blob/master/Application/src/main/AndroidManifest.xml</a></p>

<p>They are using new <code>Camera2</code> API and old manifest <code>features</code>. I don't know how both fits together.</p>
",1281930,,,user8389458,2018-04-21 22:15:45,2018-04-21 22:15:45,Where does android.hardware.camera2.full come from?,<android><android-camera><android-camera2>,3,3,2,
Android,37483049,1,46002017,,2016,,6,4907,"<p>I am trying to use PdfRenderer, and the requirement is to have Zoom and scroll available with it, but in Android PdfRenderer do not provide any support for Zoom and scroll, there is only page navigation support available.</p>

<p>But i guess zoom and scroll support can be implemented as PdfRenderer uses bitmap to show the content using imageview.</p>

<blockquote>
  <p>How to implement Zoom and Scroll support with Google PdfRenderer
  sample?</p>
</blockquote>

<p>PS: I am using this PdfRenderer sample provided by Google, <a href=""https://github.com/googlesamples/android-PdfRendererBasic"" rel=""noreferrer"">https://github.com/googlesamples/android-PdfRendererBasic</a></p>
",1791546,,1791546,,2016-07-01 10:24:51,2018-01-09 15:06:40,How to implement PdfRenderer Zoom and Scroll support?,<java><android><pdfrenderer>,3,0,2,
Android,38535355,1,,,2016,,10,3877,"<p>I have been working with the <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""noreferrer"">camera2 api demo from google</a> and unfortunately the sample application is built to display the textureview preview at approximately 70% of the screen height, after looking around I was able to determine that this was being caused by the AutoFitTextureView overriding the <code>onMeasure()</code> method as shown below:</p>

<pre><code>@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    int width = MeasureSpec.getSize(widthMeasureSpec);
    int height = MeasureSpec.getSize(heightMeasureSpec);
    if (0 == mRatioWidth || 0 == mRatioHeight) {
        setMeasuredDimension(width, height);
    } else {
        if (width &lt; height * mRatioWidth / mRatioHeight) {
            setMeasuredDimension(width, width * mRatioHeight / mRatioWidth);
        } else {
            setMeasuredDimension(height * mRatioWidth / mRatioHeight, height);
        }
    }
}
</code></pre>

<p>I attempted to correct this by setting the correct heights and widths in <code>setMeasuredDimension(width, height);</code>, this fixed the height issue and gave me a full screen preview from the textureview, however the aspect ratio is completely broken and warped on every device, what is the standard way of fixing this? I see many apps on the play store have found a way to solve this problem but havent been able to track down a fix, any help will go a long way, thanks.</p>
",793197,,,,,2017-08-17 15:12:59,android textureview full screen preview with correct aspect ratio,<java><android><android-camera><android-camera2><android-textureview>,3,2,2,
Android,33851794,1,33851850,,2015,,12,1394,"<p>In Google's in-app billing Trivial Drive sample, a <code>BroadcastReceiver</code> is registered to listen for messages about updated purchases, after the IabHelper setup has successfully completed.  </p>

<p>The author however has included the following note:</p>

<blockquote>
  <p>Note: registering this listener in an Activity is a bad idea, but is done here 
  because this is a SAMPLE.</p>
</blockquote>

<p>Why is this a bad idea for this listener?</p>

<p>This comment can be found in the <code>OnIabSetupFinishedListener</code> definition in the <code>onCreate</code> method of <a href=""https://github.com/googlesamples/android-play-billing/blob/master/TrivialDrive/app/src/main/java/com/example/android/trivialdrivesample/MainActivity.java""><code>MainActivity</code></a> in the <a href=""https://github.com/googlesamples/android-play-billing/tree/master/TrivialDrive"">source code for the Trivial Drive sample</a></p>
",2598349,,,,,2016-07-21 6:02:09,Why is registering IabBroadcastReceiver in Activity a bad idea?,<android>,3,1,2,
Android,32051973,1,32051974,,2015,,12,16099,"<p>I have checkout out the latest Google Vision APIs from here:</p>

<p><a href=""https://github.com/googlesamples/android-vision"" rel=""noreferrer"">https://github.com/googlesamples/android-vision</a></p>

<p>And I am running it on a LG G2 device with KitKat. The only change I have made is to the minSdkVerion in the Gradle file:</p>

<pre><code>...
defaultConfig {
    applicationId ""com.google.android.gms.samples.vision.face.multitracker""
    minSdkVersion 19
...
</code></pre>

<p>However it does not focus. How do I make it focus?</p>
",932052,,379726,,2015-09-28 9:31:22,2018-06-08 9:57:34,Google Vision API Samples: Get the CameraSource to Focus,<android><camera><google-play-services><google-vision><android-vision>,3,0,2,
Android,53573731,1,53764393,,2018,,12,364,"<p>We try to update <code>sqlite_sequence</code> with the following code.</p>

<pre><code>WeNoteRoomDatabase weNoteRoomDatabase = WeNoteRoomDatabase.instance();
weNoteRoomDatabase.query(new SimpleSQLiteQuery(""UPDATE sqlite_sequence SET seq = 0 WHERE name = 'attachment'""));
</code></pre>

<p>However, it has no effect at all. I exam the <code>sqlite_sequence</code> table content using SQLite browser. The counter is not reset to 0.</p>

<p>If we try to run the same query manually using SQLite browser on same SQLite file, it works just fine.</p>

<p>Our Room database is pretty straightforward.</p>

<pre><code>@Database(
    entities = {Attachment.class},
    version = 6
)
public abstract class WeNoteRoomDatabase extends RoomDatabase {
    private volatile static WeNoteRoomDatabase INSTANCE;

    private static final String NAME = ""wenote"";

    public abstract AttachmentDao attachmentDao();

    public static WeNoteRoomDatabase instance() {
        if (INSTANCE == null) {
            synchronized (WeNoteRoomDatabase.class) {
                if (INSTANCE == null) {
                    INSTANCE = Room.databaseBuilder(
                        WeNoteApplication.instance(),
                        WeNoteRoomDatabase.class,
                        NAME
                    )
                        .build();
                }
            }
        }

        return INSTANCE;
    }
}
</code></pre>

<p>Any idea what we had missed out?</p>

<hr>

<p>Additional information : <a href=""https://github.com/googlesamples/android-architecture-components/issues/330"" rel=""noreferrer"">clearing sqlite_sequence is not working in android room</a></p>
",72437,,72437,,2018-12-02 8:28:35,2018-12-14 16:24:33,Not able to update sqlite_sequence table using RoomDatabase.query,<android><android-room>,3,7,2,
Android,42054221,1,42152545,,2017,,27,1174,"<p>I have an android application that performs image analysis, which is managed with an <code>IntentService</code> - the process takes a couple of seconds each time and works accurately and quickly. </p>

<p>But when the process is repeated in the app around 50 times (as illustrated) it begins to get very slow until the point in which the app and device becomes unusable. When the device is restarted and app opens again it runs as usual.</p>

<p>Inspecting with Android Studio I can see that each time I run the analysis that the memory allocation for the app goes up and up every time by around <em>1MB</em>. So it is clearly running out of memory when it crashes.</p>

<p>I have used this flag on finishing the analysis and going to the result to try fix background activities;</p>

<pre><code>intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);
</code></pre>

<p>which has had minimal effect, and I understand the IntentService manages itself shutting down. So not sure what else I can do to try and reduce the memory allocation or at least clear down allocation and stop adding to it?</p>

<p><a href=""https://i.stack.imgur.com/S12aw.png""><img src=""https://i.stack.imgur.com/S12aw.png"" alt=""Image Analysis Workflow""></a></p>

<p>Further details:</p>

<ul>
<li>The application is using the camera implementation based on <a href=""https://github.com/googlesamples/android-Camera2Basic"">Google Camera2</a></li>
<li>The analysis is done with a C++ library through the IntentService</li>
</ul>
",1887939,,,,,2017-02-14 22:10:20,Memory allocation problems with android application,<java><android><android-camera2>,4,7,2,
Android,49832787,1,52724308,,2018,,1,1264,"<p>Is it possible to prevent LiveData receive the last value when start observing?
I am considering to use LiveData as events.</p>

<p>For example events like show message, a navigation event or a dialog trigger, similar to EventBus.</p>

<p>I found something similar <a href=""https://github.com/googlesamples/android-architecture/blob/dev-todo-mvvm-live/todoapp/app/src/main/java/com/example/android/architecture/blueprints/todoapp/SingleLiveEvent.java"" rel=""nofollow noreferrer"">SingleLiveEvent</a> - but it work only for 1 observer and not for multiple observers.</p>
",5827565,,5827565,,2019-02-08 23:34:16,2019-03-17 23:00:43,Android LiveData prevent receive the last value when subscribe,<android><android-architecture-components><android-livedata><mutablelivedata>,5,5,2,
Android,31188849,1,31191045,,2015,,3,3785,"<p>No matter what projects I import they never work - Android Studio is always flagging <code>this is not a Gradle build project</code>.</p>

<p>I select <code>VCS -&gt; GIT</code> and clone the repo without any problem. I then go through the wizard with no issues (I select <code>create project from existing sources</code>), creating my code base with a warning, below.  When i try to run throws all sorts of errors.</p>

<blockquote>
  <p>Migrate Project to Gradle? This project does not use the Gradle build
  system. We recommend that you migrate to using the Gradle build
  system. More Information about migrating to Gradle.</p>
  
  <p>Don't show this message again.</p>
</blockquote>

<p>When I go to the link it makes no sense whatever to me, it says to create an arbitrary Gradle file and populate it with my references (I think), which is out of my understanding. I shouldnt have to do this as it says in the repository instructions that it is in fact a Gradle-based project.</p>

<p>The project I am trying to clone is
<a href=""https://github.com/googlesamples/android-play-location.git"" rel=""nofollow"">https://github.com/googlesamples/android-play-location.git</a></p>

<p>Can anybody tell me specifically how to import and run the following git repo in Android studio for example?</p>
",510981,,130659,,2015-07-03 10:04:20,2018-09-20 3:42:17,Android Studio not recognising Gradle projects,<android><android-studio><gradle>,5,0,2,
Android,49833533,1,50061778,,2018,,5,3301,"<p>I'm currently writing some UI unit tests for a fragment, and one of these <code>@Test</code> is to see if a list of objects is correctly displayed, this is <strong>not an integration</strong> test, therefore I wish to <strong>mock</strong> the <code>ViewModel</code>.</p>

<p>The fragment's vars:</p>

<pre><code>class FavoritesFragment : Fragment() {

    private lateinit var adapter: FavoritesAdapter
    private lateinit var viewModel: FavoritesViewModel
    @Inject lateinit var viewModelFactory: FavoritesViewModelFactory

    (...)
</code></pre>

<p>Here's the code:</p>

<pre><code>@MediumTest
@RunWith(AndroidJUnit4::class)
class FavoritesFragmentTest {

    @Rule @JvmField val activityRule = ActivityTestRule(TestFragmentActivity::class.java, true, true)
    @Rule @JvmField val instantTaskExecutorRule = InstantTaskExecutorRule()

    private val results = MutableLiveData&lt;Resource&lt;List&lt;FavoriteView&gt;&gt;&gt;()
    private val viewModel = mock(FavoritesViewModel::class.java)

    private lateinit var favoritesFragment: FavoritesFragment

    @Before
    fun setup() {
        favoritesFragment = FavoritesFragment.newInstance()
        activityRule.activity.addFragment(favoritesFragment)
        `when`(viewModel.getFavourites()).thenReturn(results)
    }

    (...)

    // This is the initial part of the test where I intend to push to the view
    @Test
    fun whenDataComesInItIsCorrectlyDisplayedOnTheList() {
        val resultsList = TestFactoryFavoriteView.generateFavoriteViewList()
        results.postValue(Resource.success(resultsList))

        (...)
    }
</code></pre>

<p>I was able to mock the <code>ViewModel</code> but of course, that's not the same <code>ViewModel</code> created inside the <code>Fragment</code>.</p>

<p>So my question really, has someone done this successfully or has some pointers/references that might help me out?</p>

<ul>
<li><p>Also, I've tried looking into the <a href=""https://github.com/googlesamples/android-architecture-components"" rel=""noreferrer"">google-samples</a> but with no luck.</p></li>
<li><p><strong>For reference, the project can be found here:</strong> <a href=""https://github.com/JoaquimLey/transport-eta/"" rel=""noreferrer"">https://github.com/JoaquimLey/transport-eta/</a></p></li>
</ul>
",3374428,,3374428,,2018-04-27 7:47:08,2018-08-10 12:47:04,How to correctly mock ViewModel on androidTest,<android><kotlin><mockito><android-espresso><android-architecture-components>,5,0,2,
Android,53865978,1,,,2018,,7,2071,"<p>I've implemented the <code>SMS Retriever API</code> like in the google tutorials and in my debug Build Variant work fine. I can read the sms and get the code to the user can do the login. </p>

<p>My problem is when I run the app in release Build Variant the sms it doesn't work. I receive the sms but I can't read the code to do the login.</p>

<p>I change the hash generated with <a href=""https://github.com/googlesamples/android-credentials/blob/master/sms-verification/android/app/src/main/java/com/google/samples/smartlock/sms_verify/AppSignatureHelper.java"" rel=""nofollow noreferrer"">AppSignatureHelper </a> in release mode that is differente than in the debug mode. In debug work and in release no.</p>

<p>Some help will be appreciate</p>

<p>The code:</p>

<p><strong>Manifest:</strong></p>

<pre><code>   &lt;receiver android:name="".app.receivers.SmsReceiver""&gt;
        &lt;intent-filter&gt;
            &lt;action android:name=""com.google.android.gms.auth.api.phone.SMS_RETRIEVED""/&gt;
        &lt;/intent-filter&gt;
    &lt;/receiver&gt;
</code></pre>

<p>In my class: (In release and in debug mode the code go throw the onSucess method) This method is called in <strong>onCreate</strong>.</p>

<pre><code>private void startSMSListening(){
    SmsRetrieverClient client = SmsRetriever.getClient(this);
    Task&lt;Void&gt; task = client.startSmsRetriever();

    task.addOnSuccessListener(new OnSuccessListener&lt;Void&gt;() {
        @Override
        public void onSuccess(Void aVoid) {
            // Successfully started retriever, expect broadcast intent
            Log.e(""startSMSListening"", ""listening sms"");
            sendCode();
            showHideLoadingView(false);
        }
    });

    task.addOnFailureListener(new OnFailureListener() {
        @Override
        public void onFailure(@NonNull Exception e) {
            // Failed to start retriever, inspect Exception for more details
            Log.e(""startSMSListening"", ""failure listening sms"");
            showHideLoadingView(false);
        }
    });
}
</code></pre>

<p><strong>My receiver:</strong></p>

<pre><code>public class SmsReceiver extends BroadcastReceiver {
    //interface
    private static SmsListener mListener;

    @Override
    public void onReceive(Context context, Intent intent) {
        if (SmsRetriever.SMS_RETRIEVED_ACTION.equals(intent.getAction())) {
            Bundle extras = intent.getExtras();
            if(extras != null) {
                Status status = (Status) extras.get(SmsRetriever.EXTRA_STATUS);

                if(status != null) {
                    switch (status.getStatusCode()) {
                        case CommonStatusCodes.SUCCESS:
                            // Get SMS message contents
                            String message = (String) extras.get(SmsRetriever.EXTRA_SMS_MESSAGE);
                            //Pass the message text to interface
                            if (mListener != null &amp;&amp; !StringUtil.isNull(message)) {
                                mListener.messageReceived(message);
                            }
                            break;
                        case CommonStatusCodes.TIMEOUT:
                            Log.d(""SMSReceiver"", ""timed out (5 minutes)"");
                            break;
                    }
                }
            }
        }
    }

    public static void bindListener(SmsListener listener) {
        mListener = listener;
    }
}
</code></pre>

<p><strong>My smsReceiver method:</strong></p>

<pre><code>private void smsReceiver(){
        SmsReceiver.bindListener(new SmsListener() {
            @Override
            public void messageReceived(String messageText) {
                //From the received text string you may do string operations to get the required OTP
                //It depends on your SMS format
                Log.e(""Message"",messageText);

                // If your OTP is six digits number, you may use the below code
                Pattern pattern = Pattern.compile(OTP_REGEX);
                Matcher matcher = pattern.matcher(messageText);
                String otp = null;

                while (matcher.find()) {
                    otp = matcher.group();
                }

                if(otp != null &amp;&amp; et_code != null) {
                    et_code.setText(otp);
                }
            }
        });
    }
</code></pre>
",4403871,,7649582,,2019-01-16 12:28:03,2019-04-17 14:18:12,Why SMS Retriever API don't work in release mode?,<android><android-intent><android-broadcast><android-broadcastreceiver><android-sms>,6,5,2,
Android,37547385,1,,,2016,,1,376,"<p>I am working on Location and Geo Fencing. But I have seen couple of problems. I think that I have missing some thing but indeed I have many confusions regarding Geo Fencing and Location services Such as Fused Location API. </p>

<p><strong>What I am doing</strong> </p>

<p>According to my App scenario, I have to get the user location ( which I am getting using Fused Location API) and also I have ask the user what is his destination and let say he is on Point A and he picks Place F. Now I want that My app should notify him that he has Arrived at point F.</p>

<p>Problems and Confusion : </p>

<ol>
<li><p>I am notified (through my notification) that I have arrived to my destination only and only if I am in my app. it looks like that my location did not update google to my current location. so what is a best way that if the app is close or in back ground google still track him </p></li>
<li><p>What I am doing is creating the geo fence around the destination of user. Now I do not know what is a way of google to track user. ? can you please clear me that after creating geo fence how does google track Us ? </p></li>
<li><p>Do I need to implement some thing in service so that my service should remain running if my app is in background or even my app is force closed? </p></li>
</ol>

<p>I think I am quiet clear about my question that What I want . Please share your views and also tell me how does google track us when we geo fence any location ? </p>

<p>I am following <a href=""https://github.com/googlesamples/android-Geofencing"" rel=""nofollow"">this</a> to create the geofence. </p>

<p>Please sahre your views. </p>
",6404917,,,,,2016-06-22 12:37:26,GeoFencing Best Stratigies,<android><android-geofence><google-geolocation><android-fusedlocation>,1,1,1,
Android,28116521,1,28158985,,2015,,1,932,"<p><a href=""https://github.com/googlesamples/android-play-location/tree/master/Geofencing"" rel=""nofollow"">Creating and Monitoring Geofences example app</a> on github does not work as expected, Geofences in Google Play Services don't seem to work properly.</p>

<p>I have read elsewhere at Stack Overflow, that Reto Meier mentioned at Google IO that the GPS will turn on only if the phone approaches the geofence to conserve battery.
Seems that it does not turn on at all.</p>

<p>Here is the situation:</p>

<ul>
<li>I have an Emulator with Google APIs (same happens with real phone).</li>
<li>I have the above mentioned app out of the box installed and Geofence added.</li>
<li>I have a KML file that drives me in and out of the Geofence.</li>
</ul>

<p>Gofence ENTER is <strong>not</strong> triggered.</p>

<p>Now, just to be sure that KML actually works, I open Google maps. I play KML and I can see the blue ""You Are Here"" dot nicely moving in and out of Geofence, and the geofences <strong>do</strong> get triggered.</p>

<p>While Google Maps is up and running, I see GPS indicator in status bar.</p>

<p>So, it seems to me that Goefence only gets triggered if the GPS is explicitly on.</p>

<p>Can somebody explain this please? There is a lot of questions here on Stack Overflow that deal with the same problem.</p>

<p>Thanks.</p>

<p><strong>EDIT</strong>:
Did the field test with real phone. While <a href=""https://github.com/googlesamples/android-play-location/tree/master/LocationUpdates"" rel=""nofollow"">Location Updates</a> app was running and tracking me <a href=""https://github.com/googlesamples/android-play-location/tree/master/Geofencing"" rel=""nofollow"">Creating and Monitoring Geofences example app</a> was getting ENTER/EXIT events. As soon as I killed Location Updates app, the Geofences app stopped getting ENTER/EXIT events.</p>

<p>Seems to me like Google has optimized the power consumption for Geofences to the point of uselessness.</p>
",2407357,,2407357,,2015-01-23 22:34:46,2015-01-26 21:41:01,Geofences do not work as expected,<google-play-services><geofencing>,1,0,1,
Android,48095462,1,,,2018,,1,161,"<p>I've an activity in my app which <strong>Either</strong> picks an image from gallery to scan for a barcode and then displays the result in a <code>TextView</code> and picked image in an <code>ImageView</code> <strong>OR</strong> starts the camera to scan one and displays the result in the respective <code>TextView</code>.</p>

<p>I'm using <a href=""https://github.com/googlesamples/android-vision"" rel=""nofollow noreferrer"">Google Mobile Vision API</a> (indirectly through a <a href=""https://github.com/KingsMentor/MobileVisionBarcodeScanner"" rel=""nofollow noreferrer"">Library</a> just to skip the boiler plate code) and the scanning works impressively fast.</p>

<p>I've tried my best to find a way before asking this question through searching the sample project of the library and Google Mobile Vision API and the internet but failed to find one.</p>

<p>How can I pass the actual scanned barcode to an <code>ImageView</code> (or an Activity)? (seems impossible directly)</p>

<p>My code is basically this (just with some intents etc)</p>

<pre><code>@Override
    public void onRetrieved(final Barcode barcode) {
        Log.d(TAG, ""Barcode read: "" + barcode.displayValue);
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                AlertDialog.Builder builder = new AlertDialog.Builder(MainActivity.this)
                        .setTitle(""code retrieved"")
                        .setMessage(barcode.displayValue);
                builder.show();
            }
        });


    }

    // for multiple callback
    @Override
    public void onRetrievedMultiple(final Barcode closetToClick, final List&lt;BarcodeGraphic&gt; barcodeGraphics) {
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                String message = ""Code selected : "" + closetToClick.displayValue + ""\n\nother "" +
                        ""codes in frame include : \n"";
                for (int index = 0; index &lt; barcodeGraphics.size(); index++) {
                    Barcode barcode = barcodeGraphics.get(index).getBarcode();
                    message += (index + 1) + "". "" + barcode.displayValue + ""\n"";
                }
                AlertDialog.Builder builder = new AlertDialog.Builder(MainActivity.this)
                        .setTitle(""code retrieved"")
                        .setMessage(message);
                builder.show();
            }
        });

    }

    @Override
    public void onBitmapScanned(SparseArray&lt;Barcode&gt; sparseArray) {
        for (int i = 0; i &lt; sparseArray.size(); i++) {
        Barcode barcode = sparseArray.valueAt(i);
        Log.e(""value"", barcode.displayValue);
        }
    }

    @Override
    public void onRetrievedFailed(String reason) {
        // in case of failure
    }
}
</code></pre>

<p>Above code works great but is there a way possible to use that <code>SparseArray</code> for obtaining the actual scanned barcode?</p>
",8439566,,472495,,2018-01-05 18:46:55,2018-01-05 18:46:55,How to pass the actual barcode scanned to an ImageView,<android><barcode><google-vision>,1,0,1,
Android,48105925,1,,,2018,,1,596,"<p>Using Google's mvvm architecture components <a href=""https://github.com/googlesamples/android-architecture-components/tree/178fe541643adb122d2a8925cf61a21950a4611c/GithubBrowserSample"" rel=""nofollow noreferrer"">Github browser sample as a reference</a>, how would one cancel a viewmodel hosted, live data observed, retrofit network request? :)</p>

<p>Maybe I'm reading it wrong, but if network conditions are poor and requests take for example 30 seconds, each request should be cancelled otherwise many requests might be launched if the app is opened and closed rapidly. How would a well designed app handle this?</p>

<p>The callback when the livedata observer is removed can be accessed <a href=""https://github.com/googlesamples/android-architecture-components/blob/178fe541643adb122d2a8925cf61a21950a4611c/GithubBrowserSample/app/src/main/java/com/android/example/github/util/LiveDataCallAdapter.java"" rel=""nofollow noreferrer"">by overriding onInactive here</a> I think. I could try cancelling all calls here, but what if I don't want to cancel some calls for some reason?</p>

<p>I'm guessing Facebook doesn't cancel trying to load your feed when you hit the back button.</p>
",1866373,,,,,2018-01-05 3:01:42,"Should my mvvm, livedata app cancel network requests when app is backgrounded?",<android><mvvm><android-architecture-components><android-architecture-lifecycle>,1,0,1,
Android,47839974,1,,,2017,,1,479,"<p>For my university thesis, I need a android program which can detect and recognize a face in real time. I have read about 'android-vision' library and tested the example code.</p>

<p><a href=""https://github.com/googlesamples/android-vision/tree/master/visionSamples/FaceTracker/app/src/main/java/com/google/android/gms/samples/vision/face/facetracker."" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-vision/tree/master/visionSamples/FaceTracker/app/src/main/java/com/google/android/gms/samples/vision/face/facetracker.</a></p>

<p>Modified code:</p>

<pre><code>package com.google.android.gms.samples.vision.face.facetracker;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.os.AsyncTask;
import android.os.Environment;
import android.util.Log;
import android.widget.Toast;

import com.google.android.gms.samples.vision.face.facetracker.ui.camera.GraphicOverlay;
import com.google.android.gms.vision.face.Face;

import java.io.ByteArrayOutputStream;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.net.Socket;
import java.text.SimpleDateFormat;
import java.util.Date;

/**
 * Graphic instance for rendering face position, orientation, and landmarks within an associated
 * graphic overlay view.
 */
class FaceGraphic extends GraphicOverlay.Graphic
{
    private static final float FACE_POSITION_RADIUS = 10.0f;
    private static final float ID_TEXT_SIZE = 40.0f;
    private static final float ID_Y_OFFSET = 50.0f;
    private static final float ID_X_OFFSET = -50.0f;
    private static final float BOX_STROKE_WIDTH = 5.0f;

    public Canvas canvas1;
    public Face face;
    int i =0;
    int flag = 0;

    private static final int COLOR_CHOICES[] = {
        Color.BLUE,
        Color.CYAN,
        Color.GREEN,
        Color.MAGENTA,
        Color.RED,
        Color.WHITE,
        Color.YELLOW
    };
    private static int mCurrentColorIndex = 0;

    private Paint mFacePositionPaint;
    private Paint mIdPaint;
    private Paint mBoxPaint;

    private volatile Face mFace;
    private int mFaceId;
    private float mFaceHappiness;
    public Bitmap myBitmap ;
    FaceGraphic(GraphicOverlay overlay)
    {
        super(overlay);

        mCurrentColorIndex = (mCurrentColorIndex + 1) % COLOR_CHOICES.length;
        final int selectedColor = COLOR_CHOICES[mCurrentColorIndex];

        mFacePositionPaint = new Paint();
        mFacePositionPaint.setColor(selectedColor);

        mIdPaint = new Paint();
        mIdPaint.setColor(selectedColor);
        mIdPaint.setTextSize(ID_TEXT_SIZE);

        mBoxPaint = new Paint();
        mBoxPaint.setColor(selectedColor);
        mBoxPaint.setStyle(Paint.Style.STROKE);
        mBoxPaint.setStrokeWidth(BOX_STROKE_WIDTH);
    }

    void setId(int id)
    {
        mFaceId = id;
        flag = 1;
    }


    /**
     * Updates the face instance from the detection of the most recent frame.  Invalidates the
     * relevant portions of the overlay to trigger a redraw.
     */
    void updateFace(Face face)
    {
        mFace = face;
        postInvalidate();
    }

    /**
     * Draws the face annotations for position on the supplied canvas.
     */
    @Override
    public void draw(Canvas canvas)
    {
        face = mFace;
        if (face == null)
        {
            return;
        }

        // Draws a circle at the position of the detected face, with the face's track id below.
        float x = translateX(face.getPosition().x + face.getWidth() / 2);
        float y = translateY(face.getPosition().y + face.getHeight() / 2);
 //       canvas.drawCircle(x, y, FACE_POSITION_RADIUS, mFacePositionPaint);
        canvas.drawText(""id: "" + mFaceId, x + ID_X_OFFSET, y + ID_Y_OFFSET, mIdPaint);
  //      canvas.drawText(""happiness: "" + String.format(""%.2f"", face.getIsSmilingProbability()), x - ID_X_OFFSET, y - ID_Y_OFFSET, mIdPaint);
  //      canvas.drawText(""right eye: "" + String.format(""%.2f"", face.getIsRightEyeOpenProbability()), x + ID_X_OFFSET * 2, y + ID_Y_OFFSET * 2, mIdPaint);
  //      canvas.drawText(""left eye: "" + String.format(""%.2f"", face.getIsLeftEyeOpenProbability()), x - ID_X_OFFSET*2, y - ID_Y_OFFSET*2, mIdPaint);

        // Draws a bounding box around the face.
        float xOffset = scaleX(face.getWidth() / 2.0f);
        float yOffset = scaleY(face.getHeight() / 2.0f);
        float left = x - xOffset;
        float top = y - yOffset;
        float right = x + xOffset;
        float bottom = y + yOffset;
        canvas.drawRect(left, top, right, bottom, mBoxPaint);

        Log.d(""MyTag"", ""hello ""+i);
        i++;

        if (flag == 1)
        {
            flag = 0;
            canvas1=canvas;
            // send face image to server for recognition
            new MyAsyncTask().execute(""ppppp"");

        }
    }


    class MyAsyncTask extends AsyncTask&lt;String, Void, String&gt;
    {
        private Context context;

        public MyAsyncTask()
        {
            // TODO Auto-generated constructor stub
            //context = applicationContext;
        }

        protected String doInBackground(String... params)
        {
            try
            {

                Log.d(""MyTag"", ""face.getWidth() ""+face.getWidth());
                Bitmap temp_bitmap = Bitmap.createBitmap((int)face.getWidth(), (int)face.getHeight(), Bitmap.Config.RGB_565);
                canvas1.setBitmap(temp_bitmap);


            }
            catch (Exception e)
            {
                Log.e(""MyTag"", ""I got an error"", e);
                e.printStackTrace();
            }
            Log.d(""MyTag"", ""doInBackground"");
            return null;
        }

        protected void onPostExecute(String result) {
            Log.d(""MyTag"", ""onPostExecute "" + result);
            // tv2.setText(s);

        }

    }

}
</code></pre>

<p>It give me this error:</p>

<pre><code>12-16 03:08:00.310 22926-23044/com.google.android.gms.samples.vision.face.facetracker E/MyTag: I got an error
                                                                                               java.lang.UnsupportedOperationException
                                                                                                   at android.view.HardwareCanvas.setBitmap(HardwareCanvas.java:39)
                                                                                                   at com.google.android.gms.samples.vision.face.facetracker.FaceGraphic$MyAsyncTask.doInBackground(FaceGraphic.java:175)
                                                                                                   at com.google.android.gms.samples.vision.face.facetracker.FaceGraphic$MyAsyncTask.doInBackground(FaceGraphic.java:158)
</code></pre>

<p>This code can detect face in real time. For recognition part, I am planning to use 'JavaCV' <a href=""https://github.com/bytedeco/javacv"" rel=""nofollow noreferrer"">https://github.com/bytedeco/javacv</a>. If I can capture the face in a bitmap then I can save it in .jpg image then I can recognize it. Could you please give me some advise, how to save detected face. Thank you. </p>
",1850484,,1850484,,2017-12-15 21:30:08,2018-12-06 16:26:23,Save real-time detected face(Track Faces) image using 'android-vision' library,<java><android><android-vision>,1,3,1,
Android,49236067,1,,,2018,,1,233,"<p>I never worked with such a confusing DI-framework like <a href=""/questions/tagged/dagger"" class=""post-tag"" title=""show questions tagged &#39;dagger&#39;"" rel=""tag"">dagger</a>! - However, I try to wrap my head around it.</p>

<p>I have two scopes: ActivityScope and FragmentScope</p>

<p>On some of the samples provided <a href=""https://github.com/googlesamples/android-architecture/blob/todo-mvp-dagger/todoapp/app/src/main/java/com/example/android/architecture/blueprints/todoapp/statistics/StatisticsFragment.java#L36"" rel=""nofollow noreferrer"">StatisticsFragment.java</a> you see e.g. the fragment annotated with the scope </p>

<pre><code>@ActivityScoped
public class StatisticsFragment extends DaggerFragment implements 
StatisticsContract.View {
...
}
</code></pre>

<p><strong>Question 1:</strong>
Is this just documentation or not? In my app it makes no difference if I annotate the concrete fragment or not.</p>

<p><strong>Question 2:</strong> Where in the generated code can I see which scope is used? My fragment injects a Presenter and an AuthProvider. The AuthProvider is annotated with Singleton (in AppModule), the Presenter is defined in UIModule -> LoginModule</p>

<p>looks like this:</p>

<p><strong>UIModule.java:</strong></p>

<hr>

<pre><code>@Module(includes = AndroidSupportInjectionModule.class)
public abstract class UIModule {

    @ActivityScope
    @ContributesAndroidInjector(modules = LoginModule.class)
    abstract LoginActivity loginActivity();

    @ChildFragmentScope
    @ContributesAndroidInjector(modules = LoginModule.class)
    abstract LoginFragment loginFragment();

    @Binds
    //@ChildFragmentScope
    public abstract LoginContract.View loginView(final LoginFragment fragment);
}
</code></pre>

<p><strong>LoginModule.java</strong></p>

<hr>

<pre><code>@Module
public abstract class LoginModule {

    @Provides
    //@ChildFragmentScope
    static LoginContract.Presenter provideLoginPresenter(final LoginContract.View view, final BaseStore store) {
        return new LoginPresenter(view,store);
    }

}
</code></pre>

<p><strong>LoginFragemt.java</strong></p>

<hr>

<pre><code>public class LoginFragment extends DaggerFragment {
   @Inject
   LoginContract.Presenter presenter;

   @Inject
   Provider&lt;MyAuthClass&gt; myAuthClass;

   ... 
}
</code></pre>

<p>presenter is created every time the Fragment gets created, myAuthClass gets created only once and is <a href=""/questions/tagged/singleton"" class=""post-tag"" title=""show questions tagged &#39;singleton&#39;"" rel=""tag"">singleton</a>.
Perfect - but I have no idea <strong>HOW</strong> this works!!!</p>

<p>DaggerFragment#onAttach must somehow know that Presenter is a ""local"" singleton and MyAuthClass is a <a href=""/questions/tagged/global"" class=""post-tag"" title=""show questions tagged &#39;global&#39;"" rel=""tag"">global</a>-<a href=""/questions/tagged/singleton"" class=""post-tag"" title=""show questions tagged &#39;singleton&#39;"" rel=""tag"">singleton</a> ...</p>
",504184,,3903073,,2018-03-12 17:08:34,2018-03-12 20:32:36,"Dagger 2, scopes + annotation",<dagger-2><dagger.android>,1,0,1,
Android,43382586,1,,,2017,,1,261,"<p><a href=""https://github.com/googlesamples/android-UniversalMusicPlayer/tree/master/mobile/src/main"" rel=""nofollow noreferrer"">Here</a> is the Google sample app. It's set up to pull metadata from a URL with a JSON. I would like to know how to have Firebase be my source. </p>

<p>Here is my attempt in changing the RemoteJSONSource class:</p>

<pre><code>package com.mm.android.uamp.model;

import android.support.v4.media.MediaMetadataCompat;
import android.util.Log;

import com.google.firebase.database.DataSnapshot;
import com.google.firebase.database.DatabaseError;
import com.google.firebase.database.DatabaseReference;
import com.google.firebase.database.FirebaseDatabase;
import com.google.firebase.database.ValueEventListener;
import com.mm.android.uamp.utils.LogHelper;

import java.util.ArrayList;
import java.util.Iterator;

public class RemoteJSONSource implements MusicProviderSource {

private static final String TAG = LogHelper.makeLogTag(RemoteJSONSource.class);

DatabaseReference mRootRef = FirebaseDatabase.getInstance().getReference();
DatabaseReference mMusic = mRootRef.child(""music"");

ArrayList&lt;MediaMetadataCompat&gt; tracksFromFB = new ArrayList&lt;&gt;();
public void buildFromFirebase(){

    mMusic.addListenerForSingleValueEvent(new ValueEventListener() {

        @Override
        public void onDataChange(DataSnapshot dataSnapshot) {

            for (DataSnapshot music : dataSnapshot.getChildren()){

                String title = music.child(""title"").getValue(String.class);
                String album = music.child(""album"").getValue(String.class);
                String artist = music.child(""artist"").getValue(String.class);
                String genre = music.child(""genre"").getValue(String.class);
                String source = music.child(""source"").getValue(String.class);
                String id = String.valueOf(source.hashCode());
                String iconUrl = music.child(""image"").getValue(String.class);
                int trackNumber = music.child(""trackNumber"").getValue(Integer.class);
                int totalTrackCount = music.child(""totalTrackCount"").getValue(Integer.class);
                int duration = music.child(""duration"").getValue(Integer.class);

                MediaMetadataCompat theMetadataFB = new MediaMetadataCompat.Builder()
                        .putString(MediaMetadataCompat.METADATA_KEY_MEDIA_ID, id)
                        .putString(MusicProviderSource.CUSTOM_METADATA_TRACK_SOURCE, source)
                        .putString(MediaMetadataCompat.METADATA_KEY_ALBUM, album)
                        .putString(MediaMetadataCompat.METADATA_KEY_ARTIST, artist)
                        .putLong(MediaMetadataCompat.METADATA_KEY_DURATION, duration)
                        .putString(MediaMetadataCompat.METADATA_KEY_GENRE, genre)
                        .putString(MediaMetadataCompat.METADATA_KEY_ALBUM_ART_URI, iconUrl)
                        .putString(MediaMetadataCompat.METADATA_KEY_TITLE, title)
                        .putLong(MediaMetadataCompat.METADATA_KEY_TRACK_NUMBER, trackNumber)
                        .putLong(MediaMetadataCompat.METADATA_KEY_NUM_TRACKS, totalTrackCount)
                        .build();

                tracksFromFB.add(theMetadataFB);
            }
        }

        @Override
        public void onCancelled(DatabaseError databaseError) {
            Log.w(TAG, ""loadPost:onCancelled"", databaseError.toException());
        }
    });
}

@Override
public Iterator&lt;MediaMetadataCompat&gt; iterator() {
    buildFromFirebase();
    ArrayList&lt;MediaMetadataCompat&gt; tracksFB = tracksFromFB;

    return tracksFB.iterator();
}

}
</code></pre>

<p>The firebase onDataChange is asynchronous so I think it hasn't finished pulling the data yet before the iterator method returns tracksFB.iterator cause tracksFB array is null. Weird thing is when I run in debug mode with a line break on</p>

<p>ArrayList tracksFB = tracksFromFB;</p>

<p>It works. From my research I think I need a callback or some type of pausing task, but I just cant figure it out.</p>

<p>Possible relevant code connected to the iterator method</p>

<pre><code>public interface MusicProviderSource {
   String CUSTOM_METADATA_TRACK_SOURCE = ""__SOURCE__"";
   Iterator&lt;MediaMetadataCompat&gt; iterator();
}
</code></pre>

<p>next</p>

<pre><code>public class MusicProvider {
private static final String TAG = LogHelper.makeLogTag(MusicProvider.class);
private MusicProviderSource mSource;
private ConcurrentMap&lt;String, List&lt;MediaMetadataCompat&gt;&gt; mMusicListByGenre;
private final ConcurrentMap&lt;String, MutableMediaMetadata&gt; mMusicListById;

private final Set&lt;String&gt; mFavoriteTracks;

enum State {
    NON_INITIALIZED, INITIALIZING, INITIALIZED
}

private volatile State mCurrentState = State.NON_INITIALIZED;

public interface Callback {
    void onMusicCatalogReady(boolean success);
}

public MusicProvider() {
    this(new RemoteJSONSource());
}
public MusicProvider(MusicProviderSource source) {
    mSource = source;
    mMusicListByGenre = new ConcurrentHashMap&lt;&gt;();
    mMusicListById = new ConcurrentHashMap&lt;&gt;();
    mFavoriteTracks = Collections.newSetFromMap(new ConcurrentHashMap&lt;String, Boolean&gt;());
}

public Iterable&lt;String&gt; getGenres() {
    if (mCurrentState != State.INITIALIZED) {
        return Collections.emptyList();
    }
    return mMusicListByGenre.keySet();
}

/**
 * Get an iterator over a shuffled collection of all songs
 */
public Iterable&lt;MediaMetadataCompat&gt; getShuffledMusic() {
    if (mCurrentState != State.INITIALIZED) {
        return Collections.emptyList();
    }
    List&lt;MediaMetadataCompat&gt; shuffled = new ArrayList&lt;&gt;(mMusicListById.size());
    for (MutableMediaMetadata mutableMetadata: mMusicListById.values()) {
        shuffled.add(mutableMetadata.metadata);
    }
    Collections.shuffle(shuffled);
    return shuffled;
}

/**
 * Get music tracks of the given genre
 *
 */
public Iterable&lt;MediaMetadataCompat&gt; getMusicsByGenre(String genre) {
    if (mCurrentState != State.INITIALIZED || !mMusicListByGenre.containsKey(genre)) {
        return Collections.emptyList();
    }
    return mMusicListByGenre.get(genre);
}

}
</code></pre>

<p>Also the musicService.java in the link above might be relevant. PLEASE help! </p>
",7789011,,4625829,,2017-04-13 2:46:05,2017-11-27 20:50:49,How to use Firebase with the Android universal music player?,<android><firebase><android-asynctask><callback><firebase-realtime-database>,1,3,1,
Android,43371389,1,43460146,,2017,,1,439,"<p>According to <a href=""https://developer.android.com/google/play/billing/billing_reference.html"" rel=""nofollow noreferrer"" title=""documentation"">in-app billing reference</a> and <a href=""https://github.com/googlesamples/android-play-billing/blob/master/TrivialDrive/app/src/main/aidl/com/android/vending/billing/IInAppBillingService.aidl"" rel=""nofollow noreferrer"">the next aidl definition</a>, there is method <code>getPurchaseHistory()</code>. The code is as simple as:</p>

<pre><code>Bundle purchaseHistoryBundle = service.getPurchaseHistory(6, BuildConfig.APPLICATION_ID, ""subs"", null, new Bundle());
</code></pre>

<p>Response I get is <code>6 (BILLING_RESPONSE_RESULT_ERROR)</code>. That means ""Fatal error during the API action""</p>

<p>What's wrong with the code? And if it is a bug in the service, where is the right place to report it?</p>
",1732338,,,,,2017-04-21 19:40:35,Android In-app billing getPurchaseHistory() doesn't work,<android><google-play-services><in-app-billing>,1,4,1,
Android,43549220,1,,,2017,,1,375,"<p>I'm trying to implement camera2api provided by google with this link
<a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-Camera2Video</a></p>

<p>Everything works fine but after after stoping the video the app crashes on mediarecorder.stop()</p>

<p>I'm using Xiaomi 4A </p>

<p>Logcat:</p>

<p>4-21 23:37:42.189 20375-20375/? E/AndroidRuntime: FATAL EXCEPTION: main
                                                   Process: com.example.android.camera2video, PID: 20375
                                                   java.lang.RuntimeException: stop failed.
                                                       at android.media.MediaRecorder.stop(Native Method)
                                                       at com.example.android.camera2video.Camera2VideoFragment.stopRecordingVideo(Camera2VideoFragment.java:687)
                                                       at com.example.android.camera2video.Camera2VideoFragment.onClick(Camera2VideoFragment.java:314)
                                                       at android.view.View.performClick(View.java:5207)
                                                       at android.view.View$PerformClick.run(View.java:21177)
                                                       at android.os.Handler.handleCallback(Handler.java:739)
                                                       at android.os.Handler.dispatchMessage(Handler.java:95)
                                                       at android.os.Looper.loop(Looper.java:148)
                                                       at android.app.ActivityThread.main(ActivityThread.java:5441)
                                                       at java.lang.reflect.Method.invoke(Native Method)
                                                       at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:738)
                                                       at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:628)</p>
",6140957,,6140957,,2017-04-21 18:08:28,2018-02-07 10:51:50,Android media recorder crashes on stop,<android><google-api><android-mediarecorder><android-camera2>,1,3,1,
Android,26479618,1,26480019,,2014,,1,1950,"<p>I am trying out Android L's new profile manager. <a href=""https://github.com/googlesamples/android-BasicManagedProfile"" rel=""nofollow"">https://github.com/googlesamples/android-BasicManagedProfile</a></p>

<p>When I deploy the apk, the package manager is not able to resolve the intent for device provisioning hence, I am getting ""Device provisioning is not enabled. Stopping.""</p>

<p>I have the latest Android L device image, that I got from <a href=""http://developer.android.com/preview/index.html#download"" rel=""nofollow"">http://developer.android.com/preview/index.html#download</a></p>

<p>How can I enable device provisioning so that I can run the sample code.</p>
",710802,,,,,2014-10-21 6:13:22,"Android L ""Device provisioning is not enabled""?",<android><android-5.0-lollipop>,1,2,1,
Android,36170914,1,,,2016,,1,370,"<p>I have been working on an music player app based on <a href=""https://github.com/googlesamples/android-UniversalMusicPlayer"" rel=""nofollow"">android-UniversalMusicPlayer</a> sample. And I have had installed LeakCanary to detect memory leak issue and find out that there is indeed a memory leak issue. Please be noted that I did not make any changes except adding the memory leak detection.  </p>

<p>Please refer to the following information for details:</p>

<pre class=""lang-html prettyprint-override""><code>In com.example.android.uamp:1.1:2.

com.example.android.uamp.ui.FullScreenPlayerActivity has leaked:
GC ROOT static android.os.UserManager.sInstance
references android.os.UserManager.mContext
references android.app.ContextImpl.mOuterContext
references com.example.android.uamp.MusicService.mConnections
references android.support.v4.util.ArrayMap.mArray
references array java.lang.Object[].[2]
references android.os.Handler$MessengerImpl.this$0
references android.support.v4.media.MediaBrowserCompat$CallbackHandler.mCallbackImpl
references android.support.v4.media.MediaBrowserCompat$MediaBrowserImplApi23.mBrowserObj
references android.media.browse.MediaBrowser.mContext
leaks com.example.android.uamp.ui.FullScreenPlayerActivity instance
Retaining: 631 KB.
Reference Key: 21cd0054-506d-4c6f-94d1-47090c16fbb0
Device: LGE google Nexus 5 hammerhead
Android Version: 6.0.1 API: 23 LeakCanary: 1.4-beta1 02804f3
Durations: watch=5024ms, gc=121ms, heap dump=6019ms, analysis=40029ms
</code></pre>



<p>You could also refer to the <a href=""https://www.dropbox.com/s/h6b4x1jib2r6cte/Dump_memory_Leak_UniversalMusicPlayer.hprof?dl=0"" rel=""nofollow"">link</a> for the dump hprof file. To me it seems that this is a Android system bug? In this case, is there workaround? This is a deadly serious issue to my app as I could stably crash my app by exiting the app and entering the app again with playback on. Any help will be greatly appreciated. </p>
",4068957,,,,,2016-04-14 19:34:40,Memory Leak issue : com.example.android.uamp.ui.FullScreenPlayerActivity has leaked,<android><memory-leaks><exoplayer>,1,3,1,
Android,36530511,1,,,2016,,1,679,"<p>I've been looking for a solution to this and I came across several answers that didn't fit the use-case. The <a href=""https://github.com/googlesamples/android-fit/tree/master/BasicSensorsApi"" rel=""nofollow"">sample code from Google</a> works fine if imported as is, but the code sits in an Activity and is messy if you want to integrate into a real project where the code would ideally be in a fragment.</p>

<p>The issue is with the <strong>enableAutoManage</strong> functionality and what to do in the fresh install case where the googleApiClient is built but the authentication/account-pick screen is not yet done and you end up with connection failed on the googleApiClient. I'm going to answer this in full, below.</p>
",764897,,,,,2018-09-24 5:50:20,How to implement Google Fit step counter within a Fragment,<android><google-fit>,1,0,1,
Android,53931191,1,53954074,,2018,,1,51,"<p>I'm implement one demo Video and Audio recording using <code>MediaRecorder</code></p>

<p>Download the demo from hear : <strong><a href=""https://github.com/googlesamples/android-MediaRecorder"" rel=""nofollow noreferrer"">Android MediaRecorder Sample</a></strong> </p>

<p>There is one method <strong><code>prepareVideoRecorder()</code></strong> in <code>MainActivity.java</code>. in this method initialization and <strong>set Source</strong> Audio and video like:</p>

<pre><code>mMediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
</code></pre>

<p>Now i want to audio <strong>ON</strong> or <strong>OFF</strong> functionality.</p>

<p>For that i'll tried like this :</p>

<pre><code> if (!AppSetting.getValue(activity, Config.AUDIO, false)) {
            mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
        }else {
            mMediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
            mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
        }
</code></pre>

<p>But app is Crash with below error :</p>

<pre><code>java.lang.IllegalStateException
at android.media.MediaRecorder.setAudioEncoder(Native Method)
</code></pre>

<p>So how to i solve this error or there is another solution for Audio <strong>ON</strong> or <strong>OFF</strong>:</p>
",9180439,,,,,2018-12-28 7:11:39,How to ON or OFF audio recording using MediaRecorder,<java><android><audio><android-mediarecorder>,1,0,1,
Android,55301892,1,,,2019,,1,114,"<p>I have been trying to implement <a href=""https://developers.google.com/identity/sms-retriever/verify"" rel=""nofollow noreferrer"">SMS Retriever API</a> to collect incoming sms from the server on the phone, apparently <code>onReceive()</code> on the broadcast listener is never called when sms is received on the phone.</p>

<p><strong>Client implementation</strong> is mentioned as below. </p>

<pre><code>    private fun startSMSListener() {
    Log.d(TAG, ""startSMSListener():"")

    val client = SmsRetriever.getClient(this)
    val retriever = client.startSmsRetriever()
    retriever.addOnSuccessListener {

        Toast.makeText(this@MainActivity,""Listener started"", Toast.LENGTH_SHORT).show()

        val otpListener = object : SMSBroadcastReceiver.OTPListener {
            override fun onOTPReceived(otp: String) {
                Log.d(TAG, ""onOTPReceived(): $otp"")
                tv_hash_code.text = otp
                Toast.makeText(this@MainActivity, otp , Toast.LENGTH_LONG).show()
            }

            override fun onOTPTimeOut() {
                Log.d(TAG, ""onOTPTimeOut():"")
                Toast.makeText(this@MainActivity,""TimeOut"", Toast.LENGTH_SHORT).show()
            }
        }
        //smsBroadcastReceiver this is already initialized 
        smsBroadcastReceiver.injectOTPListener(otpListener)
        registerReceiver(smsBroadcastReceiver,
            IntentFilter(SmsRetriever.SMS_RETRIEVED_ACTION))
    }
    retriever.addOnFailureListener {
        Toast.makeText(this@MainActivity,""Problem to start listener"", Toast.LENGTH_SHORT).show()
    }
}
</code></pre>

<p>Broadcast receiver is </p>

<pre><code>class SMSBroadcastReceiver : BroadcastReceiver() {


private var otpReceiver: OTPListener? = null

fun injectOTPListener(receiver: OTPListener?) {
    Log.d(TAG, ""injectOTPListener is empty : ${receiver == null}"")
    this.otpReceiver = receiver
}

override fun onReceive(context: Context, intent: Intent) {
    Log.d(TAG, intent.action)
    if (SmsRetriever.SMS_RETRIEVED_ACTION == intent.action) {
        val extras = intent.extras
        val status = extras.get(SmsRetriever.EXTRA_STATUS) as Status

        when (status.statusCode) {

            CommonStatusCodes.SUCCESS -&gt; {
                Log.d(TAG, ""CommonStatusCodes.SUCCESS"")
                Toast.makeText(context, ""CommonStatusCodes.SUCCESS"", Toast.LENGTH_LONG).show()

                val message = extras.get(SmsRetriever.EXTRA_SMS_MESSAGE) as String

                val pattern = Pattern.compile(""\\d{6}"")
                val matcher = pattern.matcher(message)

                if (matcher.find()) {
                    otpReceiver?.onOTPReceived(matcher.group(0))
                    return
                }
            }
            CommonStatusCodes.TIMEOUT -&gt; {
                Log.d(TAG, ""CommonStatusCodes.TIMEOUT"")
                Toast.makeText(context, ""CommonStatusCodes.TIMEOUT"", Toast.LENGTH_LONG).show()
                otpReceiver?.onOTPTimeOut()
            }
        }
    }
}

interface OTPListener {


    fun onOTPReceived(otp: String)

    fun onOTPTimeOut()
}
}
</code></pre>

<p><strong>Server Implementation</strong> </p>

<p>This is what I have for the message </p>

<pre><code>&lt;#&gt; Your SmsVerificationCOde code is: 123456
wPMABADKiiS
</code></pre>

<p>This Hash-Code generated using debug key, I tried three different methods to generate the hash-code which all provide the same value.</p>

<ol>
<li><p>Keytool</p>

<p>keytool -exportcert -alias androiddebugkey -keystore  ~/.android/debug.keystore -storepass android -keypass android | xxd -p | tr -d ""[:space:]"" | echo -n com.example.smsverificationcode <code>cat</code> | sha256sum | tr -d ""[:space:]-"" | xxd -r -p | base64 | cut -c1-11</p></li>
<li><p><a href=""https://github.com/googlesamples/android-credentials/blob/master/sms-verification/bin/sms_retriever_hash_v9.sh"" rel=""nofollow noreferrer"">Script</a></p>

<p>./sms_retriever_hash_v9.sh --package ""com.example.smsverificationcode"" --keystore ~/.android/debug.keystore</p></li>
<li><p><a href=""https://github.com/googlesamples/android-credentials/blob/master/sms-verification/android/app/src/main/java/com/google/samples/smartlock/sms_verify/AppSignatureHelper.java"" rel=""nofollow noreferrer"">AppSignatureHelper</a></p></li>
</ol>

<p>all of them seem to provide the same hash-code which makes me believe that hash-code is alright ( I tried this for release type any way, all method provide me with another ""value"" which is same for all method of evaluation )</p>

<p>Reference:
<a href=""https://developers.google.com/identity/sms-retriever/verify"" rel=""nofollow noreferrer"">https://developers.google.com/identity/sms-retriever/verify</a>
<a href=""https://medium.com/@wilderpereira/secure-android-otp-account-verification-with-the-sms-retriever-api-c395c1985fbf"" rel=""nofollow noreferrer"">https://medium.com/@wilderpereira/secure-android-otp-account-verification-with-the-sms-retriever-api-c395c1985fbf</a></p>

<p>I am positive the client implementation is correct as I get the TimeOut error after 5 minutes, but never actually get anything at time of sms arrival.</p>

<p>I believe that Android system is not able to figure out the my application based of the hash-code or the format of my message could be wrong.</p>

<p>Kindly have a look and correct me where I could be wrong. any help is highly regarded.</p>
",11209303,,11209303,,2019-03-22 15:41:06,2019-03-22 16:28:46,SMS Retriever API android system unable to send message to the Broadcast Receiver,<android><kotlin><sms>,1,2,1,
Android,48645234,1,48649395,,2018,,1,452,"<p>I setup a device owner application provisioning app as shown in google sample <a href=""https://github.com/googlesamples/android-NfcProvisioning"" rel=""nofollow noreferrer"">NFC Provisioning</a> , with additional features to setup <code>EXTRA_PROVISIONING_DEVICE_ADMIN_PACKAGE_DOWNLOAD_LOCATION</code> and <code>EXTRA_PROVISIONING_DEVICE_ADMIN_PACKAGE_CHECKSUM</code>. I would like as shown in the video of <a href=""https://youtu.be/Za0OQo8DRM4?t=36m57s"" rel=""nofollow noreferrer"">Google I/O 2016</a>, to provide both device owner app and cosu app. 
How can I achieve this goal?</p>

<p>I should setup a single app which is both cosu and device owner or I have to provide download location automatically via nfc through provisioning app and instruct my device owner to download and install the specific app?</p>
",4875522,,,,,2018-02-06 18:12:33,Provisioning Device Owner and CosuApp,<android><android-for-work><cosu>,1,0,1,
Android,40419605,1,40419946,,2016,,1,903,"<p>I am trying to get access to <code>""/""</code> (root) directory using <code>Storage Access Framework</code> on Android 7.0 and above, after looking to the Google sample on <a href=""https://github.com/googlesamples/android-ScopedDirectoryAccess"" rel=""nofollow noreferrer"">GitHub</a>, i can see that there are only predefined directories are passed in while creating accessIntent using StorageVolume class, but how to get access to any other directory than those predefined directories?</p>

<p>Here is my code, which i tried:</p>

<pre><code>    StorageManager storageManager = (StorageManager) getSystemService(Context.STORAGE_SERVICE);
    File root = new File(""/"");
    StorageVolume storageVolume = storageManager.getStorageVolume(root);

    Intent intent = storageVolume.createAccessIntent(""/"");
    startActivityForResult(intent, REQUEST_CODE);
</code></pre>

<p>i am getting null as storageVolume and unable to get access to ""/"" directory using StorageVolume framework.</p>

<blockquote>
  <p>How to get <a href=""https://developer.android.com/training/articles/scoped-directory-access.html"" rel=""nofollow noreferrer"">Scoped Directory Access</a> to <code>""/""</code> directory
  using <a href=""https://developer.android.com/guide/topics/providers/document-provider.html"" rel=""nofollow noreferrer"">Storage Access Framework</a> on Android 7.0 and above?</p>
</blockquote>
",1791546,,1791546,,2016-11-07 11:14:48,2016-11-07 11:14:48,"How to get access to ""/"" (root) directory using Storage Access framework",<android><android-7.0-nougat><android-7.1-nougat>,1,1,1,
Android,31786559,1,31875851,,2015,,1,258,"<p>Following the <a href=""http://tools.android.com/tech-docs/android-ndk-preview"" rel=""nofollow"">Android NDK Preview</a> document, I install android-ndk-10e and experimental gradle plugin ,import the <a href=""https://github.com/googlesamples/android-ndk/tree/master/Teapot"" rel=""nofollow"">Teapot</a> sample project then set the ""Android Native"".</p>

<p>Things seem works fine except that the breakpoints in native code can not be triggered. Have tested on OS X Yosemite and Windows 7, both failed.</p>

<p>Here is a <a href=""https://groups.google.com/forum/#!topic/android-ndk/r4q67-JKBPM"" rel=""nofollow"">post</a> says doing some changes to gradle file, but not working for me.</p>
",853569,,,,,2015-08-07 10:46:31,Breakpoints in native code can not be triggered in Android Studio 13,<android-studio><gradle><android-ndk>,1,0,1,
Android,39253010,1,,,2016,,1,299,"<p>I'm trying to develop an application that uses Camera 2 API, but I have a problem when I try to edit the height of the bottom bar. I would like to remove the black space between the camera and bottom bar. Moreover, I would like to extend the camera height.</p>

<p>I followed the Google <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""nofollow noreferrer"">Camera2Basic</a> example.</p>

<p><a href=""https://i.stack.imgur.com/4foft.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/4foft.jpg"" alt=""enter image description here""></a></p>

<p>Could I fix this problem?</p>

<p>Thanks.</p>

<p><strong>activity_camera.xml</strong></p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;FrameLayout xmlns:android=""http://schemas.android.com/apk/res/android""
    xmlns:tools=""http://schemas.android.com/tools""
    android:id=""@+id/container""
    android:layout_width=""match_parent""
    android:layout_height=""match_parent""
    android:background=""#000""
    tools:context="".CameraActivity"" /&gt;
</code></pre>

<p><strong>fragment_camera2.xml</strong></p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;RelativeLayout xmlns:android=""http://schemas.android.com/apk/res/android""
    xmlns:app=""http://schemas.android.com/apk/res-auto""
    android:layout_width=""match_parent""
    android:layout_height=""match_parent""
    android:foreground=""?selectableItemBackground"" &gt;

    &lt;widgets.AutoFitTextureView
        android:id=""@+id/texture""
        android:layout_width=""match_parent""
        android:layout_height=""match_parent""
        android:layout_alignParentLeft=""true""
        android:layout_alignParentStart=""true""
        android:layout_alignParentTop=""true"" /&gt;

    &lt;FrameLayout
        android:id=""@+id/control""
        android:layout_width=""match_parent""
        android:layout_height=""wrap_content""
        android:layout_alignParentBottom=""true""
        android:layout_alignParentLeft=""true""
        android:layout_alignParentStart=""true""
        android:elevation=""4dp""
        android:paddingBottom=""12dp""
        android:paddingLeft=""16dp""
        android:paddingRight=""16dp""
        android:paddingTop=""12dp""
        android:background=""@color/white"" &gt;

        &lt;ImageButton
            android:id=""@+id/picture""
            android:layout_width=""@dimen/ic_camera""
            android:layout_height=""@dimen/ic_camera""
            android:layout_gravity=""center""
            android:background=""@drawable/cam_circle_selector""
            android:contentDescription=""@string/description_info""
            android:scaleType=""fitXY""
            app:srcCompat=""@drawable/ic_action_capture"" /&gt;

    &lt;/FrameLayout&gt;

&lt;/RelativeLayout&gt;
</code></pre>
",4711153,,4711153,,2016-10-05 15:49:25,2019-01-06 7:57:11,Android Camera2 - Remove black space between camera and bottom bar,<android><android-camera2>,1,7,1,
Android,38869938,1,,,2016,,1,197,"<p>I want to <strong>send ""text"" from android device to a LED panel via a ""BLE"" adapter.</strong></p>

<p>I am able to connect the android device with the ""BLE adapter"" through the following sample project. As this is an open-source project, i have no problems in the connection part.
<a href=""https://github.com/googlesamples/android-BluetoothLeGatt"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-BluetoothLeGatt</a></p>

<p>Now, i want to send data (say ""Hello World"") from the device to the ble adapter. I find a project on Google Play and it would send data successfully to the ""BLE Adapter"" as shown below
<a href=""https://play.google.com/store/apps/details?id=com.ingics.uc.serialble.v2"" rel=""nofollow noreferrer"">https://play.google.com/store/apps/details?id=com.ingics.uc.serialble.v2</a></p>

<p>However, <strong>this is not an open-source project and there are no ways for me to work it out programmatically.</strong> </p>

<p>I have searched github and found some projects claming they would send data to bluetooth devices but i still would not work it out.
<a href=""https://github.com/suzp1984/Light_BLE"" rel=""nofollow noreferrer"">https://github.com/suzp1984/Light_BLE</a>
<a href=""https://github.com/Lembed/Android-BLE-Terminal"" rel=""nofollow noreferrer"">https://github.com/Lembed/Android-BLE-Terminal</a></p>

<p>I know ""BLE"" is a big topic here but the objective i want to achieve is very simple. Great if anyone would share with me some ""<strong>simple sample projects</strong>"" for me to achieve my goal.</p>

<p><a href=""https://i.stack.imgur.com/rQXU1.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/rQXU1.png"" alt=""enter image description here""></a></p>
",4152203,,,,,2016-08-10 9:56:41,Android Send Data via Blue Tooth Low Energy adapter,<android><bluetooth><bluetooth-lowenergy>,1,0,1,
Android,39797164,1,,,2016,,1,1363,"<p>In this <a href=""https://stackoverflow.com/questions/32051973/google-vision-api-samples-get-the-camerasource-to-focus?rq=1"">SO Thread</a>, <a href=""https://stackoverflow.com/users/5231007/pm0733464"">pm0733464</a>, says this: </p>

<blockquote>
  <p>we open sourced the CameraSource class, which has an auto focus method as well. This one allows you to set a specific focus mode as opposed to the ""continuous video"" mode that the official API defaults to:</p>
</blockquote>

<p>Which was great. But it seems that the Google Vision API has moved on and the open Sourced version has not. The official API now has a new type of processor called: FocusingProcessor -- which allows the detector to only respond on the OnFocus event. </p>

<pre><code> barcodeDetector = new BarcodeDetector.Builder(this)
            .setBarcodeFormats(Barcode.QR_CODE | Barcode.PDF417)
            .build();
 barcodeDetector.setProcessor(new BarcodeFocusingProcessor(
            barcodeDetector,
            new NullTracker()));
 CameraSource.Builder builder = new CameraSource.Builder(getApplicationContext(), barcodeDetector)
            .setFacing(CameraSource.CAMERA_FACING_BACK)
            .setRequestedPreviewSize(1600, 1024)
            .setAutoFocusEnabled(true)
            .setRequestedFps(24.0f);
    cameraSource = builder.build();
</code></pre>

<p>In my experiments this ""finds"" barcodes much faster than using the processor that the examples show in the <a href=""https://github.com/googlesamples/android-vision/blob/master/visionSamples/barcode-reader/app/src/main/java/com/google/android/gms/samples/vision/barcodereader/ui/camera/CameraSource.java"" rel=""nofollow noreferrer"">Official Google Vision API Samples</a></p>

<p>Am I missing something somewhere? Or is the CameraSource in the Google.Vision libraries not the same one they are showing in the open source?</p>

<p>[EDIT] 
Sharing code by request of pm0733464:</p>

<p>For the record, I began with the fork of the vision api Demo which allows for <a href=""https://github.com/wax911/Vision-Barcode-Scanner"" rel=""nofollow noreferrer"">automatically detecting barcode</a></p>

<p>My code makes some simple changes. First off, I add PDF417 to the scanable barcodes. Then I set the processor to an autofocus-er. I turn the tracker into a nullTracker because I don't need the graphic displaying, and I hoped that would speed some things up</p>

<p>in  <strong>BarcodeCaptureActivity</strong> I change <strong>createCameraSource</strong> where it defined the barcode detector like to this:</p>

<pre><code>  BarcodeDetector barcodeDetector =
                new BarcodeDetector.Builder(context)
                        .setBarcodeFormats(Barcode.PDF417)
                        .build();


        barcodeDetector.setProcessor(new MyCameraFocusingProcessor(
                barcodeDetector,
                new NullTracker()));


// Creates and starts the camera.  Note that this uses a higher resolution in comparison
        // to other detection examples to enable the barcode detector to detect small barcodes
        // at long distances.

        CameraSource.Builder builder = new CameraSource.Builder(getApplicationContext(), barcodeDetector)
                .setFacing(CameraSource.CAMERA_FACING_BACK)
                .setRequestedPreviewSize(1600, 1024)
                .setRequestedFps(24.0f);

        // make sure that auto focus is an available option
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.ICE_CREAM_SANDWICH)
        {
            builder = builder.setFocusMode(
                    autoFocus ? Camera.Parameters.FOCUS_MODE_CONTINUOUS_PICTURE : null);
        }

        mCameraSource = builder
                .setFlashMode(useFlash ? Camera.Parameters.FLASH_MODE_TORCH : null)
                .build();
    }
</code></pre>

<p>My FocusProcessor (in the same class) looks like this:</p>

<pre><code>private class MyCameraFocusingProcessor implements Detector.Processor&lt;Barcode&gt;
    {
        public MyCameraFocusingProcessor(BarcodeDetector barcodeDetector, NullTracker emptyTracker)
        {

        }

        @Override
        public void release()
        {

        }

        @Override
        public void receiveDetections(Detector.Detections&lt;Barcode&gt; detections)
        {
            //  boolean chk = detections.detectorIsOperational();
            int sizeCheck = detections.getDetectedItems().size();
            if (sizeCheck &gt; 0)
            {
                SparseArray&lt;Barcode&gt; codes = detections.getDetectedItems();
                for (int i = 0; i &lt; sizeCheck; i++)
                {
                    Barcode barcode = codes.valueAt(i);
                    try
                    {
                        if (barcode.format == Barcode.PDF417)
                        {
                            Intent data = new Intent();
                            data.putExtra(BarcodeObject, barcode);
                            setResult(CommonStatusCodes.SUCCESS, data);
                            finish();
                            break;
                        }
                    }
                    catch (Exception ex)
                    {
                        Log.d(""Detect"", ""Error: "" + ex.getMessage());
                    }
                }
            }
            return;
        }
    }

    private class NullTracker
    {

    }
</code></pre>
",628887,,-1,,2017-05-23 12:00:40,2016-10-10 16:06:43,Is the Open Sourced Google Vision API CameraSource class Out-Dated?,<android><android-camera><google-play-services><android-vision><google-vision>,1,0,1,
Android,29540171,1,,,2015,,1,1148,"<p>NOTE: Before you say it's a duplicate and others have solved it and that there are tutorials (like <a href=""http://androidopentutorials.com/android-vertical-scrollbar-styling/"" rel=""nofollow""><strong>this one</strong></a>), I know, but for some reason, they don't work for me.</p>

<h2>Background</h2>

<p>I've made a library (<a href=""https://github.com/AndroidDeveloperLB/ListViewVariants"" rel=""nofollow""><strong>here</strong></a>) that shows how to mimic the way that the Contacts app of Lollipop shows the headers on the left.</p>

<p>I'd like to know how to customize the scrollbar and the fast-scroller to look like on Lollipop (either like the contacts app there as I've done <a href=""https://github.com/AndroidDeveloperLB/LollipopContactsRecyclerViewFastScroller"" rel=""nofollow""><strong>with RecyclerView</strong></a>, or like the default one for ListView).</p>

<h2>The problem</h2>

<p>For some reason, even though I use the same attributes that are talked about on all of the tutorials and StackOverflow posts, they don't do anything.</p>

<p>Here's the style I created:</p>

<pre><code>&lt;style name=""CustomTheme"" &gt;
  &lt;item name=""android:scrollbarFadeDuration""&gt;250&lt;/item&gt;
  &lt;item name=""android:scrollbarDefaultDelayBeforeFade""&gt;300&lt;/item&gt;
  &lt;item name=""android:scrollbarSize""&gt;10dip&lt;/item&gt;
  &lt;item name=""android:scrollbarThumbHorizontal""&gt;@drawable/scrollbar_handle_material&lt;/item&gt;
  &lt;item name=""android:scrollbarThumbVertical""&gt;@drawable/scrollbar_handle_material&lt;/item&gt;
  &lt;item name=""android:scrollbarTrackHorizontal""&gt;@null&lt;/item&gt;
  &lt;item name=""android:scrollbarTrackVertical""&gt;@null&lt;/item&gt;
&lt;/style&gt;
</code></pre>

<p><strong>res/drawable/scrollbar_handle_material.xml</strong></p>

<pre><code>&lt;shape xmlns:android=""http://schemas.android.com/apk/res/android""
       android:tint=""?attr/colorControlNormal""
       android:shape=""rectangle""&gt;
  &lt;solid android:color=""#84ffffff""/&gt;
  &lt;size android:width=""4dp""/&gt;
&lt;/shape&gt;
</code></pre>

<p>And of course I use it for the ListView:</p>

<pre><code>style=""@style/CustomTheme""
</code></pre>

<h2>What I've tried</h2>

<p>Well, I tried to play with the attributes, I tried to use a simple ListView (and a GridView, by using the sample ""<a href=""https://github.com/googlesamples/android-DisplayingBitmaps/"" rel=""nofollow""><strong>DisplayingBitmaps</strong></a>"") and I tried to set the attributes right in the ListView tag (instead of using a style) as such:</p>

<pre><code>            android:scrollbarFadeDuration=""250""
            android:scrollbarDefaultDelayBeforeFade=""300""
            android:scrollbarSize=""10dp""
            android:scrollbarThumbHorizontal=""@drawable/scrollbar_handle_material""
            android:scrollbarThumbVertical=""@drawable/scrollbar_handle_material""
            android:scrollbarTrackHorizontal=""@null""
            android:scrollbarTrackVertical=""@null""
</code></pre>

<p>... but nothing does anything...</p>

<h2>The question</h2>

<p>How could it be? what's missing? what's wrong ?</p>

<p>I'd also like to ask if it's possible on Android 2.x.</p>
",878126,,,,,2015-04-10 19:06:15,How to customize the scrollbar on ListView?,<android><android-listview><scrollbar>,1,4,1,
Android,52576072,1,52576209,,2018,,1,416,"<p>Recently I have dived into learning new andoirdX artefacts including Android Architecture Components. </p>

<p>After reading through the officials docs and a google code samples I have successfully added the necessary dependencies in both my project and app level Gradle files. 
They are as follows</p>

<pre><code>dependencies {
    classpath 'com.android.tools.build:gradle:3.2.0'
    classpath ""org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version""
    classpath ""android.arch.navigation:navigation-safe-args-gradle-plugin:$navigationVersion""

    // NOTE: Do not place your application dependencies here; they belong
    // in the individual module build.gradle files
}
</code></pre>

<p>and </p>

<pre><code>apply plugin: 'com.android.application'

apply plugin: 'kotlin-android'

apply plugin: 'kotlin-android-extensions'

apply plugin: 'kotlin-kapt'

apply plugin: 'androidx.navigation.safeargs'

android {
compileSdkVersion 28
defaultConfig {
    applicationId ""_ _ _ _ _ _""
    minSdkVersion 15
    targetSdkVersion 28
    versionCode 1
    versionName ""1.0""
    vectorDrawables.useSupportLibrary = true
    testInstrumentationRunner ""androidx.test.runner.AndroidJUnitRunner""
}
buildTypes {
    release {
        minifyEnabled false
        proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
    }
}
}

dependencies {
implementation fileTree(dir: 'libs', include: ['*.jar'])
implementation""org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version""
implementation 'androidx.appcompat:appcompat:1.0.0'
implementation 'androidx.recyclerview:recyclerview:1.0.0'
implementation 'androidx.constraintlayout:constraintlayout:2.0.0-alpha2'
implementation 'com.google.android.material:material:1.0.0-rc01'
testImplementation 'junit:junit:4.12'
androidTestImplementation 'androidx.test:runner:1.1.0-alpha3'
androidTestImplementation 'androidx.test.espresso:espresso-core:3.1.0-alpha3'


def lifecycle_version = ""2.0.0-beta01""
def room_version = ""2.0.0-beta01""
def navigationVersion = '1.0.0-alpha06'
kapt ""androidx.room:room-compiler:$room_version""
kapt ""androidx.lifecycle:lifecycle-compiler:$lifecycle_version""

implementation 'androidx.core:core-ktx:1.0.0-alpha1'
implementation ""androidx.lifecycle:lifecycle-viewmodel-ktx:$lifecycle_version""
implementation ""androidx.lifecycle:lifecycle-livedata:$lifecycle_version""
implementation ""androidx.lifecycle:lifecycle-runtime:$lifecycle_version""
implementation ""android.arch.navigation:navigation-fragment-ktx:$navigationVersion""
implementation ""android.arch.navigation:navigation-ui-ktx:$navigationVersion""

implementation ""androidx.room:room-runtime:$room_version""
 }
</code></pre>

<p>after giving Gradle sync everything worked fine, however, it showed an error saying <strong>""Manifest merge error please see logs for more info""</strong></p>

<p>I have double checked with <a href=""https://github.com/googlesamples/android-sunflower"" rel=""nofollow noreferrer"">an app from google</a> repository and everything seems normal.</p>

<p>Please accept my humble appreciation in advance</p>
",,user5436326,,,,2018-09-30 8:39:26,Manifest marge error after migrating to androidX,<android><android-jetpack><android-navigation-component>,1,0,1,
Android,26310908,1,27478710,,2014,,1,1108,"<p>I have an experiment with Android Manage Profile <a href=""https://github.com/googlesamples/android-BasicManagedProfile"" rel=""nofollow"">https://github.com/googlesamples/android-BasicManagedProfile</a> for Android L Platform.
Android L successfully installed on my Nexus 7 and sample application of basic manage profile successfully compiled and run on the device. </p>

<p>The sample app correctly send intent to start the Provisioning.</p>

<pre><code>Intent intent = new Intent(ACTION_PROVISION_MANAGED_PROFILE);
    intent.putExtra(EXTRA_PROVISIONING_DEVICE_ADMIN_PACKAGE_NAME,
                    activity.getApplicationContext().getPackageName());
    intent.putExtra(EXTRA_PROVISIONING_DEFAULT_MANAGED_PROFILE_NAME,
                    ""Sample Managed Profile"");
    intent.putExtra(EXTRA_DEVICE_ADMIN, BasicDeviceAdminReceiver.getComponentName(activity));
    if (intent.resolveActivity(activity.getPackageManager()) != null) {
        startActivity(intent);
        activity.finish();
    } else {
        Toast.makeText(activity, ""Device provisioning is not enabled. Stopping."",
                       Toast.LENGTH_SHORT).show();
    }
</code></pre>

<p>The provisioning activity shown and display a message that require restart to encrypt the device.
After device restarted there is a notification ""Continue provisioning"", when I click the notification, the provisioning activity ask to restart the device again and again.</p>

<p>I already tried also in emulator and got the same behaviour. </p>

<p>Is anyone have a clue on this? </p>
",1024806,,,,,2014-12-15 6:48:26,Android L Manage Profile,<android><android-5.0-lollipop>,1,0,1,
Android,35127970,1,,,2016,,1,408,"<p>I’m implementing a “use fingerprint instead of password” feature for devices with nexus imprint. </p>

<p>It’s fairly easy to prompt for a fingerprint and see if was correct or not but I’m scratching my head trying to protect a value with fingerprint, I’m following this example <a href=""https://github.com/googlesamples/android-FingerprintDialog"" rel=""nofollow"">https://github.com/googlesamples/android-FingerprintDialog</a> but there is no “recover value with fingerprint”, it only explains how to store it</p>

<p>any good example of something like that?</p>

<p>The API expects a password so the general idea is:</p>

<ul>
<li>user activates ""protect with fingerprint""</li>
<li>is asked for the password</li>
<li>if correct, is asked for fingerprint</li>
<li>if correct, password is securely stored</li>
<li>for any subsequent logins, when touching the fingerprint scanner, if correct, the value is decrypted and sent to server for login</li>
</ul>
",1481061,,,,,2016-02-01 11:01:04,Protect value with fingerprint,<android><security><fingerprint><biometrics>,1,0,1,
Android,39481821,1,,,2016,,1,579,"<h1>Question</h1>

<p>I want to do something similar to what's done on the <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""nofollow"">Camera2Basic</a> sample, that is:</p>

<ol>
<li><strong>Previewing</strong> images from the camera using a <code>TextureView</code></li>
<li><strong>Processing</strong> images from the camera using a <code>ImageReader</code></li>
</ol>

<p>With a few differences regarding <code>2</code>:</p>

<ul>
<li>I'm only interested on the gray channel (brightness) from the images to be processed. Their dimensions should be around 1000 x 1000 pixels (and not the highest resolution available)</li>
<li>When a image to be processed is available, a generic <code>process(Image)</code> method will be called instead of saving images to disk. What this method does is out of the scope of this question, but it takes around 50 ms to return</li>
<li>The image data should be processed periodically (around 10 FPS, but speed is not critical) instead of eventually</li>
</ul>

<p>How can I accomplish this using the <code>Camera2</code> API?</p>

<h1>Observations</h1>

<ul>
<li>I've changed the way I'm creating the <code>ImageReader</code> instance, selecting smaller dimensions and a different format (<code>YUV_420_888</code> instead of <code>JPEG</code>). The <code>Y</code> plane will be accessed in order to get the brightness data. Is there a more efficient format (since I'm simply ignoring the <code>U</code> and <code>V</code> planes)?</li>
<li>Both <code>TextureView</code> and <code>ImageReader</code> surfaces should be filled periodically, but at different rates. Since there can be only one repeating <code>CameraRequest</code> on a <code>CameraCaptureSession</code> (which can be set by calling <code>setRepeatingRequest()</code>), am I supposed to manually call <code>capture()</code> periodically (e.g. call <code>setRepeatingRequest()</code> with the preview request and call <code>capture()</code> periodically with the process request)?</li>
<li>Can the performance be improved by sending reprocessed requests to obtain the images to be processed from the preview images? If so, how can I do it?</li>
</ul>
",4681266,,,,,2016-09-20 8:55:43,Use Camera2 to Preview and Process camera data,<android><android-camera2>,1,0,1,
Android,48887518,1,,,2018,,1,476,"<p>My Espresso test is working fine with Espresso version <code>2.2.2</code> but When I update my studio to latest one and applied migration rule test going to fail and required to update the version.<br>
<strong>library using</strong> </p>

<pre><code>androidTestImplementation'com.android.support.test.espresso:espresso-core:3.0.1'
    implementation 'com.android.support.test.espresso:espresso-idling-resource:3.0.1'
    androidTestImplementation 'junit:junit:4.12'
    androidTestImplementation 'com.android.support.test:runner:1.0.1'
    androidTestCompile 'com.android.support.test:rules:1.0.1'
    androidTestImplementation ""com.android.support:support-annotations:${support}""
    implementation fileTree(include: ['*.jar'], dir: 'libs')
</code></pre>

<p>For Idling resource during testing I am using the <a href=""https://github.com/googlesamples/android-testing/tree/master/ui/espresso/IdlingResourceSample"" rel=""nofollow noreferrer"">IdlingResourceSample</a> also I also tried <a href=""https://github.com/chiuki/espresso-samples/tree/master/idling-resource-intent-service"" rel=""nofollow noreferrer"">idling-resource-intent-service</a>  As I am using <code>IntentService</code> and <code>BroadcastReceiver</code>.<br>
As There is issue in <code>Espresso</code> <a href=""https://issuetracker.google.com/issues/65568629"" rel=""nofollow noreferrer""> Espresso.onIdle</a> &amp; <a href=""https://issuetracker.google.com/issues/65576174"" rel=""nofollow noreferrer"">Espresso IdlingResourceRegistry.sync</a> which is already reported and will fix in next release. I use <code>IdlingRegistry</code> for registering. but still I am getting <code>AppNotIdleException</code><br>
<strong>Log Cat</strong></p>

<pre><code>android.support.test.espresso.AppNotIdleException: Looped for 35 iterations over 60 SECONDS. The following Idle Conditions failed ASYNC_TASKS_HAVE_IDLED.
at dalvik.system.VMStack.getThreadStackTrace(Native Method)
at java.lang.Thread.getStackTrace(Thread.java:1538)
at android.support.test.espresso.base.DefaultFailureHandler.getUserFriendlyError(DefaultFailureHandler.java:90)
at android.support.test.espresso.base.DefaultFailureHandler.handle(DefaultFailureHandler.java:52)
at android.support.test.espresso.ViewInteraction.waitForAndHandleInteractionResults(ViewInteraction.java:312)
at android.support.test.espresso.ViewInteraction.check(ViewInteraction.java:291)
at com.company.project.InstrumentedDeepLinkTest.setDeepLinkUri(InstrumentedDeepLinkTest.java:107)
at java.lang.reflect.Method.invoke(Native Method)
at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
at android.support.test.rule.ActivityTestRule$ActivityStatement.evaluate(ActivityTestRule.java:433)
at org.junit.rules.RunRules.evaluate(RunRules.java:20)
at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
at org.junit.runners.Suite.runChild(Suite.java:128)
at org.junit.runners.Suite.runChild(Suite.java:27)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
at android.support.test.internal.runner.TestExecutor.execute(TestExecutor.java:58)
at android.support.test.runner.AndroidJUnitRunner.onStart(AndroidJUnitRunner.java:375)
at android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:2075) 
</code></pre>

<p>I disabled already animations from <code>developer Options</code></p>

<p>After Analyzing which <code>AsyncTask</code> is keeping my <code>App</code> busy, I got the <code>thread pool</code> having many <code>AsyncTask</code> related to <code>sun.misc.Unsafe.park(Unsafe.java:299)</code>.<br>
<strong>Thread Pool</strong></p>

<pre><code>AsyncTask #9: WAITING
02-21 16:16:39.955 1611-1670/com.myCompany.MyProject W/System.err:  java.lang.Object.wait(Native Method)
02-21 16:16:39.955 1611-1670/com.myCompany.MyProject W/System.err:  java.lang.Thread.parkFor$(Thread.java:1220)
02-21 16:16:39.955 1611-1670/com.myCompany.MyProject W/System.err:  sun.misc.Unsafe.park(Unsafe.java:299)
02-21 16:16:39.955 1611-1670/com.myCompany.MyProject W/System.err:  java.util.concurrent.locks.LockSupport.park(LockSupport.java:158)
02-21 16:16:39.955 1611-1670/com.myCompany.MyProject W/System.err:  java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2013)
02-21 16:16:39.955 1611-1670/com.myCompany.MyProject W/System.err:  java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:410)
02-21 16:16:39.955 1611-1670/com.myCompany.MyProject W/System.err:  java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1036)
02-21 16:16:39.955 1611-1670/com.myCompany.MyProject W/System.err:  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1098)
02-21 16:16:39.955 1611-1670/com.myCompany.MyProject W/System.err:  java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:588)
02-21 16:16:39.955 1611-1670/com.myCompany.MyProject W/System.err:  java.lang.Thread.run(Thread.java:818)
</code></pre>
",3026578,,3026578,,2018-02-22 12:38:51,2019-01-17 22:42:07,Espresso Test Fail due to App not Idle Exception: The following Idle Conditions failed ASYNC_TASKS_HAVE_IDLED,<android><unit-testing><android-espresso><android-instrumentation>,1,2,1,
Android,39982859,1,,,2016,,1,1584,"<p>Is it possible to link platforms\android-XX\arch-arm\usr\lib*.a versions of libraries when using NDK Cmake build system with Android Studio? I'm using LLVM toolchain and Android NDK 13.</p>

<p>I have tried modifications on sample app, changing file: <a href=""https://github.com/googlesamples/android-ndk/blob/master-cmake/hello-jni/app/src/main/cpp/CMakeLists.txt"" rel=""nofollow"">https://github.com/googlesamples/android-ndk/blob/master-cmake/hello-jni/app/src/main/cpp/CMakeLists.txt</a></p>

<p>With following modification (adding libm.a):</p>

<pre><code>target_link_libraries(hello-jni libm.a android log)
</code></pre>

<p>Builds successfully, but readelf -d reveals that libm.so is still linked:</p>

<pre><code> 0x00000001 (NEEDED)                     Shared library: [libandroid.so]
 0x00000001 (NEEDED)                     Shared library: [liblog.so]
 0x00000001 (NEEDED)                     Shared library: [libm.so]
 0x00000001 (NEEDED)                     Shared library: [libdl.so]
 0x00000001 (NEEDED)                     Shared library: [libc.so]
</code></pre>

<p>When adding also libc.a it gets worse, building fails:</p>

<pre><code>Error:error: relocation overflow in R_ARM_THM_JUMP11
Error:error: linker command failed with exit code 1 (use -v to see invocation)
</code></pre>

<p>BTW, sometimes I see only last error without any explanation (for example, when misspelling library name). Should I set -v flag somehwere to see more details? How to do it?</p>
",6725342,,,,,2016-10-12 17:05:55,Linking static libraries libm.a or libc.a with NDK cmake,<android><c++><android-ndk><cmake><clang>,1,4,1,
Android,43440909,1,,,2017,,1,476,"<p>I use <a href=""https://github.com/googlesamples/android-vision/tree/master/visionSamples/barcode-reader"" rel=""nofollow noreferrer"">android vision sample</a> for scanning PDF417 barcode on South Africa driver license. 
For decoding information, I need to pass the byte array to another library. 
But I can get only get barcode.rawValue that is String.</p>

<p>Tring to get butes[] from string by barcode.rawValue.getBytes() returnes array this is not working with decode librery.</p>

<p>Need analog of Pdf417MobiScanData.getBarcodeRawData().getAllData()</p>

<p>Thank you.</p>
",7875525,,,,,2017-04-16 19:25:32,Get byte array with Android Vision scanning pdf417 barcode,<android><android-vision>,1,0,1,
Android,34017544,1,34018457,,2015,,1,3741,"<p>I have problems to get the example apps for Google Fit running provided by Google. </p>

<p>I figured out so far, that the <code>resultCode</code> I get in <code>onActivityResult</code> is <code>0</code> after I selected an <code>Account</code>.</p>

<p>The example app I use at the moment is <code>BasicRecordingApi</code>, which can be found <a href=""https://github.com/googlesamples/android-fit/tree/master/BasicRecordingApi"" rel=""nofollow"">here</a>.
But I've tried the others too.</p>

<p>I created an API key for the app and I enabled Google Fit API already.</p>

<p>Nothing helps.</p>

<p>Any ideas?</p>
",4548007,,2396432,,2015-12-01 10:20:18,2016-12-09 4:51:11,Android Google Fit example is not working,<android><google-fit><google-fit-sdk>,1,0,1,
Android,35211950,1,35214915,,2016,,1,2187,"<p>I want to test the Intent I'm sending from Activity A to Activity B.
There are samples for that, <a href=""https://github.com/googlesamples/android-testing/blob/master/ui/espresso/IntentsBasicSample/app/src/androidTest/java/com/example/android/testing/espresso/BasicSample/DialerActivityTest.java"" rel=""nofollow"">android-testing</a> and <a href=""http://developer.android.com/reference/android/support/test/espresso/intent/Intents.html"" rel=""nofollow"">espresso.intent.Intents</a>.</p>

<p>Unfortunately, I couldn't get it into work :(
I want to test following method in my first Activity.</p>

<pre><code>private void searchForDropOff()
    {
        this.startActivityForResult(PoiActivity.newIntent(this, PlacesAPIRequest.PARAM_SEARCH_TYPE_DESTINATION,
                        this.mBooking.getPickUp() != null ? this.getPickUp().getSafeLatLng() : this.mReferenceLatLng),
                        PlacesAPIRequest.PARAM_SEARCH_TYPE_DESTINATION);
    }
</code></pre>

<p>So, according to my references this is my test code:</p>

<pre><code>@RunWith(AndroidJUnit4.class)
public class FirstActivityTest
{
    @Rule
    public final IntentsTestRule&lt;FirstActivityTest&gt; mRule = new IntentsTestRule&lt;&gt;(FirstActivityTest.class);

    @Before
    public void stubAllExternalIntents()
    {
        // By default Espresso Intents does not stub any Intents. Stubbing needs to be setup before
        // every test run. In this case all external Intents will be blocked.
        intending(not(isInternal())).respondWith(new Instrumentation.ActivityResult(Activity.RESULT_OK, null));
    }

    @Test
    public void click_drop_off_box()
    {
        // Click drop-off box, POI activity displays
        onView(withId(R.id.booking_drop_off_layout)).perform(click());

        // Verify that an intent to the dialer was sent with the package.
        // Think of Intents intended API as the equivalent to Mockito's verify.
        intended(allOf(
                hasExtra(PoiActivity.EXTRA_SEARCH_TYPE, PlacesAPIRequest.PARAM_SEARCH_TYPE_DESTINATION),
                toPackage(""com.XXX.passenger.poi.PoiActivity"")));
    }
}
</code></pre>

<p>What I'm getting in Log:</p>

<pre><code>android.support.test.espresso.base.DefaultFailureHandler$AssertionFailedWithCauseError: Wanted to match 1 intents. Actually matched 0 intents.

IntentMatcher: (has extras: has bundle with: key: is ""addressType"" value: is &lt;2&gt; and resolvesTo: com.xxx.passenger.poi.PoiActivity)

Matched intents:[]

Recorded intents:
-Intent { cmp=com.xxx.passenger/com.xxx.passenger.poi.PoiActivity (has extras) } handling packages:[[com.xxx.passenger]], extras:[Bundle[{referencePoint=lat/lng: (1.3650683,103.8313499), addressType=2}]])
</code></pre>

<p>I'm confused a lot :( any idea would be appreciated. Thanks.</p>
",513413,,,,,2016-02-05 1:39:32,How to test Intent based on Espresso in Android?,<android><android-intent><android-espresso>,1,0,1,
Android,45586828,1,45586963,,2017,,1,1842,"<p>I have the following dependencies in my <code>build.gradle</code> file</p>

<pre><code> testCompile 'junit:junit:4.12'
testCompile 'org.mockito:mockito-core:1.9.5'
</code></pre>

<p>And my test class <code>EmailValidatorTest</code> has the following code</p>

<pre><code>  @Test
public void emailValidator_simpleEmail_returnsTrue(){

   assertThat(EmailValidator.isValidEmail(""name@ex.com""),is(true))
}
</code></pre>

<p>But i get the error as <code>Cannot resolve symbol assertThat</code>. I get only <code>assert</code> object .I'm currently working on a sample from <code>Android Developers</code> i,e : <code>https://github.com/googlesamples/android-testing/tree/master/unit/BasicSample</code>.</p>
",7785152,,3395198,,2017-08-09 9:57:29,2017-08-09 11:09:52,Cannot resolve symbol assertThat,<android><android-testing>,1,2,1,
Android,33686656,1,,,2015,,1,682,"<p>I'm trying to modify the universal music player app: <a href=""https://github.com/googlesamples/android-UniversalMusicPlayer"" rel=""nofollow"">https://github.com/googlesamples/android-UniversalMusicPlayer</a> </p>

<p>Since I'm trying to build this for AOSP 6.0, I have no Google Play Services or any other Google Apps on my device, and so cannot use any non-android api's or api's that depend on Google Libraries.</p>

<p>The ""Music provider"" class, seems to visit this url:</p>

<p><a href=""http://storage.googleapis.com/automotive-media/music.json"" rel=""nofollow"">http://storage.googleapis.com/automotive-media/music.json</a></p>

<p>As mentioned in this line:</p>

<pre><code>private static final String CATALOG_URL =
    ""http://storage.googleapis.com/automotive-media/music.json"";
</code></pre>

<p>This file contains a list of tracks that are hosted by Google online. It seems the app can stream these files, but for some reason it does not detect the music already on my device. Why is that ? How do I get the app to list the music tracks that are already on my device ?</p>
",2990509,,,,,2016-12-08 16:35:58,How to get the universal music player to detect on device music?,<android>,1,0,1,
Android,47874391,1,,,2017,,2,596,"<p>I've noticed an odd behavior when injecting ViewModels into my activities/fragments (following the example at <a href=""https://github.com/googlesamples/android-architecture-components/tree/master/GithubBrowserSample"" rel=""nofollow noreferrer"">GithubBrowserSample</a>).</p>

<p><strong>Trial 1</strong> At first I was just lazily seeing what happens when I use</p>

<pre><code>@Inject MainViewModel viewModel;
</code></pre>

<p>Obviously, I got a new instance of MainViewModel for every activity and when rotated.</p>

<p><strong>Trial 2</strong>
I then updated to using ""the right way"" of injecting the <code>ViewModelProvider.Factory</code> and grabbing the view model in <code>onCreate</code>:</p>

<pre><code>@Inject ViewModelProvider.Factory viewModelProviderFactory;
private MainViewModel viewModel;

@Override
public void onCreate(Bundle savedInstanceState) {
    viewModel = ViewModelProviders.of(this, viewModelProviderFactory)
            .get(MainViewModel::class);
}
</code></pre>

<p>This snippet works like a charm. Printing the viewModel will show that I get a new instance for each new activity instance triggered from a startActivity call but re-using when rotated. This got me thinking... Maybe I can just inject the MainViewModel.</p>

<p><strong>Trial 3</strong> I updated my MainActivityModule to include the following:</p>

<pre><code>@Provides @ActivityScope
public MainViewModel provideMainViewModel(MainActivity activity,
        ViewModelProvider.Factory factory) {
    return ViewModelProviders.of(activity, factory).get(MainViewModel::class);
}
</code></pre>

<p>This resulted in a new instance of MainViewModel even on screen rotations (same as trial 1). I verified that the provided ViewModelProvider.Factory instance is the same every time that provideMainViewModel is called. I also tried removing the @ActivityScope which caused even stranger behavior especially when trying to include the same instance of MainViewModel in both MainActivity and MainFragment1. The fragment got the same instance of MainViewModel as before the rotation, but the activity got a brand new one, even though both calls to provideMainViewModel were called with the same instance of MainActivity and the factory.</p>

<p><strong>Question</strong> Can anyone explain this? Is there no way for me to inject the ViewModel directly into my activity/fragment?</p>

<p><strong>UPDATE</strong></p>

<p>This is really baffling me so I've updated to include a full sample of the issue <a href=""https://github.com/yperess/android-architecture-components"" rel=""nofollow noreferrer"">HERE</a>. Note that I've had to update AppInjector's <code>FragmentLifecycleCallback</code> to inject the fragment during <code>onFragmentPreCreated</code>. This was done due to the lifecycle of a fragment, the current implementation seen in <code>SearchFragment</code> using <code>SearchViewModel</code> will get the instance of the view model during <code>onActivityCreated</code> which may be called more than once on the same fragment. In such a case, the same view model will be returned from <code>ViewModelProviders</code> and multiple observers will be registered. Instead Fragments should be injected before <code>onCreate</code> and any LiveData observers should be registered at that point.</p>

<p>When run and rotated, you'll see the following logs:</p>

<pre><code>12-19 22:48:28.538 7116-7116/com.android.example.github D/MainActivityProvidersMo: provideMainViewModel for com.android.example.github.MainActivity@78c5d27 using com.android.example.github.viewmodel.GithubViewModelFactory@6d6c140: com.android.example.github.MainViewModel@fd1f879
12-19 22:48:28.611 7116-7116/com.android.example.github D/MainActivity: viewModel: com.android.example.github.MainViewModel@fd1f879
12-19 22:48:28.615 7116-7116/com.android.example.github D/dagger.android.support: An injector for com.android.example.github.ui.search.SearchFragment was found in com.android.example.github.MainActivity
12-19 22:48:28.616 7116-7116/com.android.example.github D/SearchFragment: mainViewModel: com.android.example.github.MainViewModel@fd1f879
12-19 22:48:28.760 7116-7116/com.android.example.github D/SearchFragment: results live data has observers? false


12-19 22:48:40.579 7116-7116/com.android.example.github D/MainActivityProvidersMo: provideMainViewModel for com.android.example.github.MainActivity@d1f344f using com.android.example.github.viewmodel.GithubViewModelFactory@6d6c140: com.android.example.github.MainViewModel@c5387dc
12-19 22:48:40.581 7116-7116/com.android.example.github D/dagger.android.support: An injector for com.android.example.github.ui.search.SearchFragment was found in com.android.example.github.MainActivity
12-19 22:48:40.583 7116-7116/com.android.example.github D/SearchFragment: mainViewModel: com.android.example.github.MainViewModel@c5387dc
12-19 22:48:40.625 7116-7116/com.android.example.github D/MainActivity: viewModel: com.android.example.github.MainViewModel@c5387dc
12-19 22:48:40.715 7116-7116/com.android.example.github D/SearchFragment: results live data has observers? false
</code></pre>
",3456952,,3456952,,2017-12-20 4:00:36,2018-01-13 16:45:47,Dagger 2 inject ViewModel odd behavior (ViewModel not re-used on screen rotation),<android><mvvm><android-lifecycle><dagger-2>,1,0,1,
Android,28685027,1,28789178,,2015,,2,4714,"<p>Still not understanding if this is possible without root or not.I think that if it is possible to record the screen on video, this is also possible, have anyone done it yet?</p>

<p><a href=""https://github.com/googlesamples/android-ScreenCapture"" rel=""nofollow"">Been learning some code from this project, but still nothing</a></p>
",2129008,,,,,2015-03-01 1:46:05,Can Media Projection api take a screenshot from my home screen on lollipop?,<android><screenshot><android-5.0-lollipop>,1,0,1,
Android,37816319,1,37858843,,2016,,2,54,"<p>I try to receive Text via Bluetooth (BT) using Android. I can view the Text using a pre-existing Bluetooth logger from the Google Play store, but with my own code it does not work correct.</p>

<p>In general I use the default BT code from the Android documentation and <a href=""https://github.com/googlesamples/android-BluetoothChat"" rel=""nofollow"">samples</a>. I log the received Text. I expect my text to be something like:
<code>-0.01, -0.03, 1.04</code>, but I only receive parts of it. Here is a part of the logs:</p>

<pre><code>06-14 17:25:01.925 28217-28412/[...]: I read the following: 0.01, -0.
06-14 17:25:01.977 28217-28412/[...]: I read the following: 
06-14 17:25:02.039 28217-28412/[...]: I read the following: -
06-14 17:25:02.051 28217-28412/[...]: I read the following: 0.01, -0.
06-14 17:25:02.101 28217-28412/[...]: I read the following: 
06-14 17:25:02.174 28217-28412/[...]: I read the following: -
</code></pre>

<p>This is the code I use to read from BT:</p>

<pre><code>    public void run() {
        byte[] buffer = new byte[1024];  // buffer store for the stream
        int bytes; // bytes returned from read()

        // Keep listening to the InputStream until an exception occurs
        while (true) {
            try {
                // Read from the InputStream
                bytes = mmInStream.read(buffer);
                String readMessage = new String(buffer, 0, bytes);
                Log.e(Constants.TAG, ""I read the following: ""+readMessage);
            } catch (IOException e) {
                break;
            }
        }
    }
</code></pre>

<p>Not sure if it's relevant, but I am using an HC-06 BT module connected to an Arduino sending data with <code>9600</code> Baud. I can give you the code for this as well.</p>

<p>I tried two different Android phones with the same result. Wiko Fever and Moto G2.</p>
",1548788,,3956566,,2016-06-14 15:41:27,2016-06-16 12:10:59,Android ReceiveReceive Text via Bluetooth,<android><logging><arduino><android-bluetooth>,1,0,1,
Android,27876937,1,,,2015,,2,508,"<p>I imported WatchFace sample <a href=""https://github.com/googlesamples/android-WatchFace"" rel=""nofollow"">https://github.com/googlesamples/android-WatchFace</a>
however I cannot run phone app neither install watch faces to the emulator.
That sample project's phone app doesn't have default activity, but when I'm trying to start any of it's activities, it gives Null exception on ComponentName</p>

<pre><code>Caused by: java.lang.NullPointerException
        at com.example.android.wearable.watchface.DigitalWatchFaceCompanionConfigActivity.onCreate(DigitalWatchFaceCompanionConfigActivity.java:77)
        at android.app.Activity.performCreate(Activity.java:5231)
        at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1087)
        at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2169)    
</code></pre>

<p>row 77 is the last one in the onCreate method:</p>

<pre><code>@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_digital_watch_face_config);

    mPeerId = getIntent().getStringExtra(WatchFaceCompanion.EXTRA_PEER_ID);
    mGoogleApiClient = new GoogleApiClient.Builder(this)
            .addConnectionCallbacks(this)
            .addOnConnectionFailedListener(this)
            .addApi(Wearable.API)
            .build();

    ComponentName name = getIntent().getParcelableExtra(
            WatchFaceCompanion.EXTRA_WATCH_FACE_COMPONENT);
    TextView label = (TextView)findViewById(R.id.label);
    label.setText(label.getText() + "" ("" + name.getClassName() + "")"");
}
</code></pre>

<p>I set wearable app to not running any activity so it should install watch faces to the emulator. However is does not install anything.</p>

<p>I hope this is not a totally broken sample and I am just doing something very wrong, just can figure out what?
 Simple ""hello world"" app works OK and install with no issues when running on the same machine.</p>
",4439998,,1672895,,2015-01-10 14:36:49,2015-01-19 21:42:52,WatchFace sample - how to run,<android><nullpointerexception><sample>,1,0,1,
Android,46275819,1,,,2017,,2,283,"<p>im very confused with NDK and with OpenSL 
Im trying to add OpenSL to my project. And have some problems. When i create ndk project- i dont have file Android.mk
but i have CMakeList</p>

<p>in tutorials everywhere talks about android.mk where need write one string for implement OpenSL to project.</p>

<p>here my build.graddle(module) file</p>

<pre><code>android {
    compileSdkVersion 26
    buildToolsVersion ""26.0.1""

    defaultConfig {
        minSdkVersion 15
        targetSdkVersion 26
        versionCode 1
        versionName ""1.0""
    }
    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
    externalNativeBuild {
        cmake {
            path 'CMakeLists.txt'
        }
    }

    sourceSets {
        main {
            jniLibs.srcDirs 'imported-lib/src/', 'more-imported-libs/src/'
        }
    }
}

dependencies {
    compile fileTree(dir: 'libs', include: ['*.jar'])
    compile 'com.android.support:appcompat-v7:26.+'
}
</code></pre>

<p>CMakeList.txt</p>

<pre><code>cmake_minimum_required(VERSION 3.4.1)
add_library( # Specifies the name of the library.
             native-lib

             # Sets the library as a shared library.
             SHARED

             # Provides a relative path to your source file(s).
             src/main/cpp/native-lib.cpp )

             # Specifies a path to native header files.
             include_directories(src/main/cpp/include/)

             # Include libraries needed for native-audio-jni lib
             target_link_libraries(native-audio-jni
                                   android
                                   log
                                   OpenSLES)
</code></pre>

<p>and a simple test for ndk </p>

<pre><code>#include &lt;jni.h&gt;
#include &lt;string&gt;

extern ""C""
JNIEXPORT jstring JNICALL
Java_ndk_test_stringFromJNI(
        JNIEnv *env,
        jobject /* this */) {
    std::string hello = ""Hello from C++"";
    return env-&gt;NewStringUTF(hello.c_str());
}
</code></pre>

<p>calling function stringFromJNI is ok i see this line in logs. 
But main question what im doing wrong. How to implement OpenSL without Android.mk</p>

<p>In google.devandroid section its tell 
add <code>LOCAL_LDLIBS += -lOpenSLES</code> to Android.mk
in every tutorial all tells about android.mk. But i dont have this file. Can any help me ? 
in example of goo<a href=""https://github.com/googlesamples/android-ndk/tree/master/native-audio/app/src/main/cpp"" rel=""nofollow noreferrer"">link to example</a></p>
",562592,,,,,2017-09-29 13:23:26,Add OpenSL to android,<java><android><android-ndk><opensl>,1,2,1,
Android,39281557,1,39352506,,2016,,2,1355,"<p>I am detecting text using a pipeline just like the <a href=""https://github.com/googlesamples/android-vision/tree/master/visionSamples/ocr-reader"" rel=""nofollow"">Google CodeLabs sample code</a>.  How do I get the preview Frame that the CameraSource sends to the TextRecognizer?</p>
",3561610,,,,,2016-09-06 15:15:27,Get Frame when detecting text using a pipeline in Android Mobile Vision,<android><android-vision>,1,0,1,
Android,40533276,1,,,2016,,2,1167,"<p>I was working on taking a photo from my camera, and everything seems good, I'm using <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""nofollow noreferrer"">Camera2Basic</a> sample, this code only offre the back camera so i added a button to switch between 2 cameras like this :</p>

<p>Boolean facingCamera = true; // initialization</p>

<pre><code>onClick() {
    facingCamera = !facingCamera;
    closeCamera();
    openCamera(mTextureView.getWidth(), mTextureView.getHeight()); 
}
</code></pre>

<p>And i changed method setUpCameraOutputs code like this :</p>

<pre><code>if (facing != null &amp;&amp; facing == CameraCharacteristics.LENS_FACING_FRONT ) {
    continue;
}
</code></pre>

<p><strong>To</strong></p>

<pre><code>if (facing != null &amp;&amp; facing == CameraCharacteristics.LENS_FACING_FRONT &amp;&amp; !facingCamera 
|| facing != null &amp;&amp; facing == CameraCharacteristics.LENS_FACING_BACK &amp;&amp; facingCamera ) {
    continue;
}
</code></pre>

<p>This work fine for Nexus 4 but for my LG-D802 is not working fine ( onConfigureFailed is called each time I try to change the camera )</p>

<p>How to fix this properly so it work fine on all devices?</p>
",6325994,,,,,2018-08-11 16:01:19,Android: Camera2 switching between back and front camera,<android><android-camera><android-camera2>,1,0,1,
Android,50782496,1,,,2018,,2,411,"<p>I have a class in my app with executors for disk/network operations, like <a href=""https://github.com/googlesamples/android-architecture-components/blob/master/GithubBrowserSample/app/src/main/java/com/android/example/github/AppExecutors.kt"" rel=""nofollow noreferrer"">this</a>. Is it possible to tell Room to use one of those to execute live queries?</p>
",3998718,,,,,2018-06-10 20:07:26,How to specify which thread(s) room live queries to run on?,<android><android-room><android-architecture-components>,1,3,1,
Android,38274943,1,38798556,,2016,,2,7468,"<p>I am currently trying to build a static library of some source c++ files requiring boost. I have been following the <a href=""https://github.com/googlesamples/android-ndk/tree/master/hello-libs"" rel=""nofollow"">hello-libs</a> example and have successfully linked the boost static file dependencies as is done in the sample example.Now said that, during while building the module I get these erros :</p>

<blockquote>
  <p>Error:error: undefined reference to 'std::basic_string, std::allocator >::basic_string(char const*, std::allocator const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::runtime_error::runtime_error(std::string const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::_Rb_tree_decrement(std::_Rb_tree_node_base*)'</p>
  
  <p>Error:error: undefined reference to 'std::string::_Rep::_S_empty_rep_storage'</p>
  
  <p>Error:error: undefined reference to 'std::basic_string, std::allocator >::~basic_string()'</p>
  
  <p>Error:error: undefined reference to 'std::string::_Rep::_M_dispose(std::allocator const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::runtime_error::runtime_error(std::string const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::string::_Rep::_M_destroy(std::allocator const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::basic_string, std::allocator >::basic_string(std::string const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::_Rb_tree_increment(std::_Rb_tree_node_base*)'</p>
  
  <p>Error:error: undefined reference to 'std::string::_Rep::_S_empty_rep_storage'</p>
  
  <p>Error:error: undefined reference to 'std::string::_Rep::_M_destroy(std::allocator const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::basic_string, std::allocator >::basic_string(std::string const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::string::_Rep::_M_destroy(std::allocator const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::_Rb_tree_increment(std::_Rb_tree_node_base const*)'</p>
  
  <p>Error:error: undefined reference to 'std::_Rb_tree_rebalance_for_erase(std::_Rb_tree_node_base*, std::_Rb_tree_node_base&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::string::_Rep::_S_empty_rep_storage'</p>
  
  <p>Error:error: undefined reference to 'std::string::_Rep::_S_empty_rep_storage'</p>
  
  <p>Error:error: undefined reference to 'std::basic_string, std::allocator >::basic_string(char const*, std::allocator const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::basic_string, std::allocator >::basic_string(std::string const&amp;)'</p>
  
  <p>Error:error: linker command failed with exit code 1 (use -v to see invocation)</p>
  
  <p>Error:error: undefined reference to 'std::basic_string, std::allocator >::basic_string(char const*, std::allocator const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::string::_Rep::_M_destroy(std::allocator const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::_Rb_tree_rebalance_for_erase(std::_Rb_tree_node_base*, std::_Rb_tree_node_base&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::string::_Rep::_M_dispose(std::allocator const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::basic_string, std::allocator >::basic_string(char const*, std::allocator const&amp;)'</p>
  
  <p>Error:error: undefined reference to 'std::_Rb_tree_insert_and_rebalance(bool, std::_Rb_tree_node_base*, std::_Rb_tree_node_base*, std::_Rb_tree_node_base&amp;)'</p>
  
  <p>Error:Execution failed for task ':dummy:linkDummyArmeabiDebugSharedLibrary'.</p>
  
  <p>A build operation failed.
        Linker failed while linking libdummy.so.
    See the complete log at: file:///home/cran-cg/Downloads/Hello-libs-boost/name/build/tmp/linkDummyArmeabiDebugSharedLibrary/output.txt</p>
</blockquote>

<p>I had been trying to resolve this and had come upon many solutions on stackoverflow itself, suggesting that I should amend my linker path and include libc++.so library </p>

<pre><code>ndk{
        moduleName = 'p2psp'
        stl = ""c++_shared""
       // ldLibs.addAll('-L'+ file(""/home/cran-cg/Android/Sdk/ndk-bundle/sources/cxx-stl/llvm-libc++/libs/armeabi"").absolutePath)
        ldLibs.addAll(['android', 'log','atomic'])/*""${NDK_ROOT}/sources/cxx-stl/gnu-libstdc++/4.9/libs/armeabi"",'gnustl_static'*/
        toolchain = ""clang""
        cppFlags.add(""-std=c++11"")
        cppFlags.add('-frtti')
        cppFlags.add('-fexceptions')
        cppFlags.addAll('-I' + file(""/home/cran-cg/Android/Sdk/ndk-bundle/sources/cxx-stl/llvm-libc++/libcxx/include"").absolutePath ,'-DANDROID', ' -DANDROID_NDK', '-DAWS_CUSTOM_MEMORY_MANAGEMENT', '-fPIC', '-fexceptions')
        //cppFlags.add(""-I${lib_distribution_root}/boost/include"".toString())
        //cppFlags.add(""-I${file(""src/main/jni/inc"")}"".toString())

        abiFilters.addAll(['armeabi'])//, 'armeabi-v7a', 'x86'])
    }
</code></pre>

<p>And I am confused of what should be done. Please suggest me ways as to how can I resolve this issue. Thanks :))</p>
",3254749,,3254749,,2016-07-08 22:07:41,2016-08-05 22:29:34,Android NDK linker Error:error: undefined reference to std::basic_string,<c++11><android-ndk><android-gradle><build.gradle><ndk-build>,1,0,1,
Android,48774255,1,48972468,,2018,,2,353,"<p><a href=""https://github.com/googlesamples/android-architecture/tree/todo-mvp-dagger/todoapp/app/src/main/java/com/example/android/architecture/blueprints/todoapp"" rel=""nofollow noreferrer"">Google Repo Link</a>. All of the boilerplate code is taken from there.</p>

<p>I just can't figure out how to add my own dependencies to this architecture.
I want to do the following things:</p>

<ol>
<li>I need to use one of the presenters in a non-fragment class.</li>
<li>I need to add a network module, which provides a simple OkHttp client.</li>
</ol>

<p>I understand dagger in general, but dagger-android confuses me in many parts..</p>

<p><strong>ToDoApplication:</strong></p>

<pre><code>public class ToDoApplication extends DaggerApplication {
    @Inject
    TasksRepository tasksRepository;

    @Inject
    AsyncTask asyncTask;

    @Override
    protected AndroidInjector&lt;? extends DaggerApplication&gt; applicationInjector() {
        return DaggerAppComponent.builder().application(this).build();
    }
}
</code></pre>

<p><strong>AppComponent:</strong></p>

<pre><code>@Singleton
@Component(modules = {TasksRepositoryModule.class,
        ApplicationModule.class,
        ActivityBindingModule.class,
        AndroidSupportInjectionModule.class})
public interface AppComponent extends AndroidInjector&lt;ToDoApplication&gt; {

    TasksRepository getTasksRepository();
    AsyncTask getAsyncTask();

    @Component.Builder
    interface Builder {

        @BindsInstance
        AppComponent.Builder application(Application application);

        AppComponent build();
    }
}
</code></pre>

<p><strong>ApplicationModule:</strong></p>

<pre><code>@Module
public abstract class ApplicationModule {
    //expose Application as an injectable context
    @Binds
    abstract Context bindContext(Application application);
}
</code></pre>

<p><strong>ActivityBindingModule:</strong></p>

<pre><code>@Module
public abstract class ActivityBindingModule {
    @ActivityScoped
    @ContributesAndroidInjector(modules = TasksModule.class)
    abstract TasksActivity tasksActivity();

    @ActivityScoped
    @ContributesAndroidInjector(modules = AddEditTaskModule.class)
    abstract AddEditTaskActivity addEditTaskActivity();

    @ActivityScoped
    @ContributesAndroidInjector(modules = StatisticsModule.class)
    abstract StatisticsActivity statisticsActivity();

    @ActivityScoped
    @ContributesAndroidInjector(modules = TaskDetailPresenterModule.class)
    abstract TaskDetailActivity taskDetailActivity();
}
</code></pre>

<hr>

<p><strong>ExampleModule:</strong></p>

<pre><code>@Module
public abstract class TasksModule {
    @FragmentScoped
    @ContributesAndroidInjector
    abstract TasksFragment tasksFragment();

    @ActivityScoped
    @Binds abstract TasksContract.Presenter taskPresenter(TasksPresenter presenter);
}
</code></pre>

<p><strong>ExampleActivity:</strong></p>

<pre><code>public class TasksActivity extends DaggerAppCompatActivity {
 @Inject
    TasksPresenter mTasksPresenter;
    @Inject
    Lazy&lt;TasksFragment&gt; taskFragmentProvider;

...
</code></pre>

<p><strong>Example Fragment:</strong></p>

<pre><code>@ActivityScoped
public class TasksFragment extends DaggerFragment implements TasksContract.View {

    @Inject
    TasksContract.Presenter mPresenter;

...
</code></pre>

<p><strong>Example Presenter:</strong></p>

<pre><code>@ActivityScoped
final class TasksPresenter implements TasksContract.Presenter {

    @Inject
    TasksPresenter(TasksRepository tasksRepository) {
        mTasksRepository = tasksRepository;
    }

...
</code></pre>

<hr>

<p>The code above is all correctly working. Now my problem:</p>

<ol>
<li><p>I have an <code>AsyncTask</code>, which needs a presenter to post something in it's <code>onPostExecute</code> method. I injected the presenter, but I get the error that the presenter is not initialized.</p></li>
<li><p>I added the following <code>NetworkModule</code> to the module array in <code>@Component</code> and simply injected it in the <code>AsyncTask</code>, but it's not working (error: ... not initialized). What else would I have to add?</p></li>
</ol>

<p><strong>NetworkModule:</strong></p>

<pre><code>@Module
class NetworkModule {

    @Provides
    @Singleton
    fun provideOkHttp(): OkHttpClient {
        return OkHttpClient()
    }
}
</code></pre>

<p><strong>AsyncTask</strong></p>

<pre><code>private class MyAsyncTask extends AsyncTask&lt;String, Integer, Long&gt; {

     @Inject 
     TasksPresenter presenter;
     @Inject
     OkHttpClient client;

     protected Long doInBackground(String... params) {
         client.doSomething();
         ...
     }


     protected void onPostExecute(Long result) {
         ...
         presenter.doSomething();
     }
 }
</code></pre>

<p>All of my code is correctly working without dagger so you don't have to worry about it. :)</p>

<p>I hope somebody can help me. If you have further questions feel free to ask!</p>
",7295614,,7295614,,2018-02-15 16:22:09,2018-02-25 10:29:15,How to extend the Google android architecture dagger sample?,<java><android><dagger-2><dagger-android>,1,4,1,
Android,43765499,1,43766165,,2017,,2,645,"<p>Anybody knows how can I handle exceptions coming from native method calls?</p>

<p>I'm running the <a href=""https://github.com/googlesamples/android-vision/tree/master/visionSamples/barcode-reader"" rel=""nofollow noreferrer"">Barcode Reader example from Google Vision API</a>, it works very well reading some 2d - pdf417 codes, but in some cases it crashes with a native exception attempting to use <code>NewStringUTF</code> like this:</p>

<pre><code>    art/runtime/java_vm_ext.cc:410] JNI DETECTED ERROR IN APPLICATION: input is not valid Modified UTF-8: illegal start byte 0x90
    art/runtime/java_vm_ext.cc:410]     in call to NewStringUTF
    art/runtime/java_vm_ext.cc:410]     from com.google.android.gms.vision.barcode.internal.NativeBarcode[] com.google.android.gms.vision.barcode.internal.NativeBarcodeDetector.recognizeNative(int, int, byte[], com.google.android.gms.vision.barcode.internal.NativeOptions)
    art/runtime/java_vm_ext.cc:410] ""Thread-4533"" prio=5 tid=19 Runnable
    art/runtime/java_vm_ext.cc:410]   | group=""main"" sCount=0 dsCount=0 obj=0x12c8e0a0 self=0x7f849f4200
    art/runtime/java_vm_ext.cc:410]   | sysTid=9051 nice=0 cgrp=default sched=0/0 handle=0x7f7b7bf440
    art/runtime/java_vm_ext.cc:410]   | state=R schedstat=( 1663092757 5060164 94 ) utm=165 stm=1 core=2 HZ=100
    art/runtime/java_vm_ext.cc:410]   | stack=0x7f7b6bd000-0x7f7b6bf000 stackSize=1037KB
    art/runtime/java_vm_ext.cc:410]   | held mutexes= ""mutator lock""(shared held)
    art/runtime/java_vm_ext.cc:410]   native: #00 pc 00000000004897a8  /system/lib64/libart.so (_ZN3art15DumpNativeStackERNSt3__113basic_ostreamIcNS0_11char_traitsIcEEEEiP12BacktraceMapPKcPNS_9ArtMethodEPv+200)
    art/runtime/java_vm_ext.cc:410]   native: #01 pc 0000000000458644  /system/lib64/libart.so (_ZNK3art6Thread4DumpERNSt3__113basic_ostreamIcNS1_11char_traitsIcEEEEP12BacktraceMap+224)
    art/runtime/java_vm_ext.cc:410]   native: #02 pc 000000000030c9e4  /system/lib64/libart.so (_ZN3art9JavaVMExt8JniAbortEPKcS2_+1004)
    art/runtime/java_vm_ext.cc:410]   native: #03 pc 000000000030d29c  /system/lib64/libart.so (_ZN3art9JavaVMExt9JniAbortVEPKcS2_St9__va_list+116)
    art/runtime/java_vm_ext.cc:410]   native: #04 pc 0000000000141f9c  /system/lib64/libart.so (_ZN3art11ScopedCheck6AbortFEPKcz+144)
    art/runtime/java_vm_ext.cc:410]   native: #05 pc 000000000014a1d0  /system/lib64/libart.so (_ZN3art11ScopedCheck5CheckERNS_18ScopedObjectAccessEbPKcPNS_12JniValueTypeE.constprop.116+11084)
    art/runtime/java_vm_ext.cc:410]   native: #06 pc 0000000000153418  /system/lib64/libart.so (_ZN3art8CheckJNI12NewStringUTFEP7_JNIEnvPKc+468)
    art/runtime/java_vm_ext.cc:410]   native: #07 pc 0000000000005774  /data/data/com.google.android.gms/files/com.google.android.gms.vision/barcode/libs/arm64-v8a/libbarhopper.so (_ZN9barhopper9JniObject14SetStringFieldEPKcRKNSt3__112basic_stringIcNS3_11char_traitsIcEENS3_9allocatorIcEEEE+168)
    art/runtime/java_vm_ext.cc:410]   native: #08 pc 00000000000036f8  /data/data/com.google.android.gms/files/com.google.android.gms.vision/barcode/libs/arm64-v8a/libbarhopper.so (???)
    art/runtime/java_vm_ext.cc:410]   native: #09 pc 0000000000004c8c  /data/data/com.google.android.gms/files/com.google.android.gms.vision/barcode/libs/arm64-v8a/libbarhopper.so (Java_com_google_android_gms_vision_barcode_internal_NativeBarcodeDetector_recognizeNative+84)
</code></pre>

<p>I would like to handle the crash in order to catch it and give some feedback to the user.</p>
",1623501,,,,,2017-05-03 17:08:10,Google Vision API: Handle native crash,<android><google-play-services><google-vision><android-vision>,1,0,1,
Android,53193247,1,53341010,,2018,,2,1575,"<p>I am trying to write Android Instrumented test using Espresso. When I run the test I get this error</p>

<blockquote>
  <p>java.lang.IllegalStateException: No instrumentation registered! Must run under a registering instrumentation.</p>
</blockquote>

<p>I can't understand what this error means.</p>

<p>I will briefly explain what I am doing in my test. I followed the <a href=""https://github.com/googlesamples/android-testing"" rel=""nofollow noreferrer"">samples</a> given by google and <a href=""https://github.com/LearnShareKnowledge/EspressoTestingUi"" rel=""nofollow noreferrer"">EspressoTesting Tutorial</a></p>

<pre><code>@SmallTest
@RunWith(AndroidJUnit4.class)
public class ActivityInputTest {

   @Rule
   public ActivityTestRule&lt;ActivityInput&gt; aiRule = new ActivityTestRule&lt;&gt;(ActivityInput.class);


   @Before
   public void setUp(){}
}
</code></pre>

<p>When I run the test the error occurs at annotation <code>@Rule</code>. Can I get some explanation why this happens or what is the issue behind this? I am not interested in working code but more on the actual problem behind the issue.</p>
",1965914,,1043380,,2018-11-08 16:48:19,2018-11-16 15:37:09,Android Instrumentation Testing: No instrumentation registered Error,<java><android><android-studio><android-espresso>,1,0,1,
Android,54402542,1,,,2019,,2,96,"<p>I have followed Android Architecture Blueprints Dagger2 for dependency injection : <a href=""https://github.com/googlesamples/android-architecture/tree/todo-mvp-dagger"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-architecture/tree/todo-mvp-dagger</a></p>

<p>Now I want to inject Adapter to my Fragment class : </p>

<pre><code>@ActivityScoped
class MainFragment @Inject
constructor(): DaggerFragment() {

    @Inject lateinit var adapter : ArtistAdapter 
}
</code></pre>

<p>And I have following in the module class : </p>

<pre><code>@Module
abstract class MainModule {
    @FragmentScoped
    @ContributesAndroidInjector
    internal abstract fun mainFragment(): MainFragment

    @Module
    companion object {
        @Provides
        @ActivityScoped
        @JvmStatic internal fun provideArtistAdapter() = ArtistAdapter()
    }
}
</code></pre>

<p>But for some reason it fails to display data in RecyclerView. When I don't use injection and simply use <code>val adapter = ArtistAdapter()</code>, it works.</p>

<p>What am I missing in injection using Dagger2?</p>

<p>Addenda :</p>

<p><code>mainFragment</code> is implementing a callback as a click listener:</p>

<pre><code>interface ArtistClickCallback {
    fun onClick(artist: LastFmArtist, poster : ImageView)
}
</code></pre>

<p>And :</p>

<pre><code>class MainFragment : DaggerFragment(), ArtistClickCallback
</code></pre>

<p>And here is fragment module :</p>

<pre><code>@Module
class MainFragmentModule {

    @Provides
    fun provideArtistAdapter(mainFragment: MainFragment) = ArtistAdapter(mainFragment)

}
</code></pre>

<p>But I get following exception when I remove @Inject from Fragment constructor:</p>

<pre><code>error: [Dagger/MissingBinding] com.sample.android.lastfm.ui.main.MainFragment cannot be provided without an @Inject constructor or an @Provides-annotated method. This type supports members injection but cannot be implicitly provided.
public abstract interface AppComponent extends dagger.android.AndroidInjector&lt;com.sample.android.lastfm.LastFmApp&gt; {
                ^
  A binding with matching key exists in component: com.sample.android.lastfm.ui.main.MainModule_MainFragment$app_debug.MainFragmentSubcomponent
      com.sample.android.lastfm.ui.main.MainFragment is injected at
          com.sample.android.lastfm.ui.main.MainActivity.mainFragment
      com.sample.android.lastfm.ui.main.MainActivity is injected at
          dagger.android.AndroidInjector.inject(T) [com.sample.android.lastfm.di.AppComponent → com.sample.android.lastfm.di.ActivityBindingModule_MainActivity$app_debug.MainActivitySubcomponent]
</code></pre>
",1315447,,1315447,,2019-02-20 11:50:59,2019-02-20 11:50:59,Inject Adapter to Fragment using Dagger2,<android><kotlin><recycler-adapter><dagger-2>,1,4,1,
Android,54489418,1,54490336,,2019,,2,111,"<p>The <a href=""https://github.com/googlesamples/android-sunflower"" rel=""nofollow noreferrer"">sunflower example app by Google</a> uses a private Class with a companion object to implement a Singleton pattern of their repository instead of simply implementing the repository as an (inherently Singleton) Object. </p>

<p>This is the first time I've seen a Singleton implemented this way in Kotlin instead of implementing it as an Object. In what context(s) should this private constructor implementation be used instead of the more common Object implementation?</p>

<pre><code>class GardenPlantingRepository private constructor(
  private val gardenPlantingDao: GardenPlantingDao
) {
  suspend fun createGardenPlanting(plantId: String) {
    withContext(IO) {
      val gardenPlanting = GardenPlanting(plantId)
      gardenPlantingDao.insertGardenPlanting(gardenPlanting)
    }
  }

  suspend fun removeGardenPlanting(gardenPlanting: GardenPlanting) {
    withContext(IO) {
      gardenPlantingDao.deleteGardenPlanting(gardenPlanting)
    }
  }

  fun getGardenPlantingForPlant(plantId: String) =

    gardenPlantingDao.getGardenPlantingForPlant(plantId)

  fun getGardenPlantings() = gardenPlantingDao.getGardenPlantings()

  fun getPlantAndGardenPlantings() = gardenPlantingDao.getPlantAndGardenPlantings()

  companion object {
    // For Singleton instantiation
    @Volatile private var instance: GardenPlantingRepository? = null

    fun getInstance(gardenPlantingDao: GardenPlantingDao) =
      instance ?: synchronized(this) {
        instance ?: GardenPlantingRepository(gardenPlantingDao).also { instance = it }
      }
  }
}
</code></pre>
",490375,,,,,2019-02-02 5:41:44,Kotlin Singletons: Object vs a Class with private constructor,<kotlin><singleton>,1,0,1,
Android,54608165,1,,,2019,,2,303,"<p>I'm trying to run the barcode-reader example ( <a href=""https://github.com/googlesamples/android-vision/tree/master/visionSamples/barcode-reader"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-vision/tree/master/visionSamples/barcode-reader</a> ) as it is on my Nokia 2.1 running Android 8.1.0 and Google Play Services 15.0.90. The camera starts but no barcode is detected and in the logcat I get (continuously while the camera is working) the following error:</p>

<p><code>2019-02-09 18:17:04.990 3364-3497/com.google.android.gms.samples.vision.barcodereader E/BarcodeNativeHandle: Error Loading module com.google.android.gms.dynamite.DynamiteModule$LoadingException: No acceptable module found. Local version is 0 and remote version is 0. at com.google.android.gms.dynamite.DynamiteModule.load(Unknown Source:8) at com.google.android.gms.internal.vision.zzl.zzp(Unknown Source:39) at com.google.android.gms.internal.vision.zzl.isOperational(Unknown Source:0) at com.google.android.gms.vision.barcode.BarcodeDetector.isOperational(Unknown Source:2) at com.google.android.gms.vision.Detector.receiveFrame(Unknown Source:16) at com.google.android.gms.samples.vision.barcodereader.ui.camera.CameraSource$FrameProcessingRunnable.run(CameraSource.java:1205) at java.lang.Thread.run(Thread.java:764)</code></p>

<p>What can I do to be able to run it?</p>

<p>Thanks!</p>
",618437,,484073,,2019-03-01 6:53:43,2019-03-01 6:54:11,Barcode scanning is not working with vision API,<android><barcode-scanner><android-vision><firebase-mlkit>,1,1,1,
Android,30163964,1,30875643,,2015,,3,1164,"<p>I have been trying to get device owner, inspired by <a href=""https://github.com/googlesamples/android-DeviceOwner"" rel=""nofollow noreferrer"">google sample code</a></p>

<p>Using adb, I am able to get device owner on nexus 4,5,7,9 and micromax. However in LG G Pad (LG-V400) and LG G3 (LG G3 855) I get an error.</p>

<pre><code>java.lang.SecurityException: Neither user 2000 nor current process has android.permission.BIND_DEVICE_ADMIN.
</code></pre>

<p>I noticed that the device admin is enabled on these devices, but not the device owner. I was able to capture the bug report from the device found <a href=""https://drive.google.com/file/d/0B6pcRab4JKQJZ3pNc29vTjN1cFk/view?usp=sharing"" rel=""nofollow noreferrer"">here</a>.<img src=""https://i.stack.imgur.com/mRyFH.png"" alt=""enter image description here""></p>

<p>I have tried contacting LG but havent heard back anything.</p>

<p>Any help is greatly appreciated.</p>
",3916830,,,,,2015-07-13 14:47:22,Device owner issue using adb method with LG devices only,<android><adb><android-5.0-lollipop><device-owner>,1,0,1,
Android,47051069,1,48248557,,2017,,3,317,"<p>I am playing with <a href=""https://developer.android.com/guide/topics/ui/look-and-feel/downloadable-fonts.html"" rel=""nofollow noreferrer"">Downloadable fonts api</a>. I downloaded the  <a href=""https://github.com/googlesamples/android-DownloadableFonts"" rel=""nofollow noreferrer"">Google sample application</a> and also incorporated the code into my project. Both run successfully but some fonts consistently fail to download both from my app and from the sample app. </p>

<p>I use <code>FontsContractCompat.requestFont</code> and gets a callback to <code>onTypefaceRequestFailed(int reason)</code> with reason 1. The documentation says it means ""FAIL_REASON_FONT_NOT_FOUND"". 
I assume those fonts should exist because: 1) They appear in an xml file that comes with the sample app, 2) They appear in the <a href=""https://fonts.google.com/"" rel=""nofollow noreferrer"">online list of Google Fonts</a>, and 3) They return from the developer web api (<code>https://www.googleapis.com/webfonts/v1/webfonts?key=</code>)</p>

<p>Here is the list of failed fonts:<code>
 Angkor
 Archivo
 Asap Condensed
 Baloo Bhaijaan
 Baloo Tammudu
 Battambang
 Bayon
 Bellefair
 BioRhyme Expanded
 Bokor
 Cabin Condensed
 Chau Philomene One
 Chenla
 Content
 Dangrek
 Encode Sans
 Encode Sans Condensed
 Encode Sans Expanded
 Encode Sans Semi Condensed
 Encode Sans Semi Expanded
 Fasthand
 Faustina
 Freehand
 Hanuman
 Khmer
 Koulen
 Libre Barcode 128
 Libre Barcode 128 Text
 Libre Barcode 39
 Libre Barcode 39 Extended
 Libre Barcode 39 Extended Text
 Libre Barcode 39 Text
 Mada
 Manuale
 Metal
 Moul
 Moulpali
 Mukta
 Mukta Mahee
 Mukta Malar
 Nokora
 Open Sans Condensed
 Preahvihear
 Roboto Condensed
 Saira
 Saira Condensed
 Saira Extra Condensed
 Saira Semi Condensed
 Sedgwick Ave
 Sedgwick Ave Display
 Siemreap
 Suwannaphum
 Taprom
 Ubuntu Condensed
 Zilla Slab
 Zilla Slab Highlight</code></p>
",5346565,,2649012,,2017-11-01 10:04:47,2018-01-14 10:20:10,downloadable fonts - can't download some google fonts,<android><fonts><google-font-api><google-fonts>,1,3,1,
Android,37642551,1,,,2016,,3,1850,"<p>I am trying to work on my Nexus 5x with android <code>Camera2 APIs</code> and I am using <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""nofollow"">googlesamples android-Camera2Basic</a></p>

<p>My problem is that the JPEG images have too low quality and their size is much smaller that regular images I am taking with my phone camera app.</p>

<p>According to google documents there should be a key <code>JPEG_QUALITY</code> both in CaptureRequest and in CaptureResult:</p>

<blockquote>
  <p>JPEG_QUALITY</p>
  
  <p>Added in API level 21</p>
  
  <p>Key JPEG_QUALITY</p>
  
  <p>Compression quality of the final JPEG image.</p>
  
  <p>85-95 is typical usage range.</p>
  
  <p>Range of valid values:</p>
  
  <p>1-100; larger is higher quality</p>
  
  <p>This key is available on all devices.</p>
</blockquote>

<p>However when I ask for the available keys, <code>JPEG_QUALITY</code> key is not available so I don't how to know what is my current <code>JPEG</code> compression quallity used and how I can change it. </p>

<p>The code I did inside:</p>

<pre><code>CameraCaptureSession.CaptureCallback CaptureCallback
                = new CameraCaptureSession.CaptureCallback() {

            @Override
            public void onCaptureCompleted(@NonNull CameraCaptureSession session,
                                           @NonNull CaptureRequest request,
                                           @NonNull TotalCaptureResult result) {


                //_TEST_DEBUG
                List&lt;CaptureRequest.Key&lt;?&gt;&gt; requestKeys = request.getKeys();
                List&lt;CaptureResult.Key&lt;?&gt;&gt; resultKeys = result.getKeys();
</code></pre>

<p>requestKeys &amp; resultKeys have many keys including <code>JPEG_ORIENTATION</code> but not the <code>JPEG_QUALITY</code> key.</p>

<p>Any idea what am I doing wrong? 
Why can't I find how to change <code>JPEG</code> compression quality?</p>

<p>Thanks,
Guy</p>
",6426789,,5709159,,2016-07-04 16:04:01,2016-07-04 16:04:01,Android Camera2 API JPEG_QUALITY not available,<android><android-camera2>,1,0,1,
Android,29472129,1,51223759,,2015,,3,1621,"<p>I am trying to make an Android app about Geofencing. I have followed the tutorial on <a href=""https://developer.android.com/training/location/geofencing.html"" rel=""nofollow"">developers page</a> and <a href=""https://github.com/googlesamples/android-play-location/tree/master/Geofencing/app/src/main/java/com/google/android/gms/location/sample/geofencing"" rel=""nofollow"">the sample code</a>, however it doesn't work as expected. I could have maybe made some failures regarding the life cycle of an Android app since I combined Location Addresses and Geofencing.</p>

<p>My question is specifically why I don't get <code>onHandleIntent</code> called in the <code>IntentService</code> in the <code>GeofenceTransitionIntentService.java</code> class. Is there any error in the <code>getGeofencePending</code> function in <code>MainActivity.java</code>.
Here is the code:</p>

<pre><code>package com.example.geofence;

import java.text.DateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.Map;

import com.google.android.gms.common.ConnectionResult;
import com.google.android.gms.common.api.GoogleApiClient;
import com.google.android.gms.common.api.GoogleApiClient.Builder;
import com.google.android.gms.common.api.GoogleApiClient.ConnectionCallbacks;
import com.google.android.gms.common.api.GoogleApiClient.OnConnectionFailedListener;
import com.google.android.gms.common.api.ResultCallback;
import com.google.android.gms.common.api.Status;
import com.google.android.gms.internal.mr;
import com.google.android.gms.location.Geofence;
import com.google.android.gms.location.GeofencingRequest;
import com.google.android.gms.location.LocationListener;
import com.google.android.gms.location.LocationRequest;
import com.google.android.gms.location.LocationServices;
import com.google.android.gms.maps.model.LatLng;

import android.support.v7.app.ActionBarActivity;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.PendingIntent;
import android.content.Intent;
import android.content.SharedPreferences;
import android.location.Geocoder;
import android.location.Location;
import android.os.Bundle;
import android.os.Handler;
import android.os.ResultReceiver;

public class MainActivity extends Activity implements OnClickListener,
ConnectionCallbacks, OnConnectionFailedListener, LocationListener, ResultCallback &lt;Status&gt;{

    protected static final String TAG = ""creating-and-monitoring-geofences"";
    GoogleApiClient mGoogleApiClient;
    LocationRequest mLocationRequest;
    Boolean mRequestingLocationUpdates = true;
    Boolean mAddressRequested = true;
    String mAddressOutput = null;
    Location mCurrentLocation;
    protected Location mLastLocation;
    private AddressResultReceiver mResultReceiver;
    String mLastUpdateTime;
    TextView latitudeText, longitudeText, lastUpdateTimeText, locationAddress;
    private SharedPreferences mSharedPreferences;

    private Button mAddGeofencesButton, mRemoveGeofencesButton;
    protected ArrayList&lt;Geofence&gt; mGeofenceList = null;
    private PendingIntent mGeofencePendingIntent;
    private boolean mGeofencesAdded;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Toast.makeText(this, ""OnCreate"", Toast.LENGTH_SHORT).show();
        setContentView(R.layout.activity_main);
        mResultReceiver = new AddressResultReceiver(new Handler());
        latitudeText = (TextView) findViewById(R.id.latitudeText);
        longitudeText = (TextView) findViewById(R.id.longitudeText);
        lastUpdateTimeText = (TextView) findViewById(R.id.lastUpdateText);
        locationAddress = (TextView) findViewById(R.id.locationAddressText);

        mAddGeofencesButton = (Button) findViewById(R.id.add_geofence);
        mRemoveGeofencesButton = (Button) findViewById(R.id.remove_geofence);
        mGeofenceList = new ArrayList&lt;Geofence&gt;();
        mGeofencePendingIntent = null;
        mSharedPreferences = getSharedPreferences(Constants.SHARED_PREFERENCES_NAME,
                MODE_PRIVATE);
        mGeofencesAdded = mSharedPreferences.getBoolean(Constants.GEOFENCES_ADDED_KEY, false);

        mAddGeofencesButton.setOnClickListener(this);
        mRemoveGeofencesButton.setOnClickListener(this);

        setButtonsEnabledState();
        buildGoogleApiClient(); 
    }

    protected void startIntentService() {
        Intent intent = new Intent(this, FetchAddressIntentService.class);
        intent.putExtra(Constants.RECEIVER, mResultReceiver);
        intent.putExtra(Constants.LOCATION_DATA_EXTRA, mLastLocation);
        startService(intent);
    }
    /*  
    @Override
    protected void onSaveInstanceState(Bundle savedInstanceState) {
        savedInstanceState.putBoolean(REQUESTING_LOCATION_UPDATES_KEY,
                mRequestingLocationUpdates);
        savedInstanceState.putParcelable(LOCATION_KEY, mCurrentLocation);
        savedInstanceState.putString(LAST_UPDATED_TIME_STRING_KEY, mLastUpdateTime);
        super.onSaveInstanceState(savedInstanceState);
    }
    */

    @Override
    public void onClick(View v) {
        if(v==mAddGeofencesButton){
            addGeofencesButtonHandler(v);
        }
        if(v==mRemoveGeofencesButton){
            removeGeofencesButtonHandler(v);
        }

    }

    @Override
    protected void onPause() {
        super.onPause();
        stopLocationUpdates();
    }

    @Override
    public void onResume() {
        super.onResume();
        Toast.makeText(this, ""onResume"", Toast.LENGTH_SHORT).show();
        if (mGoogleApiClient.isConnected() &amp;&amp; !mRequestingLocationUpdates) {
            startLocationUpdates();
        }
    }

    protected synchronized void buildGoogleApiClient() {
        mGoogleApiClient = new GoogleApiClient.Builder(this)
        .addConnectionCallbacks(this)
        .addOnConnectionFailedListener(this)
        .addApi(LocationServices.API)
        .build();
        mGoogleApiClient.connect();

    }
    @Override
    public void onConnectionFailed(ConnectionResult result) {
        // TODO Auto-generated method stub
        Toast.makeText(this, ""onConnectionFailed"", Toast.LENGTH_SHORT).show();

    }
    @SuppressLint(""NewApi"")
    @Override
    public void onConnected(Bundle connectionHint) {
        Toast.makeText(this, ""onConnected"", Toast.LENGTH_SHORT).show();
        mLastLocation = LocationServices.FusedLocationApi.getLastLocation(
                mGoogleApiClient);
        if (mLastLocation != null) {
            String latitude = String.valueOf(mLastLocation.getLatitude());
            String longitude = String.valueOf(mLastLocation.getLongitude());
            latitudeText.setText(""latitude: "" + latitude);
            longitudeText.setText(""longitude: "" + longitude);
        }
        if(mRequestingLocationUpdates){
            createLocationRequest();
            startLocationUpdates();
        }
        if (mLastLocation != null) {
            // Determine whether a Geocoder is available.
            if (!Geocoder.isPresent()) {
                Toast.makeText(this, ""No geocoder available"",
                        Toast.LENGTH_SHORT).show();
                return;
            }

            if (mAddressRequested) {
                startIntentService();
            }
        }

    }
    @Override
    public void onConnectionSuspended(int cause) {
        // TODO Auto-generated method stub
        Toast.makeText(this, ""onConnectionSuspended"", Toast.LENGTH_SHORT).show();
    }

    protected void createLocationRequest() {
        mLocationRequest = new LocationRequest();
        mLocationRequest.setInterval(10000);
        mLocationRequest.setFastestInterval(5000);
        mLocationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
    }

    protected void startLocationUpdates() {
        LocationServices.FusedLocationApi.requestLocationUpdates(
                mGoogleApiClient, mLocationRequest, this); //this refers to the interface LocationListener
    }

    protected void stopLocationUpdates() {
        LocationServices.FusedLocationApi.removeLocationUpdates(
                mGoogleApiClient, this);
    }   

    @Override
    public void onLocationChanged(Location location) {
        mCurrentLocation = location;
        mLastUpdateTime = DateFormat.getTimeInstance().format(new Date());
        updateUI();
    }   

    public void updateUI() {
        latitudeText.setText(String.valueOf(mCurrentLocation.getLatitude()));
        longitudeText.setText(String.valueOf(mCurrentLocation.getLongitude()));
        lastUpdateTimeText.setText(mLastUpdateTime);
        locationAddress.setText(mAddressOutput);
    }

    public void showToast(String text){
        Toast.makeText(this, text, Toast.LENGTH_SHORT).show();
    }


    class AddressResultReceiver extends ResultReceiver {
        public AddressResultReceiver(Handler handler) {
            super(handler);
        }

        @Override
        protected void onReceiveResult(int resultCode, Bundle resultData) {
            showToast(""onReceiveResult"");
            // Display the address string
            // or an error message sent from the intent service.
            mAddressOutput = resultData.getString(Constants.RESULT_DATA_KEY);
            //displayAddressOutput();
            System.out.println(mAddressOutput);
            Log.e(""RESULT!!!"", mAddressOutput);
            locationAddress.setText(mAddressOutput);

            // Show a toast message if an address was found.
            if (resultCode == Constants.SUCCESS_RESULT) {
                ;
            }
        }
    }

    /**
    * Adds geofences, which sets alerts to be notified when the device enters or exits one of the
    * specified geofences. Handles the success or failure results returned by addGeofences().
    */
   public void addGeofencesButtonHandler(View view) {
       if (!mGoogleApiClient.isConnected()) {
           Toast.makeText(this, getString(R.string.not_connected), Toast.LENGTH_SHORT).show();
           return;
       }

       try {
           LocationServices.GeofencingApi.addGeofences(
                   mGoogleApiClient,
                   // The GeofenceRequest object.
                   getGeofencingRequest(),
                   // A pending intent that that is reused when calling removeGeofences(). This
                   // pending intent is used to generate an intent when a matched geofence
                   // transition is observed.
                   getGeofencePendingIntent()
           ).setResultCallback(this); // Result processed in onResult().
       } catch (SecurityException securityException) {
           // Catch exception generated if the app does not use ACCESS_FINE_LOCATION permission.
           logSecurityException(securityException);
       }
   }

   /**
    * Removes geofences, which stops further notifications when the device enters or exits
    * previously registered geofences.
    */
   public void removeGeofencesButtonHandler(View view) {
       if (!mGoogleApiClient.isConnected()) {
           Toast.makeText(this, getString(R.string.not_connected), Toast.LENGTH_SHORT).show();
           return;
       }
       try {
           // Remove geofences.
           LocationServices.GeofencingApi.removeGeofences(
                   mGoogleApiClient,
                   // This is the same pending intent that was used in addGeofences().
                   getGeofencePendingIntent()
           ).setResultCallback(this); // Result processed in onResult().
       } catch (SecurityException securityException) {
           // Catch exception generated if the app does not use ACCESS_FINE_LOCATION permission.
           logSecurityException(securityException);
       }
   }

   private void logSecurityException(SecurityException securityException) {
       Log.e(TAG, ""Invalid location permission. "" +
               ""You need to use ACCESS_FINE_LOCATION with geofences"", securityException);
   }

    /**
     * Gets a PendingIntent to send with the request to add or remove Geofences. Location Services
     * issues the Intent inside this PendingIntent whenever a geofence transition occurs for the
     * current list of geofences.
     *
     * @return A PendingIntent for the IntentService that handles geofence transitions.
     */
    private PendingIntent getGeofencePendingIntent() {
        // Reuse the PendingIntent if we already have it.
        if (mGeofencePendingIntent != null) {
            Toast.makeText(this, ""mGeofencePendingIntent != null"", Toast.LENGTH_SHORT).show();
            return mGeofencePendingIntent;
        }
        Intent intent = new Intent(this, GeofenceTransitionsIntentService.class);
        // We use FLAG_UPDATE_CURRENT so that we get the same pending intent back when calling
        // addGeofences() and removeGeofences().
        Toast.makeText(this, ""mGeofencePendingIntent == null"", Toast.LENGTH_SHORT).show();
        mGeofencePendingIntent = PendingIntent.getService(this, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);
        return mGeofencePendingIntent;
    }

    /**
     * Builds and returns a GeofencingRequest. Specifies the list of geofences to be monitored.
     * Also specifies how the geofence notifications are initially triggered.
     */
    private GeofencingRequest getGeofencingRequest() {     

        GeofencingRequest.Builder builder = new GeofencingRequest.Builder();

        // The INITIAL_TRIGGER_ENTER flag indicates that geofencing service should trigger a
        // GEOFENCE_TRANSITION_ENTER notification when the geofence is added and if the device
        // is already inside that geofence.
            builder.setInitialTrigger(GeofencingRequest.INITIAL_TRIGGER_ENTER);

        // Add the geofences to be monitored by geofencing service.
        builder.addGeofences(mGeofenceList);
        builder.addGeofence(new Geofence.Builder()
        .setRequestId(""CurrentLocation"")
        .setCircularRegion(mCurrentLocation.getLatitude(), mCurrentLocation.getLongitude(), 50)
        .setExpirationDuration(Geofence.NEVER_EXPIRE)
        .setTransitionTypes(Geofence.GEOFENCE_TRANSITION_ENTER | Geofence.GEOFENCE_TRANSITION_EXIT)
        .build());

        Toast.makeText(this, ""Geofence request added"",  Toast.LENGTH_SHORT).show();

        // Return a GeofencingRequest.
        return builder.build();
    }


    @Override
    public void onResult(Status status) {
        if (status.isSuccess()) {
            // Update state and save in shared preferences.
            mGeofencesAdded = !mGeofencesAdded;
            SharedPreferences.Editor editor = mSharedPreferences.edit();
            editor.putBoolean(Constants.GEOFENCES_ADDED_KEY, mGeofencesAdded);
            editor.commit();

            // Update the UI. Adding geofences enables the Remove Geofences button, and removing
            // geofences enables the Add Geofences button.
            setButtonsEnabledState();

            Toast.makeText(
                    this,
                    getString(mGeofencesAdded ? R.string.geofences_added :
                            R.string.geofences_removed),
                    Toast.LENGTH_SHORT
            ).show();
        } else {
            // Get the status code for the error and log it using a user-friendly message.
            String errorMessage = GeoFenceErrorMessages.getErrorString(this,
                    status.getStatusCode());
            Log.e(TAG, errorMessage);
        }
    }

     /**
     * Ensures that only one button is enabled at any time. The Add Geofences button is enabled
     * if the user hasn't yet added geofences. The Remove Geofences button is enabled if the
     * user has added geofences.
     */
    private void setButtonsEnabledState() {
        if (mGeofencesAdded) {
            mAddGeofencesButton.setEnabled(false);
            mRemoveGeofencesButton.setEnabled(true);
        } else {
            mAddGeofencesButton.setEnabled(true);
            mRemoveGeofencesButton.setEnabled(false);
        }
    }    
}
</code></pre>

<p>and the GeofenceTransitionIntentService class, that should deal with the triggering event</p>

<pre><code>package com.example.geofence;

import java.util.ArrayList;
import java.util.List;

import com.google.android.gms.location.Geofence;
import com.google.android.gms.location.GeofencingEvent;

import android.app.IntentService;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.graphics.BitmapFactory;
import android.graphics.Color;
import android.support.v4.app.NotificationCompat;
import android.support.v4.app.TaskStackBuilder;
import android.text.TextUtils;
import android.util.Log;
import android.widget.Toast;

public class GeofenceTransitionsIntentService extends IntentService{

    protected static final String TAG = ""geofence-transitions-service"";

    public GeofenceTransitionsIntentService(String name) {
        super(""name"");
    }

    @Override
    protected void onHandleIntent(Intent intent) {
        Toast.makeText(this, ""OnHandleIntent"", Toast.LENGTH_SHORT).show();
        Log.e(TAG, ""OnHandleIntent"");
        GeofencingEvent geofencingEvent = GeofencingEvent.fromIntent(intent);       
        if (geofencingEvent.hasError()) {
            String errorMessage = GeoFenceErrorMessages.getErrorString(this,
                    geofencingEvent.getErrorCode());
            Log.e(TAG, errorMessage);
            return;
        }
        Log.e(""DEBUG"", ""No geofencingEvent error"");

         // Get the transition type.
        int geofenceTransition = geofencingEvent.getGeofenceTransition();
        Log.e(""DEBUG"", ""getGeofenceTransition has been called"");
        // Test that the reported transition was of interest.
        if (geofenceTransition == Geofence.GEOFENCE_TRANSITION_ENTER ||
                geofenceTransition == Geofence.GEOFENCE_TRANSITION_EXIT) {
            Log.e(""DEBUG"", ""Geofence Transition enter or exit"");
            // Get the geofences that were triggered. A single event can trigger multiple geofences.
            List&lt;Geofence&gt; triggeringGeofences = geofencingEvent.getTriggeringGeofences();

            // Get the transition details as a String.
            String geofenceTransitionDetails = getGeofenceTransitionDetails(
                    this,
                    geofenceTransition,
                    triggeringGeofences
            );

            // Send notification and log the transition details.
            sendNotification(geofenceTransitionDetails);
            Log.i(TAG, geofenceTransitionDetails);
        } else {
            // Log the error.
            Log.e(TAG, getString(R.string.geofence_transition_invalid_type, geofenceTransition));
        }   
    }

    /**
     * Gets transition details and returns them as a formatted string.
     *
     * @param context               The app context.
     * @param geofenceTransition    The ID of the geofence transition.
     * @param triggeringGeofences   The geofence(s) triggered.
     * @return                      The transition details formatted as String.
     */
    private String getGeofenceTransitionDetails(
            Context context,
            int geofenceTransition,
            List&lt;Geofence&gt; triggeringGeofences) {
        Log.e(""DEBUG"", ""getGeofenceTransitionDetails"");
        String geofenceTransitionString = getTransitionString(geofenceTransition);

        // Get the Ids of each geofence that was triggered.
        ArrayList triggeringGeofencesIdsList = new ArrayList();
        for (Geofence geofence : triggeringGeofences) {
            triggeringGeofencesIdsList.add(geofence.getRequestId());
        }
        String triggeringGeofencesIdsString = TextUtils.join("", "",  triggeringGeofencesIdsList);

        return geofenceTransitionString + "": "" + triggeringGeofencesIdsString;
    }

    /**
     * Posts a notification in the notification bar when a transition is detected.
     * If the user clicks the notification, control goes to the MainActivity.
     */
    private void sendNotification(String notificationDetails) {
        // Create an explicit content Intent that starts the main Activity.
        Intent notificationIntent = new Intent(getApplicationContext(), MainActivity.class);
        Log.e(""DEBUG"", ""sendNotification"");
        // Construct a task stack.
        TaskStackBuilder stackBuilder = TaskStackBuilder.create(this);

        // Add the main Activity to the task stack as the parent.
        stackBuilder.addParentStack(MainActivity.class);

        // Push the content Intent onto the stack.
        stackBuilder.addNextIntent(notificationIntent);

        // Get a PendingIntent containing the entire back stack.
        PendingIntent notificationPendingIntent =
                stackBuilder.getPendingIntent(0, PendingIntent.FLAG_UPDATE_CURRENT);

        // Get a notification builder that's compatible with platform versions &gt;= 4
        NotificationCompat.Builder builder = new NotificationCompat.Builder(this);

        // Define the notification settings.
        builder.setSmallIcon(R.drawable.ic_launcher)
                // In a real app, you may want to use a library like Volley
                // to decode the Bitmap.
                .setLargeIcon(BitmapFactory.decodeResource(getResources(),
                        R.drawable.ic_launcher))
                .setColor(Color.RED)
                .setContentTitle(notificationDetails)
                .setContentText(getString(R.string.geofence_transition_notification_text))
                .setContentIntent(notificationPendingIntent);

        // Dismiss notification once the user touches it.
        builder.setAutoCancel(true);

        // Get an instance of the Notification manager
        NotificationManager mNotificationManager =
                (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);

        // Issue the notification
        mNotificationManager.notify(0, builder.build());
    }

    /**
     * Maps geofence transition types to their human-readable equivalents.
     *
     * @param transitionType    A transition type constant defined in Geofence
     * @return                  A String indicating the type of transition
     */
    private String getTransitionString(int transitionType) {
        Log.e(""DEBUG"", ""getTransitionString"");
        switch (transitionType) {
            case Geofence.GEOFENCE_TRANSITION_ENTER:
                return getString(R.string.geofence_transition_entered);
            case Geofence.GEOFENCE_TRANSITION_EXIT:
                return getString(R.string.geofence_transition_exited);
            default:
                return getString(R.string.unknown_geofence_transition);
        }
    }

}
</code></pre>

<p>The manifest:</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;manifest xmlns:android=""http://schemas.android.com/apk/res/android""
    package=""com.example.geofence""
    android:versionCode=""1""
    android:versionName=""1.0"" &gt;

    &lt;uses-permission android:name=""android.permission.ACCESS_FINE_LOCATION""/&gt;
    &lt;uses-permission android:name=""android.permission.ACCESS_FINE_LOCATION""/&gt;
    &lt;uses-permission android:name=""android.permission.INTERNET"" /&gt;

    &lt;uses-sdk
        android:minSdkVersion=""9""
        android:targetSdkVersion=""21"" /&gt;

    &lt;application
        android:allowBackup=""true""
        android:icon=""@drawable/ic_launcher""
        android:label=""@string/app_name""
        android:theme=""@style/AppTheme"" &gt;
        &lt;meta-data android:name=""com.google.android.gms.version""
        android:value=""@integer/google_play_services_version"" /&gt;
        &lt;activity
            android:name="".MainActivity""
            android:label=""@string/app_name"" &gt;
            &lt;intent-filter&gt;
                &lt;action android:name=""android.intent.action.MAIN"" /&gt;

                &lt;category android:name=""android.intent.category.LAUNCHER"" /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
        &lt;service
            android:name="".FetchAddressIntentService""
            android:exported=""false""/&gt;
        &lt;service android:name="".GeofenceTransitionsIntentService""/&gt;
    &lt;/application&gt;

&lt;/manifest&gt;
</code></pre>
",2410994,,2410994,,2015-04-08 13:23:39,2018-07-07 13:36:11,IntentService doesn't get called in combination with PendingIntent,<android><android-pendingintent><android-geofence><android-intentservice>,1,4,1,
Android,32310523,1,32312074,,2015,,3,4462,"<p>I have just updated my Android Studio setup to 1.3 (latest stable as of 31st of August 2015) and I need to use the latest NDK integration. My previous Android Studio version was 1.2.1 (stable as well).</p>

<p>Following <a href=""http://tools.android.com/tech-docs/new-build-system/gradle-experimental"" rel=""nofollow"">Google Migration to Gradle Experimental Guide</a> I managed to easily adapt my various gradle scripts.</p>

<p>However, Gradle Sync fails with the following error :</p>

<pre><code>Error:No such property: android for class: com.android.build.gradle.managed.ProductFlavor
</code></pre>

<p><strong>[Update 1 -> see below, error updated]</strong></p>

<p>When I attempt to <code>Make</code> the project, I obtain a little more detailed error :</p>

<pre><code>Error:(17, 1) A problem occurred configuring project ':app'.
&gt; Exception thrown while executing model rule: model.android
   &gt; No such property: android for class: com.android.build.gradle.managed.ProductFlavor
</code></pre>

<p>App refers to the main application code (with activities and other).</p>

<p>Using the feature <code>F4 &gt; Jumping to Source</code>, it opens my <code>build.gradle</code> script from my <code>app</code> project.</p>

<p>This is the content of the aforementioned script :</p>

<pre><code>apply plugin: 'com.android.model.application' // experimental

model {
    android {
        compileSdkVersion = 21
        buildToolsVersion = '22.0.1'

        defaultConfig.with {
            applicationId = ""company.com.myapplication""
            minSdkVersion.apiLevel = 10
            targetSdkVersion.apiLevel = 21
            versionCode = 1
            versionName = ""1.0""

            // NDK
            android.ndk {
                moduleName = ""MyAwesomeJNILib""
                cFlags ""-std=c99""
            }
        }
        android.buildTypes {
            release {
                minifyEnabled = false
                proguardFiles += file('proguard-rules.pro')
            }
        }
        android.productFlavors {
            // for detailed abiFilter descriptions, refer to ""Supported ABIs"" @
            // https://developer.android.com/ndk/guides/abis.html#sa
            create(""arm"") {
                ndk.abiFilters += ""armeabi""
            }
            create(""arm7"") {
                ndk.abiFilters += ""armeabi-v7a""
            }
            create(""arm8"") {
                ndk.abiFilters += ""arm64-v8a""
            }
            create(""x86"") {
                ndk.abiFilters += ""x86""
            }
            create(""x86-64"") {
                ndk.abiFilters += ""x86_64""
            }
            create(""mips"") {
                ndk.abiFilters += ""mips""
            }
            create(""mips-64"") {
                ndk.abiFilters += ""mips64""
            }
            // To include all cpu architectures, leaves abiFilters empty
            create(""all"")
        }

        packagingOptions {
            exclude 'LICENSE.txt'
        }
    }
}

dependencies {
    compile fileTree(include: ['*.jar'], dir: 'libs')
    compile 'com.android.support:appcompat-v7:22.2.0'
    compile 'com.google.code.gson:gson:2.3.1'
    compile 'com.squareup.okhttp:okhttp-android-support:2.4.0'
    compile project(':bluetoothmanager')
    compile 'joda-time:joda-time:2.8.1'
    // Units Testing
    //androidTestCompile 'junit:junit:4.12'
    compile 'junit:junit:4.12' // experimental
}
</code></pre>

<p>As you can see, there is nothing very fancy here.
But you might notice there is some unit testing setup : </p>

<pre><code>// Units Testing
//androidTestCompile 'junit:junit:4.12'
compile 'junit:junit:4.12' // experimental
</code></pre>

<p><code>androidTestCompile</code> could not be resolved while migrating to <strong>GradleExperimental</strong> so I modified following a solution I can no longer find (sorry) where I would simple put <code>compile</code> in stead of <code>androidTestCompile</code>.
This was the error : </p>

<pre><code>Error:(71, 0) Gradle DSL method not found: 'androidTestCompile()'
</code></pre>

<p>I tried to compare one of Google's NDK sample (<code>hello-jini</code> for example) as provided in the aforemention guide and <a href=""https://github.com/googlesamples/android-ndk"" rel=""nofollow"">available here</a>.</p>

<p>Except the <code>packagingOptions</code> I could not find any differences that would be responsible for my awry. I tried to remove <code>packagingOptions</code> but that did not make a single change at all.</p>

<p><strong>[UPDATE 1]</strong></p>

<p>You will notice that the more detailed error message states that it's in line #17 which is where I declare my <strong>native build settings</strong>.
I fixed the error which was <code>cFlags</code> must be changed to <code>CFlags</code> and I added the <code>=</code> as required by the new version of Gradle.
This did help, the error does not appear anymore but changed for : </p>

<pre><code>Error:No such property: android for class: com.android.build.gradle.managed.AndroidConfig
</code></pre>
",3535408,,2016562,,2015-10-05 20:52:23,2016-08-19 11:13:45,Issue when migrating to Gradle Experimental 2.5 : no such method AndroidConfig,<android><android-studio><gradle><android-ndk><gradle-experimental>,1,0,1,
Android,44911596,1,,,2017,,3,308,"<p>The official documentation is incredibly unclear when it comes how you’re supposed to be handling in-app billing.</p>

<p>For starters there are two versions of TrivialDrive:</p>

<p>github.com/googlesamples/android-play-billing</p>

<p>And then from the official docs:</p>

<p>developer.android.com/google/play/billing/billing_integrate.html </p>

<p>(here it says to import the IInAppBillingService.aidl file and use ServiceConnections / IInAppBillingService)</p>

<p>developer.android.com/training/play-billing-library/preparing-iab-app.html </p>

<p>(here it says to look at Trivial Drive v2, and also use compile 'com.android.billingclient:billing:dp-1' instead of importing the .aidl file, and to use BillingManager)</p>

<p>developer.android.com/training/in-app-billing/preparing-iab-app.html </p>

<p>(here it says to look at Trivial Drive, import the .aidl file, and use the IabHelper + associated listeners for everything instead)</p>

<p>Can anyone clarify why such a crucial part of the Android platform has different explanations for things all over the place? What's the intended / latest framework we need to be using? Which pieces are outdated? Which TrivialDrive should I be referencing?</p>
",8251758,,,,,2017-07-05 13:07:05,How do we implement in-app purchasing when the documentation is so inconsistent?,<android><in-app-purchase><google-play-services><in-app-billing><android-billing>,1,0,1,
Android,41766196,1,,,2017,,3,665,"<p>Face Tracker app based on <a href=""https://github.com/googlesamples/android-vision/tree/master/visionSamples/FaceTracker"" rel=""nofollow noreferrer"">Google Vision Face Tracker</a>. By default, Face Tracker use rear/back camera, but I want to detect faces with front camera.</p>

<p>This is the code for CameraSourcePreview that google vision provide:</p>

<pre><code>package com.google.android.gms.samples.vision.face.facetracker.ui.camera;

import android.content.Context;
import android.content.res.Configuration;
import android.util.AttributeSet;
import android.util.Log;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.ViewGroup;

import com.google.android.gms.common.images.Size;
import com.google.android.gms.vision.CameraSource;

import java.io.IOException;

public class CameraSourcePreview extends ViewGroup {
    private static final String TAG = ""CameraSourcePreview"";

    private Context mContext;
    private SurfaceView mSurfaceView;
    private boolean mStartRequested;
    private boolean mSurfaceAvailable;
    private CameraSource mCameraSource;

    private GraphicOverlay mOverlay;

    public CameraSourcePreview(Context context, AttributeSet attrs) {
        super(context, attrs);
        mContext = context;
        mStartRequested = false;
        mSurfaceAvailable = false;

        mSurfaceView = new SurfaceView(context);
        mSurfaceView.getHolder().addCallback(new SurfaceCallback());
        addView(mSurfaceView);
    }

    public void start(CameraSource cameraSource) throws IOException {
        if (cameraSource == null) {
            stop();
        }

        mCameraSource = cameraSource;

        if (mCameraSource != null) {
            mStartRequested = true;
            startIfReady();
        }
    }

    public void start(CameraSource cameraSource, GraphicOverlay overlay) throws IOException {
        mOverlay = overlay;
        start(cameraSource);
    }

    public void stop() {
        if (mCameraSource != null) {
            mCameraSource.stop();
        }
    }

    public void release() {
        if (mCameraSource != null) {
            mCameraSource.release();
            mCameraSource = null;
        }
    }

    private void startIfReady() throws IOException {
        if (mStartRequested &amp;&amp; mSurfaceAvailable) {
            mCameraSource.start(mSurfaceView.getHolder());
            if (mOverlay != null) {
                Size size = mCameraSource.getPreviewSize();
                int min = Math.min(size.getWidth(), size.getHeight());
                int max = Math.max(size.getWidth(), size.getHeight());
                if (isPortraitMode()) {
                    // Swap width and height sizes when in portrait, since it will be rotated by
                    // 90 degrees
                    mOverlay.setCameraInfo(min, max, mCameraSource.getCameraFacing());
                } else {
                    mOverlay.setCameraInfo(max, min, mCameraSource.getCameraFacing());
                }
                mOverlay.clear();
            }
            mStartRequested = false;
        }
    }

    private class SurfaceCallback implements SurfaceHolder.Callback {
        @Override
        public void surfaceCreated(SurfaceHolder surface) {
            mSurfaceAvailable = true;
            try {
                startIfReady();
            } catch (IOException e) {
                Log.e(TAG, ""Could not start camera source."", e);
            }
        }

        @Override
        public void surfaceDestroyed(SurfaceHolder surface) {
            mSurfaceAvailable = false;
        }

        @Override
        public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
        }
    }

    @Override
    protected void onLayout(boolean changed, int left, int top, int right, int bottom) {
        int width = 640;
        int height = 480;
        if (mCameraSource != null) {
            Size size = mCameraSource.getPreviewSize();
            if (size != null) {
                width = size.getWidth();
                height = size.getHeight();
            }
        }

        // Swap width and height sizes when in portrait, since it will be rotated 90 degrees
        if (isPortraitMode()) {
            int tmp = width;
            width = height;
            height = tmp;
        }

        final int layoutWidth = right - left;
        final int layoutHeight = bottom - top;

        // Computes height and width for potentially doing fit width.
        int childWidth = layoutWidth;
        int childHeight = (int)(((float) layoutWidth / (float) width) * height);

        // If height is too tall using fit width, does fit height instead.
        if (childHeight &gt; layoutHeight) {
            childHeight = layoutHeight;
            childWidth = (int)(((float) layoutHeight / (float) height) * width);
        }

        for (int i = 0; i &lt; getChildCount(); ++i) {
            getChildAt(i).layout(0, 0, childWidth, childHeight);
        }

        try {
            startIfReady();
        } catch (IOException e) {
            Log.e(TAG, ""Could not start camera source."", e);
        }
    }

    private boolean isPortraitMode() {
        int orientation = mContext.getResources().getConfiguration().orientation;
        if (orientation == Configuration.ORIENTATION_LANDSCAPE) {
            return false;
        }
        if (orientation == Configuration.ORIENTATION_PORTRAIT) {
            return true;
        }

        Log.d(TAG, ""isPortraitMode returning false by default"");
        return false;
    }
}
</code></pre>

<p>I call camera source with this method:</p>

<pre><code>private void startCameraSource() {

        // check that the device has play services available.
        int code = GoogleApiAvailability.getInstance().isGooglePlayServicesAvailable(
                getApplicationContext());
        if (code != ConnectionResult.SUCCESS) {
            Dialog dlg =
                    GoogleApiAvailability.getInstance().getErrorDialog(this, code, RC_HANDLE_GMS);
            dlg.show();
        }

        if (mCameraSource != null) {
            try {
                mPreview.start(mCameraSource, mGraphicOverlay);
            } catch (IOException e) {
                Log.e(TAG, ""Unable to start camera source."", e);
                mCameraSource.release();
                mCameraSource = null;
            }
        }
    }
</code></pre>

<p>Face Tracker front camera still too dark compare with default phone camera app.</p>

<p>How to brighten front camera in face tracker google vision? Is it related with surface view?</p>

<pre><code>&lt;com.google.android.gms.samples.vision.face.facetracker.ui.camera.CameraSourcePreview
    android:id=""@+id/preview""
    android:layout_width=""match_parent""
    android:layout_height=""0dp""
    android:layout_weight=""1.00""
    android:weightSum=""1""&gt;

&lt;com.google.android.gms.samples.vision.face.facetracker.ui.camera.GraphicOverlay
    android:id=""@+id/faceOverlay""
    android:layout_width=""match_parent""
    android:layout_height=""match_parent""
    android:layout_weight=""0.79"" /&gt;

&lt;/com.google.android.gms.samples.vision.face.facetracker.ui.camera.CameraSourcePreview&gt;
</code></pre>
",4670082,,4670082,,2017-01-20 14:47:13,2018-07-08 7:13:28,Face Tracker CameraSource Android: How to brighten front camera quality?,<android><android-studio><camera><google-vision><front-camera>,1,0,1,
Android,41221284,1,,,2016,,3,3425,"<p>I try to change the aspect ratio of the <a href=""https://developer.android.com/reference/android/hardware/camera2/package-summary.html"" rel=""nofollow noreferrer"">Camera2</a> preview but I fail :-(</p>

<p>For cropping I have to use the <a href=""https://developer.android.com/reference/android/hardware/camera2/CaptureRequest.html#SCALER_CROP_REGION"" rel=""nofollow noreferrer"">SCALER_CROP_REGION</a> but I don't get it working.</p>

<p>I used the <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""nofollow noreferrer"">android-Camera2Video</a> example from Google for my tests.</p>

<p>In the <a href=""https://github.com/googlesamples/android-Camera2Video/blob/master/Application/src/main/java/com/example/android/camera2video/Camera2VideoFragment.java#L416"" rel=""nofollow noreferrer"">openCamera</a> method I added the following line:</p>

<pre><code>mSensorSize = characteristics.get(CameraCharacteristics.SENSOR_INFO_ACTIVE_ARRAY_SIZE);
</code></pre>

<p>And in <a href=""https://github.com/googlesamples/android-Camera2Video/blob/master/Application/src/main/java/com/example/android/camera2video/Camera2VideoFragment.java#L486"" rel=""nofollow noreferrer"">startPreview</a> I added this:</p>

<pre><code>final int centerX = mSensorSize.width() / 2;
final int centerY = mSensorSize.height() / 2;
final int cropSize = Math.min(mSensorSize.width(), mSensorSize.height());
final Rect crop = new Rect(centerY - cropSize / 2,
                           centerX - cropSize / 2,
                           cropSize,
                           cropSize);
mPreviewBuilder.set(CaptureRequest.SCALER_CROP_REGION, crop);
</code></pre>

<p>I should get a preview with a 1:1 ratio but it is 3:4 :-(</p>

<p>What did I wrong?</p>
",1016472,,,,,2017-07-14 6:39:12,How to change aspect ratio of camera2 preview?,<android><android-camera2>,1,1,1,
Android,50362528,1,50389268,,2018,,3,594,"<p>I am working with multi feature android application with instant app and wear app.Here i am able to <strong><em>successfully run my application</em></strong> but getting following error during <strong><em>building APK or rebuild projects</em></strong>. </p>

<pre><code>java.lang.IllegalStateException: Expected configuration ':module1:debugFeatureCompileClasspath' to contain exactly one file, however, it contains 2 files.
at org.gradle.api.internal.file.AbstractFileCollection.getSingleFile(AbstractFileCollection.java:62)
at com.android.build.gradle.tasks.MergeManifests.doFullTaskAction(MergeManifests.java:116)
at com.android.build.gradle.internal.tasks.IncrementalTask.taskAction(IncrementalTask.java:106)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:498)
at org.gradle.internal.reflect.JavaMethod.invoke(JavaMethod.java:73)
</code></pre>

<p>My project has 3-4 module and one base module projects. 
I have already integrated all setup for multi feature instant app as per sample provide by google. <a href=""https://github.com/googlesamples/android-instant-apps/tree/master/multi-feature-module"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-instant-apps/tree/master/multi-feature-module</a></p>

<p>I have one module(<strong>apimodule</strong>) where i have added all libraries and API dependencies. Following is my project dependencies structure.</p>

<ol>
<li>AppModule</li>
</ol>

<p>Added all module as implementation</p>

<pre><code>implementation project(':base')
implementation project(':module1')
implementation project(':module2')
implementation project(':module3')
wearApp project(':wear')
</code></pre>

<ol start=""2"">
<li>BaseModule ( Also added <code>application project(':app')</code> )</li>
</ol>

<p>Added <code>baseFeature true</code> in gradle</p>

<pre><code>feature project(':module1')
feature project(':module2')
feature project(':module3')
api project(':apimodule')
</code></pre>

<p>3. apimodule </p>

<p>Added <code>baseFeature true</code> in gradle</p>

<p>Here is my one module1 gradle file. </p>

<pre><code>apply plugin: 'com.android.feature'

apply plugin: 'kotlin-android'

apply plugin: 'kotlin-android-extensions'

android {
    compileSdkVersion 26
    defaultConfig {
        minSdkVersion 23
        targetSdkVersion 26
        versionCode 1
        versionName ""1.0""
        testInstrumentationRunner ""android.support.test.runner.AndroidJUnitRunner""
    }
    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
}

dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
    implementation""org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version""
    implementation project(':base')
    testImplementation 'junit:junit:4.12'
    androidTestImplementation 'com.android.support.test:runner:1.0.1'
    androidTestImplementation 'com.android.support.test.espresso:espresso-core:3.0.1'

}
</code></pre>
",2553048,,2553048,,2018-05-17 3:57:53,2018-12-22 9:06:36,"IllegalStateException: Expected configuration ':module:debugFeatureCompileClasspath' to contain exactly one file, however, it contains 2 files",<android><kotlin><android-instant-apps><android-wear-2.0>,1,9,1,
Android,49688616,1,49689440,,2018,,3,870,"<p>I'm new to android enterprise development world, and I have some misconception of how different pieces in the android enterprise ecosystem relate to one another. Let me explain. </p>

<p>The solution that I'm trying to achieve is being able to lock the device into kiosk mode both remotely, and also based on some business logic do it even when the user is offline. I started investigating EMM and particularly <a href=""https://developers.google.com/android/management/"" rel=""nofollow noreferrer"">Android Management API</a> to solve the problem. I was able to lock the device remotely into kiosk mode using the API. The steps that I take is following</p>

<ol>
<li>Factory reset the android device</li>
<li>Reach the screen where user needs to enter their credentials</li>
<li>Instead of real credentials I enter afw#setup</li>
<li>Device enters into work profile mode and android device policy is being installed</li>
<li>I create an enrollment token in the management API (the steps for that are described in the <a href=""https://developers.google.com/android/management/quickstart"" rel=""nofollow noreferrer"">quick start guide</a></li>
<li>I generate a QR code and scan it using the factory reset device as soon as I'm prompted</li>
<li>The device will be linked to the enterprise, and I'm successfully being able to control it and put the device into kiosk mode by creating special kiosk mode policy and patching the device to comply to that policy using a combination of <a href=""https://developers.google.com/android/management/reference/rest/v1/enterprises.policies/patch"" rel=""nofollow noreferrer"">patch policy</a> (to create a policy) and <a href=""https://developers.google.com/android/management/reference/rest/v1/enterprises.devices/patch"" rel=""nofollow noreferrer"">patch device</a> APIs.</li>
</ol>

<p>The next step was finding out a way to lock the device into kiosk mode even when user is offline. I assume that it's going to happen by creating an android enterprise custom DPC (device policy controller) application. I assumed that by reading the <a href=""https://developer.android.com/work/cosu.html#create-dpc"" rel=""nofollow noreferrer"">following</a> documentation, where one of the 3 ways of provisioning ""single purpose"" devices is creating a custom DPC application. Here's another quote from different <a href=""https://developers.google.com/android/work/dpc/build-dpc"" rel=""nofollow noreferrer"">url</a></p>

<blockquote>
  <p>As an EMM, you develop a DPC app that can be used by your customers in conjunction with your EMM console and server. Your customer deploys the DPC to the user devices that they manage. The DPC acts as the bridge between your EMM console (and server) and the device. An admin uses the EMM console to perform a range of tasks, including configuring device settings and apps.</p>
</blockquote>

<p>And here's where all of my confusions arise. 
First question that naturally arises - <strong>was the author of the previous quote referring to EMM management API when talking about EMM console and server?</strong> </p>

<p>Further, there are more questions that I couldn't find an answer to</p>

<p>In the <a href=""https://developers.google.com/android/work/dpc/build-dpc"" rel=""nofollow noreferrer"">guide</a> for creating a custom DPC there are no mentions about what role EMM API will play in custom DPC, and consequently there's no place I could find that describes <strong>how exactly the custom DPC is a bridge between the EMM console (presumably EMM API) and the device?</strong></p>

<p>Then, let's assume I've developed a custom DPC application and uploaded it to google play alpha channel. <strong>The <a href=""https://developers.google.com/android/work/prov-devices#set_up_device_owner_mode_afw_accts"" rel=""nofollow noreferrer"">documentation</a> states that during the setup process instead of entering afw#setup I should enter afw#DPC_NAME, and I have no idea how to generate that name?</strong> Is it the bundle ID of the DPC app? Or perhaps it's being set somewhere in google settings? For instance, google has developed the <a href=""https://github.com/googlesamples/android-testdpc"" rel=""nofollow noreferrer"">TestDPC</a> application to test enterprise solutions, and I was able to go through the steps I described above and enter afw#testdpc and successfully scanned the QR code in the git readme file and I saw that TestDPC was installed and device was launched into work profile mode. So, I assume somehow I need to register my own ""testdpc"" and enter afw#my_dpc instead.</p>

<p>Basically I have different pieces working stand alone and I want to form a broader picture in my mind to understand how to stitch those pieces together.</p>

<p>Thanks for your answers </p>

<p><strong>UPDATE 1:</strong></p>

<p>Today I found a way of turning custom DPC into device owner without going through NFC or other provisioning process. This is particularly useful for development purposes. Follow <a href=""http://florent-dupont.blogspot.am/2015/01/android-shell-command-dpm-device-policy.html"" rel=""nofollow noreferrer"">this link</a> for instructions.This is both huge time saver, and also, in my case, we still are waiting for google's approval, but finally we can start testing some stuff without the need of custom provisioning process.</p>
",737972,,737972,,2018-04-25 17:05:35,2018-04-25 17:05:35,How does designing custom android DPC app relate to Android management API?,<android><kiosk-mode><cosu><android-enterprise><android-management-api>,1,0,1,
Android,34545676,1,34579698,,2015,,3,1065,"<p>I've been busy updating the <a href=""https://github.com/googlesamples/android-UniversalMusicPlayer"" rel=""nofollow noreferrer"">universal Android Mediaplayer</a> to use the Compat libraries to get it working on Android versions lower than lollipop. </p>

<p>This was a process of replacing most classes by the compat variants of them. You can see the commit with all my changes <a href=""https://github.com/Marc1510/android-UniversalMusicPlayer/commit/3626d74a3013f17d779940a2235e9130b36ec637"" rel=""nofollow noreferrer"">here</a>.</p>

<p>The thing I don't like right now is that the 'browse' function has dissapeard on the Wear device. This function can be seen in the images below.</p>

<p><a href=""https://i.stack.imgur.com/SGwQO.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/SGwQO.png"" alt=""enter image description here""></a> <a href=""https://i.stack.imgur.com/KseZi.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/KseZi.png"" alt=""enter image description here""></a></p>

<p>I just made screenshots of this function with the latest version of the Universal Music Player. When I updated the most classes to their compat variants this function dissapeard. </p>

<p>I don't know if I forgot to update something, if the function should be activated somehow or any other reason why it doesn't work.</p>

<p>Is there any reason for this?</p>
",1887795,,,,,2016-03-03 22:49:19,Updating MediaBrowserService to MediaBrowserServiceCompat removes 'browse' function,<android><android-mediaplayer><android-support-library><appcompat><android-wear-notification>,1,0,1,
Android,46533989,1,,,2017,,4,497,"<p>Related to this question: <a href=""https://stackoverflow.com/questions/46513349/espresso-dagger2-set-viemodelprovider-factory-on-baseactivity"">Espresso, Dagger2 set ViemodelProvider.Factory on BaseActivity</a></p>

<p>I went through hell and back to get a ViewModelFactory.Provider on an Activity during my tests, in order to get espresso tests working regarding Android Architecture Components. I expected it to be simple, but I guess it's not...    </p>

<p>The example to get it working with fragments is straightforward:<br>
<a href=""https://github.com/googlesamples/android-architecture-components/blob/master/GithubBrowserSample/app/src/androidTest/java/com/android/example/github/ui/user/UserFragmentTest.java"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-architecture-components/blob/master/GithubBrowserSample/app/src/androidTest/java/com/android/example/github/ui/user/UserFragmentTest.java</a></p>

<pre><code>@Before
public void init() {
    UserFragment fragment = UserFragment.create(""foo"");
    viewModel = mock(UserViewModel.class);
    when(viewModel.getUser()).thenReturn(userData);
    when(viewModel.getRepositories()).thenReturn(repoListData);
    navigationController = mock(NavigationController.class);
    fragmentBindingAdapters = mock(FragmentBindingAdapters.class);

    fragment.viewModelFactory = ViewModelUtil.createFor(viewModel);
    fragment.navigationController = navigationController;
    fragment.dataBindingComponent = () -&gt; fragmentBindingAdapters;

    activityRule.getActivity().setFragment(fragment);
}
</code></pre>

<p>However, this simply won't work with activities as I can't get the dependencies on the activity before its creation using an <code>ActivityTestRule</code>.<br>
I followed the same new dependency injection flow with Dagger2 as in the example above using the <code>HasActivityInjector</code> interface.  </p>

<p>I would appreciate your help! </p>
",917467,,,,,2017-11-13 10:14:15,Inject ViewModelFactory.Provider in activity for espresso testing,<android><dagger-2>,1,0,1,
Android,46367880,1,46367938,,2017,,4,11434,"<p>There is this repo :</p>

<p><a href=""https://github.com/googlesamples/android-architecture"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-architecture</a></p>

<p>And there is this branch :</p>

<p><a href=""https://github.com/googlesamples/android-architecture/tree/todo-mvvm-databinding/"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-architecture/tree/todo-mvvm-databinding/</a></p>

<p>I have clone the project but i have only the master. What can i do to get this branch ?</p>
",2611161,,,,,2017-09-22 15:12:10,How to pull a specific branch from Github,<git><github><branch>,1,0,1,
Android,54967251,1,54980053,,2019,,4,246,"<p>What are the steps necessary for me to integrate,</p>

<p><a href=""https://github.com/opencv/opencv"" rel=""nofollow noreferrer"">the latest version of OpenCV</a></p>

<p>into a pure C++(No Java Code) Android NDK project, such as Android NDK Google tutorial:</p>

<p><a href=""https://github.com/googlesamples/android-ndk/tree/master/endless-tunnel"" rel=""nofollow noreferrer"">Endless-Tunnel</a>
?</p>

<p><a href=""https://docs.opencv.org/2.4/doc/tutorials/introduction/android_binary_package/O4A_SDK.html"" rel=""nofollow noreferrer"">official documentation</a> for android integration refers to much older version :OpenCV-2.4 and folder structures are no longer the same. </p>

<p>I am using Android Studio on Linux. </p>

<p>All help is highly Appreciated.</p>
",10591628,,10591628,,2019-03-03 9:15:41,2019-03-10 16:24:21,How can I integrate OpenCV 4.0 into a pure C++ Android NDK project?,<android><c++><opencv><android-ndk>,1,0,1,
Android,35048208,1,35603674,,2016,,4,3256,"<p>I'm having some issues setting up a capture request for high speed video. I intend to capture at 120 FPS on Nexus 6P. I set the minimum API to 23, since I don't plan to deploy this app to any other phone. </p>

<p>Where I'm not quite understanding is how to get my capture request to work. Right now, I'm doing my best to change up the code within Camera2Video sample in google's samples. <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""nofollow"">Link to sample from Google</a></p>

<p>Here is all of the relevant code:</p>

<pre><code>private void startPreview() {
    if (null == mCameraDevice || !mTextureView.isAvailable() || null == mPreviewSize) {
        return;
    }
    try {
        setUpMediaRecorder();
        SurfaceTexture texture = mTextureView.getSurfaceTexture();
        assert texture != null;
        texture.setDefaultBufferSize(mPreviewSize.getWidth(), mPreviewSize.getHeight());
        mPreviewBuilder = mCameraDevice.createCaptureRequest(CameraDevice.TEMPLATE_RECORD);
        List&lt;Surface&gt; surfaces = new ArrayList&lt;Surface&gt;();

        Surface previewSurface = new Surface(texture);
        surfaces.add(previewSurface);
        mPreviewBuilder.addTarget(previewSurface);

        Surface recorderSurface = mMediaRecorder.getSurface();
        surfaces.add(recorderSurface);
        mPreviewBuilder.addTarget(recorderSurface);

        mCameraDevice.createConstrainedHighSpeedCaptureSession(surfaces, new CameraCaptureSession.StateCallback() {
        //mCameraDevice.createCaptureSession(surfaces, new CameraCaptureSession.StateCallback() {

            @Override
            public void onConfigured(CameraCaptureSession cameraCaptureSession) {
                //mPreviewSession = cameraCaptureSession;
                mPreviewSession2 = cameraCaptureSession;
                updatePreview();
            }

            @Override
            public void onConfigureFailed(CameraCaptureSession cameraCaptureSession) {
                Activity activity = getActivity();
                if (null != activity) {
                    Toast.makeText(activity, ""Failed"", Toast.LENGTH_SHORT).show();
                }
            }
        }, mBackgroundHandler);
    } catch (CameraAccessException e) {
        e.printStackTrace();
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
}


/**
 * Update the camera preview. {@link #startPreview()} needs to be called in advance.
 */
private void updatePreview() {
    if (null == mCameraDevice) {
        return;
    }
    try {
        setUpCaptureRequestBuilder(mPreviewBuilder);
        HandlerThread thread = new HandlerThread(""CameraPreview"");
        thread.start();
        mPreviewBuilder2 =  mPreviewSession2.createHighSpeedRequestList(mPreviewBuilder.build());
        //mPreviewBuilder2 =


        //mPreviewSession.setRepeatingRequest(mPreviewBuilder.build(), null, mBackgroundHandler);
        mPreviewSession.setRepeatingBurst(mPreviewBuilder2, null, mBackgroundHandler);
    } catch (CameraAccessException e) {
        e.printStackTrace();
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch(Exception e){
        e.printStackTrace();
    }
}

private void setUpCaptureRequestBuilder(CaptureRequest.Builder builder) {
    builder.set(CaptureRequest.CONTROL_MODE, CameraMetadata.CONTROL_MODE_AUTO);
    Range&lt;Integer&gt; fpsRange = Range.create(120, 120);
    builder.set(CaptureRequest.CONTROL_AE_TARGET_FPS_RANGE, fpsRange);

}
</code></pre>

<p>I have no problem getting the code to updatepreview. Unfortunately, from there I've hit a roadblock on how to give setRepeatingBurst my capture requests. I know the constructor is different from the sample's setRepeatingRequest. Therefore, I need to find a way to give setRepeatingBurst my surfaces, my CONTROL_MODE request and my TARGET_FPS_RANGE request. </p>

<pre><code>/**
 * Camera preview.
 */
private CaptureRequest.Builder mPreviewBuilder;
List&lt;CaptureRequest&gt; mPreviewBuilder2;

/**
 * A reference to the current {@link android.hardware.camera2.CameraCaptureSession} for
 * preview.
 */
private CameraCaptureSession mPreviewSession;
private CameraConstrainedHighSpeedCaptureSession mPreviewSession2;
</code></pre>

<p>Any help figuring out how to make this work correctly would be very helpful. I haven't found much on the net in order to help and there isn't any article in StackOverflow mentioning any of the highspeed capture functions. My largest issue here is trying to understand how createConstrainedHighSpeedCaptureSession gives a CameraConstrainedHighSpeedCaptureSession session. So that I can use the createHighSpeedRequestList.</p>
",1120115,,1120115,,2016-01-28 0:11:29,2016-12-15 5:57:49,High speed Capture request Android Marshmallow,<android><android-camera>,1,0,1,
Android,45005130,1,,,2017,,4,2200,"<p>I am trying to implement sms retriever api to read OTP code message without having to add read_sms permission.</p>

<p>The help doc <a href=""https://developers.google.com/identity/sms-retriever/request"" rel=""nofollow noreferrer"">here</a>, ask user to generate hash code specific to app.</p>

<p>I have generated the code as required but still </p>

<p><code>&lt;action android:name=""com.google.android.gms.auth.api.phone.SMS_RETRIEVED""/&gt;</code></p>

<p>broadcast receiver is not firing up.</p>

<p>How can I debug this? </p>

<p>I am testing this by sending a SMS from one mobile to another and I am following the SMS requirement as specified in the document above.</p>

<p>Also, 
There are various methods mentioned to generated hash code. I have tried them all. Problem is each method generated different hash. </p>

<p>I have tried for both debug and release keystore.</p>

<p>Here are those various methods:</p>

<ol>
<li>linux command as describe here - <a href=""https://developers.google.com/identity/sms-retriever/verify#computing_your_apps_hash_string"" rel=""nofollow noreferrer"">help doc</a></li>
<li>sms_retriever_hash_v9 <a href=""https://github.com/googlesamples/android-credentials/blob/master/sms-verification/bin/sms_retriever_hash_v9.sh"" rel=""nofollow noreferrer"">file</a> as described <a href=""https://github.com/googlesamples/android-credentials/tree/master/sms-verification/android"" rel=""nofollow noreferrer"">here</a></li>
<li>By including <a href=""https://github.com/googlesamples/android-credentials/blob/master/sms-verification/android/app/src/main/java/com/google/samples/smartlock/sms_verify/AppSignatureHelper.java"" rel=""nofollow noreferrer"">AppSignatureHelper</a> from sample app.</li>
</ol>
",5700434,,,,,2017-07-13 18:45:11,SMS Retriever API - Generate 11 char hash code for app specific keystore file,<java><android><google-play-services>,1,18,1,
Android,49940190,1,,,2018,,4,784,"<p>I’m working to add instant app feature to an existing application but I can’t manage to test the instant app via Internal Test or Alpha Test.</p>

<p>For testing purpose I created a completely new application on Google Play Console and compiled the “<strong>hello-java</strong>” sample in Git repository 
<a href=""https://github.com/googlesamples/android-instant-apps"" rel=""nofollow noreferrer"">Google samples:- android-instant-apps</a> , changing digital asset links.</p>

<p>I can correctly run the instant app via Android Studio on a real device.</p>

<p>On Google Play Console I uploaded an installed app APK in “<strong>Internal Test</strong>” and added a group of tester. It works correctly, I can see and download the installed app.</p>

<p>Then I uploaded an instant app APK in “Internal Test” but:</p>

<ul>
<li>test method dropdown is grayed out</li>
<li>when I open the URL provided by the Google Play Console: <a href=""https://play.google.com/apps/instantapptesting/_id_"" rel=""nofollow noreferrer"">https://play.google.com/apps/instantapptesting/<em>id</em></a> I get redirected to <a href=""https://play.google.com/apps/internaltest/_package_name_"" rel=""nofollow noreferrer"">https://play.google.com/apps/internaltest/_package_name_</a> and I see the message “App not available for this account”</li>
</ul>

<p>I tried the same process on Alpha channel but:</p>

<ul>
<li>test method dropdown is grayed out</li>
<li>when I open the URL provided by the Google Play Console: <a href=""https://play.google.com/apps/instantapptesting/_id_"" rel=""nofollow noreferrer"">https://play.google.com/apps/instantapptesting/<em>id</em></a> I get redirected to <a href=""https://play.google.com/apps/testing/_package_name_"" rel=""nofollow noreferrer"">https://play.google.com/apps/testing/_package_name_</a> and I see the page of the testing program</li>
<li>when I open App’s page on Google Play Store I don’t see “Try now” button</li>
</ul>

<p>What am I missing?</p>

<p>Thank you</p>

<p>P.S.
The device I’m testing on has “Instant Apps” enabled (I tried other Instant App already on Play Store)</p>
",1729650,,2638235,,2018-04-20 12:35:42,2018-04-20 12:35:42,Instant App not available for testing,<android><android-instant-apps>,1,0,1,
Android,37014990,1,,,2016,,4,1045,"<p>Is the following situation poor design or am I overlooking something important?</p>

<p>Here is the code</p>

<pre><code>public class MainActivity extends AppCompatActivity … {

  …

  @Override
  public void onCreate(Bundle savedInstanceState){
     …
     buildGoogleApiClient();
  }

  /**
   * Builds a GoogleApiClient. Uses the addApi() method to request the LocationServices API.
   */
    protected synchronized void buildGoogleApiClient() {
        mGoogleApiClient = new GoogleApiClient.Builder(this)
                .addConnectionCallbacks(this)
                .addOnConnectionFailedListener(this)
                .addApi(LocationServices.API)
                .build();
    }
}
</code></pre>

<p>Why is <code>buildGoogleApiClient</code> <code>synchronized</code> when it’s ever only called from inside <code>onCreate</code>?</p>

<p>I know it cannot hurt, but that's hardly the point of the question. What I need to know is: <strong>Why is it necessary?</strong></p>

<p><strong>Edit</strong></p>

<p>source to full code: <a href=""https://github.com/googlesamples/android-play-location/blob/master/BasicLocationSample/app/src/main/java/com/google/android/gms/location/sample/basiclocationsample/MainActivity.java"" rel=""nofollow"">https://github.com/googlesamples/android-play-location/blob/master/BasicLocationSample/app/src/main/java/com/google/android/gms/location/sample/basiclocationsample/MainActivity.java</a></p>
",5641865,,5641865,,2016-05-04 0:03:16,2016-05-04 0:03:16,Synchronized method called by Android Activity onCreate method,<java><android><multithreading><android-activity>,1,3,1,
Android,32108318,1,32110832,,2015,,5,1934,"<p>I am reading the code about Android Camera2 APIs from here:
<a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""noreferrer"">https://github.com/googlesamples/android-Camera2Basic</a></p>

<p>And it is confusing in this lines:
<a href=""https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/java/com/example/android/camera2basic/Camera2BasicFragment.java#L570-L574"" rel=""noreferrer"">https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/java/com/example/android/camera2basic/Camera2BasicFragment.java#L570-L574</a></p>

<p>that the previewRequest builder only add surface, which is the TextureView to show, as target. But the following line actually add both as the targets. As I understand, this should not fire the ""OnImageAvailable"" Lisenter during preview, no? So why this add the imagereader's surface here?</p>

<p>I tried to removed this imagereader's surface here but got error when I really want to capture an image.....</p>

<p>SOOO CONFUSING!!!</p>
",969986,,,,,2015-08-21 7:13:11,Android Camera2 Basics API,<android><android-camera>,1,1,1,
Android,36180407,1,36235440,,2016,,5,4592,"<p>I'm doing some simple scanning + advertising testing on bluetooth LE feature for Android using this <a href=""https://github.com/googlesamples/android-BluetoothAdvertisements"" rel=""noreferrer"">sample-code</a></p>

<p>I'm testing it using a Samsung 6 and a Nexus 9, and for some reason if I leave the app running on the Samsung and restart the app on the Nexus, the next time the Samsung devices finds the other device, it has a different address.</p>

<p>In code:</p>

<p><a href=""https://i.stack.imgur.com/D3b8F.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/D3b8F.png"" alt=""enter image description here""></a></p>

<p>On the device:</p>

<p><a href=""https://i.stack.imgur.com/aFxw2.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/aFxw2.png"" alt=""enter image description here""></a></p>

<p>The funny thing it doesn't happen the other way around. (Samsung always has the same address when discovered from the Nexus 9)</p>

<ul>
<li>Is this a common behavior between devices?</li>
<li>Is there another way to identify a specific device besides it's mac address?</li>
</ul>
",219777,,,,,2016-03-26 12:45:13,Why the address of my BluetoothDevice changes every time I relaunch the app?,<android><bluetooth-lowenergy>,1,1,1,
Android,50770478,1,,,2018,,5,734,"<p>What am I trying to do:</p>

<p><strong>Using google exoPlayer to play music, foreground and background.</strong></p>

<p>Break into details:</p>

<ol>
<li>The app launches, google exoPlayer playback control UI should be visible and starts to play immediately. </li>
<li>As soon as the player starts to play, we should see the notification (Using exoplayer's <code>PlayerNotificationManager</code> )</li>
<li>User exits the app either by pressig back button or swipe from recent task, the player service should keep running in froeground with notification.</li>
<li>User taps the notification, it should brings up the app.</li>
</ol>

<p><strong>What I have done:</strong>
I followed google IO18 on this link
<a href=""https://www.youtube.com/watch?v=svdq1BWl4r8&amp;t=1990s"" rel=""noreferrer"">https://www.youtube.com/watch?v=svdq1BWl4r8&amp;t=1990s</a></p>

<p>While I am following the above youtube link, especially the audio app part, I realize one thing, how do you pros add player control UI into this app?</p>

<p>e.g, the app is onDestory, user quits. Then user taps on the notification, back to the MainActivity, there is nothing there, it's an empty screen, quesiton is, <strong>how do you add play control ui in here?</strong></p>

<p>I have looked into <a href=""https://github.com/googlesamples/android-UniversalMusicPlayer"" rel=""noreferrer"">https://github.com/googlesamples/android-UniversalMusicPlayer</a> tyring to figure out this. However, the Universal Android Music Player Sample is using a giant notification (Not PlayerNotificationManager see on IO18) and custom player ui (Not ExoPlayer out of box control UI) which is confusing me a lot.</p>

<p>Please, please, please help.
<strong>How to add player control ui in the following code.</strong>
<a href=""https://github.com/bizkitj/MediaSessionExoPlayer/tree/ExoPlayerGoogleIO2018"" rel=""noreferrer"">https://github.com/bizkitj/MediaSessionExoPlayer/tree/ExoPlayerGoogleIO2018</a></p>

<p>If you can , please not only show me how you do it, I also need to know why did you do it? Break into steps.</p>

<p>Version of ExoPlayer being used:</p>

<pre><code>implementation 'com.google.android.exoplayer:exoplayer-core:2.8.0' 
implementation 'com.google.android.exoplayer:exoplayer-ui:2.8.0'
implementation 'com.google.android.exoplayer:extension-mediasession:2.8.0'
</code></pre>

<p>Please be noted, I am tyring to buid things upon the googleIO18 demo app. This demo app is using exoPlayer's <code>PlayerNotificationManager</code> which is great to keep sync with <code>MediaSession</code>, I do not want to change this <code>PlayerNotificationManager</code>  to android <code>Notification.MediaStyle</code>.</p>

<p>Thank you.</p>
",8328523,,5810747,,2018-06-09 11:17:59,2018-08-27 19:25:09,how to add player control ui in google IO18 audio App demo,<exoplayer><exoplayer2.x>,1,3,1,
Android,52381029,1,52396338,,2018,,5,733,"<p>Regarding <a href=""https://developer.android.com/training/articles/keystore"" rel=""noreferrer"">Android Keystore system</a> article,</p>

<blockquote>
  <p>Key material never enters the application process. When an application performs cryptographic operations using an Android Keystore key, behind the scenes plaintext, ciphertext, and messages to be signed or verified are fed to a system process which carries out the cryptographic operations. If the app's process is compromised, the attacker may be able to use the app's keys but cannot extract their key material (for example, to be used outside of the Android device)</p>
</blockquote>

<p>So, my question is why is in <a href=""https://github.com/googlesamples/android-BasicAndroidKeyStore/"" rel=""noreferrer"">BasicAndroidKeyStore</a>, developer able to <a href=""https://github.com/googlesamples/android-BasicAndroidKeyStore/blob/master/Application/src/main/java/com/example/android/basicandroidkeystore/BasicAndroidKeyStoreFragment.java#L211"" rel=""noreferrer"">get the KeyPair object</a> and then <a href=""https://github.com/googlesamples/android-BasicAndroidKeyStore/blob/master/Application/src/main/java/com/example/android/basicandroidkeystore/BasicAndroidKeyStoreFragment.java#L213"" rel=""noreferrer"">print its public/private keys</a>?</p>

<p>If developer can access the keys, how this system can be considered to be secured? It's not. If an attacker compromises the app process, he can easily retrieve the kays and use outside of the device. </p>
",1841194,,,,,2018-09-24 4:04:01,Can we extract public/private keys from the Android Keystore?,<android><android-keystore>,1,1,1,
Android,47533726,1,,,2017,,6,422,"<p>I am new to android. I have been looking for ways to record a video using Camera2 api and MediaCodec but no luck. I saw a sample by Google(<a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""noreferrer"">https://github.com/googlesamples/android-Camera2Video</a>) using MediaRecorder. My question is how to replace this MediaRecorder with MediaCodec.</p>
",4968955,,,,,2018-08-30 19:28:45,How to use MediaCodec with Camera2?,<android>,1,0,1,
Android,40548551,1,,,2016,,6,1120,"<p>I have app which uses Fingerprint and 4 digit pin (which can be set by user in application settings, this is not system pin/pattern/password) authorization.</p>

<p>With Fingerprint everything is fine, I have problem with pin.</p>

<p>What I'm trying to do is:</p>

<ol>
<li>Let user set pin from application settings</li>
<li>Generate Keypair in keystore for some alias protected by entered pin (so that private key can not be accessed without this pin)</li>
<li>Send public key to server for future signature verification</li>
<li>Get user token from server and store it in local storage</li>
</ol>

<p>Then during Authorization:</p>

<ol start=""5"">
<li>Request user to enter the pin</li>
<li>Retrieve private key by entered pin</li>
<li>Retrieve token from local storage</li>
<li>Sign token with private key from step 6</li>
<li>Send it to server with signed data</li>
<li>Verify signature on server and if it is valid, open session for user.</li>
</ol>

<p>My question is: <strong>How can I generate KeyPair protected by pin entered by user</strong></p>

<p>P.S. For <a href=""https://github.com/googlesamples/android-AsymmetricFingerprintDialog"" rel=""nofollow noreferrer"">fingerprint</a> this logic is handled by:</p>

<pre><code>KeyGenParameterSpec.Builder(KEY_NAME, KeyProperties.PURPOSE_SIGN).setUserAuthenticationRequired(true)
</code></pre>
",1372146,,1372146,,2016-11-13 16:54:35,2016-11-13 16:54:35,"How to generate KeyPair in android KeyStore, protected by custom password",<android><keystore><key-pair><android-fingerprint-api>,1,0,1,
Android,45783523,1,45878920,,2017,,6,2067,"<p>I am using the following google sample project: <a href=""https://github.com/googlesamples/android-architecture-components"" rel=""noreferrer"">https://github.com/googlesamples/android-architecture-components</a> as a reference for my new project and having difficulties trying to add a second activity to the project.</p>

<p>Here is the error I get when compiling</p>

<pre class=""lang-none prettyprint-override""><code>Error:(22, 8) error: [dagger.android.AndroidInjector.inject(T)] com.apps.myapp.ui.common.MainActivity cannot be provided without an @Inject constructor or from an @Provides-annotated method. This type supports members injection but cannot be implicitly provided.
com.apps.myapp.ui.common.MainActivity is injected at
com.apps.myapp.ui.common.NavigationController.&lt;init&gt;(mainActivity)
com.apps.myapp.ui.common.NavigationController is injected at
com.apps.myapp.ui.addContacts.AddContactsFragment.navigationController
com.apps.myapp.ui.addContacts.AddContactsFragment is injected at
dagger.android.AndroidInjector.inject(arg0)
A binding with matching key exists in component: com.apps.myapp.di.ActivityModule_ContributeMainActivity.MainActivitySubcomponent
</code></pre>

<p>Here is my code</p>

<p>ActivityModule</p>



<pre class=""lang-java prettyprint-override""><code>@Module
public abstract class ActivityModule {

    @ContributesAndroidInjector(modules = FragmentBuildersModule.class)
    abstract MainActivity contributeMainActivity();

    @ContributesAndroidInjector(modules = FragmentBuildersModule.class)
    abstract ContactActivity contributeContactActivity();
} 
</code></pre>

<p>AppComponent</p>

<pre class=""lang-java prettyprint-override""><code>@Singleton
@Component(modules = {
        AndroidInjectionModule.class,
        AppModule.class,
        ActivityModule.class})
public interface AppComponent {
    @Component.Builder
    interface Builder {
        @BindsInstance Builder application(Application application);
        AppComponent build();
    }
    void inject(App app);
}
</code></pre>

<p>AppInjector</p>

<pre class=""lang-java prettyprint-override""><code>public class AppInjector {
    private AppInjector() {}
    public static void init(App app) {DaggerAppComponent.builder().application(app).build().inject(app);
                    app.registerActivityLifecycleCallbacks(new Application.ActivityLifecycleCallbacks() {
                    @Override
                    public void onActivityCreated(Activity activity, Bundle savedInstanceState) {
                        handleActivity(activity);
                    }

                    @Override
                    public void onActivityStarted(Activity activity) {

                    }

                    @Override
                    public void onActivityResumed(Activity activity) {

                    }

                    @Override
                    public void onActivityPaused(Activity activity) {

                    }

                    @Override
                    public void onActivityStopped(Activity activity) {

                    }

                    @Override
                    public void onActivitySaveInstanceState(Activity activity, Bundle outState) {

                    }

                    @Override
                    public void onActivityDestroyed(Activity activity) {

                    }
                });
    }

    private static void handleActivity(Activity activity) {
        if (activity instanceof HasSupportFragmentInjector) {
            AndroidInjection.inject(activity);
        }
        if (activity instanceof FragmentActivity) {
            ((FragmentActivity) activity).getSupportFragmentManager()
                    .registerFragmentLifecycleCallbacks(
                            new FragmentManager.FragmentLifecycleCallbacks() {
                                @Override
                                public void onFragmentCreated(FragmentManager fm, Fragment f,
                                        Bundle savedInstanceState) {
                                    if (f instanceof Injectable) {
                                        AndroidSupportInjection.inject(f);
                                    }
                                }
                            }, true);
        }
    }
}
</code></pre>

<p>AppModule</p>

<pre class=""lang-java prettyprint-override""><code>@Module(includes = ViewModelModule.class)
class AppModule {
    @Singleton @Provides
    BnderAPIService provideService() {
        return new Retrofit.Builder()
                .baseUrl(""serverurl"")
                .addConverterFactory(GsonConverterFactory.create())
                .addCallAdapterFactory(new LiveDataCallAdapterFactory())
                .build()
                .create(APIService.class);
    }

    @Singleton @Provides
    Db provideDb(Application app) {
        return Room.databaseBuilder(app, Db.class,""Db.db"").build();
    }

    @Singleton @Provides
    UserDao provideUserDao(Db db) {
        return db.userDao();
    }

    @Singleton @Provides
    ContactDao provideContactDao(Db db) {
        return db.contactDao();
    }
}
</code></pre>

<p>FragmentBuildersModule</p>

<pre class=""lang-java prettyprint-override""><code>@Module
public abstract class FragmentBuildersModule {

    @ContributesAndroidInjector
    abstract AddContactsFragment contributeAddUserFragment();

    @ContributesAndroidInjector
    abstract ContactsFragment contributeContactsFragment();

    @ContributesAndroidInjector
    abstract ChalkboardFragment contributeChalkboardFragment();
}
</code></pre>

<p>Injectable</p>

<pre class=""lang-java prettyprint-override""><code>public interface Injectable {
}
</code></pre>

<p>ViewModelKey</p>

<pre class=""lang-java prettyprint-override""><code>@Documented
@Target({ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@MapKey
@interface ViewModelKey {
    Class&lt;? extends ViewModel&gt; value();
}
</code></pre>

<p>ViewModelModule</p>

<pre class=""lang-java prettyprint-override""><code>@Module
abstract class ViewModelModule {
    @Binds
    @IntoMap
    @ViewModelKey(AddContactsViewModel.class)
    abstract ViewModel bindAddContactsViewModel(AddContactsViewModel addContactsViewModel);

    @Binds
    @IntoMap
    @ViewModelKey(ContactsViewModel.class)
    abstract ViewModel bindContactsViewModel(ContactsViewModel contactsViewModel);

    @Binds
    @IntoMap
    @ViewModelKey(ChalkboardViewModel.class)
    abstract ViewModel bindChalkboardViewModel(ChalkboardViewModel chalkboardViewModel);

    @Binds
    abstract ViewModelProvider.Factory bindViewModelFactory(ViewModelFactory factory);
}
</code></pre>

<p>Application</p>

<pre class=""lang-java prettyprint-override""><code>public class App extends Application implements HasActivityInjector {

    @Inject
    DispatchingAndroidInjector&lt;Activity&gt; dispatchingAndroidInjector;
    @Override
    protected void attachBaseContext(Context base) {
        super.attachBaseContext(base);
        MultiDex.install(this);
    }
    @Override
    public void onCreate() {
        super.onCreate();
        if (BuildConfig.DEBUG) {

        }
        AppInjector.init(this);
    }

    @Override
    public DispatchingAndroidInjector&lt;Activity&gt; activityInjector() {
        return dispatchingAndroidInjector;
    }
}
</code></pre>

<p>NavigationController</p>

<pre class=""lang-java prettyprint-override""><code>public class NavigationController {
    private final int containerId;
    private final FragmentManager fragmentManager;
    @Inject
    public NavigationController(MainActivity mainActivity) {
        this.containerId = R.id.container;
        this.fragmentManager = mainActivity.getSupportFragmentManager();
    }

    public void navigateToUsers() {
        Log.i(""TAG"", ""Navigate to users"");
        String tag = ""users"";
        AddContactsFragment userFragment = AddContactsFragment.create();
        fragmentManager.beginTransaction()
                .replace(containerId, userFragment, tag)
                .addToBackStack(null)
                .commitAllowingStateLoss();
    }

    public void navigateToContacts() {
        Log.i(""TAG"", ""Navigate to contacts"");
        String tag = ""contacts"";
        ContactsFragment contactsFragment = ContactsFragment.create();
        fragmentManager.beginTransaction()
                .add(contactsFragment, tag)
                .addToBackStack(null)
                .commitAllowingStateLoss();
    }

    public void navigateToChalkboard() {
        Log.i(""TAG"", ""Navigate to chalkboard"");
        String tag = ""chalkboard"";
        ChalkboardFragment chalkboardFragment = ChalkboardFragment.create();
        fragmentManager.beginTransaction()
                .add(chalkboardFragment, tag)
                .addToBackStack(null)
                .commitAllowingStateLoss();
    }
}
</code></pre>

<p>MainActivity</p>

<pre class=""lang-java prettyprint-override""><code>public class MainActivity extends AppCompatActivity implements LifecycleRegistryOwner, HasSupportFragmentInjector {
    private final LifecycleRegistry lifecycleRegistry = new LifecycleRegistry(this);
    @Inject
    DispatchingAndroidInjector&lt;Fragment&gt; dispatchingAndroidInjector;
    @Inject
    NavigationController navigationController;
    private Toolbar toolbar;
    @Override
    public LifecycleRegistry getLifecycle() {
        return lifecycleRegistry;
    }

    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        ActivityMainBinding binding = DataBindingUtil.setContentView(this, R.layout.activity_main);
        binding.setHandler(this);
        binding.setManager(getSupportFragmentManager());
        toolbar = (Toolbar) findViewById(R.id.toolbar);
        setSupportActionBar(toolbar);
    }

    @Override
    public DispatchingAndroidInjector&lt;Fragment&gt; supportFragmentInjector() {
        return dispatchingAndroidInjector;
    }

    static class ViewPagerAdapter extends FragmentPagerAdapter {
        private final List&lt;Fragment&gt; mFragmentList = new ArrayList&lt;&gt;();
        private final List&lt;String&gt; mFragmentTitleList = new ArrayList&lt;&gt;();

        public ViewPagerAdapter(FragmentManager manager) {
            super(manager);
        }

        @Override
        public Fragment getItem(int position) {
            return mFragmentList.get(position);
        }

        @Override
        public int getCount() {
            return mFragmentList.size();
        }

        public void addFragment(Fragment fragment, String title) {
            mFragmentList.add(fragment);
            mFragmentTitleList.add(title);
        }

        @Override
        public CharSequence getPageTitle(int position) {
            return mFragmentTitleList.get(position);
        }
    }

    @BindingAdapter({""handler""})
    public static void bindViewPagerAdapter(final ViewPager view, final MainActivity activity) {
        final ViewPagerAdapter adapter = new ViewPagerAdapter(activity.getSupportFragmentManager());
        adapter.addFragment(new ChalkboardFragment(), ""Chalkboard"");
        adapter.addFragment(new ContactsFragment(), ""Contacts"");
        view.setAdapter(adapter);
    }

    @BindingAdapter({""pager""})
    public static void bindViewPagerTabs(final TabLayout view, final ViewPager pagerView) {
        view.setupWithViewPager(pagerView, true);
    }
}
</code></pre>

<p>ContactActivity</p>

<pre class=""lang-java prettyprint-override""><code>public class ContactActivity extends AppCompatActivity implements LifecycleRegistryOwner, HasSupportFragmentInjector {
    private final LifecycleRegistry lifecycleRegistry = new LifecycleRegistry(this);
    @Inject
    DispatchingAndroidInjector&lt;Fragment&gt; dispatchingAndroidInjector;
    @Override
    public LifecycleRegistry getLifecycle() {
        return lifecycleRegistry;
    }

    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_contact);
        if (savedInstanceState == null) {

        }
    }

    @Override
    public DispatchingAndroidInjector&lt;Fragment&gt; supportFragmentInjector() {
        return dispatchingAndroidInjector;
    }
}
</code></pre>
",4433653,,182660,,2017-08-22 23:16:39,2018-10-19 2:51:49,MVVM Dagger2 A Binding With Matching Key Exists in Component,<android><mvvm><dagger-2><android-architecture-components><android-mvvm>,1,6,1,
Android,37623264,1,,,2016,,7,1900,"<p>I have the standard com.google.android.gms.vision.Tracker <a href=""https://github.com/googlesamples/android-vision/blob/master/visionSamples/FaceTracker/app/src/main/java/com/google/android/gms/samples/vision/face/facetracker/FaceTrackerActivity.java"" rel=""noreferrer"">example</a> successfully running on my android device and now i need to postprocess the image to find the iris of the current face which has been notified in the event methods of the Tracker.</p>

<p>So, how do i get the Bitmap frame which matches exactly the com.google.android.gms.vision.face.Face i received in the Tracker events?
This also means that the final bitmap should match the webcam resolution and not the screen resolution.</p>

<p>One bad alternative solution is to call takePicture every few ms on my CameraSource and process this picture separately using the FaceDetector. Although this works i have the problem that the video stream freezes during takepicture and i get lots of GC_FOR_ALLOC messages cause of the single bmp facedetector memory waste.</p>
",73594,,,,,2017-07-19 14:23:32,How to get the current frame (as a Bitmap) for android facedetector in a Tracker event?,<android><vision>,1,5,1,
Android,36004651,1,36487904,,2016,,10,802,"<p>OK, perhaps it is very simple, but I just can not figure it out right now.</p>

<p>I have imported google sample project <a href=""https://github.com/googlesamples/android-CardReader.git"" rel=""nofollow"">Card Reader</a> in Android Studio 1.5.1, it compiles at compileSdkVerison 23, it works on my Mobile.</p>

<p>Then I walked through the SDK while came to source code to <code>android.nfc.tech.BasicTagTechnology</code>, I found <code>TransceiveResult</code> inside <code>android.nfc.tech.BasicTagTechnology#transceive</code> couldn't not be resolved then I found the class <code>TransceiveResult</code> is missing in my <code>D:\Android\sdk\platforms\android-23\android.jar</code>, but presents in Android source code here <code>D:\Android\sdk\sources\android-23\android\nfc\TransceiveResult.java</code> then I realized it could be hidden from public, not exported, actually it is</p>

<pre><code>/**
 * Class used to pipe transceive result from the NFC service.
 *
 * @hide
 */

public final class TransceiveResult implements Parcelable
</code></pre>

<p>Then I have done some random things, after I have sync the project, clean and rebuild, invalidate caches / restarted, still not able to resolve <code>TransceiveResult</code> by the way, I am wondering since the symbol has been lost in SDK, how can the project compile smoothly?</p>

<p><strong>EDIT for I finally Aha</strong></p>

<p>We call <code>android.nfc.tech.BasicTagTechnology#transceive</code> in our code rather than <code>TransceiveResult</code>, in the compile-time we no need to resolve <code>TransceiveResult</code>, we only need to resolve <code>android.nfc.tech.BasicTagTechnology#transceive</code> which is referenced in our code, I was lost at that moment.</p>
",1356874,,1356874,,2016-04-11 11:28:21,2016-04-11 11:35:03,How can Android project compile when imported class is missing in SDK?,<android><android-studio><android-sdk-tools><android-build><android-studio-import>,1,7,1,
Android,48189415,1,,,2018,,13,3814,"<p>I've started using Architecture Components in my application and I'm still learning how to use it. </p>

<p>In my app I have an Activity showing different Fragments sequentially. In some of them I need to communicate with a background service in order to receive data from external BLE sensors. Since I need to interact with the service in more than one Fragment, I'm wondering if ViewModel is the right place where to make the binding. <a href=""https://github.com/googlesamples/android-architecture-components/issues/20"" rel=""noreferrer"">I've looked around</a> but I didn't found an answer.</p>

<p>Are there any problems binding a service inside a ViewModel?</p>
",302798,,,,,2018-02-20 6:37:35,Is it correct to bind a ViewModel to a Service?,<android><android-service><android-architecture-components><android-viewmodel>,1,3,1,
Android,47148619,1,47161584,,2017,,1,157,"<p>I'm super excited that Realm now supports RxJava 2 which introduces the asFlowable functionality so thank you to anyone that contributed to this.</p>

<p>The problem I'm facing is how to best manage the life cycle of realm instances in my local data source singleton class. My local data source is similar to the Android architecture sample <a href=""https://github.com/googlesamples/android-architecture/blob/todo-mvp-rxjava/todoapp/app/src/main/java/com/example/android/architecture/blueprints/todoapp/data/source/local/TasksLocalDataSource.java"" rel=""nofollow noreferrer"">here</a>. In the Realm examples for RxJava, they instantiate a realm instance in the onCreate and close it in the onDestroy of the activity. However, since my local data source is a singleton, I won't have these lifecycle events to instantiate and close the instance.</p>

<p>The question is: should I instantiate a realm instance every time the singleton is created and close it only when the singleton is destroyed or should I instantiate a realm instance in the activity/fragment, inject it into the local data source, and then close it in the activity/fragment?
Any other suggestions are welcome. Thanks!</p>
",3308320,,,,,2017-11-07 15:27:26,How do you structure a local data source using RxJava and Realm?,<android><realm><mvp><rx-java2>,2,0,1,
Android,43319318,1,,,2017,,1,1063,"<p>I am building a custom camera with the Camera2 API.
So far the camera works very well except for the preview which is distorted sometimes. Let's say I open the camera 7 times in a row. All of the attempts are succesful and the 8th time the camera preview is distorted. It looks like it uses the width as the height and vice versa.</p>

<p>I have based my code on the Google sample implementation of the camera2 which can be found <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""nofollow noreferrer"">here</a>.
the interesting thing is that even the Google sample implementation has this distorted preview sometimes. I have tried to modify the AutoFitTextureView but nothing was successful. I am currently using the AutoFitTextureView.java Google provides again.</p>

<p>A similar post to this one <a href=""https://stackoverflow.com/questions/30049293/camera-preview-stretched-on-few-android-devices"">can be found here</a>.
However the proposed fixes didn't solve the problem.</p>

<p>I can reproduce the problem by changing the following in the setUpCameraOutputs method:</p>

<pre><code>mTextureView.setAspectRatio(mPreviewSize.getHeight(), mPreviewSize.getWidth());
</code></pre>

<p>to:</p>

<pre><code>mTextureView.setAspectRatio(mPreviewSize.getWidth(), mPreviewSize.getHeight());
</code></pre>

<p>Another weird thing is that whenever the distorted preview occurs and you just press the home button so the app goes in onPause() and open up the app again so onResume() gets called, the preview is perfect every time.</p>

<p>Has anyone here experienced this problem and found a fix for it?</p>

<p>Thanks in advance</p>
",7726613,,-1,,2017-05-23 12:17:35,2018-01-07 15:33:32,Android Camera2 API preview sometimes distorted,<android><preview><android-camera2><distortion><camera2>,2,2,1,
Android,52480833,1,,,2018,,1,240,"<p>I am trying to implement app bundle for my project. On starting the dynamic module activity, it is downloading the module and trying to install the module, but is not able to completely install it. It gets stuck as in the image given below. 
<a href=""https://i.stack.imgur.com/kHc8k.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/kHc8k.jpg"" alt=""enter image description here""></a></p>

<p>Following the below link for reference. 
<a href=""https://github.com/googlesamples/android-dynamic-features"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-dynamic-features</a></p>

<pre><code>import android.content.Intent
import android.os.Bundle
import android.support.v7.app.AppCompatActivity
import android.util.Log
import android.view.View
import android.widget.ProgressBar
import android.widget.TextView
import com.google.android.play.core.splitinstall.*
import com.google.android.play.core.splitinstall.model.SplitInstallSessionStatus
import com.lenskart.app.R

private const val modulePackageName = ""com.test.feature""

private const val htoClassname = ""$modulePackageName.hto.HtoActivity""

private const val atHomeClassname = ""$modulePackageName.athome.AtHomeActivity""

class BundleActivity : AppCompatActivity() {

    private val listener = SplitInstallStateUpdatedListener { state -&gt;
        val multiInstall = state.moduleNames().size &gt; 1
        state.moduleNames().forEach { name -&gt;
            when (state.status()) {
                SplitInstallSessionStatus.DOWNLOADING -&gt; {
                    displayLoadingState(state, ""Downloading $name"")
                }
                SplitInstallSessionStatus.REQUIRES_USER_CONFIRMATION -&gt; {
                    startIntentSender(state.resolutionIntent().intentSender, null, 0, 0, 0)
                }
                SplitInstallSessionStatus.INSTALLED -&gt; {
                    displayLoadingState(state, ""Installed $name"")
                    onSuccessfulLoad(name, launch = !multiInstall)
                }

                SplitInstallSessionStatus.INSTALLING -&gt; displayLoadingState(state, ""Installing $name"")
                SplitInstallSessionStatus.FAILED -&gt; {
                    Log.e(TAG, ""Error: ${state.errorCode()} for module ${state.moduleNames()}"")
                }

                SplitInstallSessionStatus.CANCELED -&gt; displayLoadingState(state, ""Cancelled $name"")
                SplitInstallSessionStatus.UNKNOWN -&gt; displayLoadingState(state, ""Unknown thingy $name"")
                SplitInstallSessionStatus.PENDING -&gt; displayLoadingState(state, ""Pending $name"")

            }
        }
    }

    private val moduleHto by lazy { ""hto"" }
    private val moduleAtHome by lazy { ""athome"" }

    private lateinit var manager: SplitInstallManager

    private lateinit var progressBar: ProgressBar
    private lateinit var progressText: TextView

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_bundle)
        manager = SplitInstallManagerFactory.create(this)
        initializeViews()
        loadAndLaunchModule(moduleAtHome)
    }

    override fun onResume() {
        manager.registerListener(listener)
        super.onResume()
    }

    override fun onPause() {
        manager.unregisterListener(listener)
        super.onPause()
    }

    private fun loadAndLaunchModule(name: String) {
        updateProgressMessage(""Loading module $name"")
        if (manager.installedModules.contains(name)) {
            updateProgressMessage(""Already installed"")
            onSuccessfulLoad(name, launch = true)
            return
        }
        val request = SplitInstallRequest.newBuilder()
                .addModule(name)
                .build()

        manager.startInstall(request)

        updateProgressMessage(""Starting install for $name"")
    }

    private fun onSuccessfulLoad(moduleName: String, launch: Boolean) {
        if (true) {
            when (moduleName) {
                moduleHto -&gt; launchActivity(htoClassname)
                moduleAtHome -&gt; launchActivity(atHomeClassname)
            }
        }

        displayButtons()
    }

    private fun launchActivity(className: String) {
        Intent().setClassName(packageName, className)
                .also {
                    startActivity(it)
                }
    }

    private fun displayLoadingState(state: SplitInstallSessionState, message: String) {
        displayProgress()

        progressBar.max = state.totalBytesToDownload().toInt()
        progressBar.progress = state.bytesDownloaded().toInt()

        updateProgressMessage(message)
    }

    private fun initializeViews() {
        progressBar = findViewById(R.id.progress_bar)
        progressText = findViewById(R.id.progress_text)
    }

    private fun updateProgressMessage(message: String) {
        if (progressText.visibility != View.VISIBLE &amp;&amp;
                progressBar.visibility != View.VISIBLE) displayProgress()
        progressText.text = message
    }

    private fun displayProgress() {
        progressText.visibility = View.VISIBLE
        progressBar.visibility = View.VISIBLE
    }

    private fun displayButtons() {
        progressText.visibility = View.GONE
        progressBar.visibility = View.GONE
    }

}

private const val TAG = ""DynamicFeatures""
</code></pre>
",2053458,,,,,2018-11-09 7:18:56,"Dynamic Feature activity not loading, stuck at installation",<android><generics><app-bundle><android-app-bundle>,2,1,1,
Android,52873328,1,52943251,,2018,,1,195,"<p>I'm currently working on instant apps for Android and I want to use the Camera. 
I'm requesting the camera permission in a Fragment, but the Permission request dialog doesn't appear. </p>

<p>This is how I request the permission in the Fragment:</p>

<pre><code>requestPermissions(new String[]{
                    Manifest.permission.CAMERA}, 1);
</code></pre>

<p>Now I expect, that the Permission request dialog is displayed, as it is for the Application itself (com.android.application). Unfortunately it doesn't appear for the instant app (com.android.instantapp).</p>

<p>Additionally I figured out that the </p>

<pre><code>@Override
public void onRequestPermissionsResult(final int requestCode, @NonNull final String permissions[], @NonNull int[] grantResults)
{...}
</code></pre>

<p>is called but with <code>grantResults[0] = -1</code>, which means <code>PackageManager.PERMISSION_DENIED</code>.</p>

<p>As per the <a href=""https://developer.android.com/topic/instant-apps/faqs.html"" rel=""nofollow noreferrer"">Instant Apps FAQ</a> it should be the same as for the application:</p>

<blockquote>
  <p><strong>How do permissions work in Google Play Instant?</strong></p>
  
  <p>Google Play Instant uses the <a href=""https://developer.android.com/training/permissions/requesting.html"" rel=""nofollow noreferrer"">runtime permissions</a> model that was introduced in Android 6.0 (API level 23).</p>
</blockquote>

<p>The same problem occurs, if I add a permission request for the Instant App Demo project from Google (<a href=""https://github.com/googlesamples/android-topeka"" rel=""nofollow noreferrer"">android-topeka</a>).</p>
",4291264,,4291264,,2018-10-19 11:26:11,2018-10-23 7:18:44,Android instant app permission request dialog not shown,<android><android-permissions><android-instant-apps>,2,5,1,
Android,45104944,1,,,2017,,1,885,"<p>I am interested in how to run Espresso tests from command line (gradle task) individually (<em>run group/suite tests then close app and then run another group/suite of tests</em>).</p>

<p>Found that it is feasible to implement <a href=""https://developer.android.com/training/testing/unit-testing/instrumented-unit-tests.html#test-suites"" rel=""nofollow noreferrer"">JUnit Test Suites</a> but do not really understand how does it looks like under the hood in a context of instrumentation tests. Does it starts separate processes per Test suite? There is <a href=""https://github.com/googlesamples/android-testing/tree/master/runner/AndroidJunitRunnerSample"" rel=""nofollow noreferrer"">sample application on Github</a> but how to execute it from terminal?</p>

<p>Another interesting discovery is <a href=""https://developer.android.com/training/testing/junit-runner.html#sharding-tests"" rel=""nofollow noreferrer"">Sharding tests</a>. However, it one sentence documentation.</p>

<p>May be somebody can share with any experience of running Espresso tests individually.</p>
",1474153,,1474153,,2017-07-14 17:04:31,2017-07-18 3:17:38,Android Espresso Test Suites,<android><unit-testing><android-emulator><android-espresso><android-junit>,2,0,1,
Android,40331561,1,,,2016,,1,1890,"<p>I am trying to capture video in a custom view. I can display video in correct orientation via Camera.setDisplayOrientation(rotation), but recorded video is still in landscape mode. I cannot capture video correctly in portrait mode.</p>

<p>I tested <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""nofollow"">https://github.com/googlesamples/android-Camera2Video</a>  and it has the same problem too.</p>

<p>I am calling <code>setCameraOrientation()</code> method after <code>Camera.open(currentCameraId)</code> after checking for permissions.</p>

<pre><code>private void setCameraOrientation()
{
    int rotation = getRotation();
    mCamera.setDisplayOrientation(rotation);

    Camera.Parameters parameters = mCamera.getParameters();
    parameters.setRotation(rotation);
    mCamera.setParameters(parameters);
}

private int getRotation()
{
    Display display = getWindowManager().getDefaultDisplay();
    int rotation = 0;
    switch (display.getRotation())
    {
        case Surface.ROTATION_0:
            rotation = 90;
            break;
        case Surface.ROTATION_90:
            rotation = 0;
            break;
        case Surface.ROTATION_180:
            rotation = 270;
            break;
        case Surface.ROTATION_270:
            rotation = 180;
            break;
    }
    return rotation;
}
</code></pre>

<p>This lets me display video in correct orientation. But when after I stop <code>MediaRecorder</code> and check for saved file, I see 90 degrees rotated video with bad aspect ratio. I checked this via pulling to my computer and in another fragment which has VideoView element. My  prepareRecorder method is: </p>

<pre><code>private boolean prepareRecorder()
{
    mCamera.lock();
    mCamera.unlock();
    recorder = new MediaRecorder();

    recorder.setCamera(mCamera);

    recorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);

    CamcorderProfile profile = CamcorderProfile.get(CamcorderProfile.QUALITY_HIGH);
    if (!mIsMute)
    {
        recorder.setAudioSource(MediaRecorder.AudioSource.DEFAULT);
        recorder.setProfile(profile);
    }
    else
    {
        recorder.setOutputFormat(profile.fileFormat);
        recorder.setVideoSize(profile.videoFrameWidth, profile.videoFrameHeight);
        recorder.setVideoFrameRate(profile.videoFrameRate);
        recorder.setVideoEncoder(profile.videoCodec);
        recorder.setVideoEncodingBitRate(profile.videoBitRate);
    }

    recorder.setMaxDuration(maxVideoDuration - videoProgress);

    String fileName = StorageUtil.sharedUtil().getExternalStorageDir() + File.separator + String.format(
            fileNameFormat, videoCount);
    recorder.setOutputFile(fileName);

    recorder.setPreviewDisplay(surfaceHolder.getSurface());

    try
    {
        recorder.prepare();
    }
    catch (Exception e)
    {
        e.printStackTrace();
        return false;
    }

    return true;
}
</code></pre>

<p>and then I just call <code>recorder.start();</code></p>

<p>By the way I tried <code>recorder.setOrientationHint(90);</code> just before <code>recoreder.prepare();</code> but it does not do anything. I can display correct orientation but cannot save.</p>
",7027099,,,,,2017-01-21 17:49:29,"Android, How to rotate recorded video using MediaRecorder in portrait mode",<android><video><orientation><mediarecorder><portrait>,2,0,1,
Android,48972343,1,,,2018,,1,1654,"<p>I am looking for recommendation in handling below use case w.r.t. LiveData handling:
ViewModel invokes Repository for LiveData (e.g. products catalog). Repository checks from LocalDataSource(Room) first but if data not available, invokes RemoteDataSource(REST API). </p>

<p>Questions:</p>

<p>1) As per below comment from yigit <a href=""https://github.com/googlesamples/android-architecture-components/issues/44"" rel=""nofollow noreferrer"">here</a>, Repository can't get LiveData availability status in Room until it subscribes as observer. So even when data is avaiable, I get null in response. 
<em>""LiveData is to watch the data and distribute it to the observers. It won't calculate the value until an active observer is added.""</em></p>

<p>Since Repository hides data sources to clients, it is repository's responsibility to check in Room and then pull from Remote Source. How can it check for data availability in Room ?</p>

<p>2) Since data returned by RemoteDataSource is not LiveData type, what should be done so that repository eventually returns LiveData to ViewModel ?</p>

<p>Should Repository first insert data (from RemoteDataSource) into Room first and then query Room so it returns LiveData ? It looks quite expensive operation as there Room is queried twice in the process. Please advise . Thanks !</p>
",1992013,,1000551,,2018-03-19 11:21:28,2018-12-23 13:40:27,Repository to return LiveData when Room doesn't have it and instead fetches from REST API,<android><android-room><android-architecture-components><android-livedata><android-viewmodel>,2,0,1,
Android,41032145,1,41032503,,2016,,1,1240,"<p>{Novice Android Dev.}</p>

<p>I'm currently using Google's Open Source Media App found on <a href=""https://github.com/googlesamples/android-UniversalMusicPlayer"" rel=""nofollow noreferrer"">Github</a> to try and create my own media player for one of my own projects. However, one issue that I keep running into is that when I change the JSON file in RemoteJSON from </p>

<pre><code>protected static final String CATALOG_URL =
    ""http://storage.googleapis.com/automotive-media/music.json"";
</code></pre>

<p>to</p>

<pre><code>protected static final String CATALOG_URL =
    ""https://api.myjson.com/bins/2ir4d"";
</code></pre>

<p>(using myjson.com to store the file)</p>

<p>it populates the information within the app but when one item is selected, it produces a MediaPlayer error 1 (-2147483648). (All I did was copy the JSON code from original Google URL and uploaded it to myjson)</p>

<p>My goal is to create my own JSON file with my own media content but I can't even get this one to work outside of the provided URL.</p>

<p>Any ideas?
Much obliged</p>
",2518783,,,,,2016-12-08 14:51:51,JSON with Android Universal Media Player Application (MediaPlayer Error 1),<android><json>,2,0,1,
Android,50747713,1,,,2018,,1,231,"<p>So, I was looking into the new <a href=""https://developer.android.com/topic/libraries/architecture/paging"" rel=""nofollow noreferrer"">paging library</a> by android. It has different components that you need to implement to have it work. Let's say I want to hit an API with retrofit and endlessly scroll with pagination updates. What is the best way to pass by the Header or Field maps to Retrofit considering all the stuff that you need to implement( ViewModel, repository, data source etc)? 
<a href=""https://github.com/googlesamples/android-architecture-components/tree/master/PagingWithNetworkSample"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-architecture-components/tree/master/PagingWithNetworkSample</a></p>
",1778343,,,,,2018-08-09 5:50:28,How to pass by Retrofit Header and Field Maps with Paging Library,<android><paging><android-architecture-components><androidx>,2,0,1,
Android,39454127,1,42908291,,2016,,1,1502,"<p>Our app contains a <code>MediaBrowserService</code> and uses a whitelist to restrict who can can query the service. It is typically used to permit Android Auto and Android Wear to query our app for audio content.  As far as I know, this is still a recommended approach.  For example, as shown in this Google sample app: <a href=""https://github.com/googlesamples/android-MediaBrowserService/blob/master/Application/src/main/res/xml/allowed_media_browser_callers.xml"" rel=""nofollow"">MediaBrowserService sample app</a></p>

<p>Our app reports the package names that try to query our <code>MediaBrowserService</code> but are NOT on the whitelist.   We fairly regularly receive reports that ""com.android.bluetooth"" tried to call our service and was denied.</p>

<p>I'm perplexed by these reports. We've never seen such calls from this package on our own test devices. My previous attempts to ask the user if they have a Bluetooth device that might be displaying audio information has been met with confusion...so it seems perhaps Android itself is making these calls?  </p>

<p>Has anyone else encountered this? This whitelist approach requires validating specific signing certificates.  Does com.android.bluetooth have a consistent signing certificate that can be used to add this package to the whitelist?</p>

<p><strong>UPDATE 1:</strong></p>

<p>Looking at the reports we have received from users, this appears to be exclusively a Samsung Android 6.0.1 phenomenon. The first report of it showed up on 3/13/2016 and there has been a steady trickle all summer. </p>

<p>Here's a partial list of the models that have reported this issue. All of them have had Android 6.0.1.  Could this be related to their Tizen-based Galaxy Gear watches?</p>

<ul>
<li>Galaxy Note 4 (SM-N910R4)  </li>
<li>Galaxy Note 4 (SAMSUNG-SM-N910A)  </li>
<li>Galaxy Note 5 (SM-N920V)</li>
<li>Galaxy S5 (SM-G900V)  </li>
<li>Galaxy S5 Active (SAMSUNG-SM-G870A)  </li>
<li>Galaxy S6 (SM-G920R7)  </li>
<li>Galaxy S6 (SAMSUNG-SM-G890A)</li>
<li>Galaxy S7 Edge (SM-G935V)</li>
<li>Galaxy S7 Edge (SAMSUNG-SM-G935A)</li>
<li>Galaxy J7    (SM-J700T1)</li>
</ul>

<p><strong>UPDATE 2:</strong></p>

<p>I have finally reproduced the situation on a Galaxy S6 Edge with 6.0.1.  Bluetooth on the device simply has to be turned on.  If turned on, with nothing even paired or connected, when I start playing audio in our app ""com.android.bluetooth"" (UID 1002) calls <code>onGetRoot</code> and <code>onLoadChildren</code> on our <code>MediaBrowserService</code>.  WHY!?  If I allow it, nothing visible changes on the device.  I thought I might see some Samsung widget presenting the media info from our app...but I don't.</p>
",262119,,262119,,2016-09-13 19:51:01,2017-03-20 16:03:34,"Why is package ""com.android.bluetooth"" querying our MediaBrowserService on Samsung devices?",<android><wear-os><samsung-mobile><android-auto>,2,3,1,
Android,42623014,1,,,2017,,1,737,"<p>I upgraded Android Studio 2.2 -> 2.3 today and now have a compiler error when building my app in Android Studio that I didn't have before.</p>

<pre><code>Error:No resource found that matches the given name (at 'versionName' with value '@string/BRAND_VERSION').
</code></pre>

<p>This is the string resource.</p>

<pre><code>&lt;string name=""BRAND_VERSION""&gt;2.0&lt;/string&gt;
</code></pre>

<p>This is the relevant section from the manifest.</p>

<pre><code>&lt;manifest package=""com.metaswitch.cp.unbrandedpackage""
      xmlns:android=""http://schemas.android.com/apk/res/android""
      xmlns:tools=""http://schemas.android.com/tools""
      android:versionCode=""5""
      android:versionName=""@string/BRAND_VERSION""&gt;
</code></pre>

<p>According to <a href=""https://developer.android.com/studio/publish/versioning.html"" rel=""nofollow noreferrer"">Android documentation</a>, string resources are allowed in the versionName in the manifest or in build.gradle.</p>

<p>This is not specific to my app.  I can repro with this <a href=""https://github.com/googlesamples/android-architecture/tree/todo-mvp-loaders/"" rel=""nofollow noreferrer"">Android sample</a></p>

<p>It builds and installs fine for me.  When I make this single line change to the versionName in build.gradle (picking a random string resource from strings.xml) it fails with the same error.</p>

<pre><code>// versionName ""1.0""
versionName ""@string/add_task""
</code></pre>

<p>This is the build.gradle from the Android sample (note my edit to versionName).</p>

<pre><code>apply plugin: 'com.android.application'

android {
    compileSdkVersion rootProject.ext.compileSdkVersion
    buildToolsVersion rootProject.ext.buildToolsVersion

    defaultConfig {
        applicationId ""com.example.android.architecture.blueprints.todomvploaders""
    minSdkVersion rootProject.ext.minSdkVersion
    targetSdkVersion rootProject.ext.targetSdkVersion
    versionCode 1
    // I really want to use a string resource here!
    // versionName ""1.0""
    versionName ""@string/add_task""

    testInstrumentationRunner 'android.support.test.runner.AndroidJUnitRunner'
}

buildTypes {
    debug {
        minifyEnabled true
        // Uses new built-in shrinker http://tools.android.com/tech-docs/new-build-system/built-in-shrinker
        useProguard false
        proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        testProguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguardTest-rules.pro'
    }

    release {
        minifyEnabled true
        useProguard true
        proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        testProguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguardTest-rules.pro'
    }
}

// If you need to add more flavors, consider using flavor dimensions.
productFlavors {
    mock {
        applicationIdSuffix = "".mock""
    }
    prod {

    }
}

// Remove mockRelease as it's not needed.
android.variantFilter { variant -&gt;
    if(variant.buildType.name.equals('release')
            &amp;&amp; variant.getFlavors().get(0).name.equals('mock')) {
        variant.setIgnore(true);
    }
}

// Always show the result of every unit test, even if it passes.
testOptions.unitTests.all {
    testLogging {
        events 'passed', 'skipped', 'failed', 'standardOut', 'standardError'
    }
}
buildToolsVersion '25.0.0'
</code></pre>

<p>}</p>

<pre><code>/*
 Dependency versions are defined in the top level build.gradle file. This helps keeping track of
 all versions in a single place. This improves readability and helps managing project complexity.
 */
dependencies {
    // App's dependencies, including test
    compile ""com.android.support:appcompat-v7:$rootProject.supportLibraryVersion""
    compile ""com.android.support:cardview-v7:$rootProject.supportLibraryVersion""
    compile ""com.android.support:design:$rootProject.supportLibraryVersion""
    compile ""com.android.support:recyclerview-v7:$rootProject.supportLibraryVersion""
    compile ""com.android.support:support-v4:$rootProject.supportLibraryVersion""
    compile ""com.android.support.test.espresso:espresso-idling-resource:$rootProject.espressoVersion""
    compile ""com.google.guava:guava:$rootProject.guavaVersion""
// Dependencies for local unit tests
testCompile ""junit:junit:$rootProject.ext.junitVersion""
testCompile ""org.mockito:mockito-all:$rootProject.ext.mockitoVersion""
testCompile ""org.hamcrest:hamcrest-all:$rootProject.ext.hamcrestVersion""

// Android Testing Support Library's runner and rules
androidTestCompile ""com.android.support.test:runner:$rootProject.ext.runnerVersion""
androidTestCompile ""com.android.support.test:rules:$rootProject.ext.runnerVersion""

// Dependencies for Android unit tests
androidTestCompile ""junit:junit:$rootProject.ext.junitVersion""
androidTestCompile ""org.mockito:mockito-core:$rootProject.ext.mockitoVersion""
androidTestCompile 'com.google.dexmaker:dexmaker:1.2'
androidTestCompile 'com.google.dexmaker:dexmaker-mockito:1.2'

// Espresso UI Testing
androidTestCompile ""com.android.support.test.espresso:espresso-core:$rootProject.espressoVersion""
androidTestCompile ""com.android.support.test.espresso:espresso-contrib:$rootProject.espressoVersion""
androidTestCompile ""com.android.support.test.espresso:espresso-intents:$rootProject.espressoVersion""

// Resolve conflicts between main and test APK:
androidTestCompile ""com.android.support:support-annotations:$rootProject.supportLibraryVersion""
androidTestCompile ""com.android.support:support-v4:$rootProject.supportLibraryVersion""
androidTestCompile ""com.android.support:recyclerview-v7:$rootProject.supportLibraryVersion""
androidTestCompile ""com.android.support:appcompat-v7:$rootProject.supportLibraryVersion""
androidTestCompile ""com.android.support:design:$rootProject.supportLibraryVersion""
</code></pre>

<p>}</p>
",98618,,98618,,2017-03-06 10:37:21,2017-12-16 4:09:16,Android Studio 2.3: can't use string resource in android:versionName,<android>,2,8,1,
Android,44753069,1,44753178,,2017,,1,1518,"<p>I have read <a href=""https://developer.android.com/topic/libraries/architecture/room.html#db-migration"" rel=""nofollow noreferrer"">Room Persistence Library</a>. I also clone <a href=""https://github.com/googlesamples/android-architecture-components/tree/master/GithubBrowserSample"" rel=""nofollow noreferrer"">android-architecture-components</a> then I try to add Mirgration test. However, I cannot import </p>

<pre><code>import android.arch.persistence.room.testing.MigrationTestHelper;
</code></pre>

<p>I also use latest lib version which is.</p>

<pre><code>android.arch.core:core-testing:1.0.0-alpha3
</code></pre>

<p>Here is the code for MigrationTest</p>

<pre><code>import android.arch.persistence.db.SupportSQLiteDatabase;
import android.arch.persistence.db.framework.FrameworkSQLiteOpenHelperFactory;
import android.support.test.InstrumentationRegistry;
import android.support.test.runner.AndroidJUnit4;

import org.junit.Rule;
import org.junit.Test;
import org.junit.runner.RunWith;

import java.io.IOException;
import android.arch.persistence.room.testing.MigrationTestHelper;

@RunWith(AndroidJUnit4.class)
public class MigrationTest {
    private static final String TEST_DB = ""migration-test"";

    @Rule
    public MigrationTestHelper helper;

    public MigrationTest() {
        helper = new MigrationTestHelper(InstrumentationRegistry.getInstrumentation(),
                MigrationDb.class.getCanonicalName(),
                new FrameworkSQLiteOpenHelperFactory());
    }

    @Test
    public void migrate1To2() throws IOException {
        SupportSQLiteDatabase db = helper.createDatabase(TEST_DB, 1);

        // db has schema version 1. insert some data using SQL queries.
        // You cannot use DAO classes because they expect the latest schema.
        //db.execSQL(...);

        // Prepare for the next version.
        db.close();

        // Re-open the database with version 2 and provide
        // MIGRATION_1_2 as the migration process.
        db = helper.runMigrationsAndValidate(TEST_DB, 2, true, MIGRATION_1_2);

        // MigrationTestHelper automatically verifies the schema changes,
        // but you need to validate that the data was migrated properly.
    }
}
</code></pre>
",1025935,,,,,2017-06-28 10:51:12,Cannot import android.arch.persistence.room.testing.MigrationTestHelper,<android><database-migration><android-room><android-architecture-components>,2,0,1,
Android,34387574,1,34859599,,2015,,1,2116,"<p>I am trying to get Instant Run to work in Android Studio.  I have A.S. 2.0 Preview 4 installed, and my Instant Run is enabled like this:
<a href=""https://i.stack.imgur.com/rXg32.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/rXg32.png"" alt=""enter image description here""></a></p>

<p>Now, I am experimenting with this in the Topeka sample app from Google (<a href=""https://github.com/googlesamples/android-topeka"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-topeka</a>).  So, I am placing a bunch of Toasts in CategorySelectionActivity and CategorySelectionFragment, hoping that they can be instantaneously changed with Instant Run.  But every time I hit the Instant Run button in A.S., it completely shuts down the app and re-installs it.  It does not resume from the same activity I was on previously (as expected), NOR is it displaying the toast message like </p>

<blockquote>
  <p>Applied code changes without Activity restart</p>
</blockquote>

<p>Does anyone know how to get Instant Run to work properly?</p>

<p>Thanks,
Igor</p>
",6998684,,,,,2016-01-29 17:44:54,Android Studio Instant Run not working,<android-studio><instant-run>,2,0,1,
Android,31120662,1,31120777,,2015,,1,4428,"<p>Is it possible to run <a href=""https://github.com/googlesamples/android-RuntimePermissionsBasic"" rel=""nofollow"">Google Sample - RuntimePermissionsBasic</a> </p>

<p>On devices with OS less than MNC (Android M)?</p>

<p>This project comes with:</p>

<pre><code>compileSdkVersion ""android-MNC""
targetSdkVersion ""MNC""
</code></pre>

<p>So far so good, running it on less than M OS will get:</p>

<p><code>INSTALL_FAILED_OLDER_SDK</code></p>

<p>But when I changed it to:</p>

<pre><code>compileSdkVersion 22
targetSdkVersion ""MNC""
</code></pre>

<p>The Android Studio isn't recognizing the <code>checkSelfPermission (...)</code> method </p>
",1038702,,,,,2015-10-23 11:06:26,Android Studio isn't recognizing the checkSelfPermission,<android><permissions><android-6.0-marshmallow>,2,0,1,
Android,54728368,1,54967397,,2019,,1,110,"<p><strong>Context:</strong></p>

<p>I have been using Google's <a href=""https://github.com/googlesamples/android-play-location/tree/master/LocationUpdatesForegroundService"" rel=""nofollow noreferrer"">LocationUpdatesForegroundService</a> example project to learn a bit more about services.</p>

<p>I have downloaded the project via Github desktop and ran it on my phone, everything is great and the project does what it's intended to do.</p>

<p><em>My phone is Android 8.0.0, API 26</em></p>

<p><strong>Problem:</strong></p>

<p>The foreground service notification shows up on the status bar once the app is terminated, as soon as that happens I hear a notification sound(default sound).
However, I would like the notification to be silent, like in some location-based apps(eg: <a href=""https://play.google.com/store/apps/details?id=com.life360.android.safetymapd&amp;hl"" rel=""nofollow noreferrer"">Life360</a>)</p>

<p><strong>What I've tried so far:</strong></p>

<ul>
<li>in <a href=""https://github.com/googlesamples/android-play-location/blob/master/LocationUpdatesForegroundService/app/src/main/java/com/google/android/gms/location/sample/locationupdatesforegroundservice/LocationUpdatesService.java"" rel=""nofollow noreferrer"">LocationUpdatesService.java</a> at added<code>159</code> tried <code>mChannel.setSound(null,null);</code></li>
<li>in <a href=""https://github.com/googlesamples/android-play-location/blob/master/LocationUpdatesForegroundService/app/src/main/java/com/google/android/gms/location/sample/locationupdatesforegroundservice/LocationUpdatesService.java"" rel=""nofollow noreferrer"">LocationUpdatesService.java</a> at line <code>296</code> changed <code>.setPriority(Notification.PRIORITY_HIGH)</code> to 
<code>.setPriority(Notification.PRIORITY_LOW)</code></li>
<li>in <a href=""https://github.com/googlesamples/android-play-location/blob/master/LocationUpdatesForegroundService/app/src/main/java/com/google/android/gms/location/sample/locationupdatesforegroundservice/LocationUpdatesService.java"" rel=""nofollow noreferrer"">LocationUpdatesService.java</a> at line <code>158</code>changed <code>NotificationManager.IMPORTANCE_DEFAULT</code> to <code>NotificationManager.IMPORTANCE_LOW)</code></li>
<li>in <a href=""https://github.com/googlesamples/android-play-location/blob/master/LocationUpdatesForegroundService/app/src/main/java/com/google/android/gms/location/sample/locationupdatesforegroundservice/LocationUpdatesService.java"" rel=""nofollow noreferrer"">LocationUpdatesService.java</a> at  line <code>300</code> added <code>setSound(null)</code></li>
</ul>

<p>None of the above have worked for me, I would really appreciate if someone could shed some light on this situation.</p>
",4194655,,6296561,,2019-02-25 7:14:21,2019-03-03 9:29:22,Foreground Service with a Silent Notification,<java><android><notifications><foreground-service>,2,13,1,
Android,51309576,1,52085011,,2018,,1,234,"<p><strong>EDIT:</strong> I've tested the below on two devices on Android API 22 and one on API 19, the one on API 19 does not have the issue. Any ideas what the difference could be between versions?</p>

<p>I am setting up espresso tests for my Android with an IdlingResource identical to the example <a href=""https://github.com/googlesamples/android-testing/tree/master/ui/espresso/IdlingResourceSample/app/src/main/java/com/example/android/testing/espresso/IdlingResourceSample"" rel=""nofollow noreferrer"">here</a>. </p>

<p>My Test setup:</p>

<pre><code>@Rule
public ActivityTestRule&lt;MainActivity&gt; mMainActivity =
        new ActivityTestRule(MainActivity.class);

private IdlingResource mIdlingResource;

@Before
public void registerIdlingResource() {
    mIdlingResource = mMainActivity.getActivity().getIdlingResource();
    IdlingRegistry.getInstance().register(mIdlingResource);
}
</code></pre>

<p>In my Activity each time I change the Idle state I call:</p>

<pre><code>if (mIdlingResource != null) {
    mIdlingResource.setIdleState(false);
} else {
    Log.d(""error "", ""idle resource is null"");
}
</code></pre>

<p>My issue comes when trying to change the idle state in my activity -- there seems to be a lag between when the activity is created and the IdlingResource is available.</p>

<p><strong>In the first test of the sequence, the IdlingResource is never available</strong> -- as such I cannot set the initialValue of the IdlingResource to false and then later switch back to true. That seems to be caused by the annotation lifecycle as described in <a href=""https://medium.com/mindorks/android-testing-part-1-espresso-basics-7219b86c862b"" rel=""nofollow noreferrer"">this article</a>:</p>

<p><a href=""https://i.stack.imgur.com/sF5x4.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/sF5x4.jpg"" alt=""enter image description here""></a></p>

<p>From what I can tell the Activity is created by the @Rule and then the IdlingResource is instantiated in the @Before. Since the Activity is already running the idle resource is null at each of the points where I attempt to change the state.</p>

<p>In subsequent tests only the first instance of setIdleState (which occurs in the onCreate) is skipped -- perhaps something to do with the Activity lifecycle with the @Rule? -- but the others operate as expected.</p>

<p>Is there a best practice to getting the @Rule and @Before to work in order before the first test?</p>
",3130972,,3130972,,2018-07-18 14:50:30,2018-08-29 19:42:14,Why is IdlingResource null in Espresso tests on Android API 22?,<java><android><junit><android-espresso>,2,0,1,
Android,47868684,1,47873189,,2017,,2,903,"<p>I've seen good examples of MVP architecture (<a href=""https://github.com/android10/Android-CleanArchitecture"" rel=""nofollow noreferrer"">here</a> and <a href=""https://github.com/googlesamples/android-architecture/tree/todo-mvp-clean/todoapp"" rel=""nofollow noreferrer"">here</a>). Both present only simple interactors, but I wonder how to deal with more complex use case, consisting of steps, which are repeated in other use cases.</p>

<p>For example, my API requires token to authenticate any call. I've created an interactor to get that token (<code>GetToken</code>). I want to get user's last login date (<code>GetLastLoginDate</code>) and then fetch a list of changes that occured between that date and now (<code>GetVersionChanges</code>).</p>

<p>Where those interactor should be chained? I want to keep them separate, because some of them are reused in other parts of the code. I've came up with two solutions.</p>

<ol>
<li><p>Presenter should chain all interactors. This solution works as long the use case is not complex and doesn't have many preconditions. It seems to me it's not the right place, because it burdens presenter with another responsibility.</p></li>
<li><p>Interactor can use many repositories (no clean architecture rules are broken then). Why not use <code>TokenRepository</code> in other interactors? Because getting token is much more complex than just reaching to repository. Repeating the steps in other interactor does not reuse already existing code.</p></li>
</ol>

<p>Both solutions have their flaws and are against basic principles (DRY, single responsibility principle).</p>
",7123686,,7123686,,2017-12-18 14:05:19,2019-04-12 16:21:44,"In clean MVP, who should handle combining interactors?",<android><mvp><use-case><clean-architecture>,2,0,1,
Android,42366276,1,42366771,,2017,,2,2979,"<p>I want to make video recording using <code>android.hardware.camera2</code>. I have googled but not get any proper tutorial regarding this. There are some tutorial available for <code>camera preview</code> base on <a href=""https://developer.android.com/reference/android/hardware/Camera.html"" rel=""nofollow noreferrer"">Camera</a> which is now deprecated. Can anyone help me with latest sample code just for <code>recording video</code> with its <code>preview</code> which can be saved into <code>sd card</code>. I have just check <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""nofollow noreferrer"">GitHub</a> and <a href=""https://developer.android.com/samples/Camera2Video/index.html"" rel=""nofollow noreferrer""> Google camera2Video example</a> also but I need any simple solution which I can integrated into my project.</p>
",5302251,,1033581,,2019-01-15 17:54:01,2019-01-15 17:54:01,Android: How to record video using android.hardware.camera2 and MediaRecorder,<android><camera><android-camera><android-camera2>,2,0,1,
Android,41790052,1,41790239,,2017,,2,780,"<p>I am using the Camera2Basic example from Google Samples (<a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-Camera2Basic</a>) to display a camera preview inside a fragment.
This fragment contains a RelativeLayout and a custom AutoFitTextureView. The latter can be found on the link above. I have adjusted the layout to center the preview and remove control buttons:</p>

<pre><code>&lt;RelativeLayout xmlns:android=""http://schemas.android.com/apk/res/android""
    android:layout_width=""match_parent""
    android:layout_height=""match_parent""
    android:id=""@+id/camera_rel""&gt;

    &lt;uk.co.deluxe_digital.messngr.AutoFitTextureView
    android:id=""@+id/texture""
    android:layout_width=""wrap_content""
    android:layout_height=""wrap_content""
    android:layout_centerInParent=""true""
    android:layout_centerHorizontal=""true""
    android:layout_centerVertical=""true"" /&gt;

&lt;/RelativeLayout&gt;
</code></pre>

<p>I have three total fragments that are displayed within a ViewPager. I did make some small changes to the Camera2BasicFragment to make it an android.support.v4.app.Fragment to work with my ViewPager and remove the buttons.</p>

<p>What I would like is to make the camera preview fill the entire screen. This is possible by stretching the preview image. That is not what I want. Does anyone know a way of scaling up the preview or TextureView so that the height of the preview matches the container even if the sides are cropped off. I would like it to fill the view and maintain aspect ratio. This would mean that some of the preview at either side is lost, but that is okay.</p>

<p>This is what I currently have:
<a href=""https://i.stack.imgur.com/lPZXH.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/lPZXH.jpg"" alt=""current incorrect display of camera preview""></a></p>

<p>The FloatingActionButton takes care of capturing the image. That is on the main parent activity.</p>

<p>Even if you can point me in the right direction to working this out, that would be a huge help!</p>
",2216919,,2216919,,2017-01-22 11:38:02,2018-01-23 1:59:34,Camera2 API Make Preview Fill Entire View,<java><android><android-layout><android-fragments><android-camera2>,2,0,1,
Android,49520242,1,,,2018,,2,558,"<p>I was working with Android MVP architecture and I am following <a href=""https://github.com/googlesamples/android-architecture"" rel=""nofollow noreferrer"">Google MVP Architecture</a>.</p>

<p>I am facing issue when Activity have multiple fragment,In my case activity having 2 tab. I am not able to understand, Should i create two Presenter for every Fragment OR should i create one Presenter for this? now same thing with View.</p>

<p>Even i did'nt found any solution on <a href=""https://github.com/googlesamples/android-architecture"" rel=""nofollow noreferrer"">google-sample github repository</a>.</p>

<p>Can anyone please suggest me or show me live code which accomplish my above requirement.</p>
",5867850,,,,,2018-04-03 4:06:01,Multiple fragment in one Activity in Android MVP,<android><mvp><android-mvp><android-architecture>,2,3,1,
Android,33654287,1,33702425,,2015,,2,1241,"<p>Was looking through the camera2 video <a href=""https://github.com/googlesamples/android-Camera2Video"" rel=""nofollow"">sample app</a> published by Google and one of the methods goes as following:</p>

<pre><code>/**
 * In this sample, we choose a video size with 3x4 aspect ratio. Also, we don't use sizes
 * larger than 1080p, since MediaRecorder cannot handle such a high-resolution video.
 *
 * @param choices The list of available sizes
 * @return The video size
 */
private static Size chooseVideoSize(Size[] choices) {
    for (Size size : choices) {
        if (size.getWidth() == size.getHeight() * 4 / 3 &amp;&amp; size.getWidth() &lt;= 1080) {
            return size;
        }
    }
    Log.e(TAG, ""Couldn't find any suitable video size"");
    return choices[choices.length - 1];
}
</code></pre>

<p>I've fiddled with my own implementation of camera2 and attempted to record a 4K video with media recorder which worked fine - the recorded file reported dimensions of 3840 × 2160. </p>

<p>So, is the comment in the sample incorrect or MediaRecorder was not capable of handling larger resolutions on Lollipop but is capable on Marshmallow or something else?</p>
",3361863,,294248,,2015-11-11 16:51:57,2017-10-24 7:36:44,Recording 4K with MediaRecorder,<android><android-camera><android-mediarecorder>,2,3,1,
Android,39327480,1,39333694,,2016,,2,3873,"<p>I want to fetch user's current lat long on click of a button. I know that you can get the last known location using FusedLocationApi. But what I am not able to understand is, gps or location services needs to be turned on for this? If yes, how to check that the user has turned on location and get the current location. Also, how to include marshmallow permission checks in getting the location. </p>

<p>I have already referred:
1) <a href=""https://github.com/googlesamples/android-play-location/blob/master/LocationSettings/app/src/main/java/com/google/android/gms/location/sample/locationsettings/MainActivity.java"" rel=""nofollow"">googlesamples/android-play-location</a>
2) <a href=""https://github.com/googlesamples/android-XYZTouristAttractions/blob/master/Application/src/main/java/com/example/android/xyztouristattractions/service/UtilityService.java"" rel=""nofollow"">googlesamples/android-XYZTouristAttractions</a> 
and many other links but unable to make a complete flow.</p>

<p>Code</p>

<pre><code>public class AccessLocationFragment extends BaseFragment implements View.OnClickListener, LocationListener,
    GoogleApiClient.ConnectionCallbacks, GoogleApiClient.OnConnectionFailedListener, GeneralDialogFragment.GeneralDialogClickListener {

private static final int MY_PERMISSIONS_REQUEST_LOCATION = 101;
private static final String TAG = AccessLocationFragment.class.getSimpleName();
private static final int REQUEST_CHECK_SETTINGS = 102;
private Button mAccessLocation;
private EditText mZipCode;
private Dialog progressDialog;
private GoogleApiClient mGoogleApiClient;
private Location mLastLocation;

public static AccessLocationFragment newInstance() {
    return new AccessLocationFragment();
}

@Nullable
@Override
public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
    return inflater.inflate(R.layout.fragment_access_location, container, false);
}

@Override
public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
    super.onViewCreated(view, savedInstanceState);
    RecycleApplication.getEventBus().register(this);
    mAccessLocation = (Button) view.findViewById(R.id.access_location);
    mZipCode = (EditText) view.findViewById(R.id.zip_code);
    mAccessLocation.setOnClickListener(this);

    mZipCode.setOnEditorActionListener(new TextView.OnEditorActionListener() {
        @Override
        public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
            if (actionId == EditorInfo.IME_ACTION_DONE) {
                String zipCode = mZipCode.getText().toString().trim();
                if (TextUtils.isEmpty(zipCode)) {
                    Toast.makeText(mActivity, ""Please enter zip code"", Toast.LENGTH_SHORT).show();
                } else {
                    Call&lt;Address&gt; response = mRecycleService.getAddress(zipCode);
                    response.enqueue(new GetLocationCallback(AccessLocationFragment.this));
                }
            }
            return false;
        }
    });
    // Create an instance of GoogleAPIClient.
    if (mGoogleApiClient == null) {
        mGoogleApiClient = new GoogleApiClient.Builder(mActivity)
                .addConnectionCallbacks(this)
                .addOnConnectionFailedListener(this)
                .addApi(LocationServices.API)
                .build();
    }
    if (!LocationUtils.checkFineLocationPermission(mActivity)) {
        // See if user has denied permission in the past
        if (shouldShowRequestPermissionRationale(android.Manifest.permission.ACCESS_FINE_LOCATION)) {
            // Show a simple snackbar explaining the request instead
            showPermissionSnackbar();
        } else {
            requestFineLocationPermission();
        }
    } else {
        displayLocationSettingsRequest();
    }
}

private void startHomeActivity(Address address) {
    RecyclePreferences.getInstance().setCity(address.getCity());
    RecyclePreferences.getInstance().setState(address.getState());
    RecyclePreferences.getInstance().setLatitude(address.getLatitude());
    RecyclePreferences.getInstance().setLongitude(address.getLongitude());
    RecyclePreferences.getInstance().setZipCode(address.getZipCode());
    startActivity(new Intent(mActivity, HomeActivity.class));
    mActivity.finish();
}

@Override
public void onSuccess(Call&lt;Address&gt; call, Response&lt;Address&gt; response) {
    mActivity.hideProgressDialog(progressDialog);
    if (response.isSuccessful()) {
        Address address = response.body();
        startHomeActivity(address);
    }
}

@Override
public void onFailure(Call&lt;Address&gt; call, Throwable t) {
    mActivity.hideProgressDialog(progressDialog);
}

@Override
public void onClick(View view) {
    if (view.getId() == R.id.access_location) {
        fetchAddress(mLastLocation);
    }
}

@Override
public void onRequestPermissionsResult(int requestCode, String permissions[], int[] grantResults) {
    switch (requestCode) {
        case MY_PERMISSIONS_REQUEST_LOCATION: {
            if (grantResults[0] == PackageManager.PERMISSION_GRANTED) {
               displayLocationSettingsRequest();
            }
        }
    }
}

private void fetchAddress(Location location) {
    mRecycleService = new RecycleRetrofitBuilder(mActivity).getService();
    Call&lt;Address&gt; response = mRecycleService.getAddress(String.valueOf(location.getLatitude()), String.valueOf(location.getLongitude()));
    progressDialog = mActivity.showProgressDialog(mActivity);
    response.enqueue(new GetLocationCallback(AccessLocationFragment.this));
}

private void requestFineLocationPermission() {
    requestPermissions(new String[]{Manifest.permission.ACCESS_FINE_LOCATION}, MY_PERMISSIONS_REQUEST_LOCATION);
}

private void showPermissionSnackbar() {
    GeneralDialogFragment generalDialogFragment = GeneralDialogFragment.
            newInstance(""Permissions"", ""Allow Recycle the World to use your location."", ""Allow"", ""Go Back"", this);
    mActivity.showDialogFragment(generalDialogFragment);
    displayLocationSettingsRequest();
}

private void displayLocationSettingsRequest() {
    LocationRequest locationRequest = LocationRequest.create();
    locationRequest.setPriority(LocationRequest.PRIORITY_HIGH_ACCURACY);
    locationRequest.setInterval(10000);
    locationRequest.setFastestInterval(10000 / 2);

    LocationSettingsRequest.Builder builder = new LocationSettingsRequest.Builder().addLocationRequest(locationRequest);
    builder.setAlwaysShow(true);

    PendingResult&lt;LocationSettingsResult&gt; result = LocationServices.SettingsApi.checkLocationSettings(mGoogleApiClient, builder.build());
    result.setResultCallback(new ResultCallback&lt;LocationSettingsResult&gt;() {
        @Override
        public void onResult(LocationSettingsResult result) {
            final Status status = result.getStatus();
            switch (status.getStatusCode()) {
                case LocationSettingsStatusCodes.SUCCESS:
                    getLocation();
                    break;
                case LocationSettingsStatusCodes.RESOLUTION_REQUIRED:
                    Log.i(TAG, ""Location settings are not satisfied. Show the user a dialog to upgrade location settings "");
                    try {
                        status.startResolutionForResult(mActivity, REQUEST_CHECK_SETTINGS);
                    } catch (IntentSender.SendIntentException e) {
                        Log.i(TAG, ""PendingIntent unable to execute request."");
                    }
                    break;
                case LocationSettingsStatusCodes.SETTINGS_CHANGE_UNAVAILABLE:
                    Log.i(TAG, ""Location settings are inadequate, and cannot be fixed here. Dialog not created."");
                    break;
            }
        }
    });
}

private void getLocation() {
    if (ActivityCompat.checkSelfPermission(mActivity, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED
            &amp;&amp; ActivityCompat.checkSelfPermission(mActivity, Manifest.permission.ACCESS_COARSE_LOCATION) != PackageManager.PERMISSION_GRANTED) {
        return;
    }
    mLastLocation = LocationServices.FusedLocationApi.getLastLocation(mGoogleApiClient);
}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (requestCode == REQUEST_CHECK_SETTINGS) {
        getLocation();
    }
}

@Override
public void onStart() {
    mGoogleApiClient.connect();
    super.onStart();
}

@Override
public void onStop() {
    mGoogleApiClient.disconnect();
    super.onStop();
}

@Override
public void onConnected(@Nullable Bundle bundle) {
    getLocation();
}

@Override
public void onDestroy() {
    super.onDestroy();
    RecycleApplication.getEventBus().unregister(this);
}


@Override
public void onConnectionSuspended(int i) {

}

@Override
public void onConnectionFailed(@NonNull ConnectionResult connectionResult) {

}

@Override
public void onOk(DialogFragment dialogFragment) {
    dialogFragment.dismiss();
    requestFineLocationPermission();
}

@Override
public void onCancel(DialogFragment dialogFragment) {
    dialogFragment.dismiss();

}
</code></pre>

<p>}</p>
",1081355,,1081355,,2016-09-05 11:14:02,2017-04-03 12:16:25,How to get user's current location in Android,<android><location><google-play-services>,2,2,1,
Android,42581120,1,,,2017,,2,2482,"<p>I want to play around with mobile Vulkan without having to buy a device.</p>

<p>If it is not supported, please provide evidence (e.g. source code, official Google statements). Are there any plans to support it?</p>

<p>If supported, please give detailed and tested instructions of how to get a minimal hello world triangle app running, including the app you have tested with.</p>

<p>I have tried <a href=""https://github.com/googlesamples/android-vulkan-tutorials/tree/7ba478ac2e0d9006c9e2e261446003a4449b8aa3/tutorial05_triangle"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-vulkan-tutorials/tree/7ba478ac2e0d9006c9e2e261446003a4449b8aa3/tutorial05_triangle</a> with a Pixel API 25 image (API 25 is supposed to support Vulkan), but keep getting build or runtime errors.</p>

<p>I have opened an issue at: <a href=""https://github.com/googlesamples/android-vulkan-tutorials/issues/13"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-vulkan-tutorials/issues/13</a> but it was closed without solution.</p>

<p>Related:</p>

<ul>
<li>OpenGL ES 2: <a href=""https://stackoverflow.com/questions/4455783/does-the-android-emulator-support-opengl-es-2-0"">Does the Android Emulator support OpenGL ES 2.0?</a></li>
<li>OpenGL ES 3:
<a href=""https://stackoverflow.com/questions/24874066/does-the-android-emulator-support-opengl-es-3-0"">Does the Android emulator support OpenGL ES 3.0?</a></li>
</ul>
",895245,,-1,,2017-05-23 12:09:27,2017-03-04 16:10:41,How to create and run an example Vulkan app on the Android emulator?,<android><android-emulator><vulkan>,2,0,1,
Android,44863661,1,44863853,,2017,,2,979,"<p>I have made an app which takes pictures (portrait, landscape or selfie) using the <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""nofollow noreferrer"">Google Camera2 sample</a>. Everything works, I can take the pictures, they are saved, etc. </p>

<p>But when I open my phone's (Samsung S7) gallery then all the selfies and portrait pictures are rotated 90 degrees. The landscape pictures are fine though. I have seen a lot of post about how to <strong>read</strong> images in the correct orientation, but what about saving them properly? </p>

<p>I have my own gallery in my app and there the pictures are loaded correctly (using Glide) without any special rotation fixing, so I am not sure what I did wrong and most importantly, how do I fix this?</p>
",8021836,,3908170,,2018-09-17 23:45:55,2018-09-17 23:45:55,Android Camera2 pictures appear rotated in gallery,<android><android-camera2>,2,4,1,
Android,36964572,1,,,2016,,2,616,"<p>I am working on a modification of Google's Camera2 API example for Android, found here: <a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""nofollow"">https://github.com/googlesamples/android-Camera2Basic</a></p>

<p>I am uploading captured images to Cloudinary, and obviously need to do so in a background thread so the UI isn't blocked.</p>

<p>The problem I'm running into, however, is that the UI actually is blocked when the image is uploaded even though from what I understand, it shouldn't be, because the Handler is created with the Looper from a background thread like so: </p>

<pre><code>private void startBackgroundThread() {
    mBackgroundThread = new HandlerThread(""CameraBackground"");
    mBackgroundThread.start();
    mBackgroundHandler = new Handler(mBackgroundThread.getLooper());
}
</code></pre>

<p>The ImageSaver class, which is responsible for writing the captured image to disk, is as follows:</p>

<pre><code>private static class ImageSaver implements Runnable {
    /**
     * The JPEG image
     */
    private final Image mImage;
    /**
     * The file we save the image into.
     */
    private final File mFile;

    public ImageSaver(Image image, File file ) {
        mImage = image;
        mFile = file;
    }

    @Override
    public void run() {
        ByteBuffer buffer = mImage.getPlanes()[0].getBuffer();
        byte[] bytes = new byte[buffer.remaining()];
        buffer.get(bytes);
        FileOutputStream output = null;
        try {
            output = new FileOutputStream(mFile);
            output.write(bytes);
            InputStream is = new ByteArrayInputStream(bytes);
            Map uploadResult = CloudinaryManager.getInstance().uploader().upload(is, ObjectUtils.asMap(
                    ""api_key"", CloudinaryManager.CLOUDINARY_API_KEY,
                    ""api_secret"", CloudinaryManager.CLOUDINARY_SECRET_KEY
            ));
            System.out.println(""result"");
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            mImage.close();
            if (null != output) {
                try {
                    output.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
    }
</code></pre>

<p>The ImageSaver is added to the Handler here:</p>

<pre><code> private final ImageReader.OnImageAvailableListener mOnImageAvailableListener
        = new ImageReader.OnImageAvailableListener() {

    @Override
    public void onImageAvailable(ImageReader reader) {
        mBackgroundHandler.post(new ImageSaver(reader.acquireNextImage(), mFile));
    }
};
</code></pre>

<p>I would appreciate any help or advice to point me in the right direction.</p>
",4812993,,4812993,,2016-05-01 19:08:24,2017-03-13 20:21:52,HandlerThread blocks UI android,<android><multithreading><android-camera2><android-looper><android-handlerthread>,2,2,1,
Android,48172364,1,48174338,,2018,,3,3458,"<p>I have several entities that you can see below, the problem is how to select nested lists properly when you have more than one level of nesting. If you take a look at Google repository on <a href=""https://github.com/googlesamples/android-architecture-components/tree/master/BasicRxJavaSample"" rel=""nofollow noreferrer"">github</a>, you can find very simple example, but not something complex. As documentation says <a href=""https://developer.android.com/training/data-storage/room/referencing-data.html#understand-no-object-references"" rel=""nofollow noreferrer"">here</a>, Room doesn't allow object references. How to get <code>ResultObject</code> (and how it should look) including all nested lists?</p>

<p>ResultObject should have this info:</p>

<ol>
<li><code>List&lt;Dialog&gt;</code></li>
<li><code>Dialog</code> entity has <code>List&lt;Message&gt;</code>.  </li>
<li><code>Message</code> has <code>List&lt;ImageContent&gt;</code>.</li>
<li><code>ImageContent</code> has <code>List&lt;ImageContentItem&gt;</code></li>
</ol>

<p>Dialog</p>

<pre><code>@Entity(tableName = ""dialog"")
data class Dialog(@PrimaryKey val id String, val title: String)
</code></pre>

<p>Message</p>

<pre><code>@Entity(tableName = ""message"",
        foreignKeys = [(ForeignKey(entity = Dialog::class, parentColumns [""id""], childColumns = [""dialogId""]))])
data class Message(@PrimaryKey val id: String, val dialogId: String)
</code></pre>

<p>ImageContent</p>

<pre><code>@Entity(tableName = ""image_content"",
        foreignKeys = [(ForeignKey(entity = Message::class, parentColumns = [""id""], childColumns = [""messageId""]))])
data class ImageContent(@PrimaryKey val id: String, val messageId: String)
</code></pre>

<p>ImageContentItem</p>

<pre><code>@Entity(tableName = ""image_content_item"",
        foreignKeys = [(ForeignKey(entity = ImageContent::class, parentColumns = [""id""], childColumns = [""imageContentId""]))])
data class ImageContentItem(val imageContentId: String,
                        @PrimaryKey(autoGenerate = true) val id: Long = 1)
</code></pre>

<p>DAO:</p>

<pre><code>@Dao
interface DialogDao {
    @Query(""SELECT * FROM dialog "" +
            ""INNER JOIN message ON message.dialogId = dialog.id "" +
            ""INNER JOIN image_content ON image_content.messageId = message.id "" +
            ""INNER JOIN image_content_item ON image_content_item.imageContentId = image_content.id"")
    fun getDialogAllInformation(): Flowable&lt;List&lt;**ResultObject**&gt;&gt;
}
</code></pre>
",8052090,,2649012,,2018-01-09 16:32:36,2018-02-07 23:23:55,How to query a complex nested objects in Room?,<android><android-room>,2,0,1,
Android,29253846,1,,,2015,,3,1001,"<p>I have fragment A which includes a SwipeRefresh and a RecycleView.
When user click on an Item in RecycleView, I replace a new Fragment which is B:</p>

<pre><code>mAdapter.setOnItemClickListener(new MyAdapter.OnItemClickListener() {
            @Override
            public void onItemClick(View view, int position) {

                Item tem = mItems.get(position);
                // selected item
                Log.i(TAG, item.getTitle() + "" clicked. Replacing fragment."");

                // We start the fragment transaction here. It is just an ordinary fragment transaction.
                getActivity().getSupportFragmentManager()
                        .beginTransaction()
                        .replace(R.id.content_fragment,
                                FragmentB.newInstance(item,
                                        (int) view.getX(), (int) view.getY(),
                                        view.getWidth(), view.getHeight())
                        )
                                // We push the fragment transaction to back stack. User can go back to the
                                // previous fragment by pressing back button.
                        .addToBackStack(""detail"")
                        .commit();
            }
        });
</code></pre>

<p>There is a problem :</p>

<p>When I start to refresh using SwipeRefresh, and it is still running, I click on an item (as you can see the code above), Fragment B will be replaced <code>under</code> Fragment A in the screen.
I can see Fragment B under my RecycleView in Fragment A! 
I am no longer able to scroll in recycleView since <code>onStop()</code> is called in Fragment A and <code>onCreateView</code> is called in Fragment B.</p>

<p>What could be the reason? do you have any workaround?</p>

<p>Addenda : Crash can be reproduce in google sample as well:</p>

<p><a href=""https://github.com/googlesamples/android-FragmentTransition/"" rel=""nofollow"">https://github.com/googlesamples/android-FragmentTransition/</a></p>
",1315447,,1315447,,2015-03-25 20:42:14,2016-12-21 13:47:01,Replacing Fragment does not work properly while swipeRefresh is running,<android><android-recyclerview><swiperefreshlayout>,2,5,1,
Android,44560981,1,44646030,,2017,,3,320,"<p>Looking at the following method in Google <a href=""https://github.com/googlesamples/android-testing/blob/master/ui/espresso/IntentsBasicSample/app/src/androidTest/java/com/example/android/testing/espresso/BasicSample/DialerActivityTest.java"" rel=""nofollow noreferrer"">sample for intents</a>:</p>

<pre><code>@Before
public void stubAllExternalIntents() {
    // By default Espresso Intents does not stub any Intents. Stubbing needs to be setup before
    // every test run. In this case all external Intents will be blocked.
    intending(not(isInternal())).respondWith(new ActivityResult(Activity.RESULT_OK, null));
}
</code></pre>

<p>I see that all external intents will be blocked but I was wondering what purpose does this method serve?</p>
",5907514,,1083957,,2017-06-20 7:03:59,2017-06-20 7:03:59,Purpose of stubAllExternalIntents() in Espresso intents testing,<android><testing><android-intent><android-espresso><android-testing>,2,0,1,
Android,26241916,1,,,2014,,3,484,"<p>I started by looking into a couple of Gists I found on Github: <a href=""https://gist.github.com/lpetre/87a5196d14cf4484f1f2"" rel=""nofollow"">https://gist.github.com/lpetre/87a5196d14cf4484f1f2</a></p>

<p>And this works great on my laptop, however I'm trying to set up Travis-CI to automatically build the release APK and submit it to the Play Store.  The issue that I'm encountering now is on the Travis side, in that I cannot use pip to install the google_api_python_client.</p>

<p>upon that call, I get the following:</p>

<pre><code> Installing collected packages: google-api-python-client, httplib2
  Running setup.py install for google-api-python-client
    error: could not create '/usr/local/lib/python2.7/dist-packages/apiclient': Permission denied
    Complete output from command /usr/bin/python -c ""import setuptools, tokenize;__file__='/tmp/pip_build_travis/google-api-python-client/setup.py';exec(compile(getattr(tokenize, 'open', open)(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))"" install --record /tmp/pip-ctZKCR-record/install-record.txt --single-version-externally-managed --compile:
</code></pre>

<p>So I strayed away from using pip, downloaded the python client libraries on their own, and am now including them in my git repo (under /google_api_upload).</p>

<p>A part of Google's API Upload client library instructions (<a href=""https://github.com/googlesamples/android-play-publisher-api/blob/master/v2/python/README.md"" rel=""nofollow"">https://github.com/googlesamples/android-play-publisher-api/blob/master/v2/python/README.md</a>) say to run ""import apiclient"" in a python console (again, works fine on my laptop, but not travis because I can't start a python session and enter in ""import apiclient"" so far as I've found; it just hangs on the python session).</p>

<p>So then I figured it'd be awesome to just have a Gradle function in my gradle files which calls the API functions, and is called from the travis.yml file; but I don't even know if that's possible.</p>

<p>So any input would help, notably:</p>

<ul>
<li>Did I mess up in my attempt at running pip on travis? Can I sudo to elevate permissions for this (I imagine I can't)</li>
<li>Is there a way to call ""import apiclient"" for python within a single line in the travis.yml file?</li>
<li>Is it possible to have travis call a gradle function which refers to client libraries included in my build?</li>
<li>I've tried to find examples of this end-to-end process, but haven't found any that fit this exact case, do you know of any?</li>
</ul>

<p>Thanks!</p>
",231768,,,,,2014-11-23 12:39:45,Error in Travis trying to submit app to Google's Play Store,<google-api><android-gradle><google-api-java-client><travis-ci><google-play>,2,2,1,
Android,35629725,1,,,2016,,3,299,"<p>I take example from <a href=""https://github.com/googlesamples/android-play-publisher-api/blob/master/v2/java/src/com/google/play/developerapi/samples/BasicUploadApk.java"" rel=""nofollow"">GitHub</a>.
It works fine, but I need to upload obb file with my apk.</p>

<p>Part of my code:</p>

<pre><code>        AndroidPublisher.Edits.Insert editRequest = edits.insert(bundleID, null);
        AppEdit edit = editRequest.execute();
        final String editId = edit.getId();
        final AbstractInputStreamContent apkFile = new FileContent(""application/vnd.android.package-archive"", new File(apkPath));

        AndroidPublisher.Edits.Apks.Upload uploadRequest = edits.apks().upload(bundleID, editId, apkFile);

        Apk apk = uploadRequest.execute();

        List&lt;Integer&gt; apkVersionCodes = new ArrayList&lt;&gt;();
        apkVersionCodes.add(apk.getVersionCode());
        AndroidPublisher.Edits.Tracks.Update updateTrackRequest = edits.tracks().update(bundleID, editId, TRACK_ALPHA, new Track().setVersionCodes(apkVersionCodes));
        updateTrackRequest.execute();
        // Commit changes for edit.
        AndroidPublisher.Edits.Commit commitRequest = edits.commit(bundleID, editId);
        commitRequest.execute();
</code></pre>

<p>How can I do it?</p>
",3882388,,,,,2017-05-20 4:49:38,How to upload obb file to Google Play via Android Publisher Java API v2,<java><upload><google-play-developer-api>,2,0,1,
Android,42403890,1,42426052,,2017,,3,1782,"<p>Google just launch <a href=""https://developers.google.com/android-publisher/voided-purchases"" rel=""nofollow noreferrer"">Voided Purchases API</a> </p>

<blockquote>
  <p>The Google Play Voided Purchases API allows you to revoke access to in-app products that are associated with purchases that a user has voided. The user can void a purchase in the following ways:</p>
  
  <ul>
  <li>The user requests a refund for their order.</li>
  <li>The user cancels their order.</li>
  <li>An order is charged back.</li>
  </ul>
</blockquote>

<p>But, I am confused with the use case.</p>

<p>Currently, I have an app with non consumable in-app purchase item (One-time purchase).</p>

<p>Whenever my app starts, I will check whether user has purchased the item, by using the following code.</p>

<p><a href=""https://github.com/googlesamples/android-play-billing/blob/master/TrivialDrive/app/src/main/java/com/example/android/trivialdrivesample/MainActivity.java#L243"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-play-billing/blob/master/TrivialDrive/app/src/main/java/com/example/android/trivialdrivesample/MainActivity.java#L243</a></p>

<p>I expect <code>inventory.getPurchase</code> will return null during next app startup, if user has decided to cancel their purchase order.</p>

<p>So, how does <code>Voided Purchases API</code> fit in ""user has decided to cancel their purchase order"" case? </p>

<p>I thought by using <code>onQueryInventoryFinished</code>, we can determine what item is currently owned by user?</p>
",72437,,62576,,2017-02-22 23:01:13,2017-02-23 20:58:32,What is the use case of new Voided Purchases API,<android>,2,0,1,
Android,45630903,1,,,2017,,3,545,"<p>I have been trying to elevate an internal Demo App to Device Owner on my <strong>rooted</strong> S8 and keep having problems.</p>

<p>Ways I have tried:</p>

<p>1) <strong>NFC provisioning</strong> (as explained <a href=""https://github.com/googlesamples/android-NfcProvisioning"" rel=""nofollow noreferrer"">here</a> )</p>

<p>When using NFC with Android Bean to set the Device Owner the S8 shows a ""Cannot create working profile due to the security guidelines of your device""-error</p>

<p>2) <strong>Adb provisioning</strong> (from console):</p>

<p>When using </p>

<pre><code>dpm set-device-owner my/app/namespace/.DeviceAdmin
</code></pre>

<p>in a windows console I get the following error</p>

<pre><code>java.lang.SecurityException: Neither user 2000 nor current process has com.samsung.android.knox.permission.KNOX_PROXY_ADMIN_INTERNAL.,com.sec.enterprise.permission.MDM_PROXY_ADMIN_INTERNAL
        at android.os.Parcel.readException(Parcel.java:1693)
        at android.os.Parcel.readException(Parcel.java:1646)
        at android.app.admin.IDevicePolicyManager$Stub$Proxy.setActiveAdmin(IDevicePolicyManager.java:5825)
        at com.android.commands.dpm.Dpm.runSetDeviceOwner(Dpm.java:145)
        at com.android.commands.dpm.Dpm.onRun(Dpm.java:96)
        at com.android.internal.os.BaseCommand.run(BaseCommand.java:51)
        at com.android.commands.dpm.Dpm.main(Dpm.java:41)
        at com.android.internal.os.RuntimeInit.nativeFinishInit(Native Method)
        at com.android.internal.os.RuntimeInit.main(RuntimeInit.java:307)
</code></pre>

<p>Adding the missing permissions to my manifest did not change anything.</p>

<p>3) <strong>Create xml-file manually</strong> (as explained <a href=""https://stackoverflow.com/questions/21183328/how-to-make-my-app-a-device-owner/27909315#answer-26839548"">here</a> )</p>

<p>In this case I can create the xml in the right folder, but when I restart the phone the file gets deleted and my app is not registered as Device Owner</p>

<p>Are there any more ways I could try or does anyone know where the problem is? </p>
",3840288,,3840288,,2017-08-11 11:11:35,2017-10-12 11:10:20,Device Owner on rooted Galaxy S8,<android><device-admin><samsung-knox>,2,0,1,
Android,37764937,1,,,2016,,4,2792,"<p>I am using my Samsung S5 G900F(API 23, ANDROID 6.0.1) to test the latest Android Fingerprint API. </p>

<p>I tried to build Google Sample project
<a href=""https://github.com/googlesamples/android-FingerprintDialog"" rel=""nofollow"">https://github.com/googlesamples/android-FingerprintDialog</a></p>

<p>But I am facing some problems </p>

<p><code>mFingerprintManager.hasEnrolledFingerprints()</code> </p>

<p>This always returns false. I have double checked on Settings that I have enrolled my fingerprint and I am using Fingerprint to unlock my device.</p>

<p>I had also tried this function </p>

<pre><code>mFingerprintManager.isHardwareDetected() 
</code></pre>

<p>which also returns false.</p>

<p>Does this mean my Samsung S5 (which got its offical 6.0.1 update) is not supported or I am missing something?</p>
",1162842,,,,,2017-02-11 23:02:00,FingerPrint API isHardwareDetected always returns false,<android-studio><android-6.0-marshmallow><android-fingerprint-api>,2,3,1,
Android,49232559,1,49280941,,2018,,4,1722,"<p>Looks like <code>ConstraintSet</code> is finding hard to cope up with <code>Start/End</code> constrains.<br/></p>

<p>This example is taken from <em>Google samples</em>.
Github: <a href=""https://github.com/googlesamples/android-ConstraintLayoutExamples"" rel=""nofollow noreferrer"">android-ConstraintLayoutExamples</a></p>

<p><br/></p>

<p>When you replace Left &amp; Right constrains with <code>Start</code> &amp; <code>End</code>, ConstraintSet - not working properly, It's working with <code>Left/Right</code> constrains only.
<br/>
For example replace 
layout_constraintStart_toStartOf with layout_constraintLeft_toLeftOf  &amp; replace
layout_constraintEnd_toEndOf with layout_constraintRight_toRightOf </p>

<p>in following files:<br/>
<a href=""https://github.com/googlesamples/android-ConstraintLayoutExamples/blob/master/app/src/main/res/layout/constraintset_example_main.xml"" rel=""nofollow noreferrer"">constraintset_example_main.xml</a><br/>
<a href=""https://github.com/googlesamples/android-ConstraintLayoutExamples/blob/master/app/src/main/res/layout/constraintset_example_big.xml"" rel=""nofollow noreferrer"">constraintset_example_big.xml</a>
<br/></p>

<p>Behaviour:
<a href=""https://i.stack.imgur.com/9MF2j.gif"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/9MF2j.gif"" alt=""""></a></p>

<p><strong>onClick of image:</strong></p>

<pre><code>private ConstraintSet mConstraintSetNormal = new ConstraintSet();

    private ConstraintSet mConstraintSetBig = new ConstraintSet();

 public void toggleMode(View v) {
        TransitionManager.beginDelayedTransition(mRootLayout);
        mShowBigImage = !mShowBigImage;
        applyConfig();
    }

    private void applyConfig() {
        if (mShowBigImage) {
            mConstraintSetBig.applyTo(mRootLayout);
        } else {
            mConstraintSetNormal.applyTo(mRootLayout);
        }
    }
</code></pre>

<p>By default Android studio uses <code>start</code>/ <code>end</code> constrains hence it's I want to know root cause and possible fix. <br/>
Or Is this a bug with <code>ConstrainSet</code> itself?</p>
",4903889,,4903889,,2018-03-15 4:51:30,2018-03-16 5:49:48,ConstrainLayout ConstraintSet - not working properly with Start/End constrains,<android><android-constraintlayout>,2,2,1,
Android,52441736,1,52446017,,2018,,4,469,"<p>I want to pre-populate my Room database from the json file in the assets folder. I follow the <a href=""https://github.com/googlesamples/android-sunflower/tree/master/app/src/main/java/com/google/samples/apps/sunflower"" rel=""nofollow noreferrer"">Google Sunflower sample</a>. I copied the SeedDatabaseWorker class:</p>

<pre><code>import android.content.Context
import android.util.Log
import androidx.work.Worker
import androidx.work.WorkerParameters
import com.dmitrysimakov.gymlab.data.GymLabDb
import com.dmitrysimakov.gymlab.data.entity.Training
import com.google.gson.Gson
import com.google.gson.reflect.TypeToken
import com.google.gson.stream.JsonReader
import javax.inject.Inject

class SeedDatabaseWorker(val context: Context, workerParams: WorkerParameters) : Worker(context, workerParams) {
    private val TAG = SeedDatabaseWorker::class.java.simpleName

    @Inject lateinit var database: GymLabDb

    override fun doWork(): Worker.Result {
        val plantType = object : TypeToken&lt;List&lt;Training&gt;&gt;() {}.type
        var jsonReader: JsonReader? = null

        return try {
            val inputStream = context.assets.open(""training.json"")
            jsonReader = JsonReader(inputStream.reader())
            val plantList: List&lt;Training&gt; = Gson().fromJson(jsonReader, plantType)
            database.trainingDao().insert(plantList)
            Worker.Result.SUCCESS
        } catch (ex: Exception) {
            Log.e(TAG, ""Error seeding database"", ex)
            Worker.Result.FAILURE
        } finally {
            jsonReader?.close()
        }
    }
}
</code></pre>

<p>I'm using Dagger 2, so instead of doing this: <a href=""https://github.com/googlesamples/android-sunflower/blob/master/app/src/main/java/com/google/samples/apps/sunflower/data/AppDatabase.kt"" rel=""nofollow noreferrer"">Sunflower AppDatabase</a>, I do this:</p>

<pre><code>import android.arch.persistence.db.SupportSQLiteDatabase
import android.arch.persistence.room.Room
import android.arch.persistence.room.RoomDatabase
import androidx.work.OneTimeWorkRequestBuilder
import androidx.work.WorkManager
import com.dmitrysimakov.gymlab.GymLabApp
import com.dmitrysimakov.gymlab.data.GymLabDb
import com.dmitrysimakov.gymlab.workers.SeedDatabaseWorker
import dagger.Module
import dagger.Provides
import javax.inject.Singleton

@Module(includes = [ViewModelModule::class])
class AppModule {

    @Singleton
    @Provides
    fun provideDb(app: GymLabApp): GymLabDb {
        return Room
                .databaseBuilder(app, GymLabDb::class.java, ""gymlab.db"")
                .addCallback(object : RoomDatabase.Callback() {
                    override fun onCreate(db: SupportSQLiteDatabase) {
                        super.onCreate(db)
                        val request = OneTimeWorkRequestBuilder&lt;SeedDatabaseWorker&gt;().build()
                        WorkManager.getInstance().enqueue(request)
                    }
                })
                .fallbackToDestructiveMigration()
                .build()
    }

    @Singleton
    @Provides
    fun provideTrainingDao(db: GymLabDb) = db.trainingDao()
}
</code></pre>

<p>But I can't inject the database that has not yet been created. So, how can I access the dao?</p>
",7775572,,7775572,,2018-09-21 11:44:02,2018-10-02 5:52:52,Android. Could not instantiate Worker,<android><dagger-2><android-room><android-architecture-components><android-workmanager>,2,0,1,
Android,53372539,1,53390772,,2018,,5,1017,"<p>I am implementing an android app (in Kotlin, but that is not relevant to the Problem) in my free time and I try to use android jetpack and new libraries. I have a single Activity with a navigation drawer. I try to follow the <a href=""https://github.com/googlesamples/android-sunflower"" rel=""nofollow noreferrer"">sample sunflower app</a>. It uses the following combination in the main activity to enable the logic behind the navigation drawer:</p>

<pre><code>appBarConfiguration = AppBarConfiguration(navController.graph, drawerLayout)
setSupportActionBar(findViewById(R.id.toolbar))
setupActionBarWithNavController(navController, appBarConfiguration)
</code></pre>

<p><strong>Note on this code</strong>: This automatically will navigate to the correct fragments when clicked in the navigation drawer and close the drawer and keep them selected etc. All that boilerplate code. That is pretty neat and also works. As far as I understand this, the IDs of the navigation drawer menu items have to match the ids of the fragments in the navigation graph and this way they are connected.</p>

<p><strong>The problem I have</strong>: When I use the navigation drawer to go to any fragment other than the starting fragment of the navigation graph, it will display a back button instead of the hamburger item. That is not what I expect, I would expect it still to be the hamburger item since the navigation drawer is for navigating between views on an equal level and not nested in each other, right? I expect a back button if I navigate to a subfragment of any fragment by clicking on elements in that fragment (for example list -> detail) but not if I navigate using the navigation drawer.</p>

<p>Now I traced that problem back to the <code>AppBarConfiguration</code> builder which reads on the constructor taking a navgraph <code>The NavGraph whose start destination should be considered the only top level destination.</code> I can fairly easily fix that by overriding <code>AppBarConfiguration</code> to return different top level destinations than just the starting destination of the navigation graph. </p>

<p>However my question is, why is there this behaviour default? Is it a bug? If I override this will I violate some design guidelines by Google? Should not every element in the navigation drawer be on the same level how I expect it? Is there a different solution inteded for I want to do?</p>
",3795043,,3795043,,2018-11-27 16:33:54,2018-12-09 18:57:32,Navigation graph with multiple top level destinations,<android><android-navigation-drawer><android-navigation><android-jetpack>,2,0,1,
Android,43632752,1,43661005,,2017,,5,1548,"<p>I am implementing the example given in <a href=""https://github.com/googlesamples/android-vision/tree/master/visionSamples/FaceTracker"" rel=""noreferrer"">google-vision face tracker</a>.
<code>MyFaceDetector</code> class:</p>

<pre><code>public class MyFaceDetector extends Detector&lt;Face&gt; {
    private Detector&lt;Face&gt; mDelegate;

    MyFaceDetector(Detector&lt;Face&gt; delegate) {
        mDelegate = delegate;
    }

    public SparseArray&lt;Face&gt; detect(Frame frame) {
        return mDelegate.detect(frame);
    }

    public boolean isOperational() {
        return mDelegate.isOperational();
    }

    public boolean setFocus(int id) {
        return mDelegate.setFocus(id);
    }

}
</code></pre>

<p><code>FaceTrackerActivity</code> class:</p>

<pre><code>private void createCameraSource() {

    imageView = (ImageView) findViewById(R.id.face);

    FaceDetector faceDetector = new FaceDetector.Builder(this).build();
    myFaceDetector = new MyFaceDetector(faceDetector);
    myFaceDetector.setProcessor(new MultiProcessor.Builder&lt;&gt;(new GraphicFaceTrackerFactory())
            .build());
    mCameraSource = new CameraSource.Builder(this, myFaceDetector)
            .setRequestedPreviewSize(640, 480)
            .setFacing(CameraSource.CAMERA_FACING_FRONT)
            .setRequestedFps(60.0f)
            .build();

    if (!myFaceDetector.isOperational()) {
        Log.w(TAG, ""Face detector dependencies are not yet available."");
    }
}
</code></pre>

<p>I need to crop the face and set it on <code>ImageView</code>. I am not able to implement my custom <code>Frame</code> here. <code>frame.getBitmap()</code> always returns <code>null</code> in <code>detect(Frame frame)</code>. How do I achieve this?</p>
",1785200,,,,,2017-12-15 21:57:53,Crop face from the CameraSource,<android><android-camera><android-vision>,2,1,1,
Android,34298780,1,35621793,,2015,,5,2062,"<p>I'm trying to implement <a href=""https://github.com/googlesamples/android-ndk/tree/master/hello-jni"" rel=""nofollow noreferrer""><code>hello-jni</code> sample</a>
into my project. I have <code>Gradle</code> 2.8 and <code>'com.android.tools.build:gradle-experimental:0.4.0'</code> and using <code>Android Studio 2.0 Preview 3b</code>.</p>

<p>This is my <code>build.gradle</code>:</p>

<pre><code>apply plugin: 'com.android.model.application'
model {
    android {
        compileSdkVersion = 23
        buildToolsVersion = ""23.0.2""
        defaultConfig.with {
            applicationId = ""lala.lala""
            minSdkVersion.apiLevel = 16
            targetSdkVersion.apiLevel = 23
            versionCode = 1
            versionName = ""1.0""
        }
    }
    /*
    * native build settings
    */
    android.ndk {
        moduleName = ""hello-jni""


        //  cppFlags.add(""-fno-rtti"")
     //    cppFlags.add(""-fno-exceptions"")
     //   ldLibs.addAll([""android"", ""log""])
      //  stl       = ""system""

    }

    android.productFlavors {
        // for detailed abiFilter descriptions, refer to ""Supported ABIs"" @
        // https://developer.android.com/ndk/guides/abis.html#sa
        create(""arm"") {
            ndk.abiFilters.add(""armeabi"")
        }
        create(""arm7"") {
            ndk.abiFilters.add(""armeabi-v7a"")
        }
        create(""arm8"") {
            ndk.abiFilters.add(""arm64-v8a"")
        }
        create(""x86"") {
            ndk.abiFilters.add(""x86"")
        }
        create(""x86-64"") {
            ndk.abiFilters.add(""x86_64"")
        }
        create(""mips"") {
            ndk.abiFilters.add(""mips"")
        }
        create(""mips-64"") {
            ndk.abiFilters.add(""mips64"")
        }
        // To include all cpu architectures, leaves abiFilters empty
        create(""all"")
    }
    android.buildTypes {
        release {
            minifyEnabled = false
            //proguardFiles.add(file('proguard-rules.txt'))
        }
    }

}

dependencies {
    compile fileTree(dir: 'libs', include: ['*.jar'])
    testCompile 'junit:junit:4.12'
    compile 'com.android.support:appcompat-v7:23.1.1'
    compile 'com.android.support:design:23.1.1'
    compile 'com.android.support:cardview-v7:23.1.1'
    compile 'com.android.support:recyclerview-v7:23.1.1'
    compile 'com.google.android.gms:play-services-ads:8.3.0'
    compile 'com.google.android.gms:play-services-analytics:8.3.0'
    compile 'com.google.android.gms:play-services-appindexing:8.3.0'
}
</code></pre>

<p>I have created in <code>JNI</code> folder <code>hello-jni.h</code>:</p>

<p><a href=""https://i.stack.imgur.com/iYBwU.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/iYBwU.png"" alt=""enter image description here""></a></p>

<p>In some part of my code I import this:</p>

<pre><code>static {
    System.loadLibrary(""hello-jni"");
}
public static native int testMethod();
</code></pre>

<p>And by auto completion created <code>hello-jni.c</code>:</p>

<pre><code>#include ""hello-jni.h""

JNIEXPORT jintJNICALL
Java_lala_lala_HomeScreen_testMethod(JNIEnv
*env,
jclass type
)
{
// TODO
}
</code></pre>

<p>Header file <code>hello-jni.h</code>:</p>

<pre><code>//
// Created by Filip on 15.12.2015..
//

#ifndef PHOTO_HELLO_JNI_H
#define PHOTO_HELLO_JNI_H

#endif //PHOTO_HELLO_JNI_H
</code></pre>

<p>But it doesn't work. It is full red:</p>

<p><a href=""https://i.stack.imgur.com/dtACE.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/dtACE.png"" alt=""enter image description here""></a></p>

<p>What is problem? How to solve it?</p>
",5665386,,3290339,,2015-12-17 21:08:08,2016-03-03 18:47:21,Hello-jni sample doesn't work in Android Studio 2.0 Preview,<android><android-studio><android-ndk><java-native-interface>,2,0,1,
Android,45208116,1,45325913,,2017,,7,1088,"<p>Geocoder was working fine until today. It started to return String with 0 length.
Note: This is not a duplicate of Geocoder threads, i used intent service and AsyncTask to get it before starting the thread(and AsyncTask approach was working fine over 8 months), checked <a href=""http://www.androidauthority.com/get-location-address-android-app-628764/"" rel=""nofollow noreferrer"">this code</a> and new <a href=""https://github.com/googlesamples/android-play-location/tree/master/LocationAddress"" rel=""nofollow noreferrer"">code</a> from Google with FusedLocationProviderClient(this is offical code) it also returns string with zero length.<a href=""https://developer.android.com/training/location/display-address.html"" rel=""nofollow noreferrer"">This link</a> from official Android page shows how to get it with intent service.</p>

<p>I get full address on Android 5.1 but on Android 7.1 it returns an address with length zero.</p>

<p>Code i used to use and worked fine until today.</p>

<pre><code>private void getAddressFromCoordinates() {

    new AsyncTask&lt;Void, String, Void&gt;() {

        @Override
        protected Void doInBackground(Void... params) {

            try {
                addresses.clear();
                addresses.addAll(geocoder.getFromLocation(mCurrentLocation.getLatitude(),
                        mCurrentLocation.getLongitude(), 1));


            } catch (IOException e) {
                e.printStackTrace();
                showToastAsync(getString(R.string.activity_loc_no_location_info));
            } catch (IllegalArgumentException illegalArgumentException) {
                // Catch invalid latitude or longitude values.
                showToastAsync(""Invalid latitude or longitude values"");
            }

            // Handle case where no address was found.
            if (addresses == null || addresses.size() == 0) {
                showToastAsync(getString(R.string.activity_loc_no_address_is_found));
            } else {
                Address address = addresses.get(0);
                ArrayList&lt;String&gt; addressFragments = new ArrayList&lt;String&gt;();
                for (int i = 0; i &lt; address.getMaxAddressLineIndex(); i++) {
                    addressFragments.add(address.getAddressLine(i));
                }

                addressInfo = TextUtils.join(System.getProperty(""line.separator""), addressFragments);
                addressSingleLine = LocationActivity.addressInfo.replaceAll(""[\r\n]+"", "" "");
            }
            return null;
        }

    }.execute();
}
</code></pre>

<p><strong>Answer</strong> is to add <code>=</code> to for loop to not retreive an address with zero length on Android 7. You don't need to do this on some versions. Also code on Google referenced Github pages is missing <strong>=</strong>. That's why i was not able to find the reason why.</p>
",5457853,,5457853,,2017-07-26 19:48:56,2017-07-26 19:48:56,Geocoder returns an address with zero length,<android><android-location>,2,0,1,
Android,35811411,1,,,2016,,7,4829,"<p>I am playing with the original example of BarCode scanner here:</p>

<p><a href=""https://github.com/googlesamples/android-vision/blob/master/visionSamples/barcode-reader/app/src/main/java/com/google/android/gms/samples/vision/barcodereader/BarcodeCaptureActivity.java"" rel=""noreferrer"">https://github.com/googlesamples/android-vision/blob/master/visionSamples/barcode-reader/app/src/main/java/com/google/android/gms/samples/vision/barcodereader/BarcodeCaptureActivity.java</a></p>

<p>They are able to start the AutoFocus/Flash within the camera factory like this:</p>

<pre><code>    // Creates and starts the camera.  Note that this uses a higher resolution in comparison
    // to other detection examples to enable the barcode detector to detect small barcodes
    // at long distances.
    CameraSource.Builder builder = new CameraSource.Builder(getApplicationContext(), barcodeDetector)
            .setFacing(CameraSource.CAMERA_FACING_BACK)
            .setRequestedPreviewSize(1600, 1024)
            .setRequestedFps(15.0f);

    // make sure that auto focus is an available option
    if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.ICE_CREAM_SANDWICH) {
        builder = builder.setFocusMode(
                autoFocus ? Camera.Parameters.FOCUS_MODE_CONTINUOUS_PICTURE : null);
    }

    mCameraSource = builder
            .setFlashMode(useFlash ? Camera.Parameters.FLASH_MODE_TORCH : null)
            .build();
</code></pre>

<p>However this method on cameraSource builder is gone in current version and so this setting cannot be accessed. Also I need to change the FlashMode during usage, so that is not the way to do it either. I found this ugly solution to accessing the camera:</p>

<pre><code>public static Camera getCamera(@NonNull CameraSource cameraSource) {
    Field[] declaredFields = CameraSource.class.getDeclaredFields();

    for (Field field : declaredFields) {
        if (field.getType() == Camera.class) {
            field.setAccessible(true);
            try {
                Camera camera = (Camera) field.get(cameraSource);
                if (camera != null) {
                    return camera;
                }

                return null;
            } catch (IllegalAccessException e) {
                e.printStackTrace();
            }

            break;
        }
    }

    return null;
}
</code></pre>

<p>Although it works, it does not help: when calling <code>getParameters().setFocusMode()</code> I am getting this exception:</p>

<pre><code>Attempt to invoke virtual method 'android.hardware.Camera$Parameters android.hardware.Camera.getParameters()' on a null object reference
</code></pre>

<p>Obviously what I am doing is not a right way to do it, but there seem to be no documentation about it.</p>

<p>Thanks for hints.</p>
",922584,,2057709,,2016-03-06 4:13:04,2018-04-04 12:28:43,Accessing AutoFocus/Flash with Google Vision BarCode Reader,<android><android-camera><barcode-scanner><camera-flash>,2,1,1,
Android,29822760,1,,,2015,,8,9353,"<p>Final intention here is to have a device in 'kiosk mod'.</p>

<p><a href=""http://sdgsystems.com/blog/implementing-kiosk-mode-android-part-3-android-lollipop/"" rel=""nofollow noreferrer"">They</a> <a href=""http://florent-dupont.blogspot.fr/2015/01/android-shell-command-dpm-device-policy.html"" rel=""nofollow noreferrer"">say</a> you don't need NFC nor rooting to achieve application becoming <a href=""http://developer.android.com/about/versions/android-5.0.html#DeviceOwner"" rel=""nofollow noreferrer"">device owner</a>. I've yet to see a full example of this method but lets try:</p>

<pre><code>adb shell dpm set-device-owner &lt;package&gt;/.&lt;ReceiverImplementation&gt;
</code></pre>

<p>should do... So I do so, and get: </p>

<pre><code>java.lang.SecurityException: 
Neither user 2000 nor current process has android.permission.BIND_DEVICE_ADMIN.
</code></pre>

<p>Following code, therefore, returns false.</p>

<pre><code>((DevicePolicyManager) getSystemService(Context.DEVICE_POLICY_SERVICE))
   .isDeviceOwnerApp(getApplicationContext().getPackageName())
</code></pre>

<p><a href=""https://stackoverflow.com/questions/28112382/device-owner-without-using-nfc-in-android-lollipop"">This STO question</a> poses a similar question but doesn't specify an actual failure..</p>

<p>Manifest file and the rest of the source is mostly inspired from <a href=""https://github.com/googlesamples/android-DeviceOwner"" rel=""nofollow noreferrer"">this google sample</a></p>

<pre><code>&lt;manifest
    package=""com.example.android.deviceowner""
    xmlns:android=""http://schemas.android.com/apk/res/android""
    android:versionCode=""1""
    android:versionName=""1.0""&gt;

    &lt;application
        android:allowBackup=""true""
        android:icon=""@drawable/ic_launcher""
        android:label=""@string/app_name""
        android:theme=""@style/AppTheme""&gt;

        &lt;activity
            android:name="".MainActivity""
            android:label=""@string/app_name""&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=""android.intent.action.MAIN""/&gt;
                &lt;category android:name=""android.intent.category.LAUNCHER""/&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;

        &lt;receiver
            android:name="".DeviceOwnerReceiver""
            android:description=""@string/app_name""
            android:label=""@string/app_name""
            android:permission=""android.permission.BIND_DEVICE_ADMIN""&gt;
            &lt;meta-data
                android:name=""android.app.device_admin""
                android:resource=""@xml/device_owner_receiver""/&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=""android.app.action.ACTION_DEVICE_ADMIN_ENABLED""/&gt;
            &lt;/intent-filter&gt;
        &lt;/receiver&gt;

    &lt;/application&gt;

&lt;/manifest&gt;
</code></pre>

<p>Device I am trying to do this currently is LG G Pad.</p>
",2208247,,-1,,2017-05-23 11:47:28,2016-05-12 13:42:14,"Device owner on a nonrooted device (Android L), without NFC, using adb shell, dpm set-device-owner",<android><android-5.0-lollipop><kiosk-mode>,2,15,1,
Android,32961771,1,,,2015,,9,1918,"<p>I'm trying to create an app that takes some photos from a service using the <strong>camera2 API</strong>.</p>

<p>I can get the app to take pictures fine from a fragment based on the <a href=""https://github.com/googlesamples/android-Camera2Basic/blob/d7a3bfd0f2a2a3a6447a41f7b729fcae571ef020/Application/src/main/java/com/example/android/camera2basic/Camera2BasicFragment.java"">Camera2Basic sample</a>.</p>

<p>But when I try move to a service the image doesn't finish capturing properly. It never progresses past the autoexposure precapture state.</p>

<p>I narrowed it down to being some problem with not having a preview. I've put together a test fragment by taking the <strong>Camera2Basic</strong> code and removing the preview, which results in the same issue.</p>

<p>I put together a test fragment that has the issue, based on the Camera2Basic sample where i've basically just removed code for the preview. Fragment code uploaded here <a href=""http://pastebin.ca/3182401"">http://pastebin.ca/3182401</a>.</p>

<p>I'm getting the <strong>onCaptureCompleted()</strong> callback but when i check the camera autoexposure state here, it's still in the <strong>CONTROL_AE_STATE_PRECAPTURE</strong> state.</p>

<p>It doesn't make sense to me that the capture would be completed if one of the camera states is still in precapture.</p>

<p>Anyone know what might be happening here?</p>
",2128112,,609602,,2015-10-12 7:32:15,2015-11-25 23:44:18,Camera2 API onCaptureComplete() is called but camera state is still CONTROL_AE_STATE_PRECAPTURE,<android><android-camera><camera2>,2,3,1,
Android,40832882,1,40848379,,2016,,10,4121,"<p>Does the Google Mobile Vision (<a href=""https://developers.google.com/vision/"" rel=""noreferrer"">https://developers.google.com/vision/</a>) API work offline? Or does it need Internet connectivity? The <a href=""https://github.com/googlesamples/android-vision/blob/master/visionSamples/ocr-reader/app/src/main/AndroidManifest.xml"" rel=""noreferrer"">sample app</a> does not require any Internet permission. Which means the API works entirely offline. I am looking for a positive confirmation of this.</p>

<p>PS. Also I am looking for more information on this API. For example, does it use neural networks? If so what algorithms were used? I can not find any detail discussion anywhere. </p>
",1036017,,,,,2018-01-31 2:34:31,Does Machine Vision API work offline?,<android-vision>,2,0,1,
Android,36055167,1,41862649,,2016,,1,2741,"<p>I have a camera project and im using <code>camera2 API</code> especially from this link
<a href=""https://github.com/googlesamples/android-Camera2Basic"" rel=""nofollow"">https://github.com/googlesamples/android-Camera2Basic</a></p>

<p>I can save the picture taken to my file manager located at <code>DCIM/camera</code> for example, but when I open my gallery, it wont show my last picture.</p>

<p>Can anyone help me?</p>

<p>One more question, I want to make my camera can be a list:
for example, when I open ""LINE"" and I want take picture with camera, I want my camera appears and can be chosen.</p>

<p>This is the sample code I tried for saving picture to the custom path:</p>

<pre><code>@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    mFile = new File(""/storage/emulated/0/DCIM/Camera"", ""pic.jpg"");
    int counter=1;
    while (mFile.exists()) {
        mFile = new File(""/storage/emulated/0/DCIM/Camera"", ""pic"" + String.format(""%02d"", counter) + "".jpg"");
        counter++;
    }

}
</code></pre>
",5225911,,4370109,,2016-03-19 9:57:51,2017-01-25 22:14:05,Camera2 API picture taken wont show at gallery apps,<android><android-studio><android-camera2>,3,5,1,
Android,35133519,1,36597669,,2016,,4,355,"<p>I'm trying to setup a test project like is described in the <a href=""https://github.com/googlesamples/android-testing-templates/tree/master/AndroidTestingBlueprint"" rel=""nofollow"">Android Testing Blueprint</a> but I receive the following NoClassDefFoundError:</p>

<pre><code>java.lang.NoClassDefFoundError: android.test.mock.MockContentResolver
</code></pre>

<p>Android Studio resolves this correctly but when running I receive this error.</p>

<p>It's worth to note that I do not have an androidTest configuration on the app project, instead I only have a separate <code>tests</code> module with:</p>

<pre><code>apply plugin: 'com.android.test'
</code></pre>

<p>I'm running tests like this:</p>

<pre><code> ./gradlew :tests:connectedAndroidTest
</code></pre>

<p>Test project to reproduce this issue can be found here:
<a href=""https://github.com/vexdev/android-testing-templates/tree/master/AndroidTestingBlueprint"" rel=""nofollow"">https://github.com/vexdev/android-testing-templates/tree/master/AndroidTestingBlueprint</a></p>

<p>EDIT: Also asked on <a href=""https://plus.google.com/106636663923951797914/posts/PTvUTCP39Gm"" rel=""nofollow"">Android Development community</a></p>

<p>EDIT: Also created following android issue:
<a href=""https://code.google.com/p/android/issues/detail?id=200182&amp;thanks=200182&amp;ts=1454489567"" rel=""nofollow"">https://code.google.com/p/android/issues/detail?id=200182&amp;thanks=200182&amp;ts=1454489567</a></p>
",1634147,,1634147,,2016-02-03 8:53:59,2016-04-13 11:58:46,MockContentResolver is not found in an Android Test project with separate module,<android><android-testing>,3,2,1,
Android,29501618,1,,,2015,,6,6075,"<p>Since android 5.0 they are providing mediaprojection library to capture screen content. but sample demo application provided by them is not clear. U can find sample app <a href=""https://github.com/googlesamples/android-ScreenCapture"" rel=""noreferrer"">here</a>. In that application they are projecting captured screen using virtualdisplay method</p>

<pre><code>private void setUpVirtualDisplay() {
    Log.i(TAG, ""Setting up a VirtualDisplay: "" +
            mSurfaceView.getWidth() + ""x"" + mSurfaceView.getHeight() +
            "" ("" + mScreenDensity + "")"");
    mVirtualDisplay = mMediaProjection.createVirtualDisplay(""ScreenCapture"",
            mSurfaceView.getWidth(), mSurfaceView.getHeight(), mScreenDensity,
            DisplayManager.VIRTUAL_DISPLAY_FLAG_AUTO_MIRROR,
            mSurface, null, null);
    mButtonToggle.setText(R.string.stop);
}
</code></pre>

<p>I want to convert captured screen into mp4 file for my screen recording application. Please help me to get through this.</p>
",2251601,,294248,,2015-05-07 17:46:51,2016-07-26 9:25:12,How to use Mediaprojection library in android to capture screen and convert into mp4 file?,<android><android-mediarecorder><android-mediaprojection>,3,0,1,
Android,46294833,1,,,2017,,7,6415,"<p>The notification channels which introduced from Android O (API 26) version.I read about it from the following links:</p>

<ul>
<li><a href=""https://developer.android.com/guide/topics/ui/notifiers/notifications.html#ManageChannels"" rel=""noreferrer"">Managing notification channels</a></li>
<li><a href=""https://github.com/googlesamples/android-NotificationChannels/blob/master/Application/src/main/java/com/example/android/notificationchannels/NotificationHelper.java"" rel=""noreferrer"">Google Sample for Creating Channel</a></li>
</ul>

<p><strong>Questions:</strong> </p>

<ol>
<li><p>If I have multiple numbers of notification then Is it a good idea to create notification channels when the application starts and keep it at <code>ApplicationScope</code>?</p>

<pre><code>public void addNotificationChannels(Context context) {

    List&lt;NotificationChannel&gt; channels = new ArrayList&lt;&gt;();
    channels.add(""channel_1"");
    channels.add(""channel_2"");
    .
    .
    channels.add(""channel_7"");

    NotificationManager notificationManager =
        (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);
    notificationManager.createNotificationChannels(channels);

}
</code></pre></li>
<li><p>What will happen if I try to execute this line <code>new Notification.Builder(getApplicationContext(), PRIMARY_CHANNEL)</code> before adding channels to the notification manager</p></li>
</ol>
",1004437,,4166923,,2017-10-31 19:50:41,2018-06-01 19:05:17,Correct way to create Notification Channels from Android O Api,<android><android-notifications><android-8.0-oreo><notification-channel>,3,0,1,
Android,44910631,1,44911261,,2017,,7,1426,"<p>Why are there two versions of TrivialDrive?</p>

<p><a href=""https://github.com/googlesamples/android-play-billing"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-play-billing</a></p>

<p>Which version should be the main reference project for learning in-app billing? What's the difference between the versions?</p>
",8251758,,1390874,,2017-09-28 22:38:27,2017-09-28 22:44:21,TrivialDrive vs TrivialDrive V2?,<android><github><in-app-purchase><play-billing-library>,3,0,1,
Android,41296030,1,,,2016,,2,2496,"<p><a href=""https://github.com/googlesamples/android-SwipeRefreshLayoutBasic"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-SwipeRefreshLayoutBasic</a></p>

<p>Referring to the sample above. The swipe refresh is calling when user scrolls up reaches top of the list. What i want is to call swipe refresh only when user specially swipes for it. Not calling swipe refresh when user is scrolling up and reached top end.</p>

<p>When i am using the lib below, i get what i want. But i m facing some issues with this lib so i didnt want to use it.
github.com/baoyongzhang/android-PullRefreshLayout</p>

<p>Here is the video clip of what i dont want:
<a href=""https://drive.google.com/file/d/0By2g3SV1qz5TUFdZZ1FUNmxzU1E/view?usp=sharing"" rel=""nofollow noreferrer"">https://drive.google.com/file/d/0By2g3SV1qz5TUFdZZ1FUNmxzU1E/view?usp=sharing</a></p>
",4302472,,4302472,,2016-12-23 6:21:48,2016-12-23 9:08:41,"Swipe refresh to be called only when user swipes for it, not when user reaches top of list",<android><android-support-library><swiperefreshlayout>,4,13,1,
Android,50758822,1,,,2018,,3,3869,"<p>I tried to integrate google smart login and SMS SmsRetrieverClient  in my project. First thing that shocked me is, on the official documentation of these functionalities(<a href=""https://developers.google.com/identity/sms-retriever/request#prerequisites"" rel=""nofollow noreferrer"">https://developers.google.com/identity/sms-retriever/request#prerequisites</a>), the required libraries are missing. Some how i tried to find out the required ones on net that are : </p>

<pre><code>implementation 'com.google.android.gms:play-services-base:11.8.0'
implementation 'com.google.android.gms:play-services-identity:11.8.0'
implementation 'com.google.android.gms:play-services-auth:11.8.0'
implementation 'com.google.android.gms:play-services-auth-api-phone:11.8.0'
</code></pre>

<p>but as i sync the gradle one error is coming. i.e. </p>

<blockquote>
  <p>Failed to resolve: play-services-auth-base-license Open File</p>
</blockquote>

<p>I have made a lot of search on google but do not got any solution. 
The sample of google on git hub is: <a href=""https://github.com/googlesamples/android-credentials/tree/master/sms-verification/android"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-credentials/tree/master/sms-verification/android</a></p>
",2260963,,6176003,,2018-06-08 13:02:35,2018-12-04 13:43:14,Failed to resolve: play-services-auth-base-license version 11.8.0,<android><android-gradle><resolve><play-services-auth-base-license>,4,4,1,
Android,27529852,1,,,2014,,3,5007,"<p>I have a problem with android Camera2 API on a Nexus 7. I have developed an app on android 4.4.4 that uses the camera to take a picture, and I want to update it for the Lollipop update. I've followed code from this link to make new camera api work: <a href=""https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/java/com/example/android/camera2basic/Camera2BasicFragment.java"" rel=""nofollow"">https://github.com/googlesamples/android-Camera2Basic/blob/master/Application/src/main/java/com/example/android/camera2basic/Camera2BasicFragment.java</a></p>

<p>I've tested code on a Nexus 5, and everything works well, but if i try it on a Nexus 7, something goes wrong. This is the error log:</p>

<pre><code>12-17 17:01:15.517: W/LegacyRequestMapper(24382): convertRequestMetadata - control.awbRegions setting is not supported, ignoring value
12-17 17:01:15.517: W/LegacyRequestMapper(24382): Only received metering rectangles with weight 0.
12-17 17:01:15.518: W/LegacyRequestMapper(24382): Only received metering rectangles with weight 0.
12-17 17:01:15.519: W/LegacyRequestMapper(24382): mapAeAndFlashMode - Ignore control.aeMode == ON_AUTO_FLASH;camera does not support it
12-17 17:01:15.519: W/LegacyRequestMapper(24382): convertRequestToMetadata - Ignoring android.lens.focusDistance false, only 0.0f is supported
12-17 17:01:15.955: I/CameraDeviceState(24382): Legacy camera service transitioning to state CAPTURING
12-17 17:01:21.198: I/RequestQueue(24382): Repeating capture request cancelled.
12-17 17:01:21.198: I/RequestQueue(24382): Repeating capture request set.
12-17 17:01:21.215: W/LegacyRequestMapper(24382): convertRequestMetadata - control.awbRegions setting is not supported, ignoring value
12-17 17:01:21.215: W/LegacyRequestMapper(24382): Only received metering rectangles with weight 0.
12-17 17:01:21.215: W/LegacyRequestMapper(24382): Only received metering rectangles with weight 0.
12-17 17:01:21.216: W/LegacyRequestMapper(24382): mapAeAndFlashMode - Ignore control.aeMode == ON_AUTO_FLASH;camera does not support it
12-17 17:01:21.216: W/LegacyRequestMapper(24382): convertRequestToMetadata - Ignoring android.lens.focusDistance false, only 0.0f is supported
12-17 17:01:21.495: E/AndroidRuntime(24382): FATAL EXCEPTION: CameraBackground
12-17 17:01:21.495: E/AndroidRuntime(24382): Process: com.example.newapicamera, PID: 24382
12-17 17:01:21.495: E/AndroidRuntime(24382): java.lang.NullPointerException: Attempt to invoke virtual method 'int java.lang.Integer.intValue()' on a null object reference
12-17 17:01:21.495: E/AndroidRuntime(24382):    at com.example.newapicamera.Camera2BasicFragment$4.process(Camera2BasicFragment.java:285)
12-17 17:01:21.495: E/AndroidRuntime(24382):    at com.example.newapicamera.Camera2BasicFragment$4.onCaptureCompleted(Camera2BasicFragment.java:324)
12-17 17:01:21.495: E/AndroidRuntime(24382):    at java.lang.reflect.Method.invoke(Native Method)
12-17 17:01:21.495: E/AndroidRuntime(24382):    at java.lang.reflect.Method.invoke(Method.java:372)
12-17 17:01:21.495: E/AndroidRuntime(24382):    at android.hardware.camera2.dispatch.InvokeDispatcher.dispatch(InvokeDispatcher.java:39)
12-17 17:01:21.495: E/AndroidRuntime(24382):    at android.hardware.camera2.dispatch.HandlerDispatcher$1.run(HandlerDispatcher.java:65)
12-17 17:01:21.495: E/AndroidRuntime(24382):    at android.os.Handler.handleCallback(Handler.java:739)
12-17 17:01:21.495: E/AndroidRuntime(24382):    at  android.os.Handler.dispatchMessage(Handler.java:95)
12-17 17:01:21.495: E/AndroidRuntime(24382):    at android.os.Looper.loop(Looper.java:135)
12-17 17:01:21.495: E/AndroidRuntime(24382):    at android.os.HandlerThread.run(HandlerThread.java:61)
12-17 17:01:21.542: I/RequestQueue(24382): Repeating capture request cancelled.
12-17 17:01:21.580: E/BufferQueueProducer(24382): [unnamed-24382-2] dequeueBuffer: BufferQueue has been abandoned
12-17 17:01:21.580: E/BufferQueueProducer(24382): [unnamed-24382-2] dequeueBuffer: BufferQueue has been abandoned
12-17 17:01:21.596: E/BufferQueueProducer(24382): [unnamed-24382-2] queueBuffer: BufferQueue has been abandoned
12-17 17:01:21.605: W/Camera-JNI(24382): callback on dead camera object
12-17 17:01:21.620: E/BufferQueueProducer(24382): [unnamed-24382-2] queueBuffer: BufferQueue has been abandoned
12-17 17:01:21.651: E/BufferQueueProducer(24382): [unnamed-24382-2] queueBuffer: BufferQueue has been abandoned
12-17 17:01:21.688: E/BufferQueueProducer(24382): [unnamed-24382-2] queueBuffer: BufferQueue has been abandoned
12-17 17:01:21.721: E/BufferQueueProducer(24382): [unnamed-24382-2] queueBuffer: BufferQueue has been abandoned
</code></pre>

<p>The line that throws the exception is:</p>

<pre><code>int aeState = result.get(CaptureResult.CONTROL_AE_STATE);
</code></pre>

<p>What is going wrong?</p>
",1246746,,822005,,2014-12-17 23:53:09,2016-03-15 1:46:24,new android Camera2 Api on nexus 7,<android><android-camera>,4,0,1,
Android,42107466,1,,,2017,,2,2351,"<p>I am exploring wonderful mobile vision apis, I am working on <a href=""https://github.com/googlesamples/android-vision/tree/master/visionSamples/FaceTracker"" rel=""nofollow noreferrer"">Face Tracker</a> example and looking for a solution where I can find out whether mouth is open or not. e.g. person is yawning. There is not direct way like <code>face.getIsLeftEyeOpenProbability();</code></p>

<p>So I am thinking that I need to find out x,y coordinates of both left and right mouth find out the difference and figure out whether mouse is open or not. I am not sure if this will work or not.</p>

<p>But is there any other way we can find out whether mouth is open or closed ?</p>
",1166926,,1166926,,2017-02-08 9:42:40,2019-04-10 13:48:41,Android Mobile Vision API detect mouth is open,<android><face-recognition><android-vision>,5,0,1,
Android,44497929,1,52966077,,2017,,2,3333,"<p>I have created an instant app. I uploaded it to my Google Console, and I got this error. </p>

<blockquote>
  <p>The www.kochchy.cz website has not been linked to your application
  through the Digital Assets Link protocol. Link the application site
  with Digital Assets Link.</p>
</blockquote>

<pre><code>[{
  ""relation"": [""delegate_permission/common.handle_all_urls""],
  ""target"": {
   ""namespace"": ""android_app"",
    ""package_name"": ""com.kochchy.instantapptest.app"",
    ""sha256_cert_fingerprints"":[""A4:A6:74:15:F1:3E:38:3F:93:0F:EF:E3:A6:86:8E:7C:25:45:E8:80:5B:5E:35:70:49:20:DB:F8:CB:D4:FC:E0""]
  }
}] 
</code></pre>

<p>Both apks, instant and installable use same id: <strong>com.kochchy.instantapptest.app</strong> (each defined in own module manifests) </p>

<p>My <strong>base</strong> module manifest looks like this: </p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;
&lt;manifest xmlns:android=""http://schemas.android.com/apk/res/android""
package=""com.kochchy.instantapptest""&gt;

&lt;uses-permission android:name=""android.permission.INTERNET"" /&gt;

&lt;application
    android:allowBackup=""true""
    android:icon=""@mipmap/ic_launcher""
    android:label=""@string/app_name""
    android:roundIcon=""@mipmap/ic_launcher_round""
    android:theme=""@style/AppTheme""&gt;

    &lt;activity
        android:name="".MainActivity""
        android:label=""@string/app_name""
        android:theme=""@style/AppTheme.NoActionBar""&gt;
        &lt;intent-filter&gt;
            &lt;action android:name=""android.intent.action.MAIN"" /&gt;

            &lt;category android:name=""android.intent.category.LAUNCHER"" /&gt;
        &lt;/intent-filter&gt;

        &lt;meta-data
            android:name=""default-url""
            android:value=""https://www.kochchy.cz"" /&gt;

        &lt;intent-filter android:autoVerify=""true""&gt;
            &lt;action android:name=""android.intent.action.VIEW"" /&gt;

            &lt;category android:name=""android.intent.category.DEFAULT"" /&gt;
            &lt;category android:name=""android.intent.category.BROWSABLE"" /&gt;

            &lt;data android:scheme=""https"" /&gt;
            &lt;data android:scheme=""http"" /&gt;
            &lt;data android:host=""www.kochchy.cz"" /&gt;
            &lt;data android:pathPattern=""/menu"" /&gt;
        &lt;/intent-filter&gt;
    &lt;/activity&gt;
&lt;/application&gt;
&lt;/manifest&gt;
</code></pre>

<p><strong>------ EDIT ------</strong></p>

<p>I made new project from google instant app sample: <a href=""https://github.com/googlesamples/android-instant-apps/tree/master/hello"" rel=""nofollow noreferrer"">https://github.com/googlesamples/android-instant-apps/tree/master/hello</a></p>

<p>Same google console error. I guess there is problem in my web setup, not in the app.</p>

<blockquote>
  <p><strong>The www.kochchy.cz website has not been linked to your application
  through the Digital Assets Link protocol. Link the application site
  with Digital Assets Link.</strong></p>
</blockquote>
",2291718,,2291718,,2017-06-15 14:19:10,2018-10-24 9:56:07,Digital Assets Link link to my website,<android><google-console-developer><android-instant-apps>,7,5,1,
Android,33115337,1,,,2015,,8,11927,"<p>I am trying Google Place Autocomplete Example from <a href=""https://github.com/googlesamples/android-play-places"">https://github.com/googlesamples/android-play-places</a>.</p>

<p>I have put the correct API key at the correct place. I knew it because when I put a random string invalid API key I will get a different error.</p>

<p>So after I put the correct API key, I run the app in both real device and simulator. Both devices gave me this error:</p>

<p>Status{statusCode=PLACES_API_INVALID_APP, resolution=null}</p>

<p>What causes this error and how to fix it?</p>
",1114591,,1677912,,2015-10-14 2:00:33,2018-06-04 19:20:23,PLACES_API_INVALID_APP error from Android Play Places,<android><google-places-api>,8,3,1,
Spring,36899386,1,37018939,,2016,,9,1266,"<p>Complete code for a Spring OAuth2 implementation of multi-factor authentication has been uploaded to <a href=""https://jumpshare.com/v/nal2OlUqVpMFzMgqeplw"" rel=""nofollow noreferrer"">a file sharing site that you can download by clicking on this link</a>. Instructions below explain how to use the link to recreate the current problem on any computer. <strong>A 500 point bounty is offered.</strong>  </p>

<p><hr/> 
<strong>THE CURRENT ERROR:</strong>  </p>

<hr/>  

<p>An error is being triggered when a user tries to authenticate using two factor authentication in <a href=""https://jumpshare.com/v/nal2OlUqVpMFzMgqeplw"" rel=""nofollow noreferrer"">the Spring Boot OAuth2 app from the link in the preceding paragraph</a>. The error is thrown at the point in the process when the app should serve up a second page asking the user for a pin code to confirm the user's identity.  </p>

<p><strong>Given that a null client is triggering this error, the problem seems to be how to connect a <code>ClientDetailsService</code> to a <code>Custom OAuth2RequestFactory</code> in Spring Boot OAuth2.</strong>  </p>

<p>The <a href=""https://jumpshare.com/v/8BMxbxWd2SsiVmS2Yl1I"" rel=""nofollow noreferrer"">entire debug log can be read at a file sharing site by clicking on this link</a>.  The complete stack trace in the logs contains only one reference to code that is actually in the app, and that line of code is:  </p>

<pre><code>AuthorizationRequest authorizationRequest =  
oAuth2RequestFactory.createAuthorizationRequest(paramsFromRequest(request));
</code></pre>

<p>The error thrown in the debug logs is:  </p>

<pre><code>org.springframework.security.oauth2.provider.NoSuchClientException:  
No client with requested id: null  
</code></pre>

<p><hr/>
<strong>CONTROL FLOW WHEN ERROR IS THROWN:</strong></p>

<hr/>  

<p>I created the following flowchart to illustrate the intended flow of multi-factor authentication requests in <a href=""https://stackoverflow.com/questions/30319666/two-factor-authentication-with-spring-security-oauth2#31425986"">@James' suggested implementation</a>:  </p>

<p><img src=""https://s32.postimg.org/5sahbqvrp/2_FA_OAuth_Flow.gif"">  </p>

<p>In the preceding flowchart, the current error is being thrown at some point between the <strong>Username &amp; Password View</strong> and the <strong>GET /secure/two_factor_authenticated</strong> steps.  </p>

<p><strong>The solution to this OP is limited in scope to the FIRST PASS that 1.) travels through the <code>/oauth/authorize</code> endpoint and then 2.) returns back to the <code>/oauth/authorize</code> endpoint via <code>TwoFactorAuthenticationController</code>.</strong>   </p>

<p>So we simply want to resolve the <code>NoSuchClientException</code> while also demonstrating that the client has been successfully granted <code>ROLE_TWO_FACTOR_AUTHENTICATED</code> in the <code>POST /secure/two_factor_authenticated</code>.  Given that the subsequent steps are boiler-plate, it is acceptable for the flow to demonstrably break in the <strong>SECOND PASS</strong> entry into <code>CustomOAuth2RequestFactory</code>, as long as the user enters the <strong>SECOND PASS</strong> with all the artifacts of successfully having completed the <strong>FIRST PASS</strong>.  The <strong>SECOND PASS</strong> can be a separate question as long as we successfully resolve the <strong>FIRST PASS</strong> here.  </p>

<p><hr/>
<strong>RELEVANT CODE EXCERPTS:</strong>  </p>

<hr/>  

<p>Here is the code for the <code>AuthorizationServerConfigurerAdapter</code>, where I attempt to set up the connection:  </p>

<pre><code>@Configuration
@EnableAuthorizationServer
protected static class OAuth2AuthorizationConfig extends AuthorizationServerConfigurerAdapter {

    @Autowired
    private AuthenticationManager authenticationManager;

    @Autowired//ADDED AS A TEST TO TRY TO HOOK UP THE CUSTOM REQUEST FACTORY
    private ClientDetailsService clientDetailsService;

    @Autowired//Added per: https://stackoverflow.com/questions/30319666/two-factor-authentication-with-spring-security-oauth2
    private CustomOAuth2RequestFactory customOAuth2RequestFactory;

    //THIS NEXT BEAN IS A TEST
    @Bean CustomOAuth2RequestFactory customOAuth2RequestFactory(){
        return new CustomOAuth2RequestFactory(clientDetailsService);
    }

    @Bean
    public JwtAccessTokenConverter jwtAccessTokenConverter() {
        JwtAccessTokenConverter converter = new JwtAccessTokenConverter();
        KeyPair keyPair = new KeyStoreKeyFactory(
                    new ClassPathResource(""keystore.jks""), ""foobar"".toCharArray()
                )
                .getKeyPair(""test"");
        converter.setKeyPair(keyPair);
        return converter;
    }

    @Override
    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {
        clients.inMemory()
                .withClient(""acme"")//API: http://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/config/annotation/builders/ClientDetailsServiceBuilder.ClientBuilder.html
                    .secret(""acmesecret"")
                    .authorizedGrantTypes(""authorization_code"", ""refresh_token"", ""password"")
                    .scopes(""openid"");
    }

    @Override
    public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {
        endpoints//API: http://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/config/annotation/web/configurers/AuthorizationServerEndpointsConfigurer.html
            .authenticationManager(authenticationManager)
            .accessTokenConverter(jwtAccessTokenConverter())
            .requestFactory(customOAuth2RequestFactory);//Added per: https://stackoverflow.com/questions/30319666/two-factor-authentication-with-spring-security-oauth2
    }

    @Override
    public void configure(AuthorizationServerSecurityConfigurer oauthServer) throws Exception {
        oauthServer//API: http://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/config/annotation/web/configurers/AuthorizationServerSecurityConfigurer.html
            .tokenKeyAccess(""permitAll()"")
            .checkTokenAccess(""isAuthenticated()"");
    }

}
</code></pre>

<p>Here is the code for the <code>TwoFactorAuthenticationFilter</code>, which contains the code above that is triggering the error:  </p>

<pre><code>package demo;

import java.io.IOException;
import java.util.Collection;
import java.util.HashMap;
import java.util.Map;
import java.util.Map.Entry;

import javax.servlet.FilterChain;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.oauth2.provider.AuthorizationRequest;
import org.springframework.security.oauth2.provider.ClientDetailsService;
import org.springframework.security.oauth2.provider.OAuth2RequestFactory;
import org.springframework.security.oauth2.provider.request.DefaultOAuth2RequestFactory;
import org.springframework.security.web.DefaultRedirectStrategy;
import org.springframework.security.web.RedirectStrategy;
import org.springframework.web.filter.OncePerRequestFilter;
import org.springframework.web.servlet.support.ServletUriComponentsBuilder;

//This class is added per: https://stackoverflow.com/questions/30319666/two-factor-authentication-with-spring-security-oauth2
/**
 * Stores the oauth authorizationRequest in the session so that it can
 * later be picked by the {@link com.example.CustomOAuth2RequestFactory}
 * to continue with the authoriztion flow.
 */
public class TwoFactorAuthenticationFilter extends OncePerRequestFilter {

    private RedirectStrategy redirectStrategy = new DefaultRedirectStrategy();
    private OAuth2RequestFactory oAuth2RequestFactory;
    //These next two are added as a test to avoid the compilation errors that happened when they were not defined.
    public static final String ROLE_TWO_FACTOR_AUTHENTICATED = ""ROLE_TWO_FACTOR_AUTHENTICATED"";
    public static final String ROLE_TWO_FACTOR_AUTHENTICATION_ENABLED = ""ROLE_TWO_FACTOR_AUTHENTICATION_ENABLED"";

    @Autowired
    public void setClientDetailsService(ClientDetailsService clientDetailsService) {
        oAuth2RequestFactory = new DefaultOAuth2RequestFactory(clientDetailsService);
    }

    private boolean twoFactorAuthenticationEnabled(Collection&lt;? extends GrantedAuthority&gt; authorities) {
        return authorities.stream().anyMatch(
            authority -&gt; ROLE_TWO_FACTOR_AUTHENTICATION_ENABLED.equals(authority.getAuthority())
    );
    }

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)
            throws ServletException, IOException {
        // Check if the user hasn't done the two factor authentication.
        if (AuthenticationUtil.isAuthenticated() &amp;&amp; !AuthenticationUtil.hasAuthority(ROLE_TWO_FACTOR_AUTHENTICATED)) {
            AuthorizationRequest authorizationRequest = oAuth2RequestFactory.createAuthorizationRequest(paramsFromRequest(request));
            /* Check if the client's authorities (authorizationRequest.getAuthorities()) or the user's ones
               require two factor authenticatoin. */
            if (twoFactorAuthenticationEnabled(authorizationRequest.getAuthorities()) ||
                    twoFactorAuthenticationEnabled(SecurityContextHolder.getContext().getAuthentication().getAuthorities())) {
                // Save the authorizationRequest in the session. This allows the CustomOAuth2RequestFactory
                // to return this saved request to the AuthenticationEndpoint after the user successfully
                // did the two factor authentication.
               request.getSession().setAttribute(CustomOAuth2RequestFactory.SAVED_AUTHORIZATION_REQUEST_SESSION_ATTRIBUTE_NAME, authorizationRequest);

                // redirect the the page where the user needs to enter the two factor authentiation code
                redirectStrategy.sendRedirect(request, response,
                        ServletUriComponentsBuilder.fromCurrentContextPath()
                            .path(TwoFactorAuthenticationController.PATH)
                            .toUriString());
                return;
            }
        }

        filterChain.doFilter(request, response);
    }

    private Map&lt;String, String&gt; paramsFromRequest(HttpServletRequest request) {
        Map&lt;String, String&gt; params = new HashMap&lt;&gt;();
        for (Entry&lt;String, String[]&gt; entry : request.getParameterMap().entrySet()) {
            params.put(entry.getKey(), entry.getValue()[0]);
        }
        return params;
    }
} 
</code></pre>

<hr/>

<p><strong>RE-CREATING THE PROBLEM ON YOUR COMPUTER:</strong>  </p>

<hr/>  

<p>You can recreate the problem on any computer in only a few minutes by following these simple steps:  </p>

<p>1.) Download the <a href=""https://jumpshare.com/v/nal2OlUqVpMFzMgqeplw"" rel=""nofollow noreferrer"">zipped version of the app from a file sharing site by clicking on this link</a>.  </p>

<p>2.) Unzip the app by typing: <code>tar -zxvf oauth2.tar(1).gz</code>  </p>

<p>3.) launch the <code>authserver</code> app by navigating to <code>oauth2/authserver</code> and then typing <code>mvn spring-boot:run</code>.  </p>

<p>4.) launch the <code>resource</code> app by navigating to <code>oauth2/resource</code> and then typing <code>mvn spring-boot:run</code>  </p>

<p>5.) launch the <code>ui</code> app by navigating to <code>oauth2/ui</code> and then typing <code>mvn spring-boot:run</code>  </p>

<p>6.) Open a web browser and navigate to <code>http : // localhost : 8080</code>  </p>

<p>7.) Click <code>Login</code> and then enter <code>Frodo</code> as the user and <code>MyRing</code> as the password, and click to submit.  <strong>This will trigger the error shown above.</strong>  </p>

<p>You can view the complete source code by: </p>

<p>a.) importing the maven projects into your IDE, or by  </p>

<p>b.) navigating within the unzipped directories and opening with a text editor.  </p>

<p>Note:  The code in the file sharing link above is a combination of <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2"" rel=""nofollow noreferrer"">the Spring Boot OAuth2 GitHub sample at this link</a>, and the <a href=""https://stackoverflow.com/questions/30319666/two-factor-authentication-with-spring-security-oauth2#31425986"">suggestions for 2 Factor Authentication offered by @James at this link</a>.  The only changes to the Spring Boot GitHub sample have been in the <code>authserver</code> app, specifically in <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2/authserver/src/main"" rel=""nofollow noreferrer""><code>authserver/src/main/java</code></a> and in <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2/authserver/src/main"" rel=""nofollow noreferrer""><code>authserver/src/main/resources/templates</code></a>.  </p>

<p><hr/>
<strong>NARROWING THE PROBLEM:</strong><br>
<hr/><br>
Per @AbrahamGrief's suggestion, I added a <code>FilterConfigurationBean</code>, which resolved the <code>NoSuchClientException</code>.  But the OP asks how to complete the <strong>FIRST PASS</strong> through the control flow in the diagram for a <strong>500 point bounty</strong>.  </p>

<p>I then narrowed the problem by setting <code>ROLE_TWO_FACTOR_AUTHENTICATION_ENABLED</code> in <code>Users.loadUserByUername()</code> as follows:  </p>

<pre><code>@Override
public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
    String password;
    List&lt;GrantedAuthority&gt; auth = AuthorityUtils.commaSeparatedStringToAuthorityList(""ROLE_USER"");
    if (username.equals(""Samwise"")) {//ROLE_TWO_FACTOR_AUTHENTICATION_ENABLED will need to come from the resource, NOT the user
        auth = AuthorityUtils.commaSeparatedStringToAuthorityList(""ROLE_HOBBIT, ROLE_TWO_FACTOR_AUTHENTICATION_ENABLED"");
        password = ""TheShire"";
    }
    else if (username.equals(""Frodo"")){//ROLE_TWO_FACTOR_AUTHENTICATION_ENABLED will need to come from the resource, NOT the user
        auth = AuthorityUtils.commaSeparatedStringToAuthorityList(""ROLE_HOBBIT, ROLE_TWO_FACTOR_AUTHENTICATION_ENABLED"");
        password = ""MyRing"";
    }
    else{throw new UsernameNotFoundException(""Username was not found. "");}
    return new org.springframework.security.core.userdetails.User(username, password, auth);
}
</code></pre>

<p>This eliminates the need to configure clients and resources, so that the current problem remains narrow.  However, the next roadblock is that Spring Security is rejecting the user's request for <code>/security/two_factor_authentication</code>.  <strong>What further changes need to be made to complete the FIRST PASS through the control flow, so that the <code>POST /secure/two_factor_authentication</code> can SYSO <code>ROLE_TWO_FACTOR_AUTHENTICATED</code>?</strong></p>
",807797,,-1,,2017-05-23 11:45:25,2016-05-04 20:54:53,null client in OAuth2 Multi-Factor Authentication,<spring><spring-mvc><spring-security><spring-boot><spring-security-oauth2>,1,0,7,
Spring,34751700,1,38867506,,2016,,9,7222,"<p>I have been really been searching high and low for the last few days on how to do this and have finally decided to admit defeat and ask for help, please!!!</p>

<p>I have followed Dr Dave Syer's tutorial on Angular and Spring Security specifically the Zuul Proxy as an api gateway and using Spring Session with Redis (<a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/double#_sso_with_oauth2_angular_js_and_spring_security_part_v"">https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/double#_sso_with_oauth2_angular_js_and_spring_security_part_v</a>)</p>

<p>The issue I am having is that I am calling resource rest services via the gateway from an external application with the following header:</p>

<pre><code>String plainCreds = ""user:password"";
byte[] plainCredsBytes = plainCreds.getBytes();
byte[] base64CredsBytes = Base64.getEncoder().encode(plainCredsBytes);
String base64Creds = new String(base64CredsBytes);

HttpHeaders headers = new HttpHeaders();
headers.add(""Authorization"", ""Basic "" + base64Creds);
</code></pre>

<p>to be authenticated and then routed by zuul and then the resource to have access to the authenticated session via redis.</p>

<p>The issue is that the session seems to only commit to redis in the gateway after the request has responded. So what is happening is that when I call a resource service with the header, I can see the successful authentication occurring in the gateway and session being created, however I am getting a 403 in the resource due to the session not being in redis after its been routed via zuul.</p>

<p>However if I get the error, grab the session id and add it to the header and try again it works because now my authenticated session is available for the resource project after its been routed.</p>

<p>Please could someone point me in the direction of how I go about getting my calls via the gateway to authenticate and route in the same request please?</p>

<p>Thanks
Justin</p>
",4977572,,,,,2016-10-20 12:33:45,Spring Zuul API Gateway with Spring Session / Redis Authenticate and Route in same Request,<spring-security><spring-cloud><spring-session>,2,1,7,
Spring,36100395,1,,,2016,,5,5450,"<p>I'm modifying the <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2-vanilla"" rel=""noreferrer"">oauth2-vanilla</a> sample from <a href=""https://spring.io/guides/tutorials/spring-security-and-angular-js/"" rel=""noreferrer"">Springs excellent security tutorials</a>. The oauth2-vanilla combines the Zuul Proxy and the UI into a single application. I would like to seperate the Zuul Proxy and the UI. (The Zuul Proxy should act as an API gateway and as a reverse proxy for several UIs).</p>

<p>When accessing the UI via the zuul proxy, it should be able to do SSO based on Oauth2 between the UI and the resource backend.</p>

<p>The oauth2-vanilla looks like this</p>

<p><img src=""https://dl.dropboxusercontent.com/u/13246619/Spring/Screenshot%202016-03-19%2010.58.24.png"" alt=""""></p>

<p>Where I want to move to something like this :</p>

<p><img src=""https://dl.dropboxusercontent.com/u/13246619/Spring/Screenshot%202016-03-19%2010.58.32.png"" alt=""""></p>

<p>I've removed the UI part from the gateway, and added a zuul route for the ui</p>

<p><code>
zuul:
  routes:
    resource:
      url: http://localhost:9000
    user:
      url: http://localhost:9999/uaa/user
    ui:
      url: http://localhost:8080
</code></p>

<p>I created a new UI webapp containing the UI (Angular stuff) with an <code>@EnableOAuth2Sso</code> annotation.</p>

<p>So I'm accessing the UI via <a href=""http://localhost:8888"" rel=""noreferrer"">http://localhost:8888</a> (through the zuul proxy).
After authenticating and doing through the UI flow, I can access the /user endpoint that returns me the user. (During debugging, I see that when I access the /user endpoint that I have an HTTP Session with an OAuth2Authentication.</p>

<p>When I access the /resource endpoint however, the HttpSessionSecurityContextRepository cannot find a session and is unable to build a context with the OAuth2Authentication.</p>

<p>I've created <a href=""https://github.com/ddewaele/spring-cloud-seperate-ui-gateway"" rel=""noreferrer"">a git repository</a> with the modified sample.</p>

<p>I'm guessing there is something wrong with the gateway configuration. 
I've tried changing cookie paths, changing HttpSecurity rules in the proxy but I cannot get it to work.</p>

<p>What I don't understand is why the UI, when accessed through the proxy is able to resolve the <code>/user</code> endpoint fine (with an HTTP session and a OAuth2Authentication), but it is unable to access the <code>/resource</code> endpoint.</p>

<p>Also, as the UI is now running in the <code>/ui</code> context, it seems that I need to have the following code in the gateway for it to load up the angular css / js files.</p>

<p><code>
.antMatchers(""/ui/index.html"", ""/ui/home.html"", ""ui/css/**"", ""/ui/js/**"").permitAll().anyRequest().authenticated();
</code></p>

<p>It also doesn't seem right that I need to prefix it with the zuul ui route.</p>

<p>Any help would be appreciated.</p>
",492410,,492410,,2016-03-19 17:03:55,2018-03-09 19:50:33,Spring Security Oauth2 SSO with Zuul Proxy,<spring><spring-security><spring-cloud><spring-security-oauth2>,1,5,6,
Spring,41092751,1,41092831,,2016,,35,19035,"<p>I'm experimenting with examples from this official Spring <a href=""https://spring.io/guides/gs/async-method/"" rel=""noreferrer"">tutorials</a> and there is a dependency on this code:<br>
<a href=""https://github.com/spring-guides/gs-async-method/tree/master/complete"" rel=""noreferrer"">https://github.com/spring-guides/gs-async-method/tree/master/complete</a></p>

<p>If you look at the code on <em>AppRunner.java</em>  class, I have 2 issues:</p>

<p>1) When server is starting, if I put a breakpoint in this class's constructor, seems like in the constructor, the <em>GitHubLookupService</em> is provided by spring, using the <strong>@Service</strong> bean that was configured. BUT, there was no <code>@Autowired</code> annotation on the constructor, so how in the world this constructor get called with the right dependency?  It was supposed to be <code>null</code>.</p>

<p>Is it an automatic assumption of <strong>Spring Boot</strong>?<br>
Does Spring see ""private field + constructor argument, and it assumes it should look for an appropriate bean?<br>
Is it <strong>Spring Framework</strong> or <strong>Spring boot</strong>?<br>
Am I missing something?</p>

<p>2) As I remember, it was mendatory to provide <em>default constructor</em> to beans / service etc. How come this class (AppRunner) doesn't have a default constructor?
How does Spring knows that it should run the constructor with the argument?
Is it because it is the only constructor?</p>
",1652248,,814702,,2018-01-23 16:14:54,2018-01-23 16:14:54,Spring injects dependencies in constructor without @Autowired annotation,<spring><spring-boot><dependency-injection><autowired>,1,0,6,
Spring,29831953,1,29836337,,2015,,7,19117,"<p>This is an extension to my previous question <a href=""https://stackoverflow.com/questions/29782148/why-do-i-need-main-method-if-i-develop-web-app-as-war-using-spring-boot"">here</a> at SO. As per this post, main method is NOT required to generate a <code>deployable war</code></p>

<p>I am trying to generate a <code>deployable war</code> for this simple application of <a href=""https://spring.io/guides/gs/uploading-files/"" rel=""nofollow noreferrer"">uploading files</a>. The source code can be for this example application can be found <a href=""https://github.com/spring-guides/gs-uploading-files/tree/master/complete"" rel=""nofollow noreferrer"">here</a>.</p>

<p>Following the instructions from spring boot for jar to war conversion, I changed my <code>pom.xml</code> to reflect the following. (Just added <code>tomcat</code> dependency with scope <code>provided</code>).</p>

<p>Reference: <a href=""http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#build-tool-plugins-maven-packaging"" rel=""nofollow noreferrer"">http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#build-tool-plugins-maven-packaging</a></p>

<pre><code>      &lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;
&lt;project xmlns=""http://maven.apache.org/POM/4.0.0"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""
    xsi:schemaLocation=""http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd""&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;gs-uploading-files&lt;/artifactId&gt;
    &lt;version&gt;0.1.0&lt;/version&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;

    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;1.2.3.RELEASE&lt;/version&gt;
    &lt;/parent&gt;


    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;

    &lt;/dependencies&gt;

    &lt;properties&gt;
        &lt;java.version&gt;1.7&lt;/java.version&gt;
    &lt;/properties&gt;

    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-releases&lt;/id&gt;
            &lt;name&gt;Spring Releases&lt;/name&gt;
            &lt;url&gt;https://repo.spring.io/libs-release&lt;/url&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;
    &lt;pluginRepositories&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;spring-releases&lt;/id&gt;
            &lt;name&gt;Spring Releases&lt;/name&gt;
            &lt;url&gt;https://repo.spring.io/libs-release&lt;/url&gt;
        &lt;/pluginRepository&gt;
    &lt;/pluginRepositories&gt;
&lt;/project&gt;
</code></pre>

<p>Then I changed <code>Application.java</code> as follows</p>

<p>Reference: <a href=""http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-create-a-deployable-war-file"" rel=""nofollow noreferrer"">http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-create-a-deployable-war-file</a></p>

<pre><code>@SpringBootApplication
public class Application extends SpringBootServletInitializer{

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(Application.class);
    }

    /*public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    } */
} 
</code></pre>

<p>I tried two scenarios. both fail with the following error (<code>Unable to find main class</code>).</p>

<ol>
<li>No main method (NOTE I have commented out main method above)</li>
<li>No application.Java file (commented out everything from this file - not shown here)</li>
</ol>

<p>Error:</p>

<pre><code>[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 9.218s
[INFO] Finished at: Thu Apr 23 11:46:24 PDT 2015
[INFO] Final Memory: 22M/222M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.springframework.boot:spring-boot-maven-plugin:1.2.3.RELEASE:repackage (default) on project gs-uploading-files: Execution default of goal org.springframework.boot:spring-boot-maven-plugin:1.2.3.RELEASE:repackage failed: Unable to find main class -&gt; [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/PluginExecutionException
</code></pre>

<p><strong>PS: when I have main method intact, the build is successful</strong></p>
",1988876,,-1,,2017-05-23 12:17:02,2016-04-14 1:34:00,maven build failing when generating war package for spring boot application?,<spring><maven><tomcat><spring-boot>,2,5,6,
Spring,25571843,1,25574250,,2014,,7,4574,"<p>I'm having problems accessing the sample springBoot application after I deploy it to Weblogic12C. It works fine using the springBoot-embedded Tomcat server.</p>

<h1>Install and test using SpringBoot-embedded Tomcat: all is well</h1>

<p>Steps to reproduce: get the springBoot ""getting started"" application code following the steps: <a href=""https://spring.io/guides/gs/spring-boot/"" rel=""nofollow noreferrer"">https://spring.io/guides/gs/spring-boot/</a></p>

<ul>
<li>git clone <a href=""https://github.com/spring-guides/gs-spring-boot.git"" rel=""nofollow noreferrer"">https://github.com/spring-guides/gs-spring-boot.git</a></li>
<li>cd gs-spring-boot/complete/ (we'll be using the gr-spring-boot/complete dir so that you don't have to go through the ""getting started"" page above (all changes done for you in ""complete"").  </li>
<li>open the file gs-spring-boot/complete/build.gradle and add "" apply plugin: 'war' "" below the other ""apply plugin"" entries </li>
</ul>

<p>At this point, you can validate that all is well by running the gradle ""bootRun"" tasks which starts the app in the embedded Tomcat server. Once tomcat started, browse to localhost:8080/ and see that you get ""Greetings from Spring Boot!""</p>

<h1>Now let's install this on Weblogic 12C</h1>

<ul>
<li>run ""gradle war"" (again, work from gs-spring-boot/complete/)
you will now have a war file under gs-spring-boot\complete\build\libs\complete.war

<ul>
<li>go to your weblogic12C console. I didn't make changes to my WL12C so the console is located at localhost:7001/console NOTE: I downloaded the WL12C developer version one week ago from the Oracle site. I didn't make any changes to it, as downloaded. The dev version of WL12C download requires that we point it to our already installed JDK. My WL12C uses java version:

<blockquote>
  <blockquote>
    <p>java version ""1.7.0_45""
    Java(TM) SE Runtime Environment (build 1.7.0_45-b18)
    Java HotSpot(TM) Server VM (build 24.45-b08, mixed mode)</p>
  </blockquote>
</blockquote></li>
<li>when in the console, deploy the war file:</li>
<li>click on ""deployments""</li>
<li>click on ""install""</li>
<li>browse to you ""gs-spring-boot \ complete \ build \ libs"" dir </li>
<li>select the radio button next to complete.war and hit next</li>
<li>select ""install as application"" and hit next</li>
<li>leave all options as is [DD only, use the defaults, use same accessibility] and hit next</li>
<li>click finish</li>
</ul></li>
</ul>

<p>At this point, you will see that the application deployed fine:
- click on ""deployments"" again and see that your ""complete"" springBoot app is listed and ACTIVE
- click on ""complete"" and notice on this page: ""Context Root:   /complete"". NOTE: weblogic docs say that if there is no context-root defined in weblogic.xml, then it uses the name of the war file (minus the .war)</p>

<h1>Now, the problem: getting a 403:</h1>

<p>if you try to access the springBoot app at localhost:7001/complete you get a 403!!!</p>

<pre><code>Error 403--Forbidden
From RFC 2068 Hypertext Transfer Protocol -- HTTP/1.1:
10.4.4 403 Forbidden
The server understood the request, but is refusing to fulfill it. Authorization will not help and the request SHOULD NOT be repeated. If the request method was not HEAD and the server wishes to make public why the request has not been fulfilled, it SHOULD describe the reason for the refusal in the entity. This status code is commonly used when the server does not wish to reveal exactly why the request has been refused, or when no other response is applicable.
</code></pre>

<p>Ok, so let's make one final change (I'm fishing here, maybe weblogic really wants a weblogic.xml):</p>

<ul>
<li>create the dir: gs-spring-boot\complete\src\main\webapp\WEB-INF\</li>
<li>create this file: gs-spring-boot\complete\src\main\webapp\WEB-INF\weblogic.xml</li>
<li><p>edit weblogic.xml to contain:</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;
&lt;wls:weblogic-web-app xmlns:wls=""http://xmlns.oracle.com/weblogic/weblogic-web-app"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd http://xmlns.oracle.com/weblogic/weblogic-web-app http://xmlns.oracle.com/weblogic/weblogic-web-app/1.4/weblogic-web-app.xsd""&gt;
    &lt;wls:weblogic-version&gt;12.1.1&lt;/wls:weblogic-version&gt;
    &lt;wls:context-root&gt;testApp&lt;/wls:context-root&gt;
&lt;/wls:weblogic-web-app&gt;
</code></pre></li>
<li><p>now go back to your weblogic console (localhost:7001/console)</p></li>
<li>go to ""web applications"" and select the checkbox next to ""complete"" then hit ""delete""</li>
<li>restart your weblogic12C server (just to be paranoid)</li>
<li>run the ""gradle clean"" then ""gradle war"" task again to generate a new war file</li>
<li>open the war file (using winzip or whatever) and confirm that the war file now has WEB-INF/weblogic.xml</li>
<li>go to the console the deploy the new war file (use same steps as above)</li>
<li>confirm that the app is now deployed and has a contextRoot of /testApp (as defined in weblogic.xml)</li>
<li>browse to localhost:7001/testApp/</li>
</ul>

<p>The 403 is still there. So:</p>

<ul>
<li>weblogic DOES know about this application (returns 403). Because if it didn't know about the application, it would return 404 (try it by going to localhost:7001/doesNotExist and you'll get 404)</li>
<li>but it looks like WL12C doesn't route requests to spring. In the past, we'd define a bunch of things in web.xml but nowadays, with javaConfig and SpringBoot, this should all be done automagically...

<ul>
<li>note: because SpringBoot uses JavaConfig (Servlet3), we can't use anything lower that weblogic12C (which is the latest)</li>
</ul></li>
</ul>

<h1>Another thing I tried: change RequestMapping</h1>

<p>In the sample code above, open the file gs-spring-boot\complete\src\main\java\hello\HelloController.java and replace:</p>

<pre><code>@RequestMapping(""/"")
</code></pre>

<p>with this:</p>

<pre><code>@RequestMapping(""pierre.htm"")
</code></pre>

<p>Now, if you browse to (remember weblogic.xml define context-root as /testApp):</p>

<ul>
<li>localhost:7001/testApp/pierre.htm you'll get a 404 </li>
<li>localhost:7001/testApp/           you'll get 403</li>
</ul>

<p>And if you try on tomcat with ""gradle bootrun"", you can get to it fine: localhost:8080/pierre.htm (you get ""greetings from SpringBoot!"").</p>

<p>So this yields the following hints:</p>

<ul>
<li>Weblogic does know about /testApp</li>
<li>Weblogic has no idea what /testApp/pierre.htm is. It's like it was never configured as a RequestMapping. </li>
<li>there is some ""Spring wiring"" missing for it to work on weblogic.... </li>
</ul>

<p>This is where I'm stuck... Can anyone think what JavaConfig ""wiring"" I'm missing to make it work on Weblogic? Any help greatly appreciated. Thanks!!</p>

<h1>Solution</h1>

<p>If anyone comes here, to make it simpler than read all the comments, below, here's how to make it work:</p>

<ul>
<li>start with the SpringBoot sample app and git the ""complete"" solution from here: spring.io/guides/gs/convert-jar-to-war/</li>
<li><p>update the class WebInitializer so that it implements WebApplicationInitializer. So change it from this:</p>

<pre><code>    public class WebInitializer extends SpringBootServletInitializer {
</code></pre></li>
</ul>

<p>To this:</p>

<pre><code>        public class WebInitializer extends SpringBootServletInitializer implements WebApplicationInitializer {
</code></pre>

<ul>
<li><p>create a new file src/main/webapp/WEB-INF/weblogic.xml and put this contents in it:</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;
&lt;wls:weblogic-web-app xmlns:wls=""http://xmlns.oracle.com/weblogic/weblogic-web-app"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd http://xmlns.oracle.com/weblogic/weblogic-web-app http://xmlns.oracle.com/weblogic/weblogic-web-app/1.4/weblogic-web-app.xsd""&gt;
    &lt;wls:weblogic-version&gt;12.1.1&lt;/wls:weblogic-version&gt;
    &lt;wls:context-root&gt;helloApp&lt;/wls:context-root&gt;
    &lt;wls:container-descriptor&gt;
        &lt;wls:prefer-application-packages&gt;
            &lt;wls:package-name&gt;org.slf4j.*&lt;/wls:package-name&gt;
        &lt;/wls:prefer-application-packages&gt;
    &lt;/wls:container-descriptor&gt;
&lt;/wls:weblogic-web-app&gt;
</code></pre>

<ul>
<li>gradle war</li>
<li>deploy to Weblogic12C</li>
<li>it should work now :) Thanks so much to both Dave Syer and Evgeni!</li>
</ul></li>
</ul>

<h1>Previous Solution (kept here for posterity)</h1>

<ul>
<li><p>start with the SpringBoot sample app and git the ""complete"" solution from here: spring.io/guides/gs/convert-jar-to-war/</p>

<ul>
<li>in the sample app's package ""hello"", add a new public class HelloWebXml implements WebApplicationInitializer </li>
<li><p>take all the code from org.springframework.boot.context.web.SpringBootServletInitializer and copy it into HelloWebXml but change these lines:</p>

<p>protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
    return application;
}</p></li>
</ul></li>
</ul>

<p>To this:</p>

<pre><code>    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
      return application.sources(Application.class);
    }
</code></pre>

<ul>
<li>copy the class org.springframework.boot.context.web.ErrorPageFilter into package ""hello"" in the sample app</li>
<li><p>create a new file src/main/webapp/WEB-INF/weblogic.xml and put this contents in it:</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;
&lt;wls:weblogic-web-app xmlns:wls=""http://xmlns.oracle.com/weblogic/weblogic-web-app"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd http://xmlns.oracle.com/weblogic/weblogic-web-app http://xmlns.oracle.com/weblogic/weblogic-web-app/1.4/weblogic-web-app.xsd""&gt;
    &lt;wls:weblogic-version&gt;12.1.1&lt;/wls:weblogic-version&gt;
    &lt;wls:context-root&gt;helloApp&lt;/wls:context-root&gt;
    &lt;wls:container-descriptor&gt;
        &lt;wls:prefer-application-packages&gt;
            &lt;wls:package-name&gt;org.slf4j.*&lt;/wls:package-name&gt;
        &lt;/wls:prefer-application-packages&gt;
    &lt;/wls:container-descriptor&gt;
&lt;/wls:weblogic-web-app&gt;
</code></pre>

<ul>
<li>gradle war</li>
<li>deploy to Weblogic12C</li>
<li>it should work now :) Thanks so much to both Dave Syer and Evgeni!</li>
</ul></li>
</ul>

<p>NOTE: There is a similar questions here:
<a href=""https://stackoverflow.com/questions/24835051/deploy-spring-boot-app-in-weblogic"">Deploy Spring Boot app in Weblogic</a>
...but that other question is about the deployment and it's a little vague (deployment itself works fine for me)</p>
",3930172,,-1,,2017-05-23 10:29:47,2017-07-13 12:11:00,Problems accessing fresh deploy of SpringBoot sample app on Weblogic12C,<java><spring><spring-boot><weblogic12c>,3,2,5,
Spring,23366226,1,23366746,,2014,,28,23955,"<p>I'm having trouble with my first steps using Spring-Boot with JPA. I've started with a pretty minimalistic <a href=""https://github.com/spring-guides/gs-accessing-data-jpa.git"">example from Git</a> using Gradle. </p>

<p>Now simply moving <code>Customer</code> to another package, let's say to <code>hello2</code> results in an exception <code>Caused by: java.lang.IllegalArgumentException: Not an managed type: class hello2.Customer</code>. I tried to add </p>

<p><code>@ComponentScan(basePackageClasses= {Customer.class}) // AND OR
@EnableJpaRepositories(basePackageClasses= {Customer.class})</code></p>

<p>to <code>Application</code>, but without success. </p>

<p>What am I doing wrong?</p>
",294068,,,,,2017-11-24 7:18:08,Spring Boot w/ JPA: move @Entity to different package,<spring><jpa><spring-data><spring-data-jpa><spring-boot>,4,0,5,
Spring,38800564,1,,,2016,,5,2554,"<p>We are trying to implement a SSO scheme using Azure AD and Spring security.
We found a few leads:</p>

<p><a href=""https://github.com/spring-guides/tut-spring-boot-oauth2"" rel=""noreferrer"">https://github.com/spring-guides/tut-spring-boot-oauth2</a></p>

<p><a href=""https://github.com/Pytry/azure-b2c-oauth2"" rel=""noreferrer"">https://github.com/Pytry/azure-b2c-oauth2</a></p>

<p>But none of these tell the full story.
In fact we can't get passed the access token parsing, Spring has a different idea of what the JWT token should be.</p>

<p>Ideally we wouldn't want to write an SSO filter from scratch but override the Token Services to implement custom filtering for starters.</p>

<p>Has anyone successfully implemented this?
Any help would be appreciated.</p>
",6684746,,,,,2018-05-10 8:21:19,Azure AD and Spring Security with Oauth 2,<java><security><spring-mvc><oauth><azure-active-directory>,1,1,4,
Spring,43458500,1,48949537,,2017,,10,3373,"<p>I'm studying the Spring Boot and JMS example and yes, I'm rather new on this</p>

<p>Since we work with Oracle, I would like to migrate the Spring Boot &amp; JMS example from ActiveMQ to Oracle Advanced Queueing. However I really find very little information on that.</p>

<p>As far as I see I need to replace the code below for the Oracle version, yet I did not manage to found out how.</p>

<pre><code>@Bean
public JmsListenerContainerFactory&lt;?&gt; myFactory(ConnectionFactory connectionFactory,
                                                DefaultJmsListenerContainerFactoryConfigurer configurer) {
    DefaultJmsListenerContainerFactory factory = new DefaultJmsListenerContainerFactory();
    // This provides all boot's default to this factory, including the message converter
    configurer.configure(factory, connectionFactory);
    // You could still override some of Boot's default if necessary.
    return factory;
</code></pre>

<p>}</p>

<p>The origin code can be found at <a href=""https://github.com/spring-guides/gs-messaging-jms"" rel=""noreferrer"">Github</a></p>

<p>Help would be greatly appreciated!</p>
",2529104,,,,,2018-11-04 11:15:35,How to migrate Spring Boot JMS from ActiveMQ to Oracle Advanced Queueing,<java><oracle><spring-boot><spring-jms><advanced-queuing>,2,4,4,
Spring,41429778,1,41450580,,2017,,4,4602,"<p>I am following <a href=""https://spring.io/guides/tutorials/spring-security-and-angular-js/#_the_login_page_angular_js_and_spring_security_part_ii"" rel=""nofollow noreferrer"">this</a> tutorial on Spring Security in the Spring.io guides. The logout and login functions are working fine, but when I add the following line in the <code>WebSecurityConfigurerAdapter</code> it doesn't work as expected. (Basically, I want to prevent a user from login from two devices if he is already logged in in one)</p>

<pre><code>@Configuration
@Order(SecurityProperties.ACCESS_OVERRIDE_ORDER)
protected static class SecurityConfiguration extends WebSecurityConfigurerAdapter {
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        // The configuration as in the tutorial
        http
            .httpBasic().and()
            .authorizeRequests()
                .antMatchers(""/index.html"", ""/home.html"", ""/login.html"", ""/"").permitAll()
                .anyRequest().authenticated()
                .and()
            .csrf()
                .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse());

      // Added this for session management  
      http.sessionManagement().maximumSessions(1).maxSessionsPreventsLogin(true)
    }
} 
</code></pre>

<p>The problem occurs if you logout and try to login again, a 401 is returned with the message 'Authentication Failed: Maximum
 sessions of 1 for this principal exceeded'.
Yet the logout URL is hit on this part in the <code>AngularJs</code> app</p>

<pre><code>self.logout = function() {
   $http.post('logout', {}).finally(function() {
     $rootScope.authenticated = false;
     $location.path(""/"");
   });
}
</code></pre>

<p>Why isn't the number of sessions reset in this case?</p>

<p>What can be done to make it work as expected?</p>

<p><a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/single"" rel=""nofollow noreferrer"">Link to github code</a></p>

<p>Spring Security logs in debug mode</p>

<pre><code>2017-01-03 21:38:01.806 DEBUG 32624 --- [nio-8080-exec-9] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/error'
2017-01-03 21:38:01.806 DEBUG 32624 --- [nio-8080-exec-9] o.s.security.web.FilterChainProxy        : /logout at position 1 of 13 in additional filter chain; firing Filter: 'WebAsyncManagerIntegrationFilter'
2017-01-03 21:38:01.806 DEBUG 32624 --- [nio-8080-exec-9] o.s.security.web.FilterChainProxy        : /logout at position 2 of 13 in additional filter chain; firing Filter: 'SecurityContextPersistenceFilter'
2017-01-03 21:38:01.807 DEBUG 32624 --- [nio-8080-exec-9] w.c.HttpSessionSecurityContextRepository : Obtained a valid SecurityContext from SPRING_SECURITY_CONTEXT: 'org.springframework.security.core.context.SecurityContextImpl@442b5a9f: Authentication: org.springframework.security.authentication.UsernamePasswordAuthenticationToken@442b5a9f: Principal: org.springframework.security.core.userdetails.User@36ebcb: Username: user; Password: [PROTECTED]; Enabled: true; AccountNonExpired: true; credentialsNonExpired: true; AccountNonLocked: true; Granted Authorities: ROLE_USER; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@b364: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: null; Granted Authorities: ROLE_USER'
2017-01-03 21:38:01.807 DEBUG 32624 --- [nio-8080-exec-9] o.s.security.web.FilterChainProxy        : /logout at position 3 of 13 in additional filter chain; firing Filter: 'HeaderWriterFilter'
2017-01-03 21:38:01.807 DEBUG 32624 --- [nio-8080-exec-9] o.s.security.web.FilterChainProxy        : /logout at position 4 of 13 in additional filter chain; firing Filter: 'CsrfFilter'
2017-01-03 21:38:01.807 DEBUG 32624 --- [nio-8080-exec-9] o.s.security.web.FilterChainProxy        : /logout at position 5 of 13 in additional filter chain; firing Filter: 'LogoutFilter'
2017-01-03 21:38:01.807 DEBUG 32624 --- [nio-8080-exec-9] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/logout'
2017-01-03 21:38:01.807 DEBUG 32624 --- [nio-8080-exec-9] o.s.s.w.a.logout.LogoutFilter            : Logging out user 'org.springframework.security.authentication.UsernamePasswordAuthenticationToken@442b5a9f: Principal: org.springframework.security.core.userdetails.User@36ebcb: Username: user; Password: [PROTECTED]; Enabled: true; AccountNonExpired: true; credentialsNonExpired: true; AccountNonLocked: true; Granted Authorities: ROLE_USER; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@b364: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: null; Granted Authorities: ROLE_USER' and transferring to logout destination
2017-01-03 21:38:01.807 DEBUG 32624 --- [nio-8080-exec-9] o.s.s.w.a.l.SecurityContextLogoutHandler : Invalidating session: DDC79F814F9ECD2A0192531E977D53C9
2017-01-03 21:38:01.807 DEBUG 32624 --- [nio-8080-exec-9] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2017-01-03 21:38:01.808 DEBUG 32624 --- [nio-8080-exec-9] o.s.s.web.util.matcher.OrRequestMatcher  : matched
2017-01-03 21:38:01.808 DEBUG 32624 --- [nio-8080-exec-9] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match the requestMatcher org.springframework.security.web.header.writers.HstsHeaderWriter$SecureRequestMatcher@e0735a1
2017-01-03 21:38:01.809 DEBUG 32624 --- [nio-8080-exec-9] w.c.HttpSessionSecurityContextRepository : SecurityContext is empty or contents are anonymous - context will not be stored in HttpSession.
2017-01-03 21:38:01.809 DEBUG 32624 --- [nio-8080-exec-9] s.s.w.c.SecurityContextPersistenceFilter : SecurityContextHolder now cleared, as request processing completed
2017-01-03 21:38:38.069 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/user'; against '/error'
2017-01-03 21:38:38.069 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 1 of 13 in additional filter chain; firing Filter: 'WebAsyncManagerIntegrationFilter'
2017-01-03 21:38:38.069 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 2 of 13 in additional filter chain; firing Filter: 'SecurityContextPersistenceFilter'
2017-01-03 21:38:38.069 DEBUG 32624 --- [io-8080-exec-10] w.c.HttpSessionSecurityContextRepository : No HttpSession currently exists
2017-01-03 21:38:38.069 DEBUG 32624 --- [io-8080-exec-10] w.c.HttpSessionSecurityContextRepository : No SecurityContext was available from the HttpSession: null. A new one will be created.
2017-01-03 21:38:38.069 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 3 of 13 in additional filter chain; firing Filter: 'HeaderWriterFilter'
2017-01-03 21:38:38.069 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 4 of 13 in additional filter chain; firing Filter: 'CsrfFilter'
2017-01-03 21:38:38.069 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 5 of 13 in additional filter chain; firing Filter: 'LogoutFilter'
2017-01-03 21:38:38.069 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Request 'GET /user' doesn't match 'POST /logout
2017-01-03 21:38:38.069 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 6 of 13 in additional filter chain; firing Filter: 'ConcurrentSessionFilter'
2017-01-03 21:38:38.069 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 7 of 13 in additional filter chain; firing Filter: 'BasicAuthenticationFilter'
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 8 of 13 in additional filter chain; firing Filter: 'RequestCacheAwareFilter'
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 9 of 13 in additional filter chain; firing Filter: 'SecurityContextHolderAwareRequestFilter'
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 10 of 13 in additional filter chain; firing Filter: 'AnonymousAuthenticationFilter'
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.a.AnonymousAuthenticationFilter  : Populated SecurityContextHolder with anonymous token: 'org.springframework.security.authentication.AnonymousAuthenticationToken@9055c2bc: Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@b364: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: null; Granted Authorities: ROLE_ANONYMOUS'
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 11 of 13 in additional filter chain; firing Filter: 'SessionManagementFilter'
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.session.SessionManagementFilter  : Requested session ID DDC79F814F9ECD2A0192531E977D53C9 is invalid.
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 12 of 13 in additional filter chain; firing Filter: 'ExceptionTranslationFilter'
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.security.web.FilterChainProxy        : /user at position 13 of 13 in additional filter chain; firing Filter: 'FilterSecurityInterceptor'
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/user'; against '/index.html'
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/user'; against '/home.html'
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/user'; against '/login.html'
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/user'; against '/'
2017-01-03 21:38:38.070 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.a.i.FilterSecurityInterceptor    : Secure object: FilterInvocation: URL: /user; Attributes: [authenticated]
2017-01-03 21:38:38.071 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.a.i.FilterSecurityInterceptor    : Previously Authenticated: org.springframework.security.authentication.AnonymousAuthenticationToken@9055c2bc: Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@b364: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: null; Granted Authorities: ROLE_ANONYMOUS
2017-01-03 21:38:38.071 DEBUG 32624 --- [io-8080-exec-10] o.s.s.access.vote.AffirmativeBased       : Voter: org.springframework.security.web.access.expression.WebExpressionVoter@6bd96c27, returned: -1
2017-01-03 21:38:38.072 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.a.ExceptionTranslationFilter     : Access is denied (user is anonymous); redirecting to authentication entry point

org.springframework.security.access.AccessDeniedException: Access is denied
    at org.springframework.security.access.vote.AffirmativeBased.decide(AffirmativeBased.java:84) ~[spring-security-core-4.1.3.RELEASE.jar:4.1.3.RELEASE]
    at org.springframework.security.access.intercept.AbstractSecurityInterceptor.beforeInvocation(AbstractSecurityInterceptor.java:233) ~[spring-security-core-4.1.3.RELEASE.jar:4.1.3.RELEASE]

2017-01-03 21:38:38.073 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.util.matcher.AndRequestMatcher   : Trying to match using Ant [pattern='/**', GET]
2017-01-03 21:38:38.073 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Request '/user' matched by universal pattern '/**'
2017-01-03 21:38:38.073 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.util.matcher.AndRequestMatcher   : Trying to match using NegatedRequestMatcher [requestMatcher=Ant [pattern='/**/favicon.ico']]
2017-01-03 21:38:38.073 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/user'; against '/**/favicon.ico'
2017-01-03 21:38:38.073 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.matcher.NegatedRequestMatcher  : matches = true
2017-01-03 21:38:38.073 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.util.matcher.AndRequestMatcher   : Trying to match using NegatedRequestMatcher [requestMatcher=MediaTypeRequestMatcher [contentNegotiationStrategy=org.springframework.web.accept.ContentNegotiationManager@47099aec, matchingMediaTypes=[application/json], useEquals=false, ignoredMediaTypes=[*/*]]]
2017-01-03 21:38:38.074 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.m.MediaTypeRequestMatcher      : httpRequestMediaTypes=[application/json, text/plain, */*]
2017-01-03 21:38:38.074 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.m.MediaTypeRequestMatcher      : Processing application/json
2017-01-03 21:38:38.074 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.m.MediaTypeRequestMatcher      : application/json .isCompatibleWith application/json = true
2017-01-03 21:38:38.074 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.u.matcher.NegatedRequestMatcher  : matches = false
2017-01-03 21:38:38.074 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.util.matcher.AndRequestMatcher   : Did not match
2017-01-03 21:38:38.074 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.s.HttpSessionRequestCache        : Request not saved as configured RequestMatcher did not match
2017-01-03 21:38:38.074 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.a.ExceptionTranslationFilter     : Calling Authentication entry point.
2017-01-03 21:38:38.074 DEBUG 32624 --- [io-8080-exec-10] s.w.a.DelegatingAuthenticationEntryPoint : Trying to match using RequestHeaderRequestMatcher [expectedHeaderName=X-Requested-With, expectedHeaderValue=XMLHttpRequest]
2017-01-03 21:38:38.074 DEBUG 32624 --- [io-8080-exec-10] s.w.a.DelegatingAuthenticationEntryPoint : Match found! Executing org.springframework.security.web.authentication.HttpStatusEntryPoint@301fca8
2017-01-03 21:38:38.074 DEBUG 32624 --- [io-8080-exec-10] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match the requestMatcher org.springframework.security.web.header.writers.HstsHeaderWriter$SecureRequestMatcher@e0735a1
2017-01-03 21:38:38.074 DEBUG 32624 --- [io-8080-exec-10] w.c.HttpSessionSecurityContextRepository : SecurityContext is empty or contents are anonymous - context will not be stored in HttpSession.
2017-01-03 21:38:38.074 DEBUG 32624 --- [io-8080-exec-10] s.s.w.c.SecurityContextPersistenceFilter : SecurityContextHolder now cleared, as request processing completed
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/user'; against '/error'
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : /user at position 1 of 13 in additional filter chain; firing Filter: 'WebAsyncManagerIntegrationFilter'
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : /user at position 2 of 13 in additional filter chain; firing Filter: 'SecurityContextPersistenceFilter'
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] w.c.HttpSessionSecurityContextRepository : No HttpSession currently exists
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] w.c.HttpSessionSecurityContextRepository : No SecurityContext was available from the HttpSession: null. A new one will be created.
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : /user at position 3 of 13 in additional filter chain; firing Filter: 'HeaderWriterFilter'
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : /user at position 4 of 13 in additional filter chain; firing Filter: 'CsrfFilter'
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : /user at position 5 of 13 in additional filter chain; firing Filter: 'LogoutFilter'
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] o.s.s.w.u.matcher.AntPathRequestMatcher  : Request 'GET /user' doesn't match 'POST /logout
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : /user at position 6 of 13 in additional filter chain; firing Filter: 'ConcurrentSessionFilter'
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : /user at position 7 of 13 in additional filter chain; firing Filter: 'BasicAuthenticationFilter'
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] o.s.s.w.a.www.BasicAuthenticationFilter  : Basic Authentication Authorization header found for user 'user'
2017-01-03 21:39:24.188 DEBUG 32624 --- [nio-8080-exec-1] o.s.s.authentication.ProviderManager     : Authentication attempt using org.springframework.security.authentication.dao.DaoAuthenticationProvider
2017-01-03 21:39:24.189 DEBUG 32624 --- [nio-8080-exec-1] o.s.s.w.a.www.BasicAuthenticationFilter  : Authentication success: org.springframework.security.authentication.UsernamePasswordAuthenticationToken@442b5a9f: Principal: org.springframework.security.core.userdetails.User@36ebcb: Username: user; Password: [PROTECTED]; Enabled: true; AccountNonExpired: true; credentialsNonExpired: true; AccountNonLocked: true; Granted Authorities: ROLE_USER; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@b364: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: null; Granted Authorities: ROLE_USER
2017-01-03 21:39:24.189 DEBUG 32624 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : /user at position 8 of 13 in additional filter chain; firing Filter: 'RequestCacheAwareFilter'
2017-01-03 21:39:24.189 DEBUG 32624 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : /user at position 9 of 13 in additional filter chain; firing Filter: 'SecurityContextHolderAwareRequestFilter'
2017-01-03 21:39:24.189 DEBUG 32624 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : /user at position 10 of 13 in additional filter chain; firing Filter: 'AnonymousAuthenticationFilter'
2017-01-03 21:39:24.189 DEBUG 32624 --- [nio-8080-exec-1] o.s.s.w.a.AnonymousAuthenticationFilter  : SecurityContextHolder not populated with anonymous token, as it already contained: 'org.springframework.security.authentication.UsernamePasswordAuthenticationToken@442b5a9f: Principal: org.springframework.security.core.userdetails.User@36ebcb: Username: user; Password: [PROTECTED]; Enabled: true; AccountNonExpired: true; credentialsNonExpired: true; AccountNonLocked: true; Granted Authorities: ROLE_USER; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@b364: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: null; Granted Authorities: ROLE_USER'
2017-01-03 21:39:24.189 DEBUG 32624 --- [nio-8080-exec-1] o.s.security.web.FilterChainProxy        : /user at position 11 of 13 in additional filter chain; firing Filter: 'SessionManagementFilter'
2017-01-03 21:39:24.189 DEBUG 32624 --- [nio-8080-exec-1] s.CompositeSessionAuthenticationStrategy : Delegating to org.springframework.security.web.authentication.session.ConcurrentSessionControlAuthenticationStrategy@2bf94401
2017-01-03 21:39:24.191 DEBUG 32624 --- [nio-8080-exec-1] o.s.s.w.session.SessionManagementFilter  : SessionAuthenticationStrategy rejected the authentication object

org.springframework.security.web.authentication.session.SessionAuthenticationException: Maximum sessions of 1 for this principal exceeded
    at org.springframework.security.web.authentication.session.ConcurrentSessionControlAuthenticationStrategy.allowableSessionsExceeded(ConcurrentSessionControlAuthenticationStrategy.java:153) ~[spring-security-web-4.1.3.RELEASE.jar:4.1.3.RELEASE]
    at org.springframework.security.web.authentication.session.ConcurrentSessionControlAuthenticationStrategy.onAuthentication(ConcurrentSessionControlAuthenticationStrategy.java:123) ~[spring-security-web-4.1.3.RELEASE.jar:4.1.3.RELEASE]


2017-01-03 21:39:24.192 DEBUG 32624 --- [nio-8080-exec-1] .a.SimpleUrlAuthenticationFailureHandler : No failure URL set, sending 401 Unauthorized error
2017-01-03 21:39:24.192 DEBUG 32624 --- [nio-8080-exec-1] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match the requestMatcher org.springframework.security.web.header.writers.HstsHeaderWriter$SecureRequestMatcher@e0735a1
2017-01-03 21:39:24.192 DEBUG 32624 --- [nio-8080-exec-1] w.c.HttpSessionSecurityContextRepository : SecurityContext is empty or contents are anonymous - context will not be stored in HttpSession.
2017-01-03 21:39:24.192 DEBUG 32624 --- [nio-8080-exec-1] s.s.w.c.SecurityContextPersistenceFilter : SecurityContextHolder now cleared, as request processing completed
</code></pre>
",5248299,,5248299,,2017-01-03 18:53:15,2017-01-04 6:42:30,Spring Security logout and Maximum sessions,<java><spring><spring-mvc><session><spring-security>,1,0,3,
Spring,35584271,1,35585108,,2016,,6,12422,"<p>I'm trying to use auditing to save <code>dateCreated</code> and <code>dateUpdated</code> in my objects, but since I set <code>ID</code> manually, there's some additional work.</p>

<p>Following Oliver Gierke's suggestion in <a href=""https://jira.spring.io/browse/DATAMONGO-946"" rel=""noreferrer"">DATAMONGO-946</a>
I'm trying to figure out how to correctly implement it.</p>

<p>As original poster in Jira task above, I've downloaded example from here <a href=""https://github.com/spring-guides/gs-accessing-data-mongodb.git"" rel=""noreferrer"">https://github.com/spring-guides/gs-accessing-data-mongodb.git</a> and modified it a bit:</p>

<pre><code>package hello;

import org.springframework.data.annotation.CreatedDate;
import org.springframework.data.annotation.Id;
import org.springframework.data.annotation.LastModifiedDate;
import org.springframework.data.domain.Persistable;

import java.util.Date;

public class Customer implements Persistable&lt;String&gt; {
    @Id
    private String id;
    @CreatedDate
    private Date createdDate;
    @LastModifiedDate
    private Date lastModifiedDate;
    private String firstName;
    private String lastName;
    private boolean persisted;

    public Customer() {
    }

    public Customer(String firstName, String lastName) {
        this.firstName = firstName;
        this.lastName = lastName;
    }

    public void setPersisted(boolean persisted) {
        this.persisted = persisted;
    }

    @Override
    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    @Override
    public boolean isNew() {
        return !persisted;
    }

    @Override
    public String toString() {
        return String.format(
                ""Customer[id=%s, createdDate=%s, lastModifiedDate=%s, firstName='%s', lastName='%s']"",
                id, createdDate, lastModifiedDate, firstName, lastName);
    }
}
</code></pre>

<p>and</p>

<pre><code>package hello;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.data.mongodb.config.EnableMongoAuditing;

@SpringBootApplication
@EnableMongoAuditing
public class Application implements CommandLineRunner {

    @Autowired
    private CustomerRepository repository;

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }

    @Override
    public void run(String... args) throws Exception {

        repository.deleteAll();

        // create a customer
        Customer c = new Customer(""Alice"", ""Smith"");
        c.setId(""test_id"");

        // save a customer
        repository.save(c);

        // fetch all customers
        System.out.println(""Customers found with findAll():"");
        System.out.println(""-------------------------------"");
        for (Customer customer : repository.findAll()) {
            System.out.println(customer);
        }
        System.out.println();

        // create another customer with same id
        c = new Customer(""Bob"", ""Smith"");
        c.setId(""test_id"");
        c.setPersisted(true);
        repository.save(c);

        // fetch all customers
        System.out.println(""Customers found with findAll():"");
        System.out.println(""-------------------------------"");
        for (Customer customer : repository.findAll()) {
            System.out.println(customer);
        }
        System.out.println();
    }
}
</code></pre>

<p>and a result of execution is this:</p>

<pre><code>Customers found with findAll():
-------------------------------
Customer[id=test_id, createdDate=Wed Feb 24 00:43:47 WITA 2016, lastModifiedDate=Wed Feb 24 00:43:47 WITA 2016, firstName='Alice', lastName='Smith']

Customers found with findAll():
-------------------------------
Customer[id=test_id, createdDate=null, lastModifiedDate=Wed Feb 24 00:43:47 WITA 2016, firstName='Bob', lastName='Smith']
</code></pre>

<p><code>createdDate</code> becomes <code>null</code> after object update.</p>

<p>What am I missing here? And how to correctly implement <code>Persistable</code> to make auditing work properly?</p>
",1757278,,,,,2018-12-09 20:05:25,"Spring Data MongoDB Annotation @CreatedDate isn't working, when ID is assigned manually",<java><spring><mongodb><spring-data><spring-data-mongodb>,1,0,3,
Spring,37780976,1,,,2016,,5,2100,"<p>I follow this tutorial: <a href=""https://help.github.com/articles/signing-commits-using-gpg/"" rel=""nofollow noreferrer"">https://help.github.com/articles/signing-commits-using-gpg/</a></p>

<p>I try to sign when commit like this:
<a href=""https://github.com/spring-guides/tut-spring-boot-oauth2/commit/824f418ab9d04114b14a90f7c19b4b8d6dda67b7"" rel=""nofollow noreferrer"">https://github.com/spring-guides/tut-spring-boot-oauth2/commit/824f418ab9d04114b14a90f7c19b4b8d6dda67b7</a></p>

<p><a href=""https://i.stack.imgur.com/aaVEi.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/aaVEi.jpg"" alt=""enter image description here""></a></p>

<p>but error:</p>

<pre><code>C:\Users\Administrator\Desktop\foo\test_gpg&gt;git commit -m ""test""
gpg: skipped ""DABDD34E"": secret key not available
gpg: signing failed: secret key not available
error: gpg failed to sign the data
fatal: failed to write commit object
</code></pre>

<p><a href=""https://i.stack.imgur.com/6SiFh.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/6SiFh.jpg"" alt=""enter image description here""></a>
<a href=""https://i.stack.imgur.com/ch5Sx.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/ch5Sx.jpg"" alt=""enter image description here""></a>
<a href=""https://i.stack.imgur.com/TUsRP.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/TUsRP.jpg"" alt=""enter image description here""></a>
<a href=""https://i.stack.imgur.com/ZD99v.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/ZD99v.jpg"" alt=""enter image description here""></a></p>

<p>My config:</p>

<pre><code>C:\Users\Administrator\Desktop\foo\test_gpg&gt;git config --list --show-origin
file:""C:\\ProgramData/Git/config""       core.symlinks=false
file:""C:\\ProgramData/Git/config""       core.autocrlf=true
file:""C:\\ProgramData/Git/config""       core.fscache=true
file:""C:\\ProgramData/Git/config""       color.diff=auto
file:""C:\\ProgramData/Git/config""       color.status=auto
file:""C:\\ProgramData/Git/config""       color.branch=auto
file:""C:\\ProgramData/Git/config""       color.interactive=true
file:""C:\\ProgramData/Git/config""       help.format=html
file:""C:\\ProgramData/Git/config""       http.sslcainfo=C:/Program Files/Git/mingw64/ssl/certs/ca-bundle.crt
file:""C:\\ProgramData/Git/config""       diff.astextplain.textconv=astextplain
file:""C:\\ProgramData/Git/config""       rebase.autosquash=true
file:""C:\\Program Files\\Git\\mingw64/etc/gitconfig""    credential.helper=manager
file:C:/Users/Administrator/.gitconfig  user.name=donhuvy
file:C:/Users/Administrator/.gitconfig  user.email=donhuvy@hotmail.com
file:C:/Users/Administrator/.gitconfig  user.signingkey=DABDD34E
file:C:/Users/Administrator/.gitconfig  commit.gpgsign=true
file:C:/Users/Administrator/.gitconfig  use.signingkey=DABDD34E
file:.git/config        core.repositoryformatversion=0
file:.git/config        core.filemode=false
file:.git/config        core.bare=false
file:.git/config        core.logallrefupdates=true
file:.git/config        core.symlinks=false
file:.git/config        core.ignorecase=true
file:.git/config        core.hidedotfiles=dotGitOnly
file:.git/config        remote.origin.url=https://github.com/donhuvy/test_gpg.git
file:.git/config        remote.origin.fetch=+refs/heads/*:refs/remotes/origin/*
file:.git/config        branch.master.remote=origin
file:.git/config        branch.master.merge=refs/heads/master
file:.git/config        commit.gpgsign=true
</code></pre>

<p>and</p>

<pre><code>C:\Users\Administrator\Desktop\foo\test_gpg&gt;gpg --list-key
C:/Users/Administrator/AppData/Roaming/gnupg/pubring.gpg
--------------------------------------------------------
pub   2048R/DABDD34E 2016-06-10
uid       [ultimate] donhuvy (Do Nhu Vy) &lt;v@vyhn.net&gt;
uid       [ultimate] Do Nhu Vy (Do Nhu Vy) &lt;v@vyhn.net&gt;
sub   2048R/C6B535A2 2016-06-10
</code></pre>

<p>(I register 3 emails with GitHub: <code>v@vyhn.net</code>, <code>donhuvy@hotmail.com</code> and <code>xxxxx@gmail.com</code>)
What I have been wrong? How I sign my commit?</p>
",3728901,,3728901,,2017-11-15 12:46:16,2018-05-06 0:30:34,"gpg: skipped ""XXBDXX4E"": secret key not available. gpg: signing failed: secret key not available",<git><github>,2,0,3,
Spring,36730903,1,43245998,,2016,,5,8564,"<p>How do I add the custom <code>UserDetailsService</code> below to <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2"" rel=""noreferrer"">this Spring OAuth2 sample</a>?  </p>

<p>The default <code>user</code> with default <code>password</code> is defined in the <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/blob/master/oauth2/authserver/src/main/resources/application.properties"" rel=""noreferrer""><code>application.properties</code></a> file of the <code>authserver</code> app.  </p>

<p>However, I would like to add the following custom <code>UserDetailsService</code> to <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2/authserver/src/main/java/demo"" rel=""noreferrer"">the <code>demo</code> package of the <code>authserver</code> app</a> for testing purposes:  </p>

<pre><code>package demo;

import java.util.List;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.AuthorityUtils;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.security.provisioning.UserDetailsManager;
import org.springframework.stereotype.Service;

@Service
class Users implements UserDetailsManager {

    @Override
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
        String password;
        List&lt;GrantedAuthority&gt; auth = AuthorityUtils.commaSeparatedStringToAuthorityList(""ROLE_USER"");
        if (username.equals(""Samwise"")) {
            auth = AuthorityUtils.commaSeparatedStringToAuthorityList(""ROLE_HOBBIT"");
            password = ""TheShire"";
        }
        else if (username.equals(""Frodo"")){
            auth = AuthorityUtils.commaSeparatedStringToAuthorityList(""ROLE_HOBBIT"");
            password = ""MyRing"";
        }
        else{throw new UsernameNotFoundException(""Username was not found. "");}
        return new org.springframework.security.core.userdetails.User(username, password, auth);
    }

    @Override
    public void createUser(UserDetails user) {// TODO Auto-generated method stub
    }

    @Override
    public void updateUser(UserDetails user) {// TODO Auto-generated method stub
    }

    @Override
    public void deleteUser(String username) {// TODO Auto-generated method stub
    }

    @Override
    public void changePassword(String oldPassword, String newPassword) {
        // TODO Auto-generated method stub
    }

    @Override
    public boolean userExists(String username) {
        // TODO Auto-generated method stub
        return false;
    }
}
</code></pre>

<p>As you can see, this <code>UserDetailsService</code> is not <code>autowired</code> yet, and it purposely uses insecure passwords because it is only designed for testing purposes.  </p>

<p><strong>What specific changes need to be made to <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2"" rel=""noreferrer"">the GitHub sample app</a> so that a user can login as <code>username=Samwise</code> with <code>password=TheShire</code>, or as <code>username=Frodo</code> with <code>password=MyRing</code>?</strong>  Do changes need to be made to <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/blob/master/oauth2/authserver/src/main/java/demo/AuthserverApplication.java"" rel=""noreferrer""><code>AuthserverApplication.java</code></a> or elsewhere?</p>

<hr>

<p><strong>SUGGESTIONS:</strong>  </p>

<hr>

<p>The <a href=""http://projects.spring.io/spring-security-oauth/docs/oauth2.html#grant-types"" rel=""noreferrer"">Spring OAuth2 Developer Guide</a> says to use a <code>GlobalAuthenticationManagerConfigurer</code> to configure a <code>UserDetailsService</code> globally.  However, googling those names produces less than helpful results.  </p>

<p>Also, a different app that uses internal spring security INSTEAD OF OAuth uses the following syntax to hook up the <code>UserDetailsService</code>, but I am not sure how to adjust its syntax to the current OP:  </p>

<pre><code>@Order(Ordered.HIGHEST_PRECEDENCE)
@Configuration
protected static class AuthenticationSecurity extends GlobalAuthenticationConfigurerAdapter {

    @Autowired
    private Users users;

    @Override
    public void init(AuthenticationManagerBuilder auth) throws Exception {
        auth.userDetailsService(users);
    }
}
</code></pre>

<p>I tried using <code>@Autowire</code> inside the <code>OAuth2AuthorizationConfig</code> to connect <code>Users</code> to the <code>AuthorizationServerEndpointsConfigurer</code> as follows:  </p>

<pre><code>@Autowired//THIS IS A TEST
private Users users;//THIS IS A TEST

@Override
public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {
   endpoints.authenticationManager(authenticationManager)
        .accessTokenConverter(jwtAccessTokenConverter())
        .userDetailsService(users)//DetailsService)//THIS LINE IS A TEST
        ;
}
</code></pre>

<p>But the Spring Boot logs indicate that the user <code>Samwise</code> was not found, which means that the <code>UserDetailsService</code> was not successfully hooked up.  Here is the relevant excerpt from the Spring Boot logs:  </p>

<pre><code>2016-04-20 15:34:39.998 DEBUG 5535 --- [nio-9999-exec-9] o.s.s.a.dao.DaoAuthenticationProvider    :  
        User 'Samwise' not found
2016-04-20 15:34:39.998 DEBUG 5535 --- [nio-9999-exec-9]   
        w.a.UsernamePasswordAuthenticationFilter :  
        Authentication request failed:  
        org.springframework.security.authentication.BadCredentialsException:  
        Bad credentials
</code></pre>

<p><strong>What else can I try?</strong></p>
",807797,,807797,,2016-04-20 22:42:57,2018-08-23 20:13:41,Add custom UserDetailsService to Spring Security OAuth2 app,<spring><spring-security><spring-boot><spring-security-oauth2><spring-oauth2>,2,0,3,
Spring,37061697,1,,,2016,,14,2025,"<p>Complete code for a Spring OAuth2 implementation of Multi-Factor Authentication has been uploaded to <a href=""https://jumpshare.com/v/oj7wSZaZRgJHEwqYiJ2p"" rel=""nofollow noreferrer"">a file sharing site at this link</a>.  Instructions are given below to recreate the current problem on any computer in only a few minutes.</p>

<p><hr/>
<strong>CURRENT PROBLEM:</strong></p>

<hr/>  

<p>Most of the authentication algorithm works correctly.  The program does not break until the very end of the control flow shown below.  Specifically, an <code>Invalid CSRF token found for http://localhost:9999/uaa/oauth/token</code> error is being thrown at the end of the <strong>SECOND PASS</strong> below.  The app in the link above was developed by adding a custom <code>OAuth2RequestFactory</code>, <code>TwoFactorAuthenticationFilter</code> and <code>TwoFactorAuthenticationController</code> to the <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2/authserver"" rel=""nofollow noreferrer""><code>authserver</code> app</a> of this <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2"" rel=""nofollow noreferrer"">Spring Boot OAuth2 GitHub sample</a>.  <strong>What specific changes need to be made to the code below in order to resolve this CSRF token error and enable 2-factor authentication?</strong>  </p>

<p>My research leads me to suspect that the <code>CustomOAuth2RequestFactory</code> (<a href=""http://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/provider/OAuth2RequestFactory.html"" rel=""nofollow noreferrer"">API at this link</a>) might be the place to configure a solution because it defines ways for managing <a href=""http://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/provider/AuthorizationRequest.html"" rel=""nofollow noreferrer""><code>AuthorizationRequest</code></a>s and <a href=""http://docs.spring.io/spring-security/oauth/apidocs/org/springframework/security/oauth2/provider/TokenRequest.html"" rel=""nofollow noreferrer""><code>TokenRequest</code></a>s.  </p>

<p><strong><a href=""https://tools.ietf.org/html/rfc6749#section-4.1.1"" rel=""nofollow noreferrer"">This section of the official OAuth2 spec</a> indicates that the <code>state</code> parameter of the request made to the authorization endpoint is the place where the <code>csrf</code> token is added.</strong>  </p>

<p>Also, the code in the link uses <a href=""https://tools.ietf.org/html/rfc6749#section-4.1"" rel=""nofollow noreferrer"">the Authorization Code Grant Type described at this link to the official spec</a>, which would mean that Step C in the flow does not update the <code>csrf</code> code, thus triggering the error in Step D.  (You can view the entire flow including Step C and Step D in <a href=""https://tools.ietf.org/html/rfc6749#section-4.1"" rel=""nofollow noreferrer"">the official spec</a>.)</p>

<p><hr/>
<strong>CONTROL FLOW SURROUNDING THE CURRENT ERROR:</strong>  </p>

<hr/>  

<p>The current error is being thrown during the <strong>SECOND PASS</strong> through <code>TwoFactorAuthenticationFilter</code> in the flowchart below.  Everything works as intended until the control flow gets into the <strong>SECOND PASS</strong>.    </p>

<p>The following flowchart illustrates the control flow of the two factor authentication process that is employed by the code in the downloadable app.</p>

<p><img src=""https://s32.postimg.cc/5sahbqvrp/2_FA_OAuth_Flow.gif"">  </p>

<p>Specifically, the Firefox <code>HTTP</code> Headers for the sequence of <code>POST</code>s and <code>GET</code>s show that the same <code>XSRF</code> cookie is sent with every request in the sequence.  The <code>XSRF</code> token values do not cause a problem until after the <code>POST /secure/two_factor_authentication</code>, which triggers server processing at the <code>/oauth/authorize</code> and <code>/oauth/token</code> endpoints, with <code>/oauth/token</code> throwing the <code>Invalid CSRF token found for http://localhost:9999/uaa/oauth/token</code> error.  </p>

<p>To understand the relationship between the above control flow chart and the <code>/oauth/authorize</code> and <code>/oauth/token</code> endpoints, you can compare the above flowchart side by side <a href=""https://tools.ietf.org/html/rfc6749#section-4.1"" rel=""nofollow noreferrer"">with the chart for the single factor flow at the official spec</a> in a separate browser window.  The <strong>SECOND PASS</strong> above simply runs through the steps from the one-factor official spec a second time, but with greater permissions during the <strong>SECOND PASS</strong>.  </p>

<p><hr/><br>
<strong>WHAT THE LOGS SAY:</strong></p>

<hr/>  

<p>The HTTP Request and Response Headers indicate that:  </p>

<p>1.) A POST to <code>9999/login</code> with the correct <code>username</code> and <code>password</code> submitted results in a redirect to <code>9999/authorize?client_id=acme&amp;redirect_uri=/login&amp;response_type=code&amp;state=sGXQ4v</code> followed by a <code>GET 9999/secure/two_factor_authenticated</code>.  One XSRF token remains constant across these exchanges.  </p>

<p>2.) A POST to <code>9999/secure/two_factor_authentication</code> with the correct pin code sends the same <code>XSRF</code> token, and gets successfully re-directed to <code>POST 9999/oauth/authorize</code> and makes it into <code>TwoFactorAuthenticationFilter.doFilterInternal()</code> and proceeds to <code>request 9999/oauth/token</code>, but <code>9999/oauth/token</code> rejects the request because the same old XSRF token does not match a new <code>XSRF</code> token value, which was apparently created during the <strong>FIRST PASS</strong>.    </p>

<p>One obvious difference between <code>1.)</code> and <code>2.)</code> is that the second <code>request 9999/oauth/authorize</code> in <code>2.)</code> does not contain the url parameters which are included in the first request to <code>9999/authorize?client_id=acme&amp;redirect_uri=/login&amp;response_type=code&amp;state=sGXQ4v</code> in <code>1.)</code>, and also defined in <a href=""https://tools.ietf.org/html/rfc6749#section-4.1"" rel=""nofollow noreferrer"">the official spec</a>.  But it is not clear if this is causing the problem.  </p>

<p>Also, it is not clear how to access the parameters to send a fully formed request from the <code>TwoFactorAuthenticationController.POST</code>.  I did a SYSO of the <code>parameters</code> <code>Map</code> in the <code>HttpServletRequest</code> for the <code>POST 9999/secure/two_factor_authentication</code> controller method, and all it contains are the <code>pinVal</code> and <code>_csrf</code> variables.  </p>

<p>You can read all the HTTP Headers and Spring Boot logs at a file sharing site <a href=""https://jumpshare.com/v/Xy2g91GLXLB8gkWmliMF"" rel=""nofollow noreferrer"">by clicking on this link</a>.</p>

<p><hr/>
<strong>A FAILED APPROACH:</strong>  </p>

<hr/>  

<p>I tried <a href=""https://stackoverflow.com/questions/20862299/with-spring-security-3-2-0-release-how-can-i-get-the-csrf-token-in-a-page-that#20960352"">@RobWinch's approach to a similar problem in the Spring Security 3.2 environment</a>, but the approach does not seem to apply to the context of Spring OAuth2.  Specifically, when the following <code>XSRF</code> update code block is uncommented in the <code>TwoFactorAuthenticationFilter</code> code shown below, the downstream request headers do show a different/new <code>XSRF</code> token value, but the same error is thrown.  </p>

<pre><code>if(AuthenticationUtil.hasAuthority(ROLE_TWO_FACTOR_AUTHENTICATED)){
    CsrfToken token = (CsrfToken) request.getAttribute(""_csrf"");
    response.setHeader(""XSRF-TOKEN""/*""X-CSRF-TOKEN""*/, token.getToken());
}
</code></pre>

<p><strong>This indicates that the <code>XSRF</code> configuration needs to be updated in a way that <code>/oauth/authorize</code> and <code>/oauth/token</code> are able to talk with each other and with the client and resource apps to successfully manage the <code>XSRF</code> token values.</strong>  Perhaps the <code>CustomOAuth2RequestFactory</code> is what needs to be changed to accomplish this.  But how?  </p>

<p><hr/>
<strong>RELEVANT CODE:</strong></p>

<hr/>  

<p>The code for <code>CustomOAuth2RequestFactory</code> is:  </p>

<pre><code>public class CustomOAuth2RequestFactory extends DefaultOAuth2RequestFactory {

    public static final String SAVED_AUTHORIZATION_REQUEST_SESSION_ATTRIBUTE_NAME = ""savedAuthorizationRequest"";

    public CustomOAuth2RequestFactory(ClientDetailsService clientDetailsService) {
        super(clientDetailsService);
    }

    @Override
    public AuthorizationRequest createAuthorizationRequest(Map&lt;String, String&gt; authorizationParameters) {
        ServletRequestAttributes attr = (ServletRequestAttributes) RequestContextHolder.currentRequestAttributes();
        HttpSession session = attr.getRequest().getSession(false);
        if (session != null) {
            AuthorizationRequest authorizationRequest = (AuthorizationRequest) session.getAttribute(SAVED_AUTHORIZATION_REQUEST_SESSION_ATTRIBUTE_NAME);
            if (authorizationRequest != null) {
                session.removeAttribute(SAVED_AUTHORIZATION_REQUEST_SESSION_ATTRIBUTE_NAME);
                return authorizationRequest;
            }
        }

        return super.createAuthorizationRequest(authorizationParameters);
    }
}
</code></pre>

<p>The code for <code>TwoFactorAuthenticationFilter</code> is:  </p>

<pre><code>//This class is added per: https://stackoverflow.com/questions/30319666/two-factor-authentication-with-spring-security-oauth2
/**
 * Stores the oauth authorizationRequest in the session so that it can
 * later be picked by the {@link com.example.CustomOAuth2RequestFactory}
 * to continue with the authoriztion flow.
 */
public class TwoFactorAuthenticationFilter extends OncePerRequestFilter {

    private RedirectStrategy redirectStrategy = new DefaultRedirectStrategy();
    private OAuth2RequestFactory oAuth2RequestFactory;
    //These next two are added as a test to avoid the compilation errors that happened when they were not defined.
    public static final String ROLE_TWO_FACTOR_AUTHENTICATED = ""ROLE_TWO_FACTOR_AUTHENTICATED"";
    public static final String ROLE_TWO_FACTOR_AUTHENTICATION_ENABLED = ""ROLE_TWO_FACTOR_AUTHENTICATION_ENABLED"";

    @Autowired
    public void setClientDetailsService(ClientDetailsService clientDetailsService) {
        oAuth2RequestFactory = new DefaultOAuth2RequestFactory(clientDetailsService);
    }

    private boolean twoFactorAuthenticationEnabled(Collection&lt;? extends GrantedAuthority&gt; authorities) {
        System.out.println(""&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; List of authorities includes: "");
        for (GrantedAuthority authority : authorities) {
            System.out.println(""auth: ""+authority.getAuthority() );
        }
        return authorities.stream().anyMatch(
            authority -&gt; ROLE_TWO_FACTOR_AUTHENTICATION_ENABLED.equals(authority.getAuthority())
        );
    }

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {
        System.out.println(""------------------ INSIDE TwoFactorAuthenticationFilter.doFilterInternal() ------------------------"");
        // Check if the user hasn't done the two factor authentication.
        if (AuthenticationUtil.isAuthenticated() &amp;&amp; !AuthenticationUtil.hasAuthority(ROLE_TWO_FACTOR_AUTHENTICATED)) {
        System.out.println(""++++++++++++++++++++++++ AUTHENTICATED BUT NOT TWO FACTOR +++++++++++++++++++++++++"");
        AuthorizationRequest authorizationRequest = oAuth2RequestFactory.createAuthorizationRequest(paramsFromRequest(request));
            /* Check if the client's authorities (authorizationRequest.getAuthorities()) or the user's ones
               require two factor authenticatoin. */
        System.out.println(""======================== twoFactorAuthenticationEnabled(authorizationRequest.getAuthorities()) is: "" + twoFactorAuthenticationEnabled(authorizationRequest.getAuthorities()) );
        System.out.println(""======================== twoFactorAuthenticationEnabled(SecurityContextHolder.getContext().getAuthentication().getAuthorities()) is: "" + twoFactorAuthenticationEnabled(SecurityContextHolder.getContext().getAuthentication().getAuthorities()) );
        if (twoFactorAuthenticationEnabled(authorizationRequest.getAuthorities()) ||
                twoFactorAuthenticationEnabled(SecurityContextHolder.getContext().getAuthentication().getAuthorities())) {
                // Save the authorizationRequest in the session. This allows the CustomOAuth2RequestFactory
                // to return this saved request to the AuthenticationEndpoint after the user successfully
                // did the two factor authentication.
                request.getSession().setAttribute(CustomOAuth2RequestFactory.SAVED_AUTHORIZATION_REQUEST_SESSION_ATTRIBUTE_NAME, authorizationRequest);

                // redirect the the page where the user needs to enter the two factor authentiation code
                redirectStrategy.sendRedirect(request, response,
                    ServletUriComponentsBuilder.fromCurrentContextPath()
                        .path(TwoFactorAuthenticationController.PATH)
                        .toUriString());
                return;
            }
        }
        //THE NEXT ""IF"" BLOCK DOES NOT RESOLVE THE ERROR WHEN UNCOMMENTED
        //if(AuthenticationUtil.hasAuthority(ROLE_TWO_FACTOR_AUTHENTICATED)){
        //    CsrfToken token = (CsrfToken) request.getAttribute(""_csrf"");
            // this is the value of the token to be included as either a header or an HTTP parameter
        //    response.setHeader(""XSRF-TOKEN"", token.getToken());
        //}

        filterChain.doFilter(request, response);
    }

    private Map&lt;String, String&gt; paramsFromRequest(HttpServletRequest request) {
        Map&lt;String, String&gt; params = new HashMap&lt;&gt;();
        for (Entry&lt;String, String[]&gt; entry : request.getParameterMap().entrySet()) {
            params.put(entry.getKey(), entry.getValue()[0]);
        }
        return params;
    }
}
</code></pre>

<hr/>

<p><strong>RE-CREATING THE PROBLEM ON YOUR COMPUTER:</strong>  </p>

<hr/>  

<p>You can recreate the problem on any computer in only a few minutes by following these simple steps:  </p>

<p>1.) Download the <a href=""https://jumpshare.com/v/oj7wSZaZRgJHEwqYiJ2p"" rel=""nofollow noreferrer"">zipped version of the app from a file sharing site by clicking on this link</a>.  </p>

<p>2.) Unzip the app by typing: <code>tar -zxvf oauth2.tar(2).gz</code>  </p>

<p>3.) launch the <code>authserver</code> app by navigating to <code>oauth2/authserver</code> and then typing <code>mvn spring-boot:run</code>.  </p>

<p>4.) launch the <code>resource</code> app by navigating to <code>oauth2/resource</code> and then typing <code>mvn spring-boot:run</code>  </p>

<p>5.) launch the <code>ui</code> app by navigating to <code>oauth2/ui</code> and then typing <code>mvn spring-boot:run</code>  </p>

<p>6.) Open a web browser and navigate to <code>http : // localhost : 8080</code>  </p>

<p>7.) Click <code>Login</code> and then enter <code>Frodo</code> as the user and <code>MyRing</code> as the password, and click to submit.  </p>

<p>8.) Enter <code>5309</code> as the <code>Pin Code</code> and click submit.  <strong>This will trigger the error shown above.</strong>  </p>

<p>You can view the complete source code by: </p>

<p>a.) importing the maven projects into your IDE, or by  </p>

<p>b.) navigating within the unzipped directories and opening with a text editor.  </p>

<p><hr/>
You can read all the HTTP Headers and Spring Boot logs at a file sharing site <a href=""https://jumpshare.com/v/Xy2g91GLXLB8gkWmliMF"" rel=""nofollow noreferrer"">by clicking on this link</a>.</p>
",807797,,1033581,,2018-07-21 13:43:15,2018-07-21 13:43:15,Invalid XSRF token at /oauth/token,<spring><spring-mvc><spring-security><spring-boot><spring-oauth2>,2,5,3,
Spring,37970709,1,37971596,,2016,,16,15445,"<p>I'm trying to create OAuth2 Server Provider using this tutorial <a href=""https://spring.io/blog/2015/02/03/sso-with-oauth2-angular-js-and-spring-security-part-v"" rel=""noreferrer"">Spring OAuth2</a> . The main difference between example and my project - I do not use Spring Boot. I try to split this classes (<a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/blob/master/oauth2/authserver/src/main/java/demo/AuthserverApplication.java"" rel=""noreferrer"">GitHub example link</a>) I created 2 classes:</p>

<pre><code>@Configuration
@Order(-20)
@EnableResourceServer
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {

  @Autowired
  private AuthenticationManager authenticationManager;

  @Override
  protected void configure(HttpSecurity http) throws Exception {
    http.formLogin().loginPage(""/login"").permitAll()
            .and()
            .requestMatchers().antMatchers(""/login"", ""/oauth/authorize"", ""/oauth/confirm_access"")
            .and()
            .authorizeRequests().anyRequest().authenticated();
  }

  @Override
  protected void configure(AuthenticationManagerBuilder auth) throws Exception {
    auth.parentAuthenticationManager(authenticationManager);
  }
</code></pre>

<p>}</p>

<p>Second class:</p>

<pre><code>@Configuration
@EnableAuthorizationServer
@EnableResourceServer
public class OAuth2AuthorizationConfiguration extends AuthorizationServerConfigurerAdapter {

  @Autowired
  private AuthenticationManager authenticationManager;

  @Bean
  public JwtAccessTokenConverter jwtAccessTokenConverter() {
    JwtAccessTokenConverter converter = new JwtAccessTokenConverter();
    KeyPair keyPair = new KeyStoreKeyFactory(
            new ClassPathResource(""keystore.jks""), ""foobar"".toCharArray())
            .getKeyPair(""test"");
    converter.setKeyPair(keyPair);
    return converter;
  }

  @Override
  public void configure(ClientDetailsServiceConfigurer clients) throws Exception {
    clients.inMemory()
            .withClient(""acme"")
            .secret(""acmesecret"")
            .authorizedGrantTypes(""authorization_code"", ""refresh_token"",
                    ""password"").scopes(""openid"").autoApprove(true).accessTokenValiditySeconds(30);
}

  @Override
  public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {
    endpoints.authenticationManager(authenticationManager).accessTokenConverter(
            jwtAccessTokenConverter());
  }

  @Override
  public void configure(AuthorizationServerSecurityConfigurer oauthServer) throws Exception {
    oauthServer.tokenKeyAccess(""permitAll()"").checkTokenAccess(
            ""isAuthenticated()"");
  }

}
</code></pre>

<p>But when I try to start this code, I get:</p>

<pre><code>SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'OAuth2AuthorizationConfiguration': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private   org.springframework.security.authentication.AuthenticationManager com.example.configuration.security.OAuth2AuthorizationConfiguration.authenticationManager; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type [org.springframework.security.authentication.AuthenticationManager] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
at   org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:292)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1185)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:537)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:475)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:302)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:228)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:298)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:703)
at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:760)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:482)
at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:403)
at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:306)
at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:106)
at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:5066)
at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5584)
at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:147)
at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:899)
at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:875)
at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:652)
at org.apache.catalina.startup.HostConfig.manageApp(HostConfig.java:1863)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:498)
at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:801)
at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:618)
at org.apache.catalina.mbeans.MBeanFactory.createStandardContext(MBeanFactory.java:565)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:498)
at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)
at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:819)
at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:801)
at javax.management.remote.rmi.RMIConnectionImpl.doOperation(RMIConnectionImpl.java:1468)
at javax.management.remote.rmi.RMIConnectionImpl.access$300(RMIConnectionImpl.java:76)
at javax.management.remote.rmi.RMIConnectionImpl$PrivilegedOperation.run(RMIConnectionImpl.java:1309)
at javax.management.remote.rmi.RMIConnectionImpl.doPrivilegedOperation(RMIConnectionImpl.java:1401)
at javax.management.remote.rmi.RMIConnectionImpl.invoke(RMIConnectionImpl.java:829)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:498)
at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:324)
at sun.rmi.transport.Transport$1.run(Transport.java:200)
at sun.rmi.transport.Transport$1.run(Transport.java:197)
at java.security.AccessController.doPrivileged(Native Method)
at sun.rmi.transport.Transport.serviceCall(Transport.java:196)
at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:568)
at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run0(TCPTransport.java:826)
at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.lambda$run$0(TCPTransport.java:683)
at java.security.AccessController.doPrivileged(Native Method)
at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport.java:682)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
at java.lang.Thread.run(Thread.java:745)
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.springframework.security.authentication.AuthenticationManager com.example.configuration.security.OAuth2AuthorizationConfiguration.authenticationManager; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type [org.springframework.security.authentication.AuthenticationManager] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:508)
at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:289)
... 58 more
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type [org.springframework.security.authentication.AuthenticationManager] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
at org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoSuchBeanDefinitionException(DefaultListableBeanFactory.java:1103)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:963)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:858)
at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:480)
... 60 more
</code></pre>

<p>I guess, the problem is in Spring Boot that I do not use in my app. 
I tried following solutions: <a href=""https://stackoverflow.com/questions/21633555/how-to-inject-authenticationmanager-using-java-configuration-in-a-custom-filter"">First</a>, <a href=""https://stackoverflow.com/questions/32081578/spring-security-nosuchbeandefinitionexception-no-qualifying-bean-of-type-org"">Second</a>
I use only code-based configuration. 
Additional info:
Java 8
spring-security-oauth2 - 2.0.7.RELEASE, 
spring-security-version - 4.0.1.RELEASE, 
spring-version - 4.0.6.RELEASE. </p>

<p>How to fix it?</p>

<p><strong>UPDATE</strong></p>

<p>I created </p>

<pre><code>@Configuration
public class AuthManager extends WebSecurityConfigurerAdapter {

    @Bean
    public AuthenticationManager customAuthenticationManager() throws Exception {
        return authenticationManager();
    }

}
</code></pre>

<p>And now I have exception:</p>

<pre><code>Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.springframework.security.authentication.AuthenticationManager org.com.example.configuration.security.WebSecurityConfig.authenticationManager; nested exception is org.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name 'customAuthenticationManager': Requested bean is currently in creation: Is there an unresolvable circular reference?
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:508)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:289)
    ... 100 more
Caused by: org.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name 'customAuthenticationManager': Requested bean is currently in creation: Is there an unresolvable circular reference?
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.beforeSingletonCreation(DefaultSingletonBeanRegistry.java:335)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:298)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1017)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:960)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:858)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:480)
</code></pre>

<p>This exception in OAuth2AuthorizationConfiguration class.</p>
",2114952,,-1,,2017-05-23 10:34:05,2018-05-08 10:15:38,Could not autowire field: private org.springframework.security.authentication.AuthenticationManager,<java><spring><spring-mvc><spring-security><spring-boot>,3,1,3,
Spring,42867921,1,,,2017,,4,931,"<p>I created a simple authorization server, but cannot configure it. </p>

<ol>
<li>Start both apps (8080 is for auth server and 9999 is for client).</li>
<li>Go to <code>localhost:9999/client</code> and get redirected to <code>localhost:8080/login</code> (as expected).</li>
<li>Fill the login form with <em>user/user</em>.</li>
<li>Get redirected to <code>localhost:9999/client</code> (as expected), but have <code>Hello, null</code> instead of <code>Hello, user</code>.</li>
</ol>

<p>However, if I go straight to <code>localhost:8080/me</code>, I have <code>{""name"":""user""}</code>. How can I retrieve <code>Hello, user</code>?</p>

<p><strong>Authorization server</strong></p>

<pre><code>@RestController
@EnableAuthorizationServer
@SpringBootApplication
public class Application extends WebSecurityConfigurerAdapter {

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }

    @GetMapping({ ""/user"", ""/me"" })
    public Map&lt;String, String&gt; user(Principal principal) {
        return Collections.singletonMap(""name"", principal == null ? ""null"" : principal.getName());
    }

    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        auth.inMemoryAuthentication()
                .withUser(""user"").password(""user"").authorities(AuthorityUtils.NO_AUTHORITIES);
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.formLogin();
    }
}
</code></pre>

<p><strong>Application's properties</strong></p>

<pre><code>security:
  oauth2:
    client:
      client-id: clientid
      client-secret: clientsecret
      scope: read,write
      auto-approve-scopes: '.*'
</code></pre>

<p><strong>Client</strong></p>

<pre><code>@Configuration
@EnableAutoConfiguration
@EnableOAuth2Sso
@RestController
public class Client {

    @GetMapping(""/"")
    public String home(Principal principal) {
        return ""Hello, "" + principal.getName();
    }

    public static void main(String[] args) {
        new SpringApplicationBuilder(Client.class)
                .properties(""spring.config.name=client"").run(args);
    }

}
</code></pre>

<p><strong>Client's properties</strong></p>

<pre><code>server:
  port: 9999
  context-path: /client
security:
  oauth2:
    client:
      client-id: clientid
      client-secret: clientsecret
      access-token-uri: http://localhost:8080/oauth/token
      user-authorization-uri: http://localhost:8080/oauth/authorize
    resource:
      user-info-uri: http://localhost:8080/me
</code></pre>

<p><strong>UPDATE:</strong><br>
I downloaded <a href=""https://github.com/spring-guides/tut-spring-boot-oauth2/tree/master/auth-server"" rel=""nofollow noreferrer"">a tutorial</a> when all works, but it has <a href=""https://github.com/spring-guides/tut-spring-boot-oauth2/blob/master/auth-server/src/main/java/com/example/SocialApplication.java#L81"" rel=""nofollow noreferrer"">ssoFilter</a> that is only for OAuth2 authentication. I just want to configure it with <code>loginForm</code>.<br>
I have also shared a temporary <a href=""https://github.com/delverdev/login-server-example"" rel=""nofollow noreferrer"">example</a> on GitHub. I think it will be easier to look up the problem with it.</p>
",4725496,,4725496,,2017-03-27 3:09:46,2017-03-27 14:02:39,Spring cannot configure authorization server,<java><spring><spring-boot><spring-security><spring-security-oauth2>,4,3,3,
Spring,28702698,1,28721027,,2015,,2,3201,"<p>Getting startup issues for this <a href=""https://spring.io/guides/gs/accessing-data-gorm-mongodb/"" rel=""nofollow"">springboot project using MongoDB/GORM/Groovy</a> on <code>Java 1.7.0_55</code>, gradle <code>1.11</code>, and <code>spring-boot-gradle-plugin:1.2.1.RELEASE</code>.</p>

<p>I'm running the project <em>as-is</em> with the exception of the following change to <code>application.yml</code> for my remote mongodb:</p>

<pre><code>spring:
    mongodb:
        host: ""10.160.8.1""
        databaseName: ""citydb""
</code></pre>

<p>**On startup, I'm seeing this bean initialization error with <code>mappingMongoConverter</code> </p>

<pre><code>Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'mongoTemplate' defined in class path resource [org/springframework/boot/autoconfigure/mongo/MongoDataAutoConfiguration.class]:
Unsatisfied dependency expressed through constructor argument with index 1 of type [org.springframework.data.mongodb.core.convert.MongoConverter]: : Error creating bean with name 'mappingMongoConverter' defined in class path resource [org/springframework/boot/autoconfigure/mongo/MongoDataAutoConfiguration.class]:
Unsatisfied dependency expressed through constructor argument with index 1 of type [org.springframework.data.mongodb.core.mapping.MongoMappingContext]: : No qualifying bean of type [org.springframework.data.mongodb.core.mapping.MongoMapping
Context] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type [org.springframework.data.mongodb.core.mapping.MongoMappingCo
ntext] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'mappingMongoConverter' defined in class path resource [org
/springframework/boot/autoconfigure/mongo/MongoDataAutoConfiguration.class]: Unsatisfied dependency expressed through constructor argument with index 1 of typ
e [org.springframework.data.mongodb.core.mapping.MongoMappingContext]: : No qualifying bean of type [org.springframework.data.mongodb.core.mapping.MongoMappin
gContext] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}; nested excepti
on is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type [org.springframework.data.mongodb.core.mapping.MongoMappingC
ontext] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}
</code></pre>

<p><strong>I think this is the main issue:</strong></p>

<pre><code>Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'mappingMongoConverter' defined in class path resou
rce [org/springframework/boot/autoconfigure/mongo/MongoDataAutoConfiguration.class]: Unsatisfied dependency expressed through constructor argument with index
1 of type [org.springframework.data.mongodb.core.mapping.MongoMappingContext]: : No qualifying bean of type [org.springframework.data.mongodb.core.mapping.Mon
goMappingContext] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}; nested
 exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type [org.springframework.data.mongodb.core.mapping.Mongo
MappingContext] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}
        at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:749)
        at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:464)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:
1111)
</code></pre>

<p>Could this be a GORM dependency issue? I'm using the latest, <code>org.grails:gorm-mongodb-spring-boot:1.1.0.RELEASE</code></p>

<p>Tracked as issue on github: <a href=""https://github.com/spring-guides/gs-accessing-data-gorm-mongodb/issues/6"" rel=""nofollow"">https://github.com/spring-guides/gs-accessing-data-gorm-mongodb/issues/6</a></p>
",791406,,791406,,2015-02-25 14:01:06,2018-02-21 18:58:43,springboot initialization error on startup with mongodb on gorm/groovy,<spring><mongodb><groovy><gorm><spring-boot>,1,0,2,
Spring,31730050,1,31760587,,2015,,5,1038,"<p>We've noticed in our that SOAP web-services seem to run faster when run as</p>

<pre><code>spring-boot:run
</code></pre>

<p>as opposed to packaging up the JAR as we do for deployment and running</p>

<pre><code>java -jar mySpringApp.jar
</code></pre>

<p>The speed up is in the order of 2-3x so obviously we would like this for our live environment.</p>

<p>To validate that this wasn't something in our app I've tried this with the sample app from the <a href=""https://spring.io/guides/gs/producing-web-service/"" rel=""noreferrer"">spring guide</a></p>

<p>git source <a href=""https://github.com/spring-guides/gs-soap-service.git"" rel=""noreferrer"">https://github.com/spring-guides/gs-soap-service.git</a></p>

<p>Testing this with JMeter shows the same sort of speed up.  I've tested this on both Windows 7 Java 1.8.0_31 and Ubuntu 14.04 platforms with 1.8.0_45-b14.</p>

<p>This only seems to be the case for soap services, simple html doesn't show any significant difference in performance.  Any idea what could be causing this?</p>
",3702362,,3702362,,2015-07-31 8:21:54,2015-08-01 9:59:49,spring-boot-starter-ws performance when run as jar,<spring><maven><soap><spring-boot><spring-ws>,1,4,2,
Spring,36705874,1,,,2016,,7,3608,"<p>I am studying Spring Cloud and Spring OAuth2 by decomposing <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2"" rel=""nofollow"">the three interconnected apps in this GitHub sample</a>.  When I open up the <code>/oauth/revoke-token</code> endpoint in the <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2/authserver"" rel=""nofollow""><code>authserver</code> app</a> and then call it from the <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2/ui"" rel=""nofollow""><code>ui</code> app</a> with a <code>http://localhost:9999/uaa/logout</code>, the debug log for the <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2/authserver"" rel=""nofollow""><code>authserver</code> app</a> gives the following error message while rejecting the logout request:</p>

<pre><code>Request 'OPTIONS /logout' doesn't match 'POST /logout
</code></pre>

<p><strong>What specific changes need to be made to the code in <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2"" rel=""nofollow"">the sample GitHub apps</a> in order to enable the global logout to succeed when the <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2/ui"" rel=""nofollow""><code>ui</code> app</a> calls the logout function from <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/blob/master/oauth2/ui/src/main/resources/static/js/hello.js"" rel=""nofollow""><code>hello.js</code></a>?</strong></p>

<hr/>

<p><strong>INITIAL EFFORTS:</strong></p>

<hr/>

<p>Changes that I made so far include:  </p>

<p>Add the following @Bean definition to <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/blob/master/oauth2/authserver/src/main/java/demo/AuthserverApplication.java"" rel=""nofollow"">AuthserverApplication.java</a>:  </p>

<pre><code>@Bean
public TokenStore tokenStore() {return new InMemoryTokenStore();}
</code></pre>

<p>Add the following controller class in the <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2/authserver/src/main/java/demo"" rel=""nofollow""><code>demo</code> package of the <code>authserver</code> app</a>:  </p>

<pre><code>@Configuration
public class AuthorizationServerConfiguration extends AuthorizationServerConfigurerAdapter {

    @Autowired
    TokenStore tokenStore;

    @Override
    public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {
        endpoints.tokenStore(tokenStore);
    }

    @RequestMapping(value = ""/oauth/revoke-token"", method = RequestMethod.GET)
    @ResponseStatus(HttpStatus.OK)
    public void logout(HttpServletRequest request) {
        String authHeader = request.getHeader(""Authorization"");
        if (authHeader != null) {
            String tokenValue = authHeader.replace(""Bearer"", """").trim();
            OAuth2AccessToken accessToken = tokenStore.readAccessToken(tokenValue);
            tokenStore.removeAccessToken(accessToken);
        }
    }
}
</code></pre>

<p>Change the <code>logout()</code> method of <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/blob/master/oauth2/ui/src/main/resources/static/js/hello.js"" rel=""nofollow""><code>hello.js</code> in the <code>ui</code> app</a> to become the following:  </p>

<pre><code>self.logout = function() {
    $http.post('http://localhost:9999/uaa/logout', {}).finally(function() {
        $rootScope.authenticated = false;
        $location.path(""/"");
    });
}
</code></pre>

<p>But when the user clicks on the logout button in the browser and triggers the call to <code>http://localhost:9999/uaa/logout</code>, the debug log for the <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2/authserver"" rel=""nofollow""><code>authserver</code></a> app gives the following output:  </p>

<pre><code>2016-04-18 15:34:07.142 DEBUG 313 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/css/**']
2016-04-18 15:34:07.142 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/css/**'
2016-04-18 15:34:07.142 DEBUG 313 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/js/**']
2016-04-18 15:34:07.142 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/js/**'
2016-04-18 15:34:07.142 DEBUG 313 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/images/**']
2016-04-18 15:34:07.142 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/images/**'
2016-04-18 15:34:07.142 DEBUG 313 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/**/favicon.ico']
2016-04-18 15:34:07.142 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/**/favicon.ico'
2016-04-18 15:34:07.142 DEBUG 313 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/error']
2016-04-18 15:34:07.142 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/error'
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : No matches found
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/login']
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/login'
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/oauth/authorize']
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/oauth/authorize'
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/oauth/confirm_access']
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/oauth/confirm_access'

2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/logout']
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/logout'
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : matched

2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout at position 1 of 12 in additional filter chain; firing Filter: 'WebAsyncManagerIntegrationFilter'
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout at position 2 of 12 in additional filter chain; firing Filter: 'SecurityContextPersistenceFilter'
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] w.c.HttpSessionSecurityContextRepository : No HttpSession currently exists
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] w.c.HttpSessionSecurityContextRepository : No SecurityContext was available from the HttpSession: null. A new one will be created.
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout at position 3 of 12 in additional filter chain; firing Filter: 'HeaderWriterFilter'
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.header.writers.HstsHeaderWriter  : Not injecting HSTS header since it did not match the requestMatcher org.springframework.security.web.header.writers.HstsHeaderWriter$SecureRequestMatcher@5790c1b4
2016-04-18 15:34:07.143 DEBUG 313 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout at position 4 of 12 in additional filter chain; firing Filter: 'CsrfFilter'
2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout at position 5 of 12 in additional filter chain; firing Filter: 'LogoutFilter'

2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Request 'OPTIONS /logout' doesn't match 'POST /logout
2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout at position 6 of 12 in additional filter chain; firing Filter: 'UsernamePasswordAuthenticationFilter'

2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Request 'OPTIONS /logout' doesn't match 'POST /login
2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout at position 7 of 12 in additional filter chain; firing Filter: 'RequestCacheAwareFilter'
2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout at position 8 of 12 in additional filter chain; firing Filter: 'SecurityContextHolderAwareRequestFilter'
2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout at position 9 of 12 in additional filter chain; firing Filter: 'AnonymousAuthenticationFilter'
2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.a.AnonymousAuthenticationFilter  : Populated SecurityContextHolder with anonymous token: 'org.springframework.security.authentication.AnonymousAuthenticationToken@9055e4a6: Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@957e: RemoteIpAddress: 127.0.0.1; SessionId: null; Granted Authorities: ROLE_ANONYMOUS'
2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout at position 10 of 12 in additional filter chain; firing Filter: 'SessionManagementFilter'
2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout at position 11 of 12 in additional filter chain; firing Filter: 'ExceptionTranslationFilter'
2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout at position 12 of 12 in additional filter chain; firing Filter: 'FilterSecurityInterceptor'
2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.a.i.FilterSecurityInterceptor    : Secure object: FilterInvocation: URL: /logout; Attributes: [authenticated]
2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.a.i.FilterSecurityInterceptor    : Previously Authenticated: org.springframework.security.authentication.AnonymousAuthenticationToken@9055e4a6: Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@957e: RemoteIpAddress: 127.0.0.1; SessionId: null; Granted Authorities: ROLE_ANONYMOUS
2016-04-18 15:34:07.144 DEBUG 313 --- [io-9999-exec-10] o.s.s.access.vote.AffirmativeBased       : Voter: org.springframework.security.web.access.expression.WebExpressionVoter@539015a, returned: -1
2016-04-18 15:34:07.145 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.a.ExceptionTranslationFilter     : Access is denied (user is anonymous); redirecting to authentication entry point

org.springframework.security.access.AccessDeniedException: Access is denied
    at org.springframework.security.access.vote.AffirmativeBased.decide(AffirmativeBased.java:83) ~[spring-security-core-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.access.intercept.AbstractSecurityInterceptor.beforeInvocation(AbstractSecurityInterceptor.java:232) ~[spring-security-core-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:123) ~[spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:90) ~[spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:114) ~[spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:122) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:169) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:48) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:205) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:120) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.csrf.CsrfFilter.doFilterInternal(CsrfFilter.java:96) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.2.5.RELEASE.jar:4.2.5.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:64) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.2.5.RELEASE.jar:4.2.5.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:91) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:53) [spring-security-web-4.0.3.RELEASE.jar:4.0.3.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.2.5.RELEASE.jar:4.2.5.RELEASE]
    ...  
    at java.lang.Thread.run(Thread.java:745) [na:1.8.0_45]

2016-04-18 15:34:07.146 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.util.matcher.AndRequestMatcher   : Trying to match using Ant [pattern='/**', GET]
2016-04-18 15:34:07.146 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Request 'OPTIONS /logout' doesn't match 'GET /**
2016-04-18 15:34:07.146 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.util.matcher.AndRequestMatcher   : Did not match
2016-04-18 15:34:07.146 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.s.HttpSessionRequestCache        : Request not saved as configured RequestMatcher did not match
2016-04-18 15:34:07.146 DEBUG 313 --- [io-9999-exec-10] o.s.s.w.a.ExceptionTranslationFilter     : Calling Authentication entry point.
2016-04-18 15:34:07.146 DEBUG 313 --- [io-9999-exec-10] o.s.s.web.DefaultRedirectStrategy        : Redirecting to 'http://localhost:9999/uaa/login'
2016-04-18 15:34:07.147 DEBUG 313 --- [io-9999-exec-10] w.c.HttpSessionSecurityContextRepository : SecurityContext is empty or contents are anonymous - context will not be stored in HttpSession.
2016-04-18 15:34:07.147 DEBUG 313 --- [io-9999-exec-10] s.s.w.c.SecurityContextPersistenceFilter : SecurityContextHolder now cleared, as request processing completed
</code></pre>

<p><strong>What other specific code changes need to be changed in <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2"" rel=""nofollow"">the GitHub sample apps</a> to enable the <code>ui</code> app to trigger a global logout of the user from all apps?</strong>  </p>

<p>Note: Obviously, <code>/uaa/logout</code> is a different URL than <code>/oauth/revoke-token</code>.  However, the inner workings of Spring Security and OAuth in this situation are not clear without an answer to this OP.  </p>

<hr/>

<p><strong>@StuXnet's Suggestions:</strong>  </p>

<hr/>

<p>The content of the Firefox Developer Tools Network Tab for the request is:  </p>

<p>The request to <code>http : // localhost:9999/uaa/login</code> with method <code>OPTIONS</code> was rejected with a <code>403</code> error.  </p>

<p>The raw <code>request</code> headers were:  </p>

<pre><code>Host: localhost:9999
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101 Firefox/38.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Origin: http://localhost:8080
Access-Control-Request-Method: POST
Access-Control-Request-Headers: content-type,x-requested-with
Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache
</code></pre>

<p>The raw <code>response</code> headers were:  </p>

<pre><code>Allow: GET, HEAD, POST, PUT, DELETE, TRACE, OPTIONS, PATCH
Content-Length: 20
Date: Mon, 18 Apr 2016 23:45:46 GMT
Server: Apache-Coyote/1.1
X-Application-Context: application:9999
</code></pre>

<p>Next, I changed the config(http) method of LoginConfig to read as follows:  </p>

<pre><code>@Override
protected void configure(HttpSecurity http) throws Exception {
    // @formatter:off
    http
        .formLogin().loginPage(""/login"").permitAll()
        .and()
        .requestMatchers().antMatchers(""/login"", ""/oauth/authorize"", ""/oauth/confirm_access"", ""/logout"", ""/oauth/revoke-token"")
        .and()
        .authorizeRequests()
        .antMatchers(HttpMethod.OPTIONS,""/logout"").permitAll()
        .anyRequest().authenticated();
        // @formatter:on
}
</code></pre>

<p>This resulted in the following new printout in the Spring Boot DEBUG logs:  </p>

<pre><code>2016-04-18 19:22:06.202 DEBUG 5319 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/css/**']
2016-04-18 19:22:06.202 DEBUG 5319 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/css/**'
2016-04-18 19:22:06.202 DEBUG 5319 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/js/**']
2016-04-18 19:22:06.202 DEBUG 5319 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/js/**'
2016-04-18 19:22:06.202 DEBUG 5319 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/images/**']
2016-04-18 19:22:06.202 DEBUG 5319 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/images/**'
2016-04-18 19:22:06.202 DEBUG 5319 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/**/favicon.ico']
2016-04-18 19:22:06.202 DEBUG 5319 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/**/favicon.ico'
2016-04-18 19:22:06.202 DEBUG 5319 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/error']
2016-04-18 19:22:06.202 DEBUG 5319 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/error'
2016-04-18 19:22:06.202 DEBUG 5319 --- [io-9999-exec-10] o.s.s.web.util.matcher.OrRequestMatcher  : No matches found
2016-04-18 19:22:06.203 DEBUG 5319 --- [io-9999-exec-10] o.s.s.w.u.matcher.AntPathRequestMatcher  : Request '/logout' matched by universal pattern '/**'
2016-04-18 19:22:06.203 DEBUG 5319 --- [io-9999-exec-10] o.s.security.web.FilterChainProxy        : /logout has an empty filter list
2016-04-18 19:22:06.204 DEBUG 5319 --- [io-9999-exec-10] .s.o.p.e.FrameworkEndpointHandlerMapping : Looking up handler method for path /logout
2016-04-18 19:22:06.205 DEBUG 5319 --- [io-9999-exec-10] .s.o.p.e.FrameworkEndpointHandlerMapping : Did not find handler method for [/logout]
</code></pre>

<p>And the following <code>request</code> header in Firefox:  </p>

<pre><code>Host: localhost:9999
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101 Firefox/38.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Origin: http://localhost:8080
Access-Control-Request-Method: POST
Access-Control-Request-Headers: content-type,x-requested-with
Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache
</code></pre>

<p>Along with the following <code>response</code> header in Firefox:  </p>

<pre><code>Allow: GET, HEAD, POST, PUT, DELETE, TRACE, OPTIONS, PATCH
Content-Length: 20
Date: Tue, 19 Apr 2016 02:22:06 GMT
Server: Apache-Coyote/1.1
X-Application-Context: application:9999
</code></pre>

<p>I then tried changing the <code>configure(http)</code> method of <code>LoginConfig</code> to become:  </p>

<pre><code>@Override
protected void configure(HttpSecurity http) throws Exception {
    // @formatter:off
    http
        .formLogin().loginPage(""/login"").permitAll()
        .and()
        .requestMatchers().antMatchers(""/login"", ""/oauth/authorize"", ""/oauth/confirm_access"", ""/logout"", ""/oauth/revoke-token"")
        .and()
        .authorizeRequests()
        .anyRequest().authenticated()
        // @formatter:on
        .and()
        .csrf()
        .ignoringAntMatchers(""/logout"");
}
</code></pre>

<p>But the result is the following Spring Boot DEBUG log for the <code>authserver</code> app:  </p>

<pre><code>2016-04-19 10:12:13.545 DEBUG 4593 --- [nio-9999-exec-2] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/css/**']
2016-04-19 10:12:13.546 DEBUG 4593 --- [nio-9999-exec-2] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/css/**'
2016-04-19 10:12:13.546 DEBUG 4593 --- [nio-9999-exec-2] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/js/**']
2016-04-19 10:12:13.546 DEBUG 4593 --- [nio-9999-exec-2] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/js/**'
2016-04-19 10:12:13.546 DEBUG 4593 --- [nio-9999-exec-2] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/images/**']
2016-04-19 10:12:13.546 DEBUG 4593 --- [nio-9999-exec-2] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/images/**'
2016-04-19 10:12:13.546 DEBUG 4593 --- [nio-9999-exec-2] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/**/favicon.ico']
2016-04-19 10:12:13.546 DEBUG 4593 --- [nio-9999-exec-2] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/**/favicon.ico'
2016-04-19 10:12:13.546 DEBUG 4593 --- [nio-9999-exec-2] o.s.s.web.util.matcher.OrRequestMatcher  : Trying to match using Ant [pattern='/error']
2016-04-19 10:12:13.546 DEBUG 4593 --- [nio-9999-exec-2] o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/logout'; against '/error'
2016-04-19 10:12:13.546 DEBUG 4593 --- [nio-9999-exec-2] o.s.s.web.util.matcher.OrRequestMatcher  : No matches found
2016-04-19 10:12:13.546 DEBUG 4593 --- [nio-9999-exec-2] o.s.s.w.u.matcher.AntPathRequestMatcher  : Request '/logout' matched by universal pattern '/**'
2016-04-19 10:12:13.546 DEBUG 4593 --- [nio-9999-exec-2] o.s.security.web.FilterChainProxy        : /logout has an empty filter list
2016-04-19 10:12:13.547 DEBUG 4593 --- [nio-9999-exec-2] .s.o.p.e.FrameworkEndpointHandlerMapping : Looking up handler method for path /logout
2016-04-19 10:12:13.548 DEBUG 4593 --- [nio-9999-exec-2] .s.o.p.e.FrameworkEndpointHandlerMapping : Did not find handler method for [/logout]
</code></pre>

<hr>

<p><strong>REPRODUCING THE PROBLEM ON YOUR MACHINE:</strong>  </p>

<hr>

<p>To reproduce the problem on your own machine, you can either:  </p>

<p>1.) git clone the original sample app at the link at the top of the OP and then make the changes shown above, or </p>

<p>2.) Download <a href=""https://jumpshare.com/v/ELVSYNXNeUKV6Xl1Droq"" rel=""nofollow"">the zipped version of the app as it exists on my devbox including all the changes from the OP at this file sharing link</a>, and then:  </p>

<p>2.a.) Untar the app.  </p>

<p>2.b.) Navigate a terminal window to <code>oauth2/resource</code> and <code>mvn spring-boot:run</code>.  Then navigate a second terminal window to <code>oauth2/authserver</code> and type <code>mvn spring-boot:run</code>.  Then navigate a third terminal window to <code>oauth2/ui</code> and type <code>mvn spring-boot:run</code>.  </p>

<p>2.c.) Navigate the web browser to <code>http : // localhost:8080</code>, then click <code>login</code>, then enter <code>user</code> for <code>username</code> and <code>password</code> for <code>password</code>.  After you have been authenticated, click the <code>logout</code> button to reproduce the 403 error.  Use the Network tab of your browser's developer tools to examine the browser activity.  View the Spring Boot logs in the terminal that is running the <code>authserver</code> app to see Spring's activity.  </p>

<p>3.) Either import the three folders into eclipse (or another IDE) as existing maven projects, or open the code files with a text editor to edit before repeating the relaunch and retesting in step 2.  </p>

<p><strong>What else can I provide to help isolate the solution?</strong></p>
",807797,,807797,,2016-04-20 19:42:10,2016-08-25 8:37:48,Request 'OPTIONS /logout' doesn't match 'POST /logout,<spring><spring-security><spring-boot><spring-cloud><spring-oauth2>,1,6,2,
Spring,43374658,1,43678846,,2017,,1,897,"<p>I am using <code>@EnableOauth2Sso</code> following an architecture similar as the one described in Spring's <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2-vanilla"" rel=""nofollow noreferrer"">oauth2 tutorial</a>: an auth server, a zuul proxy that enables the sso, a separated UI application etc.</p>

<pre><code>Auth server   ----  Resource Server (Zuul app) ---- Angular UI App
</code></pre>

<p>The problem is that when the UI logs out against the resource server it successfully deletes the resource server JSESSIONID, then the user is redirected to a home page. When the user wants to login again, he's redirected to the auth server but instead of asking for the user+password, it considers he's still logged. The auth server JSESSIONID is still there and wasn't affected by the previous Resource Server lougout.</p>

<p>How could I also logout from the auth server?</p>
",1729795,,,,,2017-04-28 11:12:59,Spring Oauth2 SSO - Unable to logout from the Auth server,<angularjs><spring><spring-security><oauth-2.0><spring-security-oauth2>,2,0,2,
Spring,20168563,1,20187597,,2013,,5,7231,"<p>I'm using spring-boot (I'm following <a href=""http://spring.io/guides/gs/rest-service/"" rel=""noreferrer"">this tutorial</a>), the current code is <a href=""https://github.com/spring-guides/gs-rest-service/tree/master/complete"" rel=""noreferrer"">here</a>.</p>

<p>My application is configured via <code>@EnableAutoConfiguration</code>, so I don't have <code>web.xml</code>, or other configuration files.
The application has a default handler for <code>/**</code>, files from <code>projectRoot/src/main/webapp/</code> are served, but unfortunately with <code>Content-Type: text/html;charset=ISO-8859-1</code>. I'd like to serve (<code>html</code> files) with <code>UTF-8</code> charset.</p>

<p>The static files are served by spring too, as far as I know: after launching the application, the following line apprears in the log: <code>Mapped URL path [/**] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]</code> (github.com/spring-projects/spring-boot/blob/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/WebMvcAutoConfiguration.java#L182, sorry, I cannot post more than 2 links)</p>

<p>Putting <code>&lt;meta charset=""utf-8"" /&gt;</code> or <code>&lt;meta http-equiv=""Content-Type: text/html;charset=utf-8"" /&gt;</code> into the served <code>html</code> file has no effect.</p>

<p>How can I serve <code>*.html</code> files with <code>UTF-8</code> charset?</p>

<p>The debug log is the following:</p>

<pre><code>  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::             (v0.5.0.M6)

2013-11-24 00:48:41.327  INFO 15786 --- [           main] hello.Application                        : Starting Application on ubuntu with PID 15786 (/home/lennon/bme/szoftarch/szoftarch-2013-osz/build/libs/gs-rest-service-0.1.0.jar started by lennon)
2013-11-24 00:48:41.331 DEBUG 15786 --- [           main] o.s.boot.SpringApplication               : Loading source class hello.Application
2013-11-24 00:48:41.380  INFO 15786 --- [           main] ationConfigEmbeddedWebApplicationContext : Refreshing org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@7455ffcd: startup date [Sun Nov 24 00:48:41 CET 2013]; root of context hierarchy
2013-11-24 00:48:41.385 DEBUG 15786 --- [           main] ationConfigEmbeddedWebApplicationContext : Bean factory for org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@7455ffcd: org.springframework.beans.factory.support.DefaultListableBeanFactory@54cb8484: defining beans [org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,application]; root of factory hierarchy
2013-11-24 00:48:42.179 DEBUG 15786 --- [           main] ationConfigEmbeddedWebApplicationContext : Using MessageSource [org.springframework.context.support.ResourceBundleMessageSource: basenames=[messages]]
2013-11-24 00:48:42.182 DEBUG 15786 --- [           main] ationConfigEmbeddedWebApplicationContext : Unable to locate ApplicationEventMulticaster with name 'applicationEventMulticaster': using default [org.springframework.context.event.SimpleApplicationEventMulticaster@5d36368]
2013-11-24 00:48:42.518 DEBUG 15786 --- [           main] .t.TomcatEmbeddedServletContainerFactory : Code archive: /home/lennon/bme/szoftarch/szoftarch-2013-osz/build/libs/gs-rest-service-0.1.0.jar
2013-11-24 00:48:42.518 DEBUG 15786 --- [           main] .t.TomcatEmbeddedServletContainerFactory : Code archive: /home/lennon/bme/szoftarch/szoftarch-2013-osz/build/libs/gs-rest-service-0.1.0.jar
2013-11-24 00:48:42.518 DEBUG 15786 --- [           main] .t.TomcatEmbeddedServletContainerFactory : Document root: /home/lennon/bme/szoftarch/szoftarch-2013-osz/src/main/webapp
2013-11-24 00:48:42.904  INFO 15786 --- [           main] o.apache.catalina.core.StandardService   : Starting service Tomcat
2013-11-24 00:48:42.905  INFO 15786 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/7.0.42
2013-11-24 00:48:43.006  INFO 15786 --- [ost-startStop-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2013-11-24 00:48:43.007  INFO 15786 --- [ost-startStop-1] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 1630 ms
2013-11-24 00:48:43.259  INFO 15786 --- [ost-startStop-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring FrameworkServlet 'dispatcherServlet'
2013-11-24 00:48:43.260  INFO 15786 --- [ost-startStop-1] o.s.web.servlet.DispatcherServlet        : FrameworkServlet 'dispatcherServlet': initialization started
2013-11-24 00:48:43.428  INFO 15786 --- [ost-startStop-1] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [/**/favicon.ico] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
2013-11-24 00:48:43.717  INFO 15786 --- [ost-startStop-1] s.w.s.m.m.a.RequestMappingHandlerMapping : Mapped ""{[/greeting],methods=[],params=[],headers=[],consumes=[],produces=[],custom=[]}"" onto public hello.Greeting hello.GreetingController.greeting(java.lang.String)
2013-11-24 00:48:43.725  INFO 15786 --- [ost-startStop-1] o.s.w.s.c.a.WebMvcConfigurerAdapter      : Adding welcome page: jndi:/localhost/index.html
2013-11-24 00:48:43.732  INFO 15786 --- [ost-startStop-1] o.s.w.s.handler.SimpleUrlHandlerMapping  : Root mapping to handler of type [class org.springframework.web.servlet.mvc.ParameterizableViewController]
2013-11-24 00:48:43.811  INFO 15786 --- [ost-startStop-1] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [/**] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
2013-11-24 00:48:43.812  INFO 15786 --- [ost-startStop-1] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [/webjars/**] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
2013-11-24 00:48:44.489  INFO 15786 --- [ost-startStop-1] o.s.web.servlet.DispatcherServlet        : FrameworkServlet 'dispatcherServlet': initialization completed in 1229 ms
2013-11-24 00:48:44.641 DEBUG 15786 --- [           main] ationConfigEmbeddedWebApplicationContext : Unable to locate LifecycleProcessor with name 'lifecycleProcessor': using default [org.springframework.context.support.DefaultLifecycleProcessor@10d6fc05]
2013-11-24 00:48:44.644 DEBUG 15786 --- [           main] nitializer$AutoConfigurationReportLogger : 


=========================
AUTO-CONFIGURATION REPORT
=========================


Positive matches:
-----------------

   MessageSourceAutoConfiguration
      - @ConditionalOnMissingBean (types: org.springframework.context.MessageSource; SearchStrategy: all) found no beans (OnBeanCondition)

   PropertyPlaceholderAutoConfiguration#propertySourcesPlaceholderConfigurer
      - @ConditionalOnMissingBean (types: org.springframework.context.support.PropertySourcesPlaceholderConfigurer; SearchStrategy: current) found no beans (OnBeanCondition)

   DispatcherServletAutoConfiguration
      - found web application StandardServletEnvironment (OnWebApplicationCondition)
      - @ConditionalOnClass classes found: org.springframework.web.servlet.DispatcherServlet (OnClassCondition)
      - found web application StandardServletEnvironment (OnWebApplicationCondition)
      - @ConditionalOnClass classes found: org.springframework.web.servlet.DispatcherServlet (OnClassCondition)
      - @ConditionalOnBean (types: org.springframework.boot.context.embedded.EmbeddedServletContainerFactory; SearchStrategy: all) found the following [tomcatEmbeddedServletContainerFactory] (OnBeanCondition)

   DispatcherServletAutoConfiguration#dispatcherServlet
      - no DispatcherServlet found (DispatcherServletAutoConfiguration.DefaultDispatcherServletCondition)

   EmbeddedServletContainerAutoConfiguration
      - found web application StandardServletEnvironment (OnWebApplicationCondition)
      - found web application StandardServletEnvironment (OnWebApplicationCondition)

   EmbeddedServletContainerAutoConfiguration.EmbeddedTomcat
      - @ConditionalOnClass classes found: javax.servlet.Servlet,org.apache.catalina.startup.Tomcat (OnClassCondition)
      - @ConditionalOnClass classes found: javax.servlet.Servlet,org.apache.catalina.startup.Tomcat (OnClassCondition)
      - @ConditionalOnMissingBean (types: org.springframework.boot.context.embedded.EmbeddedServletContainerFactory; SearchStrategy: current) found no beans (OnBeanCondition)

   ServerPropertiesAutoConfiguration#serverProperties
      - @ConditionalOnMissingBean (types: org.springframework.boot.context.embedded.properties.ServerProperties; SearchStrategy: all) found no beans (OnBeanCondition)

   WebMvcAutoConfiguration
      - found web application StandardServletEnvironment (OnWebApplicationCondition)
      - @ConditionalOnClass classes found: javax.servlet.Servlet,org.springframework.web.servlet.DispatcherServlet,org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter (OnClassCondition)
      - found web application StandardServletEnvironment (OnWebApplicationCondition)
      - @ConditionalOnClass classes found: javax.servlet.Servlet,org.springframework.web.servlet.DispatcherServlet,org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter (OnClassCondition)
      - @ConditionalOnMissingBean (types: org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport; SearchStrategy: all) found no beans (OnBeanCondition)

   WebMvcAutoConfiguration#hiddenHttpMethodFilter
      - @ConditionalOnMissingBean (types: org.springframework.web.filter.HiddenHttpMethodFilter; SearchStrategy: all) found no beans (OnBeanCondition)

   WebMvcAutoConfiguration.WebMvcAutoConfigurationAdapter#defaultViewResolver
      - @ConditionalOnMissingBean (types: org.springframework.web.servlet.view.InternalResourceViewResolver; SearchStrategy: all) found no beans (OnBeanCondition)


Negative matches:
-----------------

   RabbitAutoConfiguration
      - required @ConditionalOnClass classes not found: org.springframework.amqp.rabbit.core.RabbitTemplate,com.rabbitmq.client.Channel (OnClassCondition)

   AopAutoConfiguration
      - required @ConditionalOnClass classes not found: org.aspectj.lang.annotation.Aspect,org.aspectj.lang.reflect.Advice (OnClassCondition)

   BatchAutoConfiguration
      - required @ConditionalOnClass classes not found: org.springframework.batch.core.launch.JobLauncher (OnClassCondition)

   JpaRepositoriesAutoConfiguration
      - required @ConditionalOnClass classes not found: org.springframework.data.jpa.repository.JpaRepository (OnClassCondition)

   MongoRepositoriesAutoConfiguration
      - required @ConditionalOnClass classes not found: com.mongodb.Mongo,org.springframework.data.mongodb.repository.MongoRepository (OnClassCondition)

   DataSourceAutoConfiguration
      - required @ConditionalOnClass classes not found: org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseType (OnClassCondition)

   DataSourceTransactionManagerAutoConfiguration
      - required @ConditionalOnClass classes not found: org.springframework.jdbc.core.JdbcTemplate,org.springframework.transaction.PlatformTransactionManager (OnClassCondition)

   JmsTemplateAutoConfiguration
      - required @ConditionalOnClass classes not found: org.springframework.jms.core.JmsTemplate,javax.jms.ConnectionFactory (OnClassCondition)

   DeviceResolverAutoConfiguration
      - required @ConditionalOnClass classes not found: org.springframework.mobile.device.DeviceResolverHandlerInterceptor,org.springframework.mobile.device.DeviceHandlerMethodArgumentResolver (OnClassCondition)

   HibernateJpaAutoConfiguration
      - required @ConditionalOnClass classes not found: org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean,org.springframework.transaction.annotation.EnableTransactionManagement,javax.persistence.EntityManager,org.hibernate.ejb.HibernateEntityManager (OnClassCondition)

   ReactorAutoConfiguration
      - required @ConditionalOnClass classes not found: reactor.spring.context.config.EnableReactor (OnClassCondition)

   ThymeleafAutoConfiguration
      - required @ConditionalOnClass classes not found: org.thymeleaf.spring3.SpringTemplateEngine (OnClassCondition)

   EmbeddedServletContainerAutoConfiguration.EmbeddedJetty
      - required @ConditionalOnClass classes not found: org.eclipse.jetty.server.Server,org.eclipse.jetty.util.Loader (OnClassCondition)

   MultipartAutoConfiguration
      - @ConditionalOnClass classes found: javax.servlet.Servlet,org.springframework.web.multipart.support.StandardServletMultipartResolver (OnClassCondition)
      - @ConditionalOnClass classes found: javax.servlet.Servlet,org.springframework.web.multipart.support.StandardServletMultipartResolver (OnClassCondition)
      - @ConditionalOnBean (types: javax.servlet.MultipartConfigElement; SearchStrategy: all) found no beans (OnBeanCondition)

   WebMvcAutoConfiguration.WebMvcAutoConfigurationAdapter#beanNameViewResolver
      - @ConditionalOnBean (types: org.springframework.web.servlet.View; SearchStrategy: all) found no beans (OnBeanCondition)

   WebMvcAutoConfiguration.WebMvcAutoConfigurationAdapter#viewResolver
      - @ConditionalOnBean (types: org.springframework.web.servlet.View; SearchStrategy: all) found no beans (OnBeanCondition)

   WebSocketAutoConfiguration
      - required @ConditionalOnClass classes not found: org.springframework.web.socket.WebSocketHandler (OnClassCondition)

2013-11-24 00:48:44.650  INFO 15786 --- [           main] hello.Application                        : Started Application in 4.125 seconds
</code></pre>
",2288351,,2288351,,2013-11-23 23:54:35,2013-11-25 8:16:19,Spring-boot UTF-8 resources,<java><spring><utf-8><spring-boot>,2,5,2,
Spring,34606760,1,34619077,,2016,,8,14125,"<p>Given a Spring Boot + Thymeleaf web application (this is nearly identical to the Spring project's <a href=""https://github.com/spring-guides/gs-securing-web/tree/master/initial"" rel=""noreferrer"">gs-consuming-rest ""initial"" code tree</a>):</p>

<pre class=""lang-none prettyprint-override""><code>├── pom.xml
└── src
    ├── main
    │   ├── java
    │   │   └── hello
    │   │       ├── Application.java
    │   │       ├── Config.java
    │   │       └── Controller.java
    │   └── resources
    │       └── templates
    │           └── index.html
    └── test
        └── java
            └── hello
                └── ControllerTest.java
</code></pre>

<p>...the user is greeted just fine with ""Hello World!"" at <code>http://localhost:8080/</code>, but the wiring of Spring's ""context"" does not seem to apply within the integration test (<code>ControllerTest.java</code>):</p>

<pre class=""lang-none prettyprint-override""><code>java.lang.AssertionError: Status 
Expected :200
Actual   :404
</code></pre>

<p>What is wrong with the <strong>project layout</strong>, and/or the <strong>configuration annotations</strong> in the test?</p>

<p><em><code>src/main/webapp/</code> is intentionally missing, along with things like <code>web.xml</code> and <code>WEB-INF/</code>.  The goal here is to use minimal configuration, with an integration test to test-drive the development of the view and controller of the application.</em></p>

<p>Gory details below.  Sorry in advance for the ""wall of text.""</p>

<hr>

<h3>pom.xml</h3>

<pre class=""lang-xml prettyprint-override""><code>&lt;parent&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
    &lt;version&gt;1.3.1.RELEASE&lt;/version&gt;
&lt;/parent&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>

<h3>Application.java</h3>

<pre class=""lang-java prettyprint-override""><code>package hello;

// ...

@SpringBootApplication
public class Application {

  public static void main(String[] args) throws Throwable {
    SpringApplication.run(Application.class, args);
  }
}
</code></pre>

<h3>Controller.java</h3>

<pre class=""lang-java prettyprint-override""><code>package hello;

@org.springframework.stereotype.Controller
public class Controller {
}
</code></pre>

<h3>Config.java</h3>

<pre class=""lang-java prettyprint-override""><code>package hello;

// ...

@Configuration
public class Config extends WebMvcConfigurerAdapter {

  @Override
  public void addViewControllers(ViewControllerRegistry registry) {
    registry.addViewController(""/"").setViewName(""index"");
  }
}
</code></pre>

<h3>ControllerTest.java</h3>

<pre class=""lang-java prettyprint-override""><code>package hello;

// ...

@RunWith(SpringJUnit4ClassRunner.class)
@WebAppConfiguration
@ContextConfiguration(classes = Config.class)
public class ControllerTest {

  @Autowired
  private WebApplicationContext wac;

  private MockMvc mockMvc;

  @Before
  public void setup() {
    mockMvc = MockMvcBuilders.webAppContextSetup(wac).build();
  }

  @Test
  public void test() throws Exception {
    this.mockMvc
        .perform(get(""/""))
        .andExpect(status().isOk());
  }
}
</code></pre>

<h3>index.html</h3>

<pre class=""lang-html prettyprint-override""><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Hello World!&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p&gt;Hello world!&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
",1265245,,1265245,,2016-01-07 19:18:48,2017-09-21 19:24:50,@WebAppConfiguration and @ContextConfiguration for Spring Boot + Thymeleaf,<java><spring><spring-boot><integration-testing><thymeleaf>,2,2,2,
Spring,39645590,1,,,2016,,5,7114,"<p>Here is my webConfig</p>

<pre><code>@Configuration
@EnableWebMvc
public class WebConfig extends WebMvcConfigurerAdapter {

    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping(""/**"");
    }
}
</code></pre>

<p>I have a <code>/health</code> endpoint, which returns some health data and it works fine.</p>

<p>Here is junit test</p>

<pre><code>@Test
    public void corsTest() {
        HttpHeaders headers = new HttpHeaders();
        headers.add(HttpHeaders.ORIGIN, ""http://localhost:9000"");
        HttpEntity&lt;?&gt; requestEntity = new HttpEntity(headers);
        ResponseEntity&lt;Status&gt; entity = this.restTemplate.exchange(""/health"", HttpMethod.GET, requestEntity, Status.class);
        assertEquals(HttpStatus.OK, entity.getStatusCode());
        assertEquals(""http://localhost:9000"", entity.getHeaders().getAccessControlAllowOrigin()); //6
        Status health = entity.getBody();
        assertThat(health.getAppName()).isEqualTo(appName);
    }
</code></pre>

<p>Test fails at line 6. if comment-out that line, the test passes.
Through debugger, I found that <code>entity.getHeaders().getAccessControlAllowOrigin()</code> is null. I used this <a href=""https://github.com/spring-guides/gs-rest-service-cors/blob/master/complete/src/test/java/hello/GreetingIntegrationTests.java"" rel=""noreferrer"">sample app</a> as reference and it works fine. but for my application it fails.</p>

<p>when I use javascript to call the /health api, I can see the cors works. If I comment out, webConfig class, I get error in javascript. Debugging more at javascript shows that cors response header is not set but the request served successfully when webconfig is enabled.</p>

<p>so definitely cors works. It is the test that is failing. so I am guessing test is not seeing it for reasons I don't know.</p>
",1988876,,1988876,,2016-09-22 18:43:33,2016-09-22 20:59:32,cors not working for my spring boot application,<spring><spring-mvc><spring-boot><cors><spring-mvc-test>,3,2,2,
Spring,49942640,1,50349078,,2018,,29,2165,"<p>According the tutorial <a href=""https://spring.io/guides/tutorials/spring-boot-oauth2/#_social_login_authserver"" rel=""noreferrer"">Spring Boot and OAuth2</a></p>

<p>I have following project structure:</p>

<p><a href=""https://i.stack.imgur.com/O0A5t.jpg"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/O0A5t.jpg"" alt=""enter image description here""></a></p>

<p>And following source code:</p>

<p><strong>SocialApplication.class:</strong>  </p>

<pre><code>@SpringBootApplication
@RestController
@EnableOAuth2Client
@EnableAuthorizationServer
@Order(200)
public class SocialApplication extends WebSecurityConfigurerAdapter {

    @Autowired
    OAuth2ClientContext oauth2ClientContext;

    @RequestMapping({ ""/user"", ""/me"" })
    public Map&lt;String, String&gt; user(Principal principal) {
        Map&lt;String, String&gt; map = new LinkedHashMap&lt;&gt;();
        map.put(""name"", principal.getName());
        return map;
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        // @formatter:off
        http.antMatcher(""/**"").authorizeRequests().antMatchers(""/"", ""/login**"", ""/webjars/**"").permitAll().anyRequest()
                .authenticated().and().exceptionHandling()
                .authenticationEntryPoint(new LoginUrlAuthenticationEntryPoint(""/"")).and().logout()
                .logoutSuccessUrl(""/"").permitAll().and().csrf()
                .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse()).and()
                .addFilterBefore(ssoFilter(), BasicAuthenticationFilter.class);
        // @formatter:on
    }

    @Configuration
    @EnableResourceServer
    protected static class ResourceServerConfiguration extends ResourceServerConfigurerAdapter {
        @Override
        public void configure(HttpSecurity http) throws Exception {
            // @formatter:off
            http.antMatcher(""/me"").authorizeRequests().anyRequest().authenticated();
            // @formatter:on
        }
    }

    public static void main(String[] args) {
        SpringApplication.run(SocialApplication.class, args);
    }

    @Bean
    public FilterRegistrationBean&lt;OAuth2ClientContextFilter&gt; oauth2ClientFilterRegistration(OAuth2ClientContextFilter filter) {
        FilterRegistrationBean&lt;OAuth2ClientContextFilter&gt; registration = new FilterRegistrationBean&lt;OAuth2ClientContextFilter&gt;();
        registration.setFilter(filter);
        registration.setOrder(-100);
        return registration;
    }

    @Bean
    @ConfigurationProperties(""github"")
    public ClientResources github() {
        return new ClientResources();
    }

    @Bean
    @ConfigurationProperties(""facebook"")
    public ClientResources facebook() {
        return new ClientResources();
    }

    private Filter ssoFilter() {
        CompositeFilter filter = new CompositeFilter();
        List&lt;Filter&gt; filters = new ArrayList&lt;&gt;();
        filters.add(ssoFilter(facebook(), ""/login/facebook""));
        filters.add(ssoFilter(github(), ""/login/github""));
        filter.setFilters(filters);
        return filter;
    }

    private Filter ssoFilter(ClientResources client, String path) {
        OAuth2ClientAuthenticationProcessingFilter filter = new OAuth2ClientAuthenticationProcessingFilter(
                path);
        OAuth2RestTemplate template = new OAuth2RestTemplate(client.getClient(), oauth2ClientContext);
        filter.setRestTemplate(template);
        UserInfoTokenServices tokenServices = new UserInfoTokenServices(
                client.getResource().getUserInfoUri(),
                client.getClient().getClientId());
        tokenServices.setRestTemplate(template);
        filter.setTokenServices(new UserInfoTokenServices(
                client.getResource().getUserInfoUri(),
                client.getClient().getClientId()));
        return filter;
    }

}

class ClientResources {

    @NestedConfigurationProperty
    private AuthorizationCodeResourceDetails client = new AuthorizationCodeResourceDetails();

    @NestedConfigurationProperty
    private ResourceServerProperties resource = new ResourceServerProperties();

    public AuthorizationCodeResourceDetails getClient() {
        return client;
    }

    public ResourceServerProperties getResource() {
        return resource;
    }
}
</code></pre>

<p><strong>index.html:</strong></p>

<pre><code>&lt;!doctype html&gt;
&lt;html lang=""en""&gt;
&lt;head&gt;
    &lt;meta charset=""utf-8""/&gt;
    &lt;meta http-equiv=""X-UA-Compatible"" content=""IE=edge""/&gt;
    &lt;title&gt;Demo&lt;/title&gt;
    &lt;meta name=""description"" content=""""/&gt;
    &lt;meta name=""viewport"" content=""width=device-width""/&gt;
    &lt;base href=""/""/&gt;
    &lt;link rel=""stylesheet"" type=""text/css""
          href=""/webjars/bootstrap/css/bootstrap.min.css""/&gt;
    &lt;script type=""text/javascript"" src=""/webjars/jquery/jquery.min.js""&gt;&lt;/script&gt;
    &lt;script type=""text/javascript""
            src=""/webjars/bootstrap/js/bootstrap.min.js""&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Login&lt;/h1&gt;
&lt;div class=""container unauthenticated""&gt;
    With Facebook: &lt;a href=""/login/facebook""&gt;click here&lt;/a&gt;
&lt;/div&gt;
&lt;div class=""container authenticated"" style=""display: none""&gt;
    Logged in as: &lt;span id=""user""&gt;&lt;/span&gt;
    &lt;div&gt;
        &lt;button onClick=""logout()"" class=""btn btn-primary""&gt;Logout&lt;/button&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;script type=""text/javascript""
        src=""/webjars/js-cookie/js.cookie.js""&gt;&lt;/script&gt;
&lt;script type=""text/javascript""&gt;
    $.ajaxSetup({
        beforeSend: function (xhr, settings) {
            if (settings.type == 'POST' || settings.type == 'PUT'
                || settings.type == 'DELETE') {
                if (!(/^http:.*/.test(settings.url) || /^https:.*/
                        .test(settings.url))) {
                    // Only send the token to relative URLs i.e. locally.
                    xhr.setRequestHeader(""X-XSRF-TOKEN"",
                        Cookies.get('XSRF-TOKEN'));
                }
            }
        }
    });
    $.get(""/user"", function (data) {
        $(""#user"").html(data.userAuthentication.details.name);
        $("".unauthenticated"").hide();
        $("".authenticated"").show();
    });
    var logout = function () {
        $.post(""/logout"", function () {
            $(""#user"").html('');
            $("".unauthenticated"").show();
            $("".authenticated"").hide();
        });
        return true;
    }
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p><strong>application.yml:</strong></p>

<pre><code>server:
  port: 8080
security:
  oauth2:
    client:
      client-id: acme
      client-secret: acmesecret
      scope: read,write
      auto-approve-scopes: '.*'

facebook:
  client:
    clientId: 233668646673605
    clientSecret: 33b17e044ee6a4fa383f46ec6e28ea1d
    accessTokenUri: https://graph.facebook.com/oauth/access_token
    userAuthorizationUri: https://www.facebook.com/dialog/oauth
    tokenName: oauth_token
    authenticationScheme: query
    clientAuthenticationScheme: form
  resource:
    userInfoUri: https://graph.facebook.com/me
github:
  client:
    clientId: bd1c0a783ccdd1c9b9e4
    clientSecret: 1a9030fbca47a5b2c28e92f19050bb77824b5ad1
    accessTokenUri: https://github.com/login/oauth/access_token
    userAuthorizationUri: https://github.com/login/oauth/authorize
    clientAuthenticationScheme: form
  resource:
    userInfoUri: https://api.github.com/user

logging:
  level:
    org.springframework.security: DEBUG
</code></pre>

<p>But when I open browser and try to hit <code>http://localhost:8080</code></p>

<p>In browser console I see:</p>

<pre><code>(index):44 Uncaught TypeError: Cannot read property 'details' of undefined
    at Object.success ((index):44)
    at j (jquery.js:3073)
    at Object.fireWith [as resolveWith] (jquery.js:3185)
    at x (jquery.js:8251)
    at XMLHttpRequest.&lt;anonymous&gt; (jquery.js:8598)
</code></pre>

<p>in code:</p>

<pre><code>$.get(""/user"", function (data) {
        $(""#user"").html(data.userAuthentication.details.name);
        $("".unauthenticated"").hide();
        $("".authenticated"").show();
    });
</code></pre>

<p>It happens because <code>/user</code> response with 302 status code and js callback try to parse result of <code>localhost:8080</code>:</p>

<p><a href=""https://i.stack.imgur.com/LFbfu.jpg"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/LFbfu.jpg"" alt=""enter image description here""></a></p>

<p>I don't understand why this redirect happens. Can you explain this behavior and help to fix it?</p>

<h2>UPDATE</h2>

<p>I took this code from <a href=""https://github.com/spring-guides/tut-spring-boot-oauth2"" rel=""noreferrer"">https://github.com/spring-guides/tut-spring-boot-oauth2</a></p>

<h2>important:</h2>

<p>It reproduces <strong>only after I start client application.</strong></p>

<h2>P.S.</h2>

<p><strong>How to reproduce:</strong></p>

<blockquote>
  <p>To test the new features you can just run both apps and visit
  localhost:9999/client in your browser. The client app will redirect to
  the local Authorization Server, which then gives the user the usual
  choice of authentication with Facebook or Github. Once that is
  complete control returns to the test client, the local access token is
  granted and authentication is complete (you should see a ""Hello""
  message in your browser). If you are already authenticated with Github
  or Facebook you may not even notice the remote authentication</p>
</blockquote>

<h2>ANSWER:</h2>

<p><a href=""https://stackoverflow.com/a/50349078/2674303"">https://stackoverflow.com/a/50349078/2674303</a></p>
",2674303,,2674303,,2018-12-10 12:06:44,2018-12-10 12:06:44,Official Spring security oauth2 example doesn't work because of cookies clashing(authorization code mechanism),<java><spring-security><oauth-2.0><spring-oauth2>,3,5,2,
Spring,48772458,1,49214701,,2018,,4,593,"<p>So here's a new one, for me… I'm working with one of the Spring Boot guides, and getting the</p>

<pre><code>Error: Could not find or load main class org.apache.maven.wrapper.MavenWrapperMain
</code></pre>

<p>error when running</p>

<pre><code>./mvnw spring-boot:run
</code></pre>

<p>(or any Maven Wrapper command)</p>

<p>That said, I see the <code>wrapper</code> jar within <code>.mvn</code> where I would expect it to be. </p>

<p>Has anyone else hit this? It seems like it must be a system-level issue because I've had no issue with this in the past.</p>

<p>Here is the repo I am running this command on: <a href=""https://github.com/spring-guides/gs-scheduling-tasks.git"" rel=""noreferrer"">https://github.com/spring-guides/gs-scheduling-tasks.git</a></p>
",2355712,,,,,2018-03-16 19:39:49,"could not find MavenWrapperMain class, but is contained within .m2 in the directory",<java><maven>,4,7,2,
Spring,37598036,1,,,2016,,1,842,"<p>I am following this tutorial about Spring-Security-Oauth2 :</p>

<p><a href=""https://github.com/spring-guides/tut-spring-boot-oauth2/tree/master/logout"" rel=""nofollow"">https://github.com/spring-guides/tut-spring-boot-oauth2/tree/master/logout</a></p>

<p>The problem that I am facing is, when I clicked the logout button this send a post request to the /logout endpoint to kill to session, but when I clicked the LogIn button again I expect to see the login Form Again. But It seems that when /logout is called, this is in somewhere saving the information of the last logged user and always re-login again and does not display the login form.</p>

<p>I don't know how to kill the session in the SSO, I am using the  same facebook OAuth.</p>

<p>Thanks for help.</p>
",1469918,,1469918,,2016-06-02 18:06:03,2017-07-19 22:36:28,Spring Security OAuth2 doesn't kill the session and display login again,<java><spring-security><spring-boot><single-sign-on><spring-security-oauth2>,1,6,1,
Spring,46732371,1,46732904,,2017,,1,198,"<p>does anybody know why the Spring Boot Guide includes two different types of integration tests? (<a href=""https://github.com/spring-guides/gs-spring-boot#add-unit-tests"" rel=""nofollow noreferrer"">https://github.com/spring-guides/gs-spring-boot#add-unit-tests</a>)</p>

<p>One with TestRestTemplate and one with MockMvc dependency? In each test type spring boot bootstraps the test environment. So what is the reason for this separation?</p>
",6271380,,6271380,,2017-10-18 20:04:57,2018-05-29 15:09:44,Why are there different types of integration tests in Spring Boot,<spring><testing><spring-boot><resttemplate><spring-test>,1,0,1,
Spring,40357318,1,40460700,,2016,,1,539,"<p>I'm trying to repeat the ""Spring Boot and OAuth2"" example from <a href=""https://spring.io/guides/tutorials/spring-boot-oauth2/"" rel=""nofollow"">tutorial</a>.</p>

<p>I run the example with ""gradlew bootRun"".
It is working on Windows without problems, but I having an issue on Ubuntu 14.04.
When I clicked on ""login"" button the service doesn't perform a redirect to the authorization server (e.g. facebook), and after several minutes return with time-out.</p>

<p>The service's log contains the following lines:</p>

<pre><code>o.s.s.w.u.matcher.AntPathRequestMatcher  : Request 'GET /login' doesn't match 'POST /logout
o.s.security.web.FilterChainProxy        : /login at position 6 of 12 in additional filter chain; firing Filter: 'OAuth2ClientAuthenticationProcessingFilter'
o.s.s.w.u.matcher.AntPathRequestMatcher  : Checking match of request : '/login'; against '/login'
uth2ClientAuthenticationProcessingFilter : Request is to process authentication
</code></pre>

<p>I would be grateful for any help.
Thanks.</p>

<p>Source code of tutorial located on <a href=""https://github.com/spring-guides/tut-spring-boot-oauth2/tree/master/logout"" rel=""nofollow"">github</a></p>

<p>My source code are given below:</p>

<p><strong>build.gradle</strong></p>

<pre><code>buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath(""org.springframework.boot:spring-boot-gradle-plugin:1.4.1.RELEASE"")
    }
}

apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'spring-boot'
sourceCompatibility = '1.8'
targetCompatibility = '1.8'

repositories {
    mavenCentral()
}

dependencies {
    compile(""org.springframework.boot:spring-boot-starter-security"")
    compile(""org.springframework.boot:spring-boot-starter-web"")
    compile(""org.springframework.security.oauth:spring-security-oauth2"")

    compile(""org.webjars:webjars-locator"")
    compile(""org.webjars:angularjs:1.4.3"")
    compile(""org.webjars:jquery:2.1.1"")
    compile(""org.webjars:bootstrap:3.2.0"")

    testCompile group: 'junit', name: 'junit', version: '4.11'
}
</code></pre>

<p><strong>application.yml</strong></p>

<pre><code>security:
  oauth2:
    client:
      clientId: 233668646673605
      clientSecret: 33b17e044ee6a4fa383f46ec6e28ea1d
      accessTokenUri: https://graph.facebook.com/oauth/access_token
      userAuthorizationUri: https://www.facebook.com/dialog/oauth
      tokenName: oauth_token
      authenticationScheme: query
      clientAuthenticationScheme: form
    resource:
      userInfoUri: https://graph.facebook.com/me

logging:
  level:
    org.springframework.security: DEBUG
</code></pre>

<p><strong>SocialApplication.java</strong></p>

<pre><code>@SpringBootApplication
@EnableOAuth2Sso
@RestController
public class SocialApplication extends WebSecurityConfigurerAdapter {

    @RequestMapping(""/user"")
    public Principal user(Principal principal) {
        return principal;
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.antMatcher(""/**"").authorizeRequests().antMatchers(""/"", ""/login**"", ""/webjars/**"").permitAll()
                .anyRequest().authenticated()
                .and().logout().logoutSuccessUrl(""/"").permitAll()
                .and().csrf().csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse());
    }

    public static void main(String[] args) {
        SpringApplication.run(SocialApplication.class, args);
    }
}
</code></pre>
",4529210,,,,,2016-11-07 8:25:22,Spring Boot and OAuth2 example: redirect not working,<spring><spring-security><oauth2>,1,0,1,
Spring,22600920,1,22604552,,2014,,1,303,"<p>I've been trying to get this simple example running (with java 1.7) <a href=""https://github.com/spring-guides/gs-accessing-neo4j-data-rest/tree/master/complete"" rel=""nofollow"">https://github.com/spring-guides/gs-accessing-neo4j-data-rest/tree/master/complete</a></p>

<p>I keep getting the following error when attempting to start the application via the main method in the Application class.</p>

<p>I'uploaded the entire log to this gist: <a href=""http://bit.ly/1hU7Vpu"" rel=""nofollow"">http://bit.ly/1hU7Vpu</a></p>

<p>Here's the summary of the error.</p>

<pre><code>WARN 6470 --- [           main] o.s.boot.SpringApplication               : Error handling failed (Error creating bean with name 'org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration': Initialization of bean failed; nested exception is java.lang.NoSuchMethodError: org.springframework.data.rest.webmvc.config.RepositoryRestMvcConfiguration.setBeanFactory(Lorg/springframework/beans/factory/BeanFactory;)V)
Exception in thread ""main"" org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityFetchHandler' defined in class hello.Application: Instantiation of bean failed; nested exception is org.springframework.beans.factory.BeanDefinitionStoreException: Factory method [public org.springframework.data.neo4j.support.mapping.Neo4jEntityFetchHandler org.springframework.data.neo4j.config.Neo4jConfiguration.entityFetchHandler() throws java.lang.Exception] threw exception; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'nodeStateTransmitter' defined in class hello.Application: Initialization of bean failed; nested exception is java.lang.reflect.MalformedParameterizedTypeException
</code></pre>
",2091827,,592228,,2014-03-24 8:43:12,2014-03-24 13:28:49,Spring Neo4J REST error - nodeStateTransmitter,<java><spring><rest><neo4j><spring-boot>,1,0,1,
Spring,50141309,1,,,2018,,1,272,"<p>I want to build the app with Spring and react, so I started learning from this tutorial: <a href=""https://github.com/spring-guides/tut-react-and-spring-data-rest/tree/master/basic"" rel=""nofollow noreferrer"">https://github.com/spring-guides/tut-react-and-spring-data-rest/tree/master/basic</a> </p>

<p>My project contains the same files - I did all step by step( just shared my project for help <a href=""https://github.com/Lewan110/rest-react"" rel=""nofollow noreferrer"">https://github.com/Lewan110/rest-react</a>). 
Spring Data rest works well, because I getting right data, but when I go to <a href=""http://localhost:8080"" rel=""nofollow noreferrer"">http://localhost:8080</a> I got no data and an error with bundle.js </p>

<p>It's weird for me because bundle.js is generated in: \src\main\resources\static\built\bundle.js
also <em>webpack.config.js</em> looks good:</p>

<pre><code>var path = require('path');

module.exports = {
    entry: './src/main/js/app.js',
    devtool: 'sourcemaps',
    cache: true,
    debug: true,
    output: {
        path: __dirname,
        filename: './src/main/resources/static/built/bundle.js'
    },
    module: {
        loaders: [
            {
                test: path.join(__dirname, '.'),
                exclude: /(node_modules)/,
                loader: 'babel',
                query: {
                    cacheDirectory: true,
                    presets: ['es2015', 'react']
                }
            }
        ]
    }
};
</code></pre>

<p><a href=""https://i.stack.imgur.com/sOuCO.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/sOuCO.png"" alt=""""></a></p>

<p>I'm completely new in React(and JS) and I don't know where cause can be.</p>
",7920494,,4460737,,2018-05-02 18:49:33,2018-05-30 16:33:53,Error 404 bundle.js not found - Spring Data Rest and React.js,<javascript><spring><reactjs><spring-boot>,1,0,1,
Spring,35195982,1,35603281,,2016,,1,1196,"<p>I have used <a href=""https://spring.io/guides/gs/scheduling-tasks/"" rel=""nofollow"">this tutorial</a> and <a href=""https://github.com/spring-guides/gs-scheduling-tasks.git"" rel=""nofollow"">it's github project</a> as a base for this SSCCE.</p>

<p>For unknown reason, methods marked as <code>@Async</code> ran from a <code>@Scheduled</code> method always execute synchronously.</p>

<p>I am looking for a fix or workaround to make the code from <code>performTask()</code> run asynchonously.</p>

<p>The classes below:</p>

<p>Application.java</p>

<pre><code>@SpringBootApplication
@EnableScheduling
@EnableAsync
public class Application implements AsyncConfigurer{

    public static void main(String[] args) throws Exception {
        SpringApplication.run(Application.class);
    }

    @Override
    @Bean(name=""asyncExecutor"")
    public Executor getAsyncExecutor() {
        ThreadPoolTaskExecutor exec = new ThreadPoolTaskExecutor();
        exec.setMaxPoolSize(Runtime.getRuntime().availableProcessors()*2);
        exec.setThreadGroupName(""MyCustomExecutor"");
        exec.setWaitForTasksToCompleteOnShutdown(true);
        exec.setBeanName(""asyncExecutor"");
        exec.initialize();
        return exec;
    }

    @Override
    public AsyncUncaughtExceptionHandler getAsyncUncaughtExceptionHandler() {
        return new SimpleAsyncUncaughtExceptionHandler();
    }
}
</code></pre>

<p>MyAsyncService.java</p>

<pre><code>@Service
public class MyAsyncService {

    static AtomicInteger taskNoCounter = new AtomicInteger();

    public MyAsyncService() {
    }

    @Async(""asyncExecutor"")
    public void performTask() {
        int delayMs = (int) (System.currentTimeMillis()%1000+1000);
        int taskNo = taskNoCounter.incrementAndGet();
        String taskInfo = ""MyAsyncTask [taskNo="" + taskNo + "", delayMs="" + delayMs + "", threadId=""+Thread.currentThread().getId()+""]"";
        System.out.println(""+ start "" +taskInfo);
        try {
            Thread.sleep(delayMs);
        } catch (InterruptedException e) {
            // empty on purpose
        }
        System.out.println(""- end   "" +taskInfo);
    }

}
</code></pre>

<p>ScheduledTasks.java</p>

<pre><code>@Component
public class ScheduledTasks {

    @Autowired
    MyAsyncService service;

    @Scheduled(fixedRate = 1000)
    public void reportCurrentTime() {
        for (int i=0; i&lt;20; i++) {
            service.performTask();
        }

    }
}
</code></pre>

<p>Produce the following synchronouse result:</p>

<pre><code>+ start MyAsyncTask [taskNo=1, delayMs=1874, threadId=16]
- end   MyAsyncTask [taskNo=1, delayMs=1874, threadId=16]
+ start MyAsyncTask [taskNo=2, delayMs=1749, threadId=16]
- end   MyAsyncTask [taskNo=2, delayMs=1749, threadId=16]
+ start MyAsyncTask [taskNo=3, delayMs=1498, threadId=16]
- end   MyAsyncTask [taskNo=3, delayMs=1498, threadId=16]
+ start MyAsyncTask [taskNo=4, delayMs=1997, threadId=16]
- end   MyAsyncTask [taskNo=4, delayMs=1997, threadId=16]
+ start MyAsyncTask [taskNo=5, delayMs=1994, threadId=16]
</code></pre>
",1961634,,,,,2016-02-24 13:16:00,Spring-boot @Async not running with @Scheduled,<java><spring><spring-boot><spring-scheduled><spring-async>,1,3,1,
Spring,36655518,1,36665463,,2016,,1,861,"<p>I am studying Spring OAuth2 by decomposing the set of <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2"" rel=""nofollow noreferrer"">three interconnected sample apps at this GitHub link</a>.  The apps work as intended on my devbox, but the <code>authserver</code> app produces an unwanted confirmation page that asks the user to confirm that they authorize the client at <code>localhost:8080/login</code> to receive their protected information. A screen shot of the confirmation page is as follows:  </p>

<p><img src=""https://s22.postimg.org/mwyq9xelt/Authorization_View.gif"" />  </p>

<p><strong>What specific changes need to be made to the <code>authserver</code> app's code to remove the confirmation step?</strong>  </p>

<p>I understand that the confirmation page could be useful in certain use cases.  But the confirmation page is not appropriate for the use case that I have in mind, so how can I disable this step?  </p>

<hr>

<p><strong>FIRST ATTEMPT:</strong>  </p>

<hr>

<p>I have located the view code for the authorization page in <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/blob/master/oauth2/authserver/src/main/resources/templates/authorize.ftl"" rel=""nofollow noreferrer""><code>authorize.ftl</code>, which you can read by clicking on this link</a>.  But when I do <code>Ctrl-H</code> in an eclipse workspace and search for ""authorize.ftl"", no results show up.  Similarly, I reviewed the <a href=""http://projects.spring.io/spring-security-oauth/docs/oauth2.html#customizing-the-ui"" rel=""nofollow noreferrer"">Spring OAuth2 Developer Guide</a>.  Some mention in the guide is made of creating a separate <code>@RequestMappig(""/oauth/authorize"")</code>, but it did not seem clear how to disable this confirmation step.  </p>

<p>The code for the template <code>login</code> view is in <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/blob/master/oauth2/authserver/src/main/resources/templates/login.ftl"" rel=""nofollow noreferrer""><code>login.ftl</code>, which you can read at this link</a>.  </p>

<p><strong>Is the solution to simply move the <code>login.ftl</code> code into a new <code>login.html</code> file, and then manage that view with <code>@RequestMappig(""/oauth/authorize"")</code>?</strong>   </p>

<p>If I interpret the working from the Developer Guide link above correctly, it seems to say that  </p>

<p>1.) an <code>@RequestMappig(""/oauth/authorize"")</code> method linked to GET would serve up the login view, then another <code>@RequestMappig(""/oauth/authorize"")</code>,  </p>

<p>2.) then another <code>@RequestMappig(""/oauth/authorize"")</code> method linked to POST would take the information from the view and bypass the confirmation step.  </p>

<p><strong>But what would this look like in code?</strong>  Here is a starting point, if I understand correctly:  </p>

<pre><code>`@RequestMappig(""/oauth/authorize"", method = RequestMethod.GET)`
public @ResponseBody SomeType method1Name(){
    SomeType st = new SomeType();
    //do some stuff to st
    return st;
}

`@RequestMappig(""/oauth/authorize"", method = RequestMethod.POST)`
public @ResponseBody SomeType method2Name(){
    SomeType st = new SomeType();
    //do other stuff to st
    return st;
}
</code></pre>

<p>What do I put in the methods?  And then were do I put the view code?  </p>

<p>The Developer Guide says to start with <a href=""https://github.com/spring-projects/spring-security-oauth/blob/master/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/WhitelabelApprovalEndpoint.java"" rel=""nofollow noreferrer""><code>WhiteLabelApprovalEndpoint,java</code>, which you can read on GitHub at this link</a>.</p>
",807797,,-1,,2017-02-08 15:09:36,2016-04-16 14:34:42,disable confirmation page in Spring OAuth2,<spring><spring-mvc><spring-security><spring-boot><spring-oauth2>,1,2,1,
Spring,27643278,1,,,2014,,2,1888,"<p>I'm trying to make the example of this link: <a href=""https://github.com/spring-guides/gs-uploading-files"" rel=""nofollow"">https://github.com/spring-guides/gs-uploading-files</a> work with Apcahe <code>commons-fileupload</code>but the error: <code>Required MultipartFile parameter 'file' is not present</code> is occurring.</p>

<p>The configuration that I'm making on the example is:</p>

<p>1 - Adding the dependency of <code>commons-fileupload</code> in the <code>pom.xml</code>:</p>

<pre><code>&lt;dependency&gt;
  &lt;groupId&gt;commons-fileupload&lt;/groupId&gt;
  &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt;
  &lt;version&gt;1.3.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<p>2 - Config the <code>multipartResolver()</code> in the <code>Application.java</code></p>

<pre><code>@Bean
public MultipartResolver multipartResolver() {
  return new CommonsMultipartResolver();
}
</code></pre>

<p>Without this configuration everything works fine as Spring is using <code>org.springframework.web.multipart.support.StandardServletMultipartResolver</code> for handle uploads, but I want use <code>commons-fileupload</code>.</p>

<p>There is something that I'm missing? </p>

<p>Thanks.</p>

<p>@avaz</p>
",510024,,,,,2018-02-12 15:43:52,spring-boot spring-mvc apache-commons-fileupload: Required MultipartFile parameter 'file' is not present error,<spring-mvc><spring-boot><apache-commons-fileupload>,1,2,1,
Spring,41578040,1,41771377,,2017,,2,778,"<p>I've found similar <a href=""https://stackoverflow.com/questions/36674438/multiple-resource-server-oauth2-clients-spring-oauth2-sso"">issue</a> but it's unanswered, so I suppose I'm going to duplicate question a little.</p>

<p>I am using Spring OAuth2 to implement separate resource and custom authentification servers. 
I've already configured interaction with auth server through issuing&amp;validating JWT tokens and everything seems fine.</p>

<p>Now I'm trying to add SSO functionality but really stuck with it. I've researched the official Spring <a href=""https://github.com/spring-guides/tut-spring-boot-oauth2"" rel=""nofollow noreferrer"">examples</a> and attached guide but it is very short worded when it comes to connecting SSO part with custom server authentication. And actually author uses only external provider resource ('user' info) to show process.</p>

<p>I think it is normal thing to have all this SSO means of authentication and also custom registration. I can see it works well with stackoverflow for example.</p>

<p>I am loking for directions where to find any info about handling on resource server different kind of tokens issued by multiply SSO providers and also from custom auth server.
Maybe I can use auth chain to do this and some mean to distinguish token format to know how to process it. Is it possible with Spring OAuth2? Or I need to do this magic somehow manually?</p>

<p>For now I have just one 'maybe strange' idea: 
To not involve my own resource server with this SSO stuff at all. After receiving Facebook (for example) token - just exchange it for api JWT token with custom auth server (associating or creating user on the way) and then work with resource server on standard basics</p>

<p><strong>EDITED:</strong>
I've found at least something. I've read about configuring filters in authorization chain and translate given social tokens to my custom JWT-s as 'post authenticate'(not a crazy idea after all). But it mostly done with SpringSocial. 
So now question is: how to do that?
Forgot to say that I am using Password Grant for authentication on custom server. Clients will be only trusted application and I do not even sure about browser client (thinking about only native mobile options). Even if I decide to have browser client I'll make sure it's going to have backend to store sencetive information</p>
",3778348,,-1,,2017-05-23 12:26:17,2017-03-29 17:42:17,Spring OAuth2: support auth and resource access with both SSO and custom auth server,<spring-boot><single-sign-on><spring-security-oauth2>,1,0,1,
Spring,41738864,1,,,2017,,2,1105,"<p>I have read and implemented my own Auth server following <a href=""https://github.com/spring-guides/tut-spring-boot-oauth2/tree/master/auth-server"" rel=""nofollow noreferrer"">this tutorial</a> from Spring. There are multiple SSO providers - Facebook, Github and a custom auth server. In this tutorial, the auth server contains the handling of other SSO providers.</p>

<p>I have a separate resource server that links to my auth server using the following properties:</p>

<pre><code>security.oauth2.resource.userInfoUri=http://localhost:9000/user
</code></pre>

<p>I am able to get the token from my auth server using a cUrl command:</p>

<pre><code>curl acme:acmesecret@localhost:9000/oauth/token -d grant_type=password -d username=user -d password=...
{""access_token"":""aa49e025-c4fe-4892-86af-15af2e6b72a2"",""token_type"":""bearer"",""refresh_token"":""97a9f978-7aad-4af7-9329-78ff2ce9962d"",""expires_in"":43199,""scope"":""read write""}
</code></pre>

<p>But what I fail to understand is how can I use the other SSO providers to get such token as well from the auth server? The resource server should not care how did I get the token and whether I am authenticated using Facebook or my custom auth server. It should simply ask the auth server what is the Principal (logged user) and then decide which resources to show him, right?</p>

<p>I don't have any UI and this will be backed for a mobile application so I need to udnerstand how to handle the authentication using REST reqeusts.</p>
",1262024,,,,,2017-01-27 6:36:10,Multiple SSO providers in Spring Boot Auth server,<java><spring-boot><oauth-2.0><spring-security-oauth2>,1,0,1,
Spring,35076591,1,35076775,,2016,,2,3977,"<p>I'm completely new to Spring &amp; not very experienced in Java admittedly. I am trying to go through the <a href=""http://spring.io/guides/tutorials/bookmarks/"" rel=""nofollow"">Building REST services with Spring</a> tutorial on the spring.io website. I came across the following code segment and I'm confused as to what it actually does.</p>

<pre><code>@Configuration
@ComponentScan
@EnableAutoConfiguration
public class Application {

    @Bean
    CommandLineRunner init(AccountRepository accountRepository,
            BookmarkRepository bookmarkRepository) {
        return (evt) -&gt; Arrays.asList(
                ""jhoeller,dsyer,pwebb,ogierke,rwinch,mfisher,mpollack,jlong"".split("",""))
                .forEach(
                        a -&gt; {
                            Account account = accountRepository.save(new Account(a,
                                    ""password""));
                            bookmarkRepository.save(new Bookmark(account,
                                    ""http://bookmark.com/1/"" + a, ""A description""));
                            bookmarkRepository.save(new Bookmark(account,
                                    ""http://bookmark.com/2/"" + a, ""A description""));
                        });
    }

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }
}
</code></pre>

<p>I looked up CommandLineRunner on Spring Boot docs, and it says it's an interface that gets implemented if you want to execute some code when the application starts. But to my limited knowledge, CommandLineRunner is not getting implemented by anything in the above code segment. Also, I have no clue where the init() method came from or what it really is.</p>

<p>Additionally, I downloaded the complete code from their <a href=""https://github.com/spring-guides/tut-bookmarks.git"" rel=""nofollow"">github repo</a> but I'm not quite sure how to actually run it. I read earlier today that <code>SpringApplication.run()</code> makes it so that you don't have to deploy anything to an external service like Tomcat. But when I tried <code>java -jar ./jarFileName</code> for the Application class (seemed like a natural choice since it had main() ), it gave an error.</p>

<p>Any help would be appreciated.</p>
",1993941,,,,,2016-01-29 4:15:41,What does CommandLineRunner do in this case?,<java><spring><spring-boot>,1,0,1,
Spring,38910280,1,,,2016,,3,601,"<p>I'm working with tutorial that describes how to write a modular Project single-page app using Spring Boot, Spring Security and AngularJS </p>

<p><a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2-vanilla"" rel=""nofollow"">https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2-vanilla</a> </p>

<p>and this Project</p>

<p><a href=""https://github.com/sharmaritesh/spring-angularjs-oauth2-sample"" rel=""nofollow"">https://github.com/sharmaritesh/spring-angularjs-oauth2-sample</a></p>

<p>I cannot logout currently logged user.
If you click on the ""logout"" link you will see that the home page changes (the greeting is no longer displayed) so the user is no longer authenticated with the UI server. Click back on ""login"" though and you actually don’t need to go back through the authentication and approval cycle in the authorization server (because you haven’t logged out of that). </p>

<p>I'm new to Spring and would like that some User could logged out et come back to a login Page again.
Please somebody could help me or give some suggestion to solve this Problem?</p>
",2657234,,7791521,,2018-01-05 21:39:49,2018-01-05 21:39:49,Spring Boot with Angularjs Logout Error,<angularjs><spring><spring-security><spring-boot><logout>,1,0,1,
Spring,24025004,1,24040465,,2014,,5,3165,"<p>I'm working with a Maven multi module with a war depending on an other war.</p>

<p>The Spring Boot webapp depends on a basic webapp that only serves html files.</p>

<p>When I run the Spring Boot app, I'm able to access services and html from the main webapp (the Spring Boot one) but I can't access the html files from the dependency war (404). But these html files are well packaged in the Spring Boot webapp war...</p>

<p>Here is a project that show the problem:<br>
<a href=""https://github.com/cthiebault/spring-boot-war-overlays"" rel=""noreferrer"">https://github.com/cthiebault/spring-boot-war-overlays</a></p>

<p>This project has 2 war modules:</p>

<ul>
<li><strong>dependency-webapp</strong>: basic webapp serving just html (/dependency/index.html)</li>
<li><strong>main-webapp</strong>: Spring Boot webapp (copied from Spring Guides <a href=""https://github.com/spring-guides/gs-serving-web-content"" rel=""noreferrer"">gs-serving-web-content</a>). This webapp has a dependency on <strong>dependency-webapp</strong>.</li>
</ul>

<p>Here is the main-webapp pom.xml:</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;
&lt;project xmlns=""http://maven.apache.org/POM/4.0.0"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""
    xsi:schemaLocation=""http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd""&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

  &lt;parent&gt;
    &lt;groupId&gt;spring-boot-overlays&lt;/groupId&gt;
    &lt;artifactId&gt;parent&lt;/artifactId&gt;
    &lt;version&gt;0.1.0-SNAPSHOT&lt;/version&gt;
  &lt;/parent&gt;

  &lt;artifactId&gt;main-webapp&lt;/artifactId&gt;
  &lt;packaging&gt;war&lt;/packaging&gt;

  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;spring-boot-overlays&lt;/groupId&gt;
      &lt;artifactId&gt;dependency-webapp&lt;/artifactId&gt;
      &lt;version&gt;0.1.0-SNAPSHOT&lt;/version&gt;
      &lt;type&gt;war&lt;/type&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;

  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;overlays&gt;
            &lt;overlay&gt;
              &lt;groupId&gt;spring-boot-overlays&lt;/groupId&gt;
              &lt;artifactId&gt;dependency-webapp&lt;/artifactId&gt;
            &lt;/overlay&gt;
          &lt;/overlays&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;

  &lt;properties&gt;
    &lt;start-class&gt;hello.Application&lt;/start-class&gt;
  &lt;/properties&gt;

&lt;/project&gt;
</code></pre>

<p>Run the webapp: </p>

<pre><code>mvn install
cd main-webapp
mvn spring-boot:run
</code></pre>

<h3>EDIT 1: Here are the logs when I try to access html pages:</h3>

<p><code>http://localhost:8080/index.html</code> <strong>--> OK</strong></p>

<pre><code>o.s.web.servlet.DispatcherServlet        : DispatcherServlet with name 'dispatcherServlet' processing GET request for [/index.html]
s.w.s.m.m.a.RequestMappingHandlerMapping : Looking up handler method for path /index.html
s.w.s.m.m.a.RequestMappingHandlerMapping : Did not find handler method for [/index.html]
o.s.w.s.handler.SimpleUrlHandlerMapping  : Matching patterns for request [/index.html] are [/**]
o.s.w.s.handler.SimpleUrlHandlerMapping  : URI Template variables for request [/index.html] are {}
o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapping [/index.html] to HandlerExecutionChain with handler [org.springframework.web.servlet.resource.ResourceHttpRequestHandler@25595861] and 1 interceptor
o.s.web.servlet.DispatcherServlet        : Last-Modified value for [/index.html] is: -1
o.s.w.s.r.ResourceHttpRequestHandler     : Trying relative path [index.html] against base location: ServletContext resource [/]
o.s.w.s.r.ResourceHttpRequestHandler     : Found matching resource: ServletContext resource [/index.html]
o.s.w.s.r.ResourceHttpRequestHandler     : Determined media type 'text/html' for ServletContext resource [/index.html]
o.s.w.s.r.ResourceHttpRequestHandler     : Resource not modified - returning 304
o.s.web.servlet.DispatcherServlet        : Null ModelAndView returned to DispatcherServlet with name 'dispatcherServlet': assuming HandlerAdapter completed request handling
o.s.web.servlet.DispatcherServlet        : Successfully completed request
</code></pre>

<p><code>http://localhost:8080/dependency/index.html</code> <strong>--> ERROR 404</strong></p>

<pre><code>o.s.web.servlet.DispatcherServlet        : DispatcherServlet with name 'dispatcherServlet' processing GET request for [/dependency/index.html]
s.w.s.m.m.a.RequestMappingHandlerMapping : Looking up handler method for path /dependency/index.html
s.w.s.m.m.a.RequestMappingHandlerMapping : Did not find handler method for [/dependency/index.html]
o.s.w.s.handler.SimpleUrlHandlerMapping  : Matching patterns for request [/dependency/index.html] are [/**]
o.s.w.s.handler.SimpleUrlHandlerMapping  : URI Template variables for request [/dependency/index.html] are {}
o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapping [/dependency/index.html] to HandlerExecutionChain with handler [org.springframework.web.servlet.resource.ResourceHttpRequestHandler@25595861] and 1 interceptor
o.s.web.servlet.DispatcherServlet        : Last-Modified value for [/dependency/index.html] is: -1
o.s.w.s.r.ResourceHttpRequestHandler     : Trying relative path [dependency/index.html] against base location: ServletContext resource [/]
o.s.w.s.r.ResourceHttpRequestHandler     : Trying relative path [dependency/index.html] against base location: class path resource [META-INF/resources/]
o.s.w.s.r.ResourceHttpRequestHandler     : Trying relative path [dependency/index.html] against base location: class path resource [resources/]
o.s.w.s.r.ResourceHttpRequestHandler     : Trying relative path [dependency/index.html] against base location: class path resource [static/]
o.s.w.s.r.ResourceHttpRequestHandler     : Trying relative path [dependency/index.html] against base location: class path resource [public/]
o.s.w.s.r.ResourceHttpRequestHandler     : No matching resource found - returning 404
o.s.web.servlet.DispatcherServlet        : Null ModelAndView returned to DispatcherServlet with name 'dispatcherServlet': assuming HandlerAdapter completed request handling
o.s.web.servlet.DispatcherServlet        : Successfully completed request
</code></pre>

<p>Any idea of what's wrong?</p>
",386713,,386713,,2014-06-04 13:08:34,2014-06-04 14:38:56,Spring Boot & Maven war overlay,<maven><spring-boot><maven-war-plugin>,1,2,1,
Spring,39082691,1,,,2016,,4,2273,"<p>I have been following Dave Syer tutorial, SSO with OAuth2, Part 5  <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2"" rel=""nofollow"">https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2</a></p>

<p>It has UI/API gateway, resource server and Authorization server. 
When i click logout from UI/API gateway application i get the following,<a href=""http://i.stack.imgur.com/T7WO0.jpg"" rel=""nofollow"">enter image description here</a> Cors issue</p>

<p>What is currently happening from Dave Syer tutorial is that when a user click logout it changes the authentication flag to false, making it seem the user has logged out but they have only logged out from the UI/API gateway application. </p>

<p>When user click login, remember they haven’t logout from the Authentication server. Therefore, user doesn’t go through the authentication and approval cycle again. </p>

<p>What I want, when a user click logout and try to login again user must input username and password. In fact, they should start afresh, meaning system should invalidate the session and or token.</p>

<p>I've been banging my head against a wall trying to find a solution for this. Can anyone please point out how to resolve/ achieve this. </p>
",6726502,,,,,2017-07-19 17:50:43,"Spring boot Security, Oauth2 logout, invalidate session in order to go through the authentication and approval cycle in the authorization server",<java><angularjs><spring-security><spring-boot><spring-security-oauth2>,2,2,1,
Spring,36683434,1,36703486,,2016,,4,10867,"<p><strong>How do I trigger auto-logout of <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2"" rel=""nofollow noreferrer"">this sample Spring Boot OAuth2 app</a>?</strong>  </p>

<p>I tried adding the following code from <a href=""https://stackoverflow.com/questions/21987589/spring-security-how-to-log-out-user-revoke-oauth2-token#32320860"">an answer to this other posting</a> into a new controller class in the <code>demo</code> package of the <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2/authserver"" rel=""nofollow noreferrer""><code>authserver</code> app</a>:  </p>

<pre><code>package demo;

import javax.servlet.http.HttpServletRequest;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.oauth2.common.OAuth2AccessToken;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseStatus;
import org.springframework.http.HttpStatus;

@Controller
public class OAuthController {
    @Autowired
    private TokenStore tokenStore;

    @RequestMapping(value = ""/oauth/revoke-token"", method = RequestMethod.GET)
    @ResponseStatus(HttpStatus.OK)
    public void logout(HttpServletRequest request) {
        String authHeader = request.getHeader(""Authorization"");
        if (authHeader != null) {
            String tokenValue = authHeader.replace(""Bearer"", """").trim();
            OAuth2AccessToken accessToken = tokenStore.readAccessToken(tokenValue);
            tokenStore.removeAccessToken(accessToken);
        }
    }
}  
</code></pre>

<p>But when I try to launch the app, the debug log gives the following error indicating that it cannot <code>autowire</code> the token store:  </p>

<pre><code>Caused by: org.springframework.beans.factory.BeanCreationException:  
Could not autowire field:  
private org.springframework.security.oauth2.provider.token.TokenStore  
demo.OAuthController.tokenStore; nested exception is  
org.springframework.beans.factory.NoSuchBeanDefinitionException:  
No qualifying bean of type [org.springframework.security.oauth2.provider.token.TokenStore] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:573)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:88)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:331)
    ... 23 more
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException:  
No qualifying bean of type  
[org.springframework.security.oauth2.provider.token.TokenStore]  
found for dependency: expected at least 1 bean which qualifies as  
autowire candidate for this dependency. Dependency annotations:  
{@org.springframework.beans.factory.annotation.Autowired(required=true)}
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoSuchBeanDefinitionException(DefaultListableBeanFactory.java:1373)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1119)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1014)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:545        )
    ... 25 more
</code></pre>

<p>When the compilation error is resolved, I intend to trigger the logout process from the following code which will be added to the <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/blob/master/oauth2/ui/src/main/resources/static/js/hello.js"" rel=""nofollow noreferrer""><code>hello.js</code> controller of the <code>ui</code> app</a> in the github link above:  </p>

<pre><code>self.logout = function() {
    $http.post('http://localhost:9000/oauth/revoke-token', {}).finally(function() {
        $rootScope.authenticated = false;
        $location.path(""/"");
    });
}
</code></pre>

<p><strong>The full code of the sample app is at the github link above, so what specific changes do I need to make in order to successfully <code>autowire</code> the <code>token store</code> and auto-logout the user globally?</strong>  </p>

<hr>

<p><strong>ONGOING EFFORTS:</strong>  </p>

<hr>

<p>Per @ManoJ's suggestion, I changed the new controller class to become the following:  </p>

<pre><code>package demo;

import javax.servlet.http.HttpServletRequest;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.oauth2.common.OAuth2AccessToken;
import org.springframework.security.oauth2.provider.token.TokenStore;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseStatus;
import org.springframework.http.HttpStatus;

@Controller
public class OAuthController {

    private TokenStore tokenStore;

    @Autowired
    public OAuthController(TokenStore tokenStore) {
        this.tokenStore = tokenStore;
    }

    @RequestMapping(value = ""/oauth/revoke-token"", method = RequestMethod.GET)
    @ResponseStatus(HttpStatus.OK)
    public void logout(HttpServletRequest request) {
        String authHeader = request.getHeader(""Authorization"");
        if (authHeader != null) {
            String tokenValue = authHeader.replace(""Bearer"", """").trim();
            OAuth2AccessToken accessToken = tokenStore.readAccessToken(tokenValue);
            tokenStore.removeAccessToken(accessToken);
        }
    }
}
</code></pre>

<p>However, I am still getting a very similar error message when I try to launch the app at the terminal with <code>mvn spring-boot:run</code>, as follows:  </p>

<pre><code>java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:497)
    at org.springframework.boot.maven.AbstractRunMojo$LaunchRunner.run(AbstractRunMojo.java:478)
    at java.lang.Thread.run(Thread.java:745)
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'OAuthController' defined in file [/home/user/spring_boot_apps/security_tut_remodel/tut-spring-security-and-angular-js/oauth2/authserver/target/classes/demo/OAuthController.class]: Unsatisfied dependency expressed through constructor argument with index 0 of type [org.springframework.security.oauth2.provider.token.TokenStore]: No qualifying bean of type [org.springframework.security.oauth2.provider.token.TokenStore] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type [org.springframework.security.oauth2.provider.token.TokenStore] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}
    at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:749)
    at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:185)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1143)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1046)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:538)
    at org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.refresh(EmbeddedWebApplicationContext.java:118)
    at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:766)
    at org.springframework.boot.SpringApplication.createAndRefreshContext(SpringApplication.java:361)
    at org.springframework.boot.SpringApplication.run(SpringApplication.java:307)
    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1191)
    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1180)
    at demo.AuthserverApplication.main(AuthserverApplication.java:88)
    ... 6 more
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type [org.springframework.security.oauth2.provider.token.TokenStore] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {}
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.raiseNoSuchBeanDefinitionException(DefaultListableBeanFactory.java:1373)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1119)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1014)
    at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:813)
    at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:741)
    ... 25 more
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
</code></pre>

<p><strong>Given that this class is the only addition to the sample app in the link in the first line of the <code>OP</code> above, all of the code for the entire app is available both online and on your own devbox with <code>git clone ...</code>.  So what else needs to change in order for autowire of the TokenStore to work properly?</strong></p>
",807797,,-1,,2017-05-23 11:54:22,2016-04-18 20:16:25,How to autowire this TokenStore,<spring><spring-security><spring-boot><autowired><spring-oauth2>,2,0,1,
Spring,40355743,1,,,2016,,5,2709,"<p>I would like to be able to upload images to a server, handling errors and exceptions gracefully, with error messages displayed to the user in the form, and ideally only using an existing barebones Spring Boot and Thymeleaf install. </p>

<p>Using the example project <a href=""https://github.com/spring-guides/gs-uploading-files"" rel=""nofollow noreferrer"">gs-uploading-files</a> I can upload files to a server using Spring Boot and Thymeleaf. In application.properties I set <code>spring.http.multipart.max-file-size=1MB</code> and 
<code>spring.http.multipart.max-request-size=1MB</code>. 
 However several security and validation issues are unresolved when I upload files larger than 1MB.</p>

<ol>
<li><p>Any file can be uploaded. For example, an html file could be uploaded and thus hosted on the server. How can files be restricted by type? Can they be validated in the page before the request is sent? If I have multiple ways of uploading images how can I validate all MultipartFiles?</p></li>
<li><p>Users can attempt to uploade large files, beyond the default limits of Spring and the embedded Tomcat. This causes a <code>org.springframework.web.multipart.MultipartException</code> is not handled by Spring. How can the file size be validated before the upload attempt? In case this is bypassesed can any file upload exceptions caught by Spring, so that a nice error message is displayed?</p></li>
<li><p>The default Spring error page is not used as a fallback for all exceptions. The MultipartException returns a Tomcat exception page with a full stacktrace (see Log 1).</p></li>
</ol>

<hr>

<p>I've searched to try and find and implement a set of solutions.</p>

<p>A step towards fixing number 1 is by amending to <code>handleFileUpload</code> check the content type, rejecting files which fail this:  <code>!file.getContentType().toLowerCase().startsWith(""image"")</code>. Will this always be valid? Can a malicious user bypass this? And how can I check every MultipartFile, to save having to remember to add this every time?</p>

<pre><code>@PostMapping(""/"")
public String handleFileUpload(@RequestParam(""file"") MultipartFile file, RedirectAttributes redirectAttributes)
        throws MultipartException, IllegalStateException {

    if (file != null &amp;&amp; file.getContentType() != null &amp;&amp; !file.getContentType().toLowerCase().startsWith(""image""))
        throw new MultipartException(""not img"");

    storageService.store(file);
    redirectAttributes.addFlashAttribute(""message"",
            ""You successfully uploaded "" + file.getOriginalFilename() + ""!"");

    return ""redirect:/"";
}
</code></pre>

<p>Adding an <code>@ExceptionHandler</code> doesn't work, it simply never gets called.</p>

<pre><code>@ExceptionHandler({ SizeLimitExceededException.class, MultipartException.class,
        java.lang.IllegalStateException.class })
public ModelAndView handleError(HttpServletRequest req, Exception e) {
    // error(""Request: "" + req.getRequestURL() + "" raised "" + ex);

    ModelAndView mav = new ModelAndView();
    mav.addObject(""exception"", e);
    mav.addObject(""url"", req.getRequestURL());
    mav.addObject(""timestamp"", new Date());
    mav.addObject(""error"", e.getClass());
    mav.addObject(""message"", e.getMessage());
    mav.addObject(""status"", HttpStatus.INTERNAL_SERVER_ERROR);
    mav.setViewName(""error"");
    return mav;
}
</code></pre>

<p>Number 3 can be resolved by a global exception handler on all Exceptions. (explained in detail in <a href=""https://spring.io/blog/2013/11/01/exception-handling-in-spring-mvc"" rel=""nofollow noreferrer"">this post</a>). However, I'm concerned that it may overrule a Controller level handler.</p>

<pre><code>package hello;

import java.util.Date;

import javax.servlet.http.HttpServletRequest;

import org.springframework.core.annotation.AnnotationUtils;
import org.springframework.http.HttpStatus;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseStatus;
import org.springframework.web.servlet.ModelAndView;

@ControllerAdvice
class GlobalDefaultExceptionHandler {
    public static final String DEFAULT_ERROR_VIEW = ""error"";

    @ExceptionHandler(value = Exception.class)
    public ModelAndView defaultErrorHandler(HttpServletRequest req, Exception e) throws Exception {
        // If the exception is annotated with @ResponseStatus rethrow it and let
        // the framework handle it - like the OrderNotFoundException example
        // at the start of this post.
        // AnnotationUtils is a Spring Framework utility class.
        if (AnnotationUtils.findAnnotation(e.getClass(), ResponseStatus.class) != null)
            throw e;

        // Otherwise setup and send the user to a default error-view.
        ModelAndView mav = new ModelAndView();
        mav.addObject(""exception"", e);
        mav.addObject(""url"", req.getRequestURL());
        mav.addObject(""timestamp"", new Date());
        mav.addObject(""error"", e.getClass());
        mav.addObject(""message"", e.getMessage());
        mav.addObject(""status"", HttpStatus.INTERNAL_SERVER_ERROR);
        mav.setViewName(DEFAULT_ERROR_VIEW);
        return mav;
    }
}
</code></pre>

<p>I've attempted <a href=""https://stackoverflow.com/questions/29363705/handling-multipartexception-with-spring-boot-and-display-error-page"">this answer</a>, which handles the exception but returns an error page. I'd like to return to the original page and display a nice error message. </p>

<hr>

<p>Log 1:</p>

<pre><code>HTTP Status 500 - Request processing failed; nested exception is org.springframework.web.multipart.MultipartException: Could not parse multipart servlet request; nested exception is java.lang.IllegalStateException: org.apache.tomcat.util.http.fileupload.FileUploadBase$SizeLimitExceededException: the request was rejected because its size (1292555) exceeds the configured maximum (1048576)

type Exception report

message Request processing failed; nested exception is org.springframework.web.multipart.MultipartException: Could not parse multipart servlet request; nested exception is java.lang.IllegalStateException: org.apache.tomcat.util.http.fileupload.FileUploadBase$SizeLimitExceededException: the request was rejected because its size (1292555) exceeds the configured maximum (1048576)

description The server encountered an internal error that prevented it from fulfilling this request.

exception

org.springframework.web.util.NestedServletException: Request processing failed; nested exception is org.springframework.web.multipart.MultipartException: Could not parse multipart servlet request; nested exception is java.lang.IllegalStateException: org.apache.tomcat.util.http.fileupload.FileUploadBase$SizeLimitExceededException: the request was rejected because its size (1292555) exceeds the configured maximum (1048576)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:982)
    org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:648)
    org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:729)
    org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
    org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)
    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
    org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:89)
    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
    org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:77)
    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
    org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)
    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
root cause

org.springframework.web.multipart.MultipartException: Could not parse multipart servlet request; nested exception is java.lang.IllegalStateException: org.apache.tomcat.util.http.fileupload.FileUploadBase$SizeLimitExceededException: the request was rejected because its size (1292555) exceeds the configured maximum (1048576)
    org.springframework.web.multipart.support.StandardMultipartHttpServletRequest.parseRequest(StandardMultipartHttpServletRequest.java:111)
    org.springframework.web.multipart.support.StandardMultipartHttpServletRequest.&lt;init&gt;(StandardMultipartHttpServletRequest.java:85)
    org.springframework.web.multipart.support.StandardServletMultipartResolver.resolveMultipart(StandardServletMultipartResolver.java:76)
    org.springframework.web.servlet.DispatcherServlet.checkMultipart(DispatcherServlet.java:1099)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:932)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:897)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)
    org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:648)
    org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:729)
    org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
    org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)
    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
    org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:89)
    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
    org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:77)
    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
    org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)
    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
root cause

java.lang.IllegalStateException: org.apache.tomcat.util.http.fileupload.FileUploadBase$SizeLimitExceededException: the request was rejected because its size (1292555) exceeds the configured maximum (1048576)
    org.apache.catalina.connector.Request.parseParts(Request.java:2871)
    org.apache.catalina.connector.Request.parseParameters(Request.java:3176)
    org.apache.catalina.connector.Request.getParameter(Request.java:1110)
    org.apache.catalina.connector.RequestFacade.getParameter(RequestFacade.java:381)
    org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:70)
    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
    org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)
    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
root cause

org.apache.tomcat.util.http.fileupload.FileUploadBase$SizeLimitExceededException: the request was rejected because its size (1292555) exceeds the configured maximum (1048576)
    org.apache.tomcat.util.http.fileupload.FileUploadBase$FileItemIteratorImpl.&lt;init&gt;(FileUploadBase.java:811)
    org.apache.tomcat.util.http.fileupload.FileUploadBase.getItemIterator(FileUploadBase.java:256)
    org.apache.tomcat.util.http.fileupload.FileUploadBase.parseRequest(FileUploadBase.java:280)
    org.apache.catalina.connector.Request.parseParts(Request.java:2801)
    org.apache.catalina.connector.Request.parseParameters(Request.java:3176)
    org.apache.catalina.connector.Request.getParameter(Request.java:1110)
    org.apache.catalina.connector.RequestFacade.getParameter(RequestFacade.java:381)
    org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:70)
    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
    org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)
    org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
note The full stack trace of the root cause is available in the Apache Tomcat/8.5.5 logs.

Apache Tomcat/8.5.5
</code></pre>

<hr>
",4161471,,-1,,2017-05-23 12:10:04,2018-02-19 12:31:17,"File upload in Spring Boot: Uploading, validation, and exception handling",<java><tomcat><file-upload><spring-boot><thymeleaf>,2,0,1,
Spring,41850162,1,,,2017,,4,903,"<p>Referring to the logout flow in <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/single-sign-out/oauth2"" rel=""nofollow noreferrer"">oauth2</a> spring-guides project, once the the user has authenticated using user/password for the first time, the credentials are not asked next time after logout.</p>

<p>How can I ensure that username/password are asked every time after a logout.</p>

<p>This is what I am trying to implement:-</p>

<ul>
<li><p>OAuth2 server issuing JWT token using ""authorization_code"" grant type
with auto approval. This has html/angularjs form to collect
username/password.</p></li>
<li><p>UI/Webfront - Uses @EnableSSO. ALL its endpoints are authenticated
i.e it does not have any unauthorized landing page/ui/link that user
clicks to go to /uaa server. So hitting <a href=""http://localhost:8080"" rel=""nofollow noreferrer"">http://localhost:8080</a>
instantly redirects you to <a href=""http://localhost:9999/uaa"" rel=""nofollow noreferrer"">http://localhost:9999/uaa</a> and presents
custom form to collect username/password.</p></li>
<li>Resource server - Uses @EnableResourceServer. Plain &amp; simple REST api.</li>
</ul>

<p>With the above approach I am not able to workout the logout flow. HTTP POST /logout to the UI application clears the session/auth in UI application but the users gets logged in again automatically ( as I have opted for auto approval for all scopes) without being asked for username password again.</p>

<p>Looking at logs and networks calls, it looks like that all the ""oauth dance"" happens all over again successfully without user being asked for username/password again and seems like the auth server remembers last auth token issued for a client ( using org.springframework.security.oauth2.provider.code.InMemoryAuthorizationCodeServices? ).</p>

<p>How can I tell auth server to ask for username/password every time it is requested for code/token - stateless.</p>

<p>Or what is the best way to implement logout in my given scenario.</p>

<p>( To recreate somewhat near to my requirements, remove <code>permitAll()</code> part from the UiApplication and configure <code>autoApproval</code> in auth server of the mentioned boot project.)</p>

<p><a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/issues/138"" rel=""nofollow noreferrer"">github issue</a></p>
",945034,,1531064,,2017-07-18 8:02:25,2017-07-24 20:53:37,Spring Security OAuth2 AngularJS | Logout Flow,<spring-security><spring-security-oauth2>,3,2,1,
Spring,34525587,1,34560982,,2015,,7,4791,"<p>I must prepare a webservice to accept anan already defined wsdl structure. I followed the tutorial <a href=""https://spring.io/guides/gs/producing-web-service/"" rel=""noreferrer"">found here</a>, with source code for the test project <a href=""https://github.com/spring-guides/gs-producing-web-service/archive/master.zip"" rel=""noreferrer"">downloadable here</a>.</p>

<p>For xsd like this:</p>

<pre><code>&lt;xs:element name=""getCountryRequest""&gt;
    &lt;xs:complexType&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=""name"" type=""xs:string""/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
&lt;/xs:element&gt;
</code></pre>

<p>Wsdl operation for request returned by application is OK, looks like this:</p>

<pre><code>&lt;wsdl:binding name=""CountriesPortSoap11"" type=""tns:CountriesPort""&gt;
    &lt;soap:binding style=""document"" transport=""http://schemas.xmlsoap.org/soap/http""/&gt;
    &lt;wsdl:operation name=""getCountry""&gt;
        &lt;soap:operation soapAction=""""/&gt;
        &lt;wsdl:input name=""getCountryRequest""&gt;
            &lt;soap:body use=""literal""/&gt;
        &lt;/wsdl:input&gt;
        &lt;wsdl:output name=""getCountryResponse""&gt;
            &lt;soap:body use=""literal""/&gt;
        &lt;/wsdl:output&gt;
    &lt;/wsdl:operation&gt;
&lt;/wsdl:binding&gt;
</code></pre>

<p>But when I change the xsd to (no 'Request' in element name):</p>

<pre><code>&lt;xs:element name=""getCountry""&gt;
    &lt;xs:complexType&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name=""name"" type=""xs:string""/&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
&lt;/xs:element&gt;
</code></pre>

<p>the wsdl is invalid, and has no <code>&lt;input&gt;</code> specified:</p>

<pre><code>&lt;wsdl:binding name=""CountriesPortSoap11"" type=""tns:CountriesPort""&gt;
    &lt;soap:binding style=""document"" transport=""http://schemas.xmlsoap.org/soap/http""/&gt;
    &lt;wsdl:operation name=""getCountry""&gt;
        &lt;soap:operation soapAction=""""/&gt;
        &lt;wsdl:output name=""getCountryResponse""&gt;
            &lt;soap:body use=""literal""/&gt;
        &lt;/wsdl:output&gt;
    &lt;/wsdl:operation&gt;
&lt;/wsdl:binding&gt;
</code></pre>

<p>How can I fix that? How can I make a <code>Request</code>-less element appear properly as soap operation input in wsdl?</p>
",1961634,,1961634,,2015-12-30 8:28:23,2016-11-25 8:22:56,Invalid wsdl generated by spring-ws when the request element doesn't end with 'Request',<java><web-services><wsdl><cxf><spring-ws>,3,1,1,
Spring,34512248,1,34576917,,2015,,7,1291,"<p>I'm trying to use Facebook sign in as described in 
<a href=""https://github.com/spring-guides/gs-accessing-facebook"" rel=""noreferrer"">https://github.com/spring-guides/gs-accessing-facebook</a></p>

<p>When I'm trying to create JdbcUsersConnectionRepository, I need spring security in class path.
And when I add spring security I receive</p>

<pre><code>""java.lang.IllegalStateException: Unable to get a ConnectionRepository: no user signed in""
</code></pre>

<p>when trying to receive Connection</p>

<pre><code>Connection&lt;Facebook&gt; connection = connectionRepository.findPrimaryConnection(Facebook.class);
</code></pre>

<p>or checking</p>

<pre><code>if (!facebook.isAuthorized())
</code></pre>

<p>All this happens only when spring security is in the class path</p>
",20391,,,,,2016-10-31 12:55:47,"Spring Social: ""Unable to get a ConnectionRepository: no user signed in""",<spring><facebook><spring-security><spring-social><spring-social-facebook>,2,0,,
Spring,46174992,1,46229614,,2017,,8,628,"<p>I have extended spring security oauth example <a href=""https://github.com/spring-guides/tut-spring-boot-oauth2/tree/master/auth-server"" rel=""noreferrer"">social-auth-server</a>, linkedIn was added as third authentication option.
This project is described in tutorial <a href=""https://spring.io/guides/tutorials/spring-boot-oauth2/#_social_login_authserver"" rel=""noreferrer"">Hosting an Authorization Server</a>. </p>

<p>Source code: <a href=""https://github.com/spring-guides/tut-spring-boot-oauth2/tree/master/auth-server"" rel=""noreferrer"">https://github.com/spring-guides/tut-spring-boot-oauth2/tree/master/auth-server</a></p>

<p>How to configure this client to add client_id?</p>

<p>LinkedIn properties:</p>

<pre><code>linkedin:
  client:
    clientId: XXX
    clientSecret: YYY
    accessTokenUri: https://www.linkedin.com/oauth/v2/accessToken
    userAuthorizationUri: https://www.linkedin.com/oauth/v2/authorization
  resource:
    userInfoUri: https://api.linkedin.com/v1/people/~?format=json
</code></pre>

<p>Logs:</p>

<pre><code>uth2ClientAuthenticationProcessingFilter : Request is to process authentication
 g.c.AuthorizationCodeAccessTokenProvider : Retrieving token from https://www.linkedin.com/oauth/v2/accessToken
 g.c.AuthorizationCodeAccessTokenProvider : Encoding and sending form: {grant_type=[authorization_code], code=[XXXXXXXXXXXXXXXXXXXX], redirect_uri=[http://localhost:8080/login/linkedin]}
 uth2ClientAuthenticationProcessingFilter : Authentication request failed: org.springframework.security.authentication.BadCredentialsException: Could not obtain access token
</code></pre>

<p>Exception:</p>

<pre><code>org.springframework.security.authentication.BadCredentialsException: Could not obtain access token
    at org.springframework.security.oauth2.client.filter.OAuth2ClientAuthenticationProcessingFilter.attemptAuthentication(OAuth2ClientAuthenticationProcessingFilter.java:107) ~[spring-security-oauth2-2.0.13.RELEASE.jar:na]
    at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:212) ~[spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:112) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:73) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.security.web.csrf.CsrfFilter.doFilterInternal(CsrfFilter.java:100) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:64) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:331) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:214) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177) [spring-security-web-4.2.2.RELEASE.jar:4.2.2.RELEASE]
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:262) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.springframework.security.oauth2.client.filter.OAuth2ClientContextFilter.doFilter(OAuth2ClientContextFilter.java:60) [spring-security-oauth2-2.0.13.RELEASE.jar:na]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:105) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:81) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.springframework.boot.actuate.autoconfigure.MetricsFilter.doFilterInternal(MetricsFilter.java:106) [spring-boot-actuator-1.5.2.RELEASE.jar:1.5.2.RELEASE]
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) [spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:192) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:165) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:474) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:349) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:783) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:798) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1434) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_144]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_144]
    at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-8.5.11.jar:8.5.11]
    at java.lang.Thread.run(Thread.java:748) [na:1.8.0_144]
Caused by: org.springframework.security.oauth2.client.resource.OAuth2AccessDeniedException: Access token denied.
    at org.springframework.security.oauth2.client.token.OAuth2AccessTokenSupport.retrieveToken(OAuth2AccessTokenSupport.java:142) ~[spring-security-oauth2-2.0.13.RELEASE.jar:na]
    at org.springframework.security.oauth2.client.token.grant.code.AuthorizationCodeAccessTokenProvider.obtainAccessToken(AuthorizationCodeAccessTokenProvider.java:209) ~[spring-security-oauth2-2.0.13.RELEASE.jar:na]
    at org.springframework.security.oauth2.client.token.AccessTokenProviderChain.obtainNewAccessTokenInternal(AccessTokenProviderChain.java:148) ~[spring-security-oauth2-2.0.13.RELEASE.jar:na]
    at org.springframework.security.oauth2.client.token.AccessTokenProviderChain.obtainAccessToken(AccessTokenProviderChain.java:121) ~[spring-security-oauth2-2.0.13.RELEASE.jar:na]
    at org.springframework.security.oauth2.client.OAuth2RestTemplate.acquireAccessToken(OAuth2RestTemplate.java:221) ~[spring-security-oauth2-2.0.13.RELEASE.jar:na]
    at org.springframework.security.oauth2.client.OAuth2RestTemplate.getAccessToken(OAuth2RestTemplate.java:173) ~[spring-security-oauth2-2.0.13.RELEASE.jar:na]
    at org.springframework.security.oauth2.client.filter.OAuth2ClientAuthenticationProcessingFilter.attemptAuthentication(OAuth2ClientAuthenticationProcessingFilter.java:105) ~[spring-security-oauth2-2.0.13.RELEASE.jar:na]
    ... 62 common frames omitted
Caused by: org.springframework.security.oauth2.common.exceptions.InvalidRequestException: A required parameter ""client_id"" is missing
    at org.springframework.security.oauth2.common.exceptions.OAuth2ExceptionJackson2Deserializer.deserialize(OAuth2ExceptionJackson2Deserializer.java:100) ~[spring-security-oauth2-2.0.13.RELEASE.jar:na]
    at org.springframework.security.oauth2.common.exceptions.OAuth2ExceptionJackson2Deserializer.deserialize(OAuth2ExceptionJackson2Deserializer.java:33) ~[spring-security-oauth2-2.0.13.RELEASE.jar:na]
    at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:3798) ~[jackson-databind-2.8.7.jar:2.8.7]
    at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:2922) ~[jackson-databind-2.8.7.jar:2.8.7]
    at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.readJavaType(AbstractJackson2HttpMessageConverter.java:237) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.readInternal(AbstractJackson2HttpMessageConverter.java:217) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.http.converter.AbstractHttpMessageConverter.read(AbstractHttpMessageConverter.java:193) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.security.oauth2.client.token.OAuth2AccessTokenSupport$AccessTokenErrorHandler.handleError(OAuth2AccessTokenSupport.java:235) ~[spring-security-oauth2-2.0.13.RELEASE.jar:na]
    at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:700) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:653) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:621) ~[spring-web-4.3.7.RELEASE.jar:4.3.7.RELEASE]
    at org.springframework.security.oauth2.client.token.OAuth2AccessTokenSupport.retrieveToken(OAuth2AccessTokenSupport.java:137) ~[spring-security-oauth2-2.0.13.RELEASE.jar:na]
    ... 68 common frames omitted
</code></pre>
",516167,,516167,,2017-09-13 10:04:49,2018-07-04 17:10:02,Missing client_id when accessing token with linkedIn,<spring><spring-security><oauth><spring-oauth2>,2,0,,
Spring,34821978,1,,,2016,,8,16335,"<p>I am studying AngularJS and REST.  A code sample uses the word <code>callback</code> repeatedly in an authentication function.  <strong>Is callback a keyword in JavaScript or Angular?  Or is <code>callback</code> just a custom variable created in this code?  How does <code>callback</code> work in the code below?</strong>  Googling <code>callback</code> and AngularJS is not producing usable results.  <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/blob/master/modular/src/main/resources/static/js/auth/auth.js"" rel=""noreferrer"">The code for the AngularJS module in question can be read at this link</a>, which also contains all the code for the sample app.  </p>

<p>Here is the module code itself:  </p>

<pre><code>angular.module('auth', []).factory( 'auth',

    function($rootScope, $http, $location) {

        enter = function() {
            if ($location.path() != auth.loginPath) {
                auth.path = $location.path();
                if (!auth.authenticated) {
                    $location.path(auth.loginPath);
                }
            }                   
        }

        var auth = {

            authenticated : false,

            loginPath : '/login',
            logoutPath : '/logout',
            homePath : '/',
            path : $location.path(),

            authenticate : function(credentials, callback) {

                var headers = credentials &amp;&amp; credentials.username ? {
                    authorization : ""Basic ""
                            + btoa(credentials.username + "":""
                                    + credentials.password)
                } : {};

                $http.get('user', {
                    headers : headers
                }).success(function(data) {
                    if (data.name) {
                        auth.authenticated = true;
                    } else {
                        auth.authenticated = false;
                    }
                    callback &amp;&amp; callback(auth.authenticated);
                    $location.path(auth.path==auth.loginPath ? auth.homePath : auth.path);
                }).error(function() {
                    auth.authenticated = false;
                    callback &amp;&amp; callback(false);
                });

            },

            clear : function() {
                $location.path(auth.loginPath);
                auth.authenticated = false;
                $http.post(auth.logoutPath, {}).success(function() {
                    console.log(""Logout succeeded"");
                }).error(function(data) {
                    console.log(""Logout failed"");
                });
            },

            init : function(homePath, loginPath, logoutPath) {

                auth.homePath = homePath;
                auth.loginPath = loginPath;
                auth.logoutPath = logoutPath;

                auth.authenticate({}, function(authenticated) {
                    if (authenticated) {
                        $location.path(auth.path);
                    }
                })

                // Guard route changes and switch to login page if unauthenticated
                $rootScope.$on('$routeChangeStart', function() {
                    enter();
                });

            }

        };

        return auth;

    });
</code></pre>

<hr>

<p><strong>ADDITIONAL INFORMATION:</strong>  </p>

<hr>

<p>Based on @okonyk's response, I am including code from a DIFFERENT MODULE that calls the auth.authenticate() function:  </p>

<pre><code>$scope.login = function() {
    auth.authenticate($scope.credentials, function(authenticated) {
        if (authenticated) {
            //do some stuff
             $scope.error = false;
         } else { 
            $scope.error = true;
        }
    })
}
</code></pre>

<p>So how does the call from <code>login()</code> to <code>auth.authenticate($scope.credentials, function(authenticated)</code> work?  Is the <code>function(authenticated)</code> parameter sending a boolean that determines functionality inside <code>auth.authenticate()</code>?  If so, can you please be explicit?  I can piece it together.  For example true might indicate to do the callback, while false might indicate note to do the callback, but it would help to have it explained.  <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/blob/master/modular/src/main/resources/static/js/navigation/navigation.js"" rel=""noreferrer"">You can read the code in the sample app for the other module with the <code>login()</code> method by clicking on this link</a>.</p>
",807797,,807797,,2016-01-16 6:48:54,2016-01-16 8:18:04,How does callback work in AngularJS call to REST service?,<javascript><angularjs>,2,0,,
Spring,27987068,1,45322933,,2015,,11,6800,"<p>I've modified the Spring Boot JPA Data example (<a href=""https://github.com/spring-guides/gs-accessing-data-jpa.git"">https://github.com/spring-guides/gs-accessing-data-jpa.git</a>) slightly adding an Order entity and a corresponding one to many mapping to it from the customer.  When I run the example there are several Syntax Error in SQL Statement lines logged by Hibernate.  I'm trying to figure out why?  I've pasted the code for the entities and the console output from the application below.</p>

<pre><code>package hello;

import java.util.List;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.OneToMany;

@Entity
public class Customer {

@Id
@GeneratedValue(strategy=GenerationType.AUTO)
private long id;
private String firstName;
private String lastName;
@OneToMany(mappedBy=""customer"")
private List&lt;Order&gt; orders;


protected Customer() {}

public Customer(String firstName, String lastName) {
    this.firstName = firstName;
    this.lastName = lastName;
}

@Override
public String toString() {
    return String.format(
            ""Customer[id=%d, firstName='%s', lastName='%s']"",
            id, firstName, lastName);
}

}
</code></pre>

<p>And a corresponding Order entity:</p>

<pre><code>package hello;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.ManyToOne;

@Entity
public class Order {

@Id
@GeneratedValue(strategy=GenerationType.AUTO)
private long id;

protected Order() {}

double amount;

@ManyToOne
Customer customer;
}
</code></pre>

<p>And the console output:</p>

<pre><code>    .   ____          _            __ _ _
     /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
    ( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
     \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
      '  |____| .__|_| |_|_| |_\__, | / / / /
     =========|_|==============|___/=/_/_/_/
     :: Spring Boot ::       (v1.1.10.RELEASE)

    2015-01-16 08:56:53.116  INFO 27810 --- [           main] hello.Application                        : Starting Application on MKI with PID 27810 (/home/ole/Documents/workspace-sts-3.6.3.RELEASE/gs-accessing-data-jpa-complete/target/classes started by ole in /home/ole/Documents/workspace-sts-3.6.3.RELEASE/gs-accessing-data-jpa-complete)
    2015-01-16 08:56:53.149  INFO 27810 --- [           main] s.c.a.AnnotationConfigApplicationContext : Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@5d59e6f1: startup date [Fri Jan 16 08:56:53 CST 2015]; root of context hierarchy
    2015-01-16 08:56:54.253  INFO 27810 --- [           main] j.LocalContainerEntityManagerFactoryBean : Building JPA container EntityManagerFactory for persistence unit 'default'
    2015-01-16 08:56:54.269  INFO 27810 --- [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [
      name: default
      ...]
    2015-01-16 08:56:54.320  INFO 27810 --- [           main] org.hibernate.Version                    : HHH000412: Hibernate Core {4.3.7.Final}
    2015-01-16 08:56:54.322  INFO 27810 --- [           main] org.hibernate.cfg.Environment            : HHH000205: Loaded properties from resource hibernate.properties: {hibernate.connection.charSet=UTF-8, hibernate.dialect=org.hibernate.dialect.H2Dialect, hibernate.show_sql=true, hibernate.export.schema.delimiter=;, hibernate.bytecode.use_reflection_optimizer=false, hibernate.ejb.naming_strategy=org.hibernate.cfg.ImprovedNamingStrategy}
    2015-01-16 08:56:54.322  INFO 27810 --- [           main] org.hibernate.cfg.Environment            : HHH000021: Bytecode provider name : javassist
    2015-01-16 08:56:54.462  INFO 27810 --- [           main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {4.0.5.Final}
    2015-01-16 08:56:54.499  INFO 27810 --- [           main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
    2015-01-16 08:56:54.591  INFO 27810 --- [           main] o.h.h.i.ast.ASTQueryTranslatorFactory    : HHH000397: Using ASTQueryTranslatorFactory
    2015-01-16 08:56:54.751  INFO 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : HHH000227: Running hbm2ddl schema export
    Hibernate: alter table order drop constraint FK_m6q2ofkj1g5aobtb2p00ajpqg if exists
    2015-01-16 08:56:54.752 ERROR 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : HHH000389: Unsuccessful: alter table order drop constraint FK_m6q2ofkj1g5aobtb2p00ajpqg if exists
    2015-01-16 08:56:54.753 ERROR 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : Syntax error in SQL statement ""ALTER TABLE ORDER[*] DROP CONSTRAINT FK_M6Q2OFKJ1G5AOBTB2P00AJPQG IF EXISTS ""; expected ""identifier""; SQL statement:
    alter table order drop constraint FK_m6q2ofkj1g5aobtb2p00ajpqg if exists [42001-176]
    Hibernate: drop table customer if exists
    Hibernate: drop table order if exists
    2015-01-16 08:56:54.753 ERROR 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : HHH000389: Unsuccessful: drop table order if exists
    2015-01-16 08:56:54.753 ERROR 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : Syntax error in SQL statement ""DROP TABLE ORDER[*] IF EXISTS ""; expected ""identifier""; SQL statement:
    drop table order if exists [42001-176]
    Hibernate: create table customer (id bigint generated by default as identity, first_name varchar(255), last_name varchar(255), primary key (id))
    Hibernate: create table order (id bigint generated by default as identity, amount double not null, customer_id bigint, primary key (id))
    2015-01-16 08:56:54.756 ERROR 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : HHH000389: Unsuccessful: create table order (id bigint generated by default as identity, amount double not null, customer_id bigint, primary key (id))
    2015-01-16 08:56:54.756 ERROR 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : Syntax error in SQL statement ""CREATE TABLE ORDER[*] (ID BIGINT GENERATED BY DEFAULT AS IDENTITY, AMOUNT DOUBLE NOT NULL, CUSTOMER_ID BIGINT, PRIMARY KEY (ID)) ""; expected ""identifier""; SQL statement:
    create table order (id bigint generated by default as identity, amount double not null, customer_id bigint, primary key (id)) [42001-176]
    Hibernate: alter table order add constraint FK_m6q2ofkj1g5aobtb2p00ajpqg foreign key (customer_id) references customer
    2015-01-16 08:56:54.757 ERROR 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : HHH000389: Unsuccessful: alter table order add constraint FK_m6q2ofkj1g5aobtb2p00ajpqg foreign key (customer_id) references customer
    2015-01-16 08:56:54.757 ERROR 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : Syntax error in SQL statement ""ALTER TABLE ORDER[*] ADD CONSTRAINT FK_M6Q2OFKJ1G5AOBTB2P00AJPQG FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER ""; expected ""identifier""; SQL statement:
    alter table order add constraint FK_m6q2ofkj1g5aobtb2p00ajpqg foreign key (customer_id) references customer [42001-176]
    2015-01-16 08:56:54.757  INFO 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : HHH000230: Schema export complete
    2015-01-16 08:56:55.085  INFO 27810 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup
    2015-01-16 08:56:55.102  INFO 27810 --- [           main] hello.Application                        : Started Application in 2.286 seconds (JVM running for 2.604)
    Hibernate: insert into customer (id, first_name, last_name) values (null, ?, ?)
    Hibernate: insert into customer (id, first_name, last_name) values (null, ?, ?)
    Hibernate: insert into customer (id, first_name, last_name) values (null, ?, ?)
    Hibernate: insert into customer (id, first_name, last_name) values (null, ?, ?)
    Hibernate: insert into customer (id, first_name, last_name) values (null, ?, ?)
    Hibernate: select customer0_.id as id1_0_, customer0_.first_name as first_na2_0_, customer0_.last_name as last_nam3_0_ from customer customer0_
    Customers found with findAll():
    -------------------------------
    Customer[id=1, firstName='Jack', lastName='Bauer']
    Customer[id=2, firstName='Chloe', lastName='O'Brian']
    Customer[id=3, firstName='Kim', lastName='Bauer']
    Customer[id=4, firstName='David', lastName='Palmer']
    Customer[id=5, firstName='Michelle', lastName='Dessler']

    Hibernate: select customer0_.id as id1_0_0_, customer0_.first_name as first_na2_0_0_, customer0_.last_name as last_nam3_0_0_ from customer customer0_ where customer0_.id=?
    Customer found with findOne(1L):
    --------------------------------
    Customer[id=1, firstName='Jack', lastName='Bauer']

    Hibernate: select customer0_.id as id1_0_, customer0_.first_name as first_na2_0_, customer0_.last_name as last_nam3_0_ from customer customer0_ where customer0_.last_name=?
    Customer found with findByLastName('Bauer'):
    --------------------------------------------
    Customer[id=1, firstName='Jack', lastName='Bauer']
    Customer[id=3, firstName='Kim', lastName='Bauer']
    Hibernate: select customer0_.id as id1_0_, customer0_.first_name as first_na2_0_, customer0_.last_name as last_nam3_0_ from customer customer0_
    Hibernate: delete from customer where id=?
    Hibernate: delete from customer where id=?
    Hibernate: delete from customer where id=?
    Hibernate: delete from customer where id=?
    Hibernate: delete from customer where id=?
    2015-01-16 08:56:55.258  INFO 27810 --- [           main] s.c.a.AnnotationConfigApplicationContext : Closing org.springframework.context.annotation.AnnotationConfigApplicationContext@5d59e6f1: startup date [Fri Jan 16 08:56:53 CST 2015]; root of context hierarchy
    2015-01-16 08:56:55.259  INFO 27810 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Unregistering JMX-exposed beans on shutdown
    2015-01-16 08:56:55.260  INFO 27810 --- [           main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
    2015-01-16 08:56:55.261  INFO 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : HHH000227: Running hbm2ddl schema export
    Hibernate: alter table order drop constraint FK_m6q2ofkj1g5aobtb2p00ajpqg if exists
    2015-01-16 08:56:55.261 ERROR 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : HHH000389: Unsuccessful: alter table order drop constraint FK_m6q2ofkj1g5aobtb2p00ajpqg if exists
    2015-01-16 08:56:55.261 ERROR 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : Syntax error in SQL statement ""ALTER TABLE ORDER[*] DROP CONSTRAINT FK_M6Q2OFKJ1G5AOBTB2P00AJPQG IF EXISTS ""; expected ""identifier""; SQL statement:
    alter table order drop constraint FK_m6q2ofkj1g5aobtb2p00ajpqg if exists [42001-176]
    Hibernate: drop table customer if exists
    Hibernate: drop table order if exists
    2015-01-16 08:56:55.263 ERROR 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : HHH000389: Unsuccessful: drop table order if exists
    2015-01-16 08:56:55.263 ERROR 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : Syntax error in SQL statement ""DROP TABLE ORDER[*] IF EXISTS ""; expected ""identifier""; SQL statement:
    drop table order if exists [42001-176]
    2015-01-16 08:56:55.263  INFO 27810 --- [           main] org.hibernate.tool.hbm2ddl.SchemaExport  : HHH000230: Schema export complete
</code></pre>

<p>Thoughts?  </p>

<p>TIA,
- Ole</p>
",1684269,,,,,2018-07-13 13:10:55,Spring Boot Hibernate Syntax Error in SQL Statement,<spring><hibernate><jpa><spring-boot><spring-data-jpa>,2,2,,
Spring,47202657,1,,,2017,,1,1816,"<p>I am following the link <a href=""https://spring.io/blog/2015/02/03/sso-with-oauth2-angular-js-and-spring-security-part-v"" rel=""nofollow noreferrer"">https://spring.io/blog/2015/02/03/sso-with-oauth2-angular-js-and-spring-security-part-v</a> &amp; the github project <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2"" rel=""nofollow noreferrer"">https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2</a>. I am able to login in to the OAuth provider and get the authorization code back in the client. </p>

<p>Now I make the following call from the client to get the token from the provider (provider is on port 9999)</p>

<pre><code>        HttpHeaders headers = new HttpHeaders();
        headers.add(""Accept"",MediaType.APPLICATION_JSON_VALUE);
        List&lt;String&gt; cookies = httpEntity.getHeaders().get(""Cookie"");
        headers.put(""Cookie"", cookies);
        String redirectURL= ""http://localhost:9999/oauthprovider/oauth/token"" +  ""?"" + ""response_type=token"" + ""&amp;"" + ""grant_type=authorization_code"" + ""&amp;"" + ""client_id=acme""+ ""&amp;"" + ""client_secret=acmesecret""+  ""&amp;"" + ""redirect_uri=http://localhost:8081/callback""+""&amp;"" + ""code="" + authCode + ""&amp;"" + ""state="" + stateValue;

        HttpEntity&lt;String&gt; redirectResponse = template.exchange(
                redirectURL,
                    HttpMethod.POST,
                    responseentity,
                    String.class);


        result=redirectResponse.toString()
</code></pre>

<p>The result variable value has the following.(I have disabled csrf and sending client_secret as a query parameter (for the time being), although they are not recommended)</p>

<pre><code>    &lt;302 Found,{X-Content-Type-Options=[nosniff], X-XSS-Protection=[1; mode=block], Cache-Control=[no-cache, no-store, max-age=0, must-revalidate], Pragma=[no-cache], Expires=[0], X-Frame-Options=[DENY], Location=[http://localhost:9999/oauthprovider/oauthlogin], Content-Length=[0], Date=[Thu, 09 Nov 2017 12:07:37 GMT]}&gt;
</code></pre>

<p>In the console I have these</p>

<pre><code>   Previously Authenticated: org.springframework.security.authentication.AnonymousAuthenticationToken@9055c2bc: Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@b364: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: 2B669DF59BCE8047849BFBCA148BEE67; Granted Authorities: ROLE_ANONYMOUS
</code></pre>

<p>Does I am redirecting back to login(I am getting it in the logs as mentioned before), since the role is ROLE_ANONYMOUS? How can I fix the issue? </p>

<p>Adding more details on the code (Did only minor changes from the sample code provided in the link). Providers's context path is /oauthprovider and with curl call I am getting the token. </p>

<pre><code>@Configuration
@EnableAuthorizationServer
protected static class OAuth2AuthorizationConfig extends
        AuthorizationServerConfigurerAdapter {

    @Autowired
    private AuthenticationManager authenticationManager;

    //................................
    //................................
    @Override
    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {
        clients.inMemory()
                .withClient(""acme"")
                .secret(""acmesecret"")
                .authorizedGrantTypes(""authorization_code"", ""refresh_token"",
                        ""password"").scopes(""openid"").autoApprove(true).redirectUris(""http://localhost:8081/callback""); 
    }

    @Override
    public void configure(AuthorizationServerEndpointsConfigurer endpoints)
            throws Exception {
        endpoints.authenticationManager(authenticationManager).accessTokenConverter(
                jwtAccessTokenConverter());
    }

    @Override
    public void configure(AuthorizationServerSecurityConfigurer oauthServer)
            throws Exception {
        oauthServer.tokenKeyAccess(""permitAll()"").checkTokenAccess(
                ""isAuthenticated()"");
    }

}
@Configuration
@Order(-20)
protected static class LoginConfig extends WebSecurityConfigurerAdapter {

    @Autowired
    private AuthenticationManager authenticationManager;

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        // @formatter:off
        http
            .formLogin().loginPage(""/oauthlogin"").loginProcessingUrl(""/login"").failureUrl(""/login?error=true"").permitAll() 
        .and()
            .requestMatchers().antMatchers(""/login"", ""/oauthlogin"", ""/oauth/authorize"", ""/oauth/token"" ,""/oauth/confirm_access"")
        .and()
            .authorizeRequests().anyRequest().authenticated();
        // @formatter:on

        http.csrf().disable();
    }

    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        auth.parentAuthenticationManager(authenticationManager);
    }
}
</code></pre>
",7349475,,7349475,,2017-11-09 14:17:44,2019-01-29 14:08:19,Spring Security OAuth2- POST request to oauth/token redirects to login and role displays ROLE_ANONYMOUS,<spring><spring-security><oauth><oauth-2.0><spring-security-oauth2>,3,3,,
Spring,36581834,1,36586730,,2016,,1,602,"<p>I have been doing a line by line study of the code in <a href=""https://github.com/spring-guides/tut-spring-security-and-angular-js/tree/master/oauth2"" rel=""nofollow"">this spring cloud app on github</a> after downloading and installing it on my devbox.  When you type <code>http://localhost:8080</code> in your web browser, the content from the <code>ui</code> app loads, and is able to interact with the content from the <code>authserver</code> and <code>resource</code> apps.  </p>

<p><code>Port 9999</code> is defined for the <code>authserver</code> app, both in the <code>ui</code> app's <code>zuul route</code> definitions, and also in the <code>authserver</code> app's <code>application.properties</code>.  </p>

<p>Similarly, <code>port 9000</code> is defined for the <code>resource</code> app, both in the <code>ui</code> app's route definitions, and also in the <code>resource</code> app's <code>application.properties</code>.  </p>

<p>But I cannot find any reference to <code>port 8080</code>, even after reviewing every line of code in the three apps and also doing a <code>Ctrl-H</code> to do full text search of the entire eclipse workspace for the word <code>8080</code>.  </p>

<p><strong>So how does the <code>ui</code> app know to serve its client content on <code>port 8080</code>?</strong></p>
",807797,,,,,2016-04-13 6:35:42,where is port 8080 defined in spring cloud app?,<spring><spring-boot><spring-cloud><netflix-zuul>,3,1,,
Spring,42721597,1,42764690,,2017,,1,7037,"<p>As I followed this tutorial: <a href=""https://spring.io/guides/gs/handling-form-submission/"" rel=""nofollow noreferrer"">https://spring.io/guides/gs/handling-form-submission/</a> after a while I came to a dead end. I tried to figure out what the problem is for some hours now. I hope you can help me.</p>

<p>When I submit my form, I get this error-message:</p>

<pre><code> There was an unexpected error (type=Method Not Allowed, status=405).
 Request method 'POST' not supported
</code></pre>

<p>My App (App.java):</p>

<pre><code>package de.poc.logging.main;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
@SpringBootApplication
public class App {
  public static void main(String[] args) {
    SpringApplication.run(App.class, args);
  }
}
</code></pre>

<p>My Controller (InformationController.java):</p>

<pre><code>package de.poc.logging.main;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

@Controller
@RequestMapping(value = ""/info"")
public class InformationController {
  @RequestMapping(method = RequestMethod.GET, produces = ""text/html"")
  public String infoForm(Model model) {
    model.addAttribute(""information"", new Information());
    return ""infoForm.html"";
  }

  @RequestMapping(method = RequestMethod.POST, produces = ""text/html"")
  public String infoSubmit(@ModelAttribute Information information) {
    return ""infoResult.html"";
  }
}
</code></pre>

<p>I created an additional class for security (WebSecurityConf.java):</p>

<pre><code>package de.poc.logging.main.config;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;

@Configuration
@EnableWebSecurity
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {
  @Override
  protected void configure(HttpSecurity http) throws Exception {
    http.headers()
        .frameOptions().sameOrigin()
        .httpStrictTransportSecurity().disable();
    http.csrf().disable();
  }
}
</code></pre>

<p>And I have following two HTML-Files:</p>

<p>infoForm.html:</p>

<pre><code>    &lt;!DOCTYPE HTML&gt;
    &lt;html xmlns:th=""http://www.thymeleaf.org""&gt;
    &lt;head&gt;
        &lt;title&gt;Getting Started: Handling Form Submission&lt;/title&gt;
        &lt;meta http-equiv=""Content-Type"" content=""text/html; charset=UTF-8""/&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;h1&gt;Form&lt;/h1&gt;
    &lt;form action=""#"" th:action=""@{/info}"" th:object=""${information}"" method=""post""&gt;
        &lt;p&gt;Id: &lt;input type=""text"" th:field=""*{id}""/&gt;&lt;/p&gt;
        &lt;p&gt;Message: &lt;input type=""text"" th:field=""*{content}""/&gt;&lt;/p&gt;
        &lt;p&gt;&lt;input type=""submit"" value=""Submit""/&gt;
            &lt;input type=""reset"" value=""Reset""/&gt;&lt;/p&gt;
        &lt;!--&lt;input type=""hidden"" th:name=""${_csrf.parameterName}"" th:value=""${_csrf.token}""/&gt;--&gt;
    &lt;/form&gt;
    &lt;/body&gt;
    &lt;/html&gt;
</code></pre>

<p>infoResult.html:</p>

<pre><code>&lt;!DOCTYPE HTML&gt;
&lt;html xmlns:th=""http://www.thymeleaf.org""&gt;
&lt;head&gt;
    &lt;title&gt;Getting Started: Handling Form Submission&lt;/title&gt;
    &lt;meta http-equiv=""Content-Type"" content=""text/html; charset=UTF-8""/&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Result&lt;/h1&gt;
&lt;p th:text=""'id: ' + ${information.id}""/&gt;
&lt;p th:text=""'content: ' + ${information.content}""/&gt;
&lt;a href=""/info""&gt;Submit another message&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>Edit (additional information):
my Information.java:</p>

<pre><code>package de.poc.logging.main;

public class Information {
  private long id;
  private String content;

  public long getId() {
    return id;
  }

  public String getContent() {
    return content;
  }

  public void setId(long id) {
    this.id = id;
  }

  public void setContent(String content) {
    this.content = content;
  }

}
</code></pre>

<p>my pom-dependencies:</p>

<pre><code>    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
            &lt;version&gt;1.5.2.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
            &lt;version&gt;1.5.2.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
            &lt;version&gt;1.5.2.RELEASE&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
</code></pre>

<p>I'm using Java 1.8u121 (jdk).</p>

<p>Edit2:
I tried 3 different versions of spring boot now.
Also I downloaded the project from here: <a href=""https://github.com/spring-guides/gs-handling-form-submission"" rel=""nofollow noreferrer"">https://github.com/spring-guides/gs-handling-form-submission</a> and added spring boot via pom.xml.
The downloaded project does not work for me.</p>

<p>I'm getting really frustrated.</p>
",7458242,,7458242,,2017-03-13 10:14:01,2017-03-13 13:19:40,Spring Boot - Request method 'POST' not supported (Method not allowed),<java><spring><spring-mvc><post>,3,2,,
Spring,22935840,1,22935912,,2014,,2,4169,"<p>I am going through this guide:</p>

<p><a href=""https://spring.io/guides/gs/rest-service/"" rel=""nofollow"">https://spring.io/guides/gs/rest-service/</a></p>

<p>I use Maven for building, so I've fetched the pom.xml linked in the official Spring guide:</p>

<p><a href=""https://github.com/spring-guides/gs-rest-service/blob/master/initial/pom.xml"" rel=""nofollow"">https://github.com/spring-guides/gs-rest-service/blob/master/initial/pom.xml</a></p>

<pre><code>    &lt;?xml version=""1.0"" encoding=""UTF-8""?&gt;&lt;project xmlns=""http://maven.apache.org/POM/4.0.0"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance""
    xsi:schemaLocation=""http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd""&gt;

    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;gs-rest-service&lt;/artifactId&gt;
    &lt;version&gt;0.1.0&lt;/version&gt;

    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;1.0.1.RELEASE&lt;/version&gt;
    &lt;/parent&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;properties&gt;
        &lt;start-class&gt;hello.Application&lt;/start-class&gt;
    &lt;/properties&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.3.2&lt;/version&gt;
            &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-build&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-snapshots&lt;/id&gt;
            &lt;url&gt;http://repo.spring.io/libs-snapshot&lt;/url&gt;
            &lt;snapshots&gt;&lt;enabled&gt;true&lt;/enabled&gt;&lt;/snapshots&gt;
        &lt;/repository&gt;
        &lt;repository&gt;
            &lt;id&gt;spring-repo&lt;/id&gt;
            &lt;name&gt;Spring Repository&lt;/name&gt;
            &lt;url&gt;http://repo.spring.io/release&lt;/url&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;
    &lt;pluginRepositories&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;spring-snapshots&lt;/id&gt;
            &lt;url&gt;http://repo.spring.io/libs-snapshot&lt;/url&gt;
            &lt;snapshots&gt;&lt;enabled&gt;true&lt;/enabled&gt;&lt;/snapshots&gt;
        &lt;/pluginRepository&gt;
    &lt;/pluginRepositories&gt;
&lt;/project&gt;
</code></pre>

<p>I get the following error when running <em>mvn install</em></p>

<blockquote>
  <p>[ERROR] Error resolving version for plugin
  org.springframework.boot:spring-boot-maven-build' from the
  repositories [local (C:\Users\Laszlo_Szucs.m2\repository),
  spring-snapshots (repo.spring.io/libs-snapshot), central
  repo.maven.apache.org/maven2)]: Plugin not found in any plugin
  repository -> [Help 1]</p>
</blockquote>

<p><strong>How do I know which version to provide in the pom.xml for this?</strong></p>
",2427686,,2427686,,2014-04-08 12:15:57,2017-10-06 7:00:46,Cannot build Spring 4 project with Maven,<java><spring><maven><pom.xml>,3,1,,
Spring,40585031,1,40595012,,2016,,7,11431,"<p>Tried springboot for the first time but I am unable to get it to start.
I used the sample app: <a href=""https://github.com/spring-guides/gs-spring-boot.git"" rel=""nofollow noreferrer"">https://github.com/spring-guides/gs-spring-boot.git</a>
I also made modifications to use an embedded jetty instead of tomcat but still no success.</p>

<p>The exception I get is this: org.springframework.context.ApplicationContextException: Unable to start embedded container; nested exception is java.lang.IllegalArgumentException: Resource location must not be null.</p>

<p>This is on MacOSX.</p>

<p>Edit: I have confirmed this is an environment issue. I can start the app just fine in a linux(fedora) VM but for whatever reason I run into this problem on my Mac. Not sure if anyone else run into this and has any clues on what might be causing this.</p>

<p>Edit 2: So this appears to be an issue with trying to configure ssl by default. I am not sure why this is the case since I haven't specified this anywhere; So my question now is, how do I disable https in spring-boot? </p>

<pre><code>mvn -version
Apache Maven 3.2.5 (12a6b3acb947671f09b81f49094c53f426d8cea1; 2014-12-14T09:29:23-08:00)
Maven home: /usr/local/Cellar/maven/3.2.5/libexec
Java version: 1.8.0_25, vendor: Oracle Corporation
Java home: /Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk/Contents/Home/jre
Default locale: en_US, platform encoding: UTF-8
OS name: ""mac os x"", version: ""10.10.5"", arch: ""x86_64"", family: ""mac""
</code></pre>

<p>Any help is appreciated. </p>

<pre><code>org.springframework.context.ApplicationContextException: Unable to start embedded container; nested exception is java.lang.IllegalArgumentException: Resource location must not be null
    at org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.onRefresh(EmbeddedWebApplicationContext.java:137) ~[spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:536) ~[spring-context-4.3.4.RELEASE.jar!/:4.3.4.RELEASE]
    at org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.refresh(EmbeddedWebApplicationContext.java:122) ~[spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:761) [spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:371) [spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at org.springframework.boot.SpringApplication.run(SpringApplication.java:315) [spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1186) [spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1175) [spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at hello.Application.main(Application.java:15) [classes!/:0.1.0]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_25]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_25]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_25]
    at java.lang.reflect.Method.invoke(Method.java:483) ~[na:1.8.0_25]
    at org.springframework.boot.loader.MainMethodRunner.run(MainMethodRunner.java:48) [gs-spring-boot-0.1.0.jar:0.1.0]
    at org.springframework.boot.loader.Launcher.launch(Launcher.java:87) [gs-spring-boot-0.1.0.jar:0.1.0]
    at org.springframework.boot.loader.Launcher.launch(Launcher.java:50) [gs-spring-boot-0.1.0.jar:0.1.0]
    at org.springframework.boot.loader.JarLauncher.main(JarLauncher.java:58) [gs-spring-boot-0.1.0.jar:0.1.0]
Caused by: java.lang.IllegalArgumentException: Resource location must not be null
    at org.springframework.util.Assert.notNull(Assert.java:115) ~[spring-core-4.3.4.RELEASE.jar!/:4.3.4.RELEASE]
    at org.springframework.util.ResourceUtils.getURL(ResourceUtils.java:131) ~[spring-core-4.3.4.RELEASE.jar!/:4.3.4.RELEASE]
    at org.springframework.boot.context.embedded.tomcat.TomcatEmbeddedServletContainerFactory.configureSslKeyStore(TomcatEmbeddedServletContainerFactory.java:417) ~[spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at org.springframework.boot.context.embedded.tomcat.TomcatEmbeddedServletContainerFactory.configureSsl(TomcatEmbeddedServletContainerFactory.java:395) ~[spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at org.springframework.boot.context.embedded.tomcat.TomcatEmbeddedServletContainerFactory.customizeSsl(TomcatEmbeddedServletContainerFactory.java:332) ~[spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at org.springframework.boot.context.embedded.tomcat.TomcatEmbeddedServletContainerFactory.customizeConnector(TomcatEmbeddedServletContainerFactory.java:311) ~[spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at org.springframework.boot.context.embedded.tomcat.TomcatEmbeddedServletContainerFactory.getEmbeddedServletContainer(TomcatEmbeddedServletContainerFactory.java:169) ~[spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.createEmbeddedServletContainer(EmbeddedWebApplicationContext.java:164) ~[spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    at org.springframework.boot.context.embedded.EmbeddedWebApplicationContext.onRefresh(EmbeddedWebApplicationContext.java:134) ~[spring-boot-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
    ... 16 common frames omitted
</code></pre>
",979467,,1399491,,2018-12-12 18:26:43,2019-03-07 16:10:00,Unable to start springboot app - Resource location must not be null,<spring><spring-boot>,4,5,,
